"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[12969],{503625:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>o,contentTitle:()=>a,default:()=>p,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"cwa/scripts/da7e6b68-3ac3-4d15-9969-ca843a187d2d","title":"PowerShell Version Audit","description":"This document provides a detailed overview of a script that obtains the current agent PowerShell version, supported across all versions of PowerShell. It includes sample runs, dependencies, variables, process description, and expected output.","source":"@site/docs/cwa/scripts/PowerShell Version Audit.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/da7e6b68-3ac3-4d15-9969-ca843a187d2d","permalink":"/proval-docs/docs/cwa/scripts/da7e6b68-3ac3-4d15-9969-ca843a187d2d","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/PowerShell Version Audit.md","tags":[{"inline":false,"label":"Performance","permalink":"/proval-docs/docs/tags/performance","description":"Documents related to enhancing system and application performance"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"da7e6b68-3ac3-4d15-9969-ca843a187d2d","title":"PowerShell Version Audit","title_meta":"PowerShell Version Audit","keywords":["powershell","agent","version","script","query"],"description":"This document provides a detailed overview of a script that obtains the current agent PowerShell version, supported across all versions of PowerShell. It includes sample runs, dependencies, variables, process description, and expected output.","tags":["performance","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"PowerShell Response - All Errors - Check","permalink":"/proval-docs/docs/cwa/scripts/89346170-6657-4784-93cf-c0aa024b4386"},"next":{"title":"Powershell V2 - Disable","permalink":"/proval-docs/docs/cwa/scripts/9e2ff280-a904-48c5-b2de-017c77881147"}}');var i=t(474848),n=t(28453);const l={id:"da7e6b68-3ac3-4d15-9969-ca843a187d2d",title:"PowerShell Version Audit",title_meta:"PowerShell Version Audit",keywords:["powershell","agent","version","script","query"],description:"This document provides a detailed overview of a script that obtains the current agent PowerShell version, supported across all versions of PowerShell. It includes sample runs, dependencies, variables, process description, and expected output.",tags:["performance","windows"],draft:!1,unlisted:!1},a=void 0,o={},c=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Variables",id:"variables",level:2},{value:"Script States",id:"script-states",level:4},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2}];function d(e){const s={a:"a",h2:"h2",h4:"h4",img:"img",li:"li",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(s.p,{children:"This script obtains the current agent PowerShell version. The script is supported in all versions of PowerShell to collect its version."}),"\n",(0,i.jsx)(s.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"Sample Run",src:t(599463).A+"",width:"482",height:"352"})}),"\n",(0,i.jsx)(s.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://proval.itglue.com/DOC-5078775-10218221",children:"PowerShell Version Audit"})}),"\n",(0,i.jsx)(s.h2,{id:"variables",children:"Variables"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Name"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsx)(s.tbody,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"psout"}),(0,i.jsx)(s.td,{children:"This contains the PowerShell Version"})]})})]}),"\n",(0,i.jsx)(s.h4,{id:"script-states",children:"Script States"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Name"}),(0,i.jsx)(s.th,{children:"Example"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsx)(s.tbody,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"PowerShellVersion"}),(0,i.jsx)(s.td,{children:"2022.5.1"}),(0,i.jsx)(s.td,{children:"This contains the PowerShell Version"})]})})]}),"\n",(0,i.jsx)(s.h2,{id:"process",children:"Process"}),"\n",(0,i.jsx)(s.p,{children:"This script runs a PowerShell query that is supported by all Windows operating systems and collects the data to the Script State, which replicates to the dataview. It also stores the date when the PowerShell version was last checked."}),"\n",(0,i.jsx)(s.h2,{id:"output",children:"Output"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Script log"}),"\n",(0,i.jsx)(s.li,{children:"Script state"}),"\n",(0,i.jsx)(s.li,{children:"Dataview"}),"\n"]})]})}function p(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},599463:(e,s,t)=>{t.d(s,{A:()=>r});const r=t.p+"assets/images/image_1-2ce2283916d10c1c79143531829c8eb7.png"},28453:(e,s,t)=>{t.d(s,{R:()=>l,x:()=>a});var r=t(296540);const i={},n=r.createContext(i);function l(e){const s=r.useContext(n);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(n.Provider,{value:s},e.children)}}}]);