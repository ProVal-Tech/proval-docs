"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[93363],{821557:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>n,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"powershell/2e38bff4-a727-4c7e-8c3b-ccf8eee85891","title":"Backup-RegistryValue","description":"This document provides an overview of a script that creates a backup of a specified registry item either specifically or recursively to a designated backup location in the Windows registry. The script requires administrative rights and ensures that the backup is identical to the original key.","source":"@site/docs/powershell/Backup-RegistryValue.md","sourceDirName":"powershell","slug":"/powershell/2e38bff4-a727-4c7e-8c3b-ccf8eee85891","permalink":"/proval-docs/docs/powershell/2e38bff4-a727-4c7e-8c3b-ccf8eee85891","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/powershell/Backup-RegistryValue.md","tags":[{"inline":false,"label":"Backup","permalink":"/proval-docs/docs/tags/backup","description":"Documents detailing backup solutions and data protection strategies"},{"inline":false,"label":"Registry","permalink":"/proval-docs/docs/tags/registry","description":"Documents concerning system registry management and troubleshooting"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"2e38bff4-a727-4c7e-8c3b-ccf8eee85891","title":"Backup-RegistryValue","title_meta":"Backup-RegistryValue","keywords":["backup","registry","windows","administration","copy"],"description":"This document provides an overview of a script that creates a backup of a specified registry item either specifically or recursively to a designated backup location in the Windows registry. The script requires administrative rights and ensures that the backup is identical to the original key.","tags":["backup","registry","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Backup-BitlockerRecoveryPW","permalink":"/proval-docs/docs/powershell/ps-backup-bitlockerrecoverypw"},"next":{"title":"BackupTeamTool","permalink":"/proval-docs/docs/powershell/ps-backupteamtool"}}');var r=i(474848),a=i(28453);const n={id:"2e38bff4-a727-4c7e-8c3b-ccf8eee85891",title:"Backup-RegistryValue",title_meta:"Backup-RegistryValue",keywords:["backup","registry","windows","administration","copy"],description:"This document provides an overview of a script that creates a backup of a specified registry item either specifically or recursively to a designated backup location in the Windows registry. The script requires administrative rights and ensures that the backup is identical to the original key.",tags:["backup","registry","windows"],draft:!1,unlisted:!1},o=void 0,c={},d=[{value:"Overview",id:"overview",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Process",id:"process",level:2},{value:"Payload Usage",id:"payload-usage",level:2},{value:"Parameters",id:"parameters",level:3},{value:"Output",id:"output",level:2},{value:"Locations",id:"locations",level:2}];function l(e){const t={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(t.p,{children:["This script will ",(0,r.jsxs)(t.strong,{children:["create a backup of a registry item either specifically or recursively to ",(0,r.jsx)(t.code,{children:"HKLM:\\Software\\_automation\\RegistryBackup"})]}),"."]}),"\n",(0,r.jsxs)(t.p,{children:["For instance, if backing up the key ",(0,r.jsx)(t.strong,{children:"Windowsversion found in"})," ",(0,r.jsx)(t.strong,{children:(0,r.jsx)(t.code,{children:"HKLM:\\Software\\_automation\\WindowsUpdate"})}),", the backed-up key will be found in ",(0,r.jsx)(t.strong,{children:(0,r.jsx)(t.code,{children:"HKLM:\\SOFTWARE\\_automation\\RegistryBackup\\HKLM\\Software\\_automation\\WindowsUpdate\\Windowsversion"})}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"requirements",children:"Requirements"}),"\n",(0,r.jsx)(t.p,{children:"This script requires administrative rights to read and write in the registry."}),"\n",(0,r.jsx)(t.h2,{id:"process",children:"Process"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"Gets needed information for the key properties (or keys and all associated properties) being backed up."}),"\n",(0,r.jsxs)(t.li,{children:["Formats a new path for the backup using the standard ",(0,r.jsx)(t.code,{children:"HKLM:\\Software\\_automation\\RegistryBackup"})," (HKLM, HKCU, HKU, etc.) followed by the remainder of the given origin path."]}),"\n",(0,r.jsx)(t.li,{children:"Saves a copy of that key to the new location."}),"\n",(0,r.jsx)(t.li,{children:"Verifies that the copied key is identical to the original key."}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"payload-usage",children:"Payload Usage"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"Backup-RegistryValue.ps1 -Path 'HKLM:\\Software\\_automation\\WindowsUpdate' -KeyName Windowsversion\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Creates a copy of the key ",(0,r.jsx)(t.code,{children:"HKLM:\\Software\\_automation\\WindowsUpdate\\Windowsversion"})," to ",(0,r.jsx)(t.code,{children:"HKLM:\\SOFTWARE\\_automation\\RegistryBackup\\HKLM\\Software\\_automation\\WindowsUpdate\\Windowsversion"}),"."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"Backup-RegistryValue.ps1 'HKLM:\\SOFTWARE\\Microsoft\\DataAccess'\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Creates a copy of the key ",(0,r.jsx)(t.code,{children:"HKLM:\\Software\\Microsoft\\DataAccess"})," and all its subkeys recursively to ",(0,r.jsx)(t.code,{children:"HKLM:\\SOFTWARE\\_automation\\RegistryBackup\\HKLM\\Software\\Microsoft\\DataAccess"}),"."]}),"\n",(0,r.jsx)(t.h3,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Parameter"}),(0,r.jsx)(t.th,{children:"Alias"}),(0,r.jsx)(t.th,{children:"Required"}),(0,r.jsx)(t.th,{children:"Default"}),(0,r.jsx)(t.th,{children:"Type"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"-Path"})}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{children:"True"}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{children:"String"}),(0,r.jsx)(t.td,{children:"The path of the key you wish to backup."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"-Name"})}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{children:"True"}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{children:"String"}),(0,r.jsx)(t.td,{children:"Holds the key name for the desired backup specific key (omit for recursive backup)."})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:".\\Backup-RegistryValue-log.txt\r\n.\\Backup-RegistryValue-error.txt\n"})}),"\n",(0,r.jsx)(t.h2,{id:"locations",children:"Locations"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Payload"}),(0,r.jsx)(t.th,{})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"/repo/script/Backup-RegistryValue.ps1"}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Automate"}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"ConnectWise RMM"}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Kaseya"}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Datto RMM"}),(0,r.jsx)(t.td,{})]})]})]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},28453:(e,t,i)=>{i.d(t,{R:()=>n,x:()=>o});var s=i(296540);const r={},a=s.createContext(r);function n(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:n(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);