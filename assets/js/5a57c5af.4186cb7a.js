"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[71472],{462643:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"cwa/monitors/4a1b21f7-1b25-4640-9405-8c07277c54f0","title":"Windows Update Report","description":"This document outlines an optional monitor set designed to track machines where the Windows Update Report script has executed but failed to retrieve data. It includes SQL queries and dependencies necessary for effective monitoring and ticket creation if issues are detected.","source":"@site/docs/cwa/monitors/Windows Update Report.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/4a1b21f7-1b25-4640-9405-8c07277c54f0","permalink":"/docs/cwa/monitors/4a1b21f7-1b25-4640-9405-8c07277c54f0","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Windows Update Report.md","tags":[{"inline":false,"label":"Report","permalink":"/docs/tags/report","description":"Documents focused on generating and managing reports"},{"inline":false,"label":"SQL","permalink":"/docs/tags/sql","description":"Documents discussing Structured Query Language and database interactions"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"4a1b21f7-1b25-4640-9405-8c07277c54f0","title":"Windows Update Report","title_meta":"Windows Update Report","keywords":["monitor","windows","update","report","ticket"],"description":"This document outlines an optional monitor set designed to track machines where the Windows Update Report script has executed but failed to retrieve data. It includes SQL queries and dependencies necessary for effective monitoring and ticket creation if issues are detected.","tags":["report","sql","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Windows Update Orchestrator","permalink":"/docs/cwa/monitors/95f64d6e-cb10-4c2c-9d40-c55941a7d7bc"},"next":{"title":"Winget Auto Update Errors","permalink":"/docs/cwa/monitors/68a14948-368f-4064-97a3-d1928e122013"}}');var i=n(474848),s=n(28453);const o={id:"4a1b21f7-1b25-4640-9405-8c07277c54f0",title:"Windows Update Report",title_meta:"Windows Update Report",keywords:["monitor","windows","update","report","ticket"],description:"This document outlines an optional monitor set designed to track machines where the Windows Update Report script has executed but failed to retrieve data. It includes SQL queries and dependencies necessary for effective monitoring and ticket creation if issues are detected.",tags:["report","sql","windows"],draft:!1,unlisted:!1},a=void 0,d={},c=[{value:"Summary",id:"summary",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Target",id:"target",level:2},{value:"Translated SQL",id:"translated-sql",level:2}];function l(e){const t={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsxs)(t.p,{children:["This is an optional monitor set to keep an eye on the machines where ",(0,i.jsx)(t.a,{href:"/docs/cwa/scripts/41141ff5-ef57-4900-93d4-642b4a9d254f",children:"CWM - Automate - Script - Windows Update Report [DV]"})," script has executed at least twice in a month but failed to fetch any data."]}),"\n",(0,i.jsxs)(t.p,{children:["By default, it's a view-only monitor set, but the ",(0,i.jsx)(t.code,{children:"default - create automate ticket"})," alert template can be used to create tickets."]}),"\n",(0,i.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/cwa/scripts/41141ff5-ef57-4900-93d4-642b4a9d254f",children:"CWM - Automate - Script - Windows Update Report [DV]"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/cwa/monitors/fa9b4535-5711-4cde-ac58-cb9759dbd65a",children:"CWM - Automate - Internal Monitor - ProVal - Development - Fetch Windows Update Report [DV]"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/solutions/affc0b47-f0fe-43f9-95f6-0e0d1205b4d6",children:"CWM - Automate - Solution - Windows Update Report"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/cwa/tables/845fe569-12ec-48e3-86f4-34377aba03ec",children:"CWM - Automate - Custom Table - plugin_proval_windows_update_report"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/cwa/tables/938cd822-f6a3-4ee3-add2-62b407e45622",children:"SEC - Windows Patching - Custom Table - plugin_proval_windows_os_support"})}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"target",children:"Target"}),"\n",(0,i.jsx)(t.p,{children:"The SQL query is limiting the monitor to the machines that are supported by Microsoft and have a Managed Patch policy applied."}),"\n",(0,i.jsx)(t.h2,{id:"translated-sql",children:"Translated SQL"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sql",children:"SELECT \r\n  c.os AS testvalue, \r\n  c.version AS IdentityField, \r\n  c.computerid, \r\n  Cl.Name AS ClientName, \r\n  l.Name AS LocationName, \r\n  c.Name AS ComputerName, \r\n  c.lastContact AS LastContact, \r\n  acd.uptimestart, \r\n  acd.uptimeend, \r\n  acd.noalerts \r\nFROM \r\n  computers c \r\n  JOIN Clients Cl ON c.clientid = Cl.clientid \r\n  JOIN Locations L ON c.locationid = L.locationid \r\n  JOIN agentcomputerdata acd ON acd.computerid = c.computerid \r\n  LEFT JOIN plugin_proval_windows_os_support pp ON CASE \r\n    WHEN pp.build IS NULL OR pp.build = '' THEN c.os REGEXP pp.BaseOS \r\n    ELSE (pp.build = c.version AND c.os REGEXP pp.BaseOS) \r\n  END \r\nWHERE \r\n  (SELECT \r\n    COUNT(Softwarepolicy) \r\n  FROM \r\n    computerpatchpolicies \r\n  WHERE \r\n    Installpolicy IN (SELECT \r\n      ID \r\n    FROM \r\n      installsoftwarepolicies \r\n    WHERE \r\n      UpdateMode IN (5, 6)) \r\n    AND computerid = c.computerid) <> 0 \r\n  AND c.os LIKE '%Windows%' \r\n  AND (SELECT \r\n    COUNT(scriptid) \r\n  FROM \r\n    h_scripts \r\n  WHERE \r\n    scriptid = (SELECT \r\n      DISTINCT scriptid \r\n    FROM \r\n      lt_scripts \r\n    WHERE \r\n      scriptguid = '24e0791d-1733-11ed-9676-000c295e5f17') \r\n    AND StartedDate > NOW() - INTERVAL 30 DAY \r\n    AND Computerid = c.computerid) > 1 \r\n  AND (SELECT \r\n    COUNT(computerid) \r\n  FROM \r\n    plugin_proval_windows_update_report \r\n  WHERE \r\n    STR_TO_DATE(scriptruntime, '%m/%d/%Y %H:%i:%S') < NOW() - INTERVAL 1 MONTH \r\n    AND computerid = c.computerid) = 0 \r\n  AND IF(NOW() < (CASE \r\n    WHEN c.os REGEXP 'LTS[CB]' THEN supportltsbend \r\n    WHEN c.os REGEXP 'Enterprise|Server' THEN supportenterpriseend \r\n    ELSE supportmainstreamend \r\n  END), \r\n    'No', \r\n    'Yes') <> 'Yes'\n"})})]})}function p(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var r=n(296540);const i={},s=r.createContext(i);function o(e){const t=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);