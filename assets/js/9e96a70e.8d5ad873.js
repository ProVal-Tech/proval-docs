"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[12193],{120514:(e,o,t)=>{t.r(o),t.d(o,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>n,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"solutions/7736f421-bfd6-41c0-ba75-5eba3bc82f78","title":"CVE-2022-30190 MSDT Vulnerability - Workarounds","description":"This document provides a comprehensive solution for applying a temporary workaround for the Microsoft Support Diagnostic Tool Vulnerability (CVE-2022-30190) as released by Microsoft. It includes detailed implementation steps and associated content for monitoring and restoring registry keys.","source":"@site/docs/solutions/CVE-2022-30190 MSDT Vulnerability - Workarounds.md","sourceDirName":"solutions","slug":"/solutions/7736f421-bfd6-41c0-ba75-5eba3bc82f78","permalink":"/proval-docs/docs/solutions/7736f421-bfd6-41c0-ba75-5eba3bc82f78","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/solutions/CVE-2022-30190 MSDT Vulnerability - Workarounds.md","tags":[{"inline":false,"label":"Backup","permalink":"/proval-docs/docs/tags/backup","description":"Documents detailing backup solutions and data protection strategies"},{"inline":false,"label":"Security","permalink":"/proval-docs/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"7736f421-bfd6-41c0-ba75-5eba3bc82f78","title":"CVE-2022-30190 MSDT Vulnerability - Workarounds","title_meta":"CVE-2022-30190 MSDT Vulnerability - Workarounds","keywords":["microsoft","vulnerability","workaround","msdt","security"],"description":"This document provides a comprehensive solution for applying a temporary workaround for the Microsoft Support Diagnostic Tool Vulnerability (CVE-2022-30190) as released by Microsoft. It includes detailed implementation steps and associated content for monitoring and restoring registry keys.","tags":["backup","security","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"CVE-2016-2183 Birthday Attacks 3DES Cipher Suites Remediation","permalink":"/proval-docs/docs/solutions/3c954c80-c9c7-4cdf-bc64-a5b7ffe9bf98"},"next":{"title":"CVE-2023-36884 - HTML Remote Code Execution Vulnerability","permalink":"/proval-docs/docs/solutions/633ce746-ac44-421a-9b7d-26a726ed99e2"}}');var i=t(474848),s=t(28453);const n={id:"7736f421-bfd6-41c0-ba75-5eba3bc82f78",title:"CVE-2022-30190 MSDT Vulnerability - Workarounds",title_meta:"CVE-2022-30190 MSDT Vulnerability - Workarounds",keywords:["microsoft","vulnerability","workaround","msdt","security"],description:"This document provides a comprehensive solution for applying a temporary workaround for the Microsoft Support Diagnostic Tool Vulnerability (CVE-2022-30190) as released by Microsoft. It includes detailed implementation steps and associated content for monitoring and restoring registry keys.",tags:["backup","security","windows"],draft:!1,unlisted:!1},a=void 0,c={},l=[{value:"Purpose",id:"purpose",level:2},{value:"Associated Content",id:"associated-content",level:2},{value:"Implementation",id:"implementation",level:2},{value:"Introduction to a New Internal Monitor:",id:"introduction-to-a-new-internal-monitor",level:3}];function d(e){const o={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.h2,{id:"purpose",children:"Purpose"}),"\n",(0,i.jsxs)(o.p,{children:["This solution applies the temporary workaround for the Microsoft Support Diagnostic Tool Vulnerability, as released by Microsoft.",(0,i.jsx)(o.br,{}),"\n","Reference:",(0,i.jsx)(o.br,{}),"\n",(0,i.jsx)(o.a,{href:"https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/",children:"Guidance for CVE-2022-30190 Microsoft Support Diagnostic Tool Vulnerability"}),(0,i.jsx)(o.br,{}),"\n",(0,i.jsx)(o.a,{href:"https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-30190",children:"Microsoft Update Guide for CVE-2022-30190"})]}),"\n",(0,i.jsx)(o.h2,{id:"associated-content",children:"Associated Content"}),"\n",(0,i.jsxs)(o.table,{children:[(0,i.jsx)(o.thead,{children:(0,i.jsxs)(o.tr,{children:[(0,i.jsx)(o.th,{children:"Content"}),(0,i.jsx)(o.th,{children:"Type"}),(0,i.jsx)(o.th,{children:"Function"})]})}),(0,i.jsxs)(o.tbody,{children:[(0,i.jsxs)(o.tr,{children:[(0,i.jsx)(o.td,{children:(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/roles/174939f4-d7d5-4c92-9813-308db2c2b0c3",children:"MS-MSDT Registry Key"})}),(0,i.jsx)(o.td,{children:"Role"}),(0,i.jsx)(o.td,{children:"This role is used to detect the computers in need of a workaround."})]}),(0,i.jsxs)(o.tr,{children:[(0,i.jsx)(o.td,{children:(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/monitors/74e11590-49e4-445b-a380-18d2914f9f3f",children:"ProVal - Development - Workaround - Microsoft Support Diagnostic Tool Vulnerability [G]"})}),(0,i.jsx)(o.td,{children:"Internal Monitor"}),(0,i.jsxs)(o.td,{children:["This monitor set will detect the computers with the ",(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/roles/174939f4-d7d5-4c92-9813-308db2c2b0c3",children:"MS-MSDT Registry Key"})," role enabled and will execute the ",(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/scripts/af9266ed-a796-49b5-b497-944836e23b8c",children:"Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]"})," script to apply the autofix/workaround."]})]}),(0,i.jsxs)(o.tr,{children:[(0,i.jsx)(o.td,{children:(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/scripts/af9266ed-a796-49b5-b497-944836e23b8c",children:"Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]"})}),(0,i.jsx)(o.td,{children:"Script"}),(0,i.jsx)(o.td,{children:"The primary purpose of the script is to take a backup of the HKEY_CLASSES_ROOT/ms-msdt registry keys and remove them from the computer. However, it can also be executed manually to restore the key in case of need."})]}),(0,i.jsxs)(o.tr,{children:[(0,i.jsx)(o.td,{children:(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/dataviews/c9b50925-af78-47f8-b637-434d2c185f40",children:"Microsoft Support Diagnostic Tool Registry Key Audit [Script][Role]"})}),(0,i.jsx)(o.td,{children:"Dataview"}),(0,i.jsxs)(o.td,{children:["This serves the purpose of tracking the progress of the workaround being applied by the ",(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/scripts/af9266ed-a796-49b5-b497-944836e23b8c",children:"Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]"})," script and the ",(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/monitors/74e11590-49e4-445b-a380-18d2914f9f3f",children:"ProVal - Development - Workaround - Microsoft Support Diagnostic Tool Vulnerability [G]"})," monitor set."]})]}),(0,i.jsxs)(o.tr,{children:[(0,i.jsx)(o.td,{children:(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/monitors/e711d3f6-7a23-42da-8d60-400318c8b725",children:"ProVal - Development - Restore MS-MSDT Registry Key [G]"})}),(0,i.jsx)(o.td,{children:"Internal Monitor"}),(0,i.jsxs)(o.td,{children:["This will run the ",(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/scripts/af9266ed-a796-49b5-b497-944836e23b8c",children:"Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]"})," script to restore the key on computers where the recommended patches are installed."]})]})]})]}),"\n",(0,i.jsx)(o.h2,{id:"implementation",children:"Implementation"}),"\n",(0,i.jsxs)(o.ol,{children:["\n",(0,i.jsxs)(o.li,{children:["Import the Role, ",(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/roles/174939f4-d7d5-4c92-9813-308db2c2b0c3",children:"MS-MSDT Registry Key"}),"."]}),"\n",(0,i.jsxs)(o.li,{children:["Import the Internal Monitor, ",(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/monitors/74e11590-49e4-445b-a380-18d2914f9f3f",children:"ProVal - Development - Workaround - Microsoft Support Diagnostic Tool Vulnerability [G]"}),"."]}),"\n",(0,i.jsxs)(o.li,{children:["Import the Script, ",(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/scripts/af9266ed-a796-49b5-b497-944836e23b8c",children:"Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]"}),"."]}),"\n",(0,i.jsxs)(o.li,{children:["Import the Dataview, ",(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/dataviews/c9b50925-af78-47f8-b637-434d2c185f40",children:"Microsoft Support Diagnostic Tool Registry Key Audit [Script][Role]"}),"."]}),"\n",(0,i.jsxs)(o.li,{children:['Create an alert template "WorkAround - MSDT Vulnerability" to run the ',(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/scripts/af9266ed-a796-49b5-b497-944836e23b8c",children:"Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]"})," script."]}),"\n",(0,i.jsxs)(o.li,{children:['Apply the "WorkAround - MSDT Vulnerability" template to the ',(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/monitors/74e11590-49e4-445b-a380-18d2914f9f3f",children:"ProVal - Development - Workaround - Microsoft Support Diagnostic Tool Vulnerability [G]"})," internal monitor."]}),"\n",(0,i.jsx)(o.li,{children:'Execute the "Update Config" command against all agent groups.'}),"\n",(0,i.jsx)(o.li,{children:"Wait for 10 minutes."}),"\n",(0,i.jsx)(o.li,{children:'Execute the "Resend System" command against all agent groups.'}),"\n"]}),"\n",(0,i.jsx)(o.p,{children:(0,i.jsx)(o.strong,{children:"OR"})}),"\n",(0,i.jsxs)(o.ol,{children:["\n",(0,i.jsxs)(o.li,{children:["Import the ",(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/scripts/af9266ed-a796-49b5-b497-944836e23b8c",children:"Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]"})," script."]}),"\n",(0,i.jsx)(o.li,{children:"Execute it against a computer, and it will import the rest of the contents."}),"\n",(0,i.jsx)(o.li,{children:"Verify the existence of the contents."}),"\n",(0,i.jsx)(o.li,{children:'Execute the "Update Config" command against all agent groups.'}),"\n",(0,i.jsx)(o.li,{children:"Wait for 10 minutes."}),"\n",(0,i.jsx)(o.li,{children:'Execute the "Resend System" command against all agent groups.'}),"\n"]}),"\n",(0,i.jsxs)(o.p,{children:["The above steps will accomplish the task, but if you need tickets for failures, you will have to update the value of the global variable ",(0,i.jsx)(o.code,{children:"Ticket"})," to 1."]}),"\n",(0,i.jsx)(o.h3,{id:"introduction-to-a-new-internal-monitor",children:"Introduction to a New Internal Monitor:"}),"\n",(0,i.jsxs)(o.ol,{children:["\n",(0,i.jsxs)(o.li,{children:['Import the "',(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/monitors/e711d3f6-7a23-42da-8d60-400318c8b725",children:"ProVal - Development - Restore MS-MSDT Registry Key [G]"}),'" monitor set from the pro-sync plugin.']}),"\n",(0,i.jsxs)(o.li,{children:["Update the ",(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/monitors/74e11590-49e4-445b-a380-18d2914f9f3f",children:"ProVal - Development - Workaround - Microsoft Support Diagnostic Tool Vulnerability [G]"})," monitor set from the pro-sync plugin."]}),"\n",(0,i.jsxs)(o.li,{children:["Update the ",(0,i.jsx)(o.a,{href:"/proval-docs/docs/cwa/scripts/af9266ed-a796-49b5-b497-944836e23b8c",children:"Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]"})," script from the pro-sync plugin."]}),"\n"]})]})}function p(e={}){const{wrapper:o}={...(0,s.R)(),...e.components};return o?(0,i.jsx)(o,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,o,t)=>{t.d(o,{R:()=>n,x:()=>a});var r=t(296540);const i={},s=r.createContext(i);function n(e){const o=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function a(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:n(e.components),r.createElement(s.Provider,{value:o},e.children)}}}]);