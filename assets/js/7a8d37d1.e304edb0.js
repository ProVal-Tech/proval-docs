"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[56236],{237776:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>i,default:()=>R,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"cwa/monitors/b08343d9-9d4b-4edd-92e2-5941c23d8e43","title":"Import- TLS Version Check - Server","description":"This document provides a step-by-step guide on how to set up a remote monitor for checking TLS versions within specified groups in your database. It includes obtaining group IDs, modifying SQL queries, and executing them to establish the monitor.","source":"@site/docs/cwa/monitors/Import- TLS Version Check - Server.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/b08343d9-9d4b-4edd-92e2-5941c23d8e43","permalink":"/docs/cwa/monitors/b08343d9-9d4b-4edd-92e2-5941c23d8e43","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Import- TLS Version Check - Server.md","tags":[{"inline":false,"label":"Database","permalink":"/docs/tags/database","description":"Documents related to database management systems and operations"},{"inline":false,"label":"Security","permalink":"/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Setup","permalink":"/docs/tags/setup","description":"Documents on setting up software and hardware configurations"}],"version":"current","frontMatter":{"id":"b08343d9-9d4b-4edd-92e2-5941c23d8e43","title":"Import- TLS Version Check - Server","title_meta":"Import- TLS Version Check - Server","keywords":["tls","monitor","setup","database","query"],"description":"This document provides a step-by-step guide on how to set up a remote monitor for checking TLS versions within specified groups in your database. It includes obtaining group IDs, modifying SQL queries, and executing them to establish the monitor.","tags":["database","security","setup"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Import- TLS Version Check - Client","permalink":"/docs/cwa/monitors/a2436d9b-83e4-4405-a3e1-dc4019438d3a"},"next":{"title":"Import- Time Sync Compliance","permalink":"/docs/cwa/monitors/d0b9c0fa-fe52-412b-a4b9-dee96f9ff58b"}}');var o=n(474848),a=n(28453);const s={id:"b08343d9-9d4b-4edd-92e2-5941c23d8e43",title:"Import- TLS Version Check - Server",title_meta:"Import- TLS Version Check - Server",keywords:["tls","monitor","setup","database","query"],description:"This document provides a step-by-step guide on how to set up a remote monitor for checking TLS versions within specified groups in your database. It includes obtaining group IDs, modifying SQL queries, and executing them to establish the monitor.",tags:["database","security","setup"],draft:!1,unlisted:!1},i=void 0,c={},d=[{value:"Step 1.",id:"step-1",level:3},{value:"Step 2.",id:"step-2",level:3},{value:"Step 3.",id:"step-3",level:3},{value:"Step 4.",id:"step-4",level:3},{value:"Step 5.",id:"step-5",level:3}];function S(e){const r={br:"br",code:"code",h3:"h3",hr:"hr",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.h3,{id:"step-1",children:"Step 1."}),"\n",(0,o.jsx)(r.p,{children:"Obtain the group ID(s) of the group(s) that the remote monitor should be applied to."}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsx)(r.h3,{id:"step-2",children:"Step 2."}),"\n",(0,o.jsxs)(r.p,{children:["Copy the following query and replace ",(0,o.jsx)(r.strong,{children:"YOUR COMMA SEPARATED LIST OF GROUP ID(S)"})," with the Group ID(s) of the relevant groups:",(0,o.jsx)(r.br,{}),"\n","(The string to replace can be found at the very bottom of the query, right after ",(0,o.jsx)(r.strong,{children:"WHERE"}),")"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{children:"INSERT INTO groupagents \r\n  SELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'TLS Version Check - Server' as `Name`,\r\n'6' as `CheckAction`,\r\n'1' as `AlertAction`,\r\n'%NAME% %STATUS% on %CLIENTNAME%//%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%.!!!%NAME% %STATUS% on %CLIENTNAME%//%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%.' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'86400' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C://Windows//System32//WindowsPowerShell//v1.0//powershell.exe -ExecutionPolicy Bypass -Command \\\"$ErroractionPreference= /'SilentlyContinue/'; $protocols = @(/'1.0/',/'1.1/',/'1.2/',/'1.3/'); $Enabled = @() ;foreach ( $protocol in $protocols ) { $Enable = (Get-Itemproperty \\\"//HKLM//SYSTEM//CurrentControlSet//Control//SecurityProviders//SCHANNEL//Protocols//TLS $($protocol)//Server//\\\" -Erroraction SilentlyContinue).Enabled; if ($Enable -ne $Null) {if ($Enable -ge 1) {$Enabled += $protocol} } else {$OSVer = [version](Get-WmiObject Win32_OperatingSystem).Version; if($OSVer -lt [Version]/'6.1/') {$Enabled += @(/'1.0/') -Match $protocol} elseif ($osVer -lt [Version]/'6.2/') {$Enabled += @(/'1.0/',/'1.1/') -Match $protocol} else {$Enabled += @(/'1.0/',/'1.1/',/'1.2/') -Match $Protocol} }}; return $($Enabled -Join /',/')\\\" as `DataOut`,\r\n'12' as `Comparor`,\r\n'' as `DataIn`,\r\n'' as `IDField`,\r\n'0' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'21' as `Category`,\r\n'0' as `TicketCategory`,\r\n'1' as `ScriptTarget`,\r\nCONCAT(\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1)\r\n) as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (YOUR COMMA SEPARATED LIST OF GROUPID(S))\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'TLS Version Check - Server');\n"})}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsx)(r.h3,{id:"step-3",children:"Step 3."}),"\n",(0,o.jsx)(r.p,{children:"An example of a query with a group ID:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{children:"INSERT INTO groupagents \r\n  SELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'TLS Version Check - Server' as `Name`,\r\n'6' as `CheckAction`,\r\n'1' as `AlertAction`,\r\n'%NAME% %STATUS% on %CLIENTNAME%//%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%.!!!%NAME% %STATUS% on %CLIENTNAME%//%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%.' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'86400' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C://Windows//System32//WindowsPowerShell//v1.0//powershell.exe -ExecutionPolicy Bypass -Command \\\"$ErroractionPreference= /'SilentlyContinue/'; $protocols = @(/'1.0/',/'1.1/',/'1.2/',/'1.3/'); $Enabled = @() ;foreach ( $protocol in $protocols ) { $Enable = (Get-Itemproperty \\\"//HKLM//SYSTEM//CurrentControlSet//Control//SecurityProviders//SCHANNEL//Protocols//TLS $($protocol)//Server//\\\" -Erroraction SilentlyContinue).Enabled; if ($Enable -ne $Null) {if ($Enable -ge 1) {$Enabled += $protocol} } else {$OSVer = [version](Get-WmiObject Win32_OperatingSystem).Version; if($OSVer -lt [Version]/'6.1/') {$Enabled += @(/'1.0/') -Match $protocol} elseif ($osVer -lt [Version]/'6.2/') {$Enabled += @(/'1.0/',/'1.1/') -Match $protocol} else {$Enabled += @(/'1.0/',/'1.1/',/'1.2/') -Match $Protocol} }}; return $($Enabled -Join /',/')\\\" as `DataOut`,\r\n'12' as `Comparor`,\r\n'' as `DataIn`,\r\n'' as `IDField`,\r\n'0' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'21' as `Category`,\r\n'0' as `TicketCategory`,\r\n'1' as `ScriptTarget`,\r\nCONCAT(\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1)\r\n) as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (950,955,853)\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'TLS Version Check - Server');\n"})}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsx)(r.h3,{id:"step-4",children:"Step 4."}),"\n",(0,o.jsx)(r.p,{children:"Now execute your query from a RAWSQL monitor set."}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsx)(r.h3,{id:"step-5",children:"Step 5."}),"\n",(0,o.jsx)(r.p,{children:"Locate your remote monitor by opening the group(s) remote monitors tab, then apply the appropriate alert template."})]})}function R(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(S,{...e})}):S(e)}},28453:(e,r,n)=>{n.d(r,{R:()=>s,x:()=>i});var t=n(296540);const o={},a=t.createContext(o);function s(e){const r=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(a.Provider,{value:r},e.children)}}}]);