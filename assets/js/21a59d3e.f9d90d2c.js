"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[55877],{493456:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>o,contentTitle:()=>c,default:()=>p,frontMatter:()=>r,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"cwa/scripts/bc22877d-262a-47f7-8d2f-7e69f07c92e5","title":"Bitlocker - Key Retrieval","description":"This document details a script that audits the recovery keys for each encrypted drive on an agent and adds the information to a custom table, saving time and improving efficiency in managing BitLocker encryption.","source":"@site/docs/cwa/scripts/Bitlocker - Key Retrieval.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/bc22877d-262a-47f7-8d2f-7e69f07c92e5","permalink":"/proval-docs/docs/cwa/scripts/bc22877d-262a-47f7-8d2f-7e69f07c92e5","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Bitlocker - Key Retrieval.md","tags":[{"inline":false,"label":"Database","permalink":"/proval-docs/docs/tags/database","description":"Documents related to database management systems and operations"},{"inline":false,"label":"Encryption","permalink":"/proval-docs/docs/tags/encryption","description":"Documents discussing encryption technologies for data protection"},{"inline":false,"label":"Security","permalink":"/proval-docs/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Setup","permalink":"/proval-docs/docs/tags/setup","description":"Documents on setting up software and hardware configurations"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"bc22877d-262a-47f7-8d2f-7e69f07c92e5","title":"Bitlocker - Key Retrieval","title_meta":"Bitlocker - Key Retrieval","keywords":["audit","recovery","keys","encrypted","drives","database"],"description":"This document details a script that audits the recovery keys for each encrypted drive on an agent and adds the information to a custom table, saving time and improving efficiency in managing BitLocker encryption.","tags":["database","encryption","security","setup","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Bitlocker - Enable TPM","permalink":"/proval-docs/docs/cwa/scripts/aa0c7575-d9f1-4c41-98bb-50eab8aa1ade"},"next":{"title":"Bitlocker - Remove Volume","permalink":"/proval-docs/docs/cwa/scripts/710777f0-5c3f-4582-96e9-3beacaf085eb"}}');var s=i(474848),a=i(28453);const r={id:"bc22877d-262a-47f7-8d2f-7e69f07c92e5",title:"Bitlocker - Key Retrieval",title_meta:"Bitlocker - Key Retrieval",keywords:["audit","recovery","keys","encrypted","drives","database"],description:"This document details a script that audits the recovery keys for each encrypted drive on an agent and adds the information to a custom table, saving time and improving efficiency in managing BitLocker encryption.",tags:["database","encryption","security","setup","windows"],draft:!1,unlisted:!1},c=void 0,o={},d=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Variables",id:"variables",level:2},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2}];function l(e){const t={a:"a",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsx)(t.p,{children:"This script audits the recovery keys for each encrypted drive on an agent and adds them to a custom table."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Time Saved by Automation:"})," 5 Minutes"]}),"\n",(0,s.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Sample Run",src:i(885815).A+"",width:"479",height:"347"})}),"\n",(0,s.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"@plugin_proval_bitlocker (Table)"}),"\n",(0,s.jsx)(t.li,{children:"@BitLocker Enabled (Role)"}),"\n",(0,s.jsx)(t.li,{children:"@BitLocker TPM Enabled (Role)"}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"/proval-docs/docs/cwa/roles/e5234598-aaa5-412c-8425-f9d1c95c00b5",children:"BitLocker TPM Ready"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"../dataviews/Windows%20-%20BitLocker%20Eligibility.md",children:"Windows - BitLocker Eligibility"})}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"variables",children:"Variables"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"@PowerShellResult@"})," -> This variable shows whether BitLocker is enabled, retrieves the keys, and returns the corresponding information if it cannot be enabled."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"@sqlletter@"})," -> SQL dataset cycling that returns the drive letter checked."]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"process",children:"Process"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Creates the required table if it does not already exist in the database."}),"\n",(0,s.jsx)(t.li,{children:"Adds the required role definitions for the dataview."}),"\n",(0,s.jsx)(t.li,{children:"Queries the target machine(s) and runs PowerShell to return the BitLocker key or the BitLocker status."}),"\n",(0,s.jsx)(t.li,{children:"Writes the key back into the Automate database if it is found to be encrypted."}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Script log"}),"\n",(0,s.jsx)(t.li,{children:"Role"}),"\n",(0,s.jsx)(t.li,{children:"Dataview"}),"\n"]})]})}function p(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},885815:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/image_1-e2c72ee3d321f221ee50352030420b06.png"},28453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>c});var n=i(296540);const s={},a=n.createContext(s);function r(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);