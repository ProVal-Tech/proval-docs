"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[23493],{212940:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"powershell/1f1d7e57-764e-4888-bda1-fc0ea45f85c0","title":"Restore-RegistryValue","description":"This document provides a comprehensive guide on restoring backed up registry key properties or keys recursively using the Restore-RegistryValue.ps1 script. It outlines the requirements, process, parameters, and output associated with the script, ensuring users can effectively restore their registry settings.","source":"@site/docs/powershell/Restore-RegistryValue.md","sourceDirName":"powershell","slug":"/powershell/1f1d7e57-764e-4888-bda1-fc0ea45f85c0","permalink":"/proval-docs/docs/powershell/1f1d7e57-764e-4888-bda1-fc0ea45f85c0","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/powershell/Restore-RegistryValue.md","tags":[{"inline":false,"label":"Backup","permalink":"/proval-docs/docs/tags/backup","description":"Documents detailing backup solutions and data protection strategies"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"1f1d7e57-764e-4888-bda1-fc0ea45f85c0","title":"Restore-RegistryValue","title_meta":"Restore-RegistryValue","keywords":["registry","restore","backup","windows","administration"],"description":"This document provides a comprehensive guide on restoring backed up registry key properties or keys recursively using the Restore-RegistryValue.ps1 script. It outlines the requirements, process, parameters, and output associated with the script, ensuring users can effectively restore their registry settings.","tags":["backup","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Reset-KrbtgtKeys","permalink":"/proval-docs/docs/powershell/ps-reset-krbtgtkeys"},"next":{"title":"Set-ChromiumHomepage","permalink":"/proval-docs/docs/powershell/ps-set-chromiumhomepage"}}');var i=s(474848),n=s(28453);const o={id:"1f1d7e57-764e-4888-bda1-fc0ea45f85c0",title:"Restore-RegistryValue",title_meta:"Restore-RegistryValue",keywords:["registry","restore","backup","windows","administration"],description:"This document provides a comprehensive guide on restoring backed up registry key properties or keys recursively using the Restore-RegistryValue.ps1 script. It outlines the requirements, process, parameters, and output associated with the script, ensuring users can effectively restore their registry settings.",tags:["backup","windows"],draft:!1,unlisted:!1},d=void 0,a={},l=[{value:"Overview",id:"overview",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Process",id:"process",level:2},{value:"Payload Usage",id:"payload-usage",level:2},{value:"Parameters",id:"parameters",level:3},{value:"Output",id:"output",level:2},{value:"Locations",id:"locations",level:2}];function c(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(t.p,{children:["This document explains how to restore a backed-up registry key property or registry key recursively when backed up with ",(0,i.jsx)(t.code,{children:"Backup-RegistryValue.ps1"}),"."]}),"\n",(0,i.jsx)(t.h2,{id:"requirements",children:"Requirements"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["The ",(0,i.jsx)(t.a,{href:"/proval-docs/docs/powershell/2e38bff4-a727-4c7e-8c3b-ccf8eee85891",children:"EPM - Windows Configuration - Agnostic - Script - Backup-RegistryValue"})," must have been used to back up the registry value."]}),"\n",(0,i.jsx)(t.li,{children:"The script must be run with Admin Rights."}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"process",children:"Process"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"Retrieve the necessary information for the key properties (or keys and all associated properties) being restored."}),"\n",(0,i.jsx)(t.li,{children:"Restore the key property or key properties to their original registry location."}),"\n",(0,i.jsxs)(t.li,{children:["Verify that the two keys match.","\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"If the removal of the backup is desired, remove the backup key."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"payload-usage",children:"Payload Usage"}),"\n",(0,i.jsx)(t.p,{children:"To restore the backed-up key property to its original registry location and remove the backed-up key property when finished, use the following command:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'Restore-RegistryValue.ps1 -Path "HKLM:\\\\Software\\\\_automation\\\\WindowsUpdate\\\\Windowsversion" -Name Windowsversion -RemoveOnRestore\n'})}),"\n",(0,i.jsx)(t.p,{children:"To restore the backed-up key property and all recursive keys and properties to their original registry locations, use the following command:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'Restore-RegistryValue.ps1 -Path "HKLM:\\\\Software\\\\_automation\\\\WindowsUpdate\\\\Windowsversion"\n'})}),"\n",(0,i.jsx)(t.h3,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Parameter"}),(0,i.jsx)(t.th,{children:"Alias"}),(0,i.jsx)(t.th,{children:"Required"}),(0,i.jsx)(t.th,{children:"Default"}),(0,i.jsx)(t.th,{children:"Type"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"-Path"})}),(0,i.jsx)(t.td,{}),(0,i.jsx)(t.td,{children:"True"}),(0,i.jsx)(t.td,{}),(0,i.jsx)(t.td,{children:"String"}),(0,i.jsx)(t.td,{children:"The path to the backed-up registry key."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"-Name"})}),(0,i.jsx)(t.td,{}),(0,i.jsx)(t.td,{children:"True"}),(0,i.jsx)(t.td,{}),(0,i.jsx)(t.td,{children:"String"}),(0,i.jsx)(t.td,{children:"The original path of the backed-up key."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"-RemoveOnRestore"})}),(0,i.jsx)(t.td,{}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:"Bool"}),(0,i.jsx)(t.td,{children:"Designates removal of the backed-up key after successful restore."})]})]})]}),"\n",(0,i.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,i.jsx)(t.p,{children:"Does the content write to the RMM log, a data file, or the console? If so, what is the syntax?"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:".\\Restore-RegistryValue-log.txt\r\n.\\Restore-RegistryValue-error.txt\n"})}),"\n",(0,i.jsx)(t.h2,{id:"locations",children:"Locations"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Payload"}),(0,i.jsx)(t.th,{children:"Path"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Restore Script"}),(0,i.jsx)(t.td,{children:"/repo/script/Restore-RegistryValue.ps1"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Automate"}),(0,i.jsx)(t.td,{})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"ConnectWise RMM"}),(0,i.jsx)(t.td,{})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Kaseya"}),(0,i.jsx)(t.td,{})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Datto RMM"}),(0,i.jsx)(t.td,{})]})]})]})]})}function h(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>o,x:()=>d});var r=s(296540);const i={},n=r.createContext(i);function o(e){const t=r.useContext(n);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(n.Provider,{value:t},e.children)}}}]);