"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[83476],{475463:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"cwa/scripts/e5e1f07f-f6ed-41bc-b0f1-b2cc86e059e1","title":"Service - Restart","description":"This document outlines a script designed to restart one or more services on Windows machines with comprehensive error handling. It includes implementation steps, dependencies, user parameters, and system properties necessary for successful execution. The script can be triggered through a custom alert template for automated service management.","source":"@site/docs/cwa/scripts/Service - Restart.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/e5e1f07f-f6ed-41bc-b0f1-b2cc86e059e1","permalink":"/docs/cwa/scripts/e5e1f07f-f6ed-41bc-b0f1-b2cc86e059e1","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Service - Restart.md","tags":[{"inline":false,"label":"Ticketing","permalink":"/docs/tags/ticketing","description":"Documents related to ticketing systems and IT support management"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"e5e1f07f-f6ed-41bc-b0f1-b2cc86e059e1","title":"Service - Restart","title_meta":"Service - Restart","keywords":["restart","services","error","handling","windows"],"description":"This document outlines a script designed to restart one or more services on Windows machines with comprehensive error handling. It includes implementation steps, dependencies, user parameters, and system properties necessary for successful execution. The script can be triggered through a custom alert template for automated service management.","tags":["ticketing","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"SentinelOne Agent Deployment","permalink":"/docs/cwa/scripts/eacca668-9959-4317-81d7-ee037837139c"},"next":{"title":"Service Start - Routing and Remote Access Autofix","permalink":"/docs/cwa/scripts/2ce8cbad-6df7-4d57-bb96-50f43f002491"}}');var i=s(474848),n=s(28453);const c={id:"e5e1f07f-f6ed-41bc-b0f1-b2cc86e059e1",title:"Service - Restart",title_meta:"Service - Restart",keywords:["restart","services","error","handling","windows"],description:"This document outlines a script designed to restart one or more services on Windows machines with comprehensive error handling. It includes implementation steps, dependencies, user parameters, and system properties necessary for successful execution. The script can be triggered through a custom alert template for automated service management.",tags:["ticketing","windows"],draft:!1,unlisted:!1},d=void 0,a={},l=[{value:"Summary",id:"summary",level:2},{value:"Implementation",id:"implementation",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Variables",id:"variables",level:3},{value:"User Parameters",id:"user-parameters",level:2},{value:"System Properties",id:"system-properties",level:2},{value:"Ticket Category",id:"ticket-category",level:2},{value:"Output",id:"output",level:2}];function o(e){const t={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(t.p,{children:"This script will restart one or more services with proper error handling. It can also be imported and triggered using the Alert Template '\u25b3 Custom - Autofix - Restart Service'."}),"\n",(0,i.jsx)(t.h2,{id:"implementation",children:"Implementation"}),"\n",(0,i.jsx)(t.p,{children:"These steps must be followed after importing/updating the script after September 5, 2023."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Step 1:"})," Run the script on any online Windows computer. This will create the necessary system properties."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"System Properties",src:s(833884).A+"",width:"501",height:"446"})}),"\n",(0,i.jsx)(t.p,{children:"System Properties:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"System Properties",src:s(91991).A+"",width:"967",height:"275"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Step 2:"})," Set the system properties for alerting. Check the ",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.code,{children:"System Properties"})})," section of the document for more information on the properties."]}),"\n",(0,i.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Manual Execution:"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Manual Execution",src:s(662766).A+"",width:"503",height:"447"})}),"\n",(0,i.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/powershell/ps-invoke-restartservice",children:"EPM - Windows Configuration - Agnostic - Invoke-RestartService"})}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"variables",children:"Variables"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Name"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"STATUS"}),(0,i.jsx)(t.td,{children:"Status returned from Monitor Set (SUCCESS"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"FieldName"}),(0,i.jsx)(t.td,{children:"Service name returned from Monitor Set"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Subject"}),(0,i.jsx)(t.td,{children:"Ticket/Email subject"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Body"}),(0,i.jsx)(t.td,{children:"Ticket/Email body for failure"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Comment"}),(0,i.jsx)(t.td,{children:"Ticket/Email comment for failure"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"TicketComment"}),(0,i.jsx)(t.td,{children:"Ticket comment for success"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"EmailBody"}),(0,i.jsx)(t.td,{children:"Email body for success"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"TicketCreationCategory"}),(0,i.jsx)(t.td,{children:"Numerical ID of the ticket category to create the ticket. The script will fetch the ticket category from the monitor set running it."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"PSCheck"}),(0,i.jsx)(t.td,{children:"To check the PowerShell version of the computer, the script will perform Automate's inbuilt functions to attempt to restart the service for older operating systems."})]})]})]}),"\n",(0,i.jsx)(t.h2,{id:"user-parameters",children:"User Parameters"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Name"}),(0,i.jsx)(t.th,{children:"Example"}),(0,i.jsx)(t.th,{children:"Required"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"ServiceNames"}),(0,i.jsx)(t.td,{children:"'SAAZDPMACTL', 'SAAZWatchDog', 'SAAZServerPlus', 'SAAZScheduler'"}),(0,i.jsx)(t.td,{children:"True (for manual execution)"}),(0,i.jsx)(t.td,{children:"A string array of service names to restart."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Set_Environment"}),(0,i.jsx)(t.td,{children:"1"}),(0,i.jsx)(t.td,{children:"True (for first run)"}),(0,i.jsx)(t.td,{children:"Set it to 1 to create the required system properties."})]})]})]}),"\n",(0,i.jsx)(t.h2,{id:"system-properties",children:"System Properties"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Name"}),(0,i.jsx)(t.th,{children:"Example"}),(0,i.jsx)(t.th,{children:"Required"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Restart_Service_Autofix_Ticketing_Enabled"}),(0,i.jsx)(t.td,{children:"1"}),(0,i.jsx)(t.td,{children:"True"}),(0,i.jsx)(t.td,{children:"1 and 0 to toggle between the ticket creation feature of the script. The default value is 1 (Enabled Ticketing)."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Restart_Service_Autofix_Emailing_Enabled"}),(0,i.jsx)(t.td,{children:"0"}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:"1 and 0 to toggle between the emailing feature of the script. The default value is 0 (Disabled Emailing)."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Restart_Service_Autofix_Send_Success_Email"}),(0,i.jsx)(t.td,{children:"0"}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsxs)(t.td,{children:["Set it to 1 to send an email on monitor success as well. The default value is 0. To enable monitor success emails, ",(0,i.jsx)(t.code,{children:"Restart_Service_Autofix_Emailing_Enabled"})," must be set to 1."]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"_sysTicketDefaultEmail"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"mailto:support@provaltech.com",children:"support@provaltech.com"})}),(0,i.jsx)(t.td,{children:"True (if emailing is enabled)"}),(0,i.jsxs)(t.td,{children:["Email address to notify. It is mandatory to set the email address(es) if the system property ",(0,i.jsx)(t.code,{children:"Restart_Service_Autofix_Emailing_Enabled"})," is set to 1. Multiple email addresses should be separated by a semicolon. ",(0,i.jsx)(t.strong,{children:"Note: Please be careful while making any changes to this property as this is a default system property and other script(s) might be using this as well. Do not update the email address(es) saved in this property without checking the other scripts for this system property."})]})]})]})]}),"\n",(0,i.jsx)(t.h2,{id:"ticket-category",children:"Ticket Category"}),"\n",(0,i.jsx)(t.p,{children:"The script will fetch the ticket category from the monitor set running the script."}),"\n",(0,i.jsxs)(t.p,{children:["From individual machine:",(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.img,{alt:"Individual Machine",src:s(580481).A+"",width:"937",height:"587"})]}),"\n",(0,i.jsxs)(t.p,{children:["From Group Monitor:",(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.img,{alt:"Group Monitor",src:s(359352).A+"",width:"1000",height:"453"})]}),"\n",(0,i.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Script log (for detailed information on individual results)"}),"\n",(0,i.jsx)(t.li,{children:"Tickets (if enabled)"}),"\n",(0,i.jsx)(t.li,{children:"Emails (if enabled)"}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},833884:(e,t,s)=>{s.d(t,{A:()=>r});const r=s.p+"assets/images/image_1-a0c7b6fe387acf6e673aca9eb70b5fb0.png"},91991:(e,t,s)=>{s.d(t,{A:()=>r});const r=s.p+"assets/images/image_2-d5f8ca68a12359143eabacdf6b6dfd32.png"},662766:(e,t,s)=>{s.d(t,{A:()=>r});const r=s.p+"assets/images/image_3-f7a5c13d2bf55f4994f54224b6919b27.png"},580481:(e,t,s)=>{s.d(t,{A:()=>r});const r=s.p+"assets/images/image_4-1415f39da619c8e179e880c7d443dee6.png"},359352:(e,t,s)=>{s.d(t,{A:()=>r});const r=s.p+"assets/images/image_5-9396e07a56e66c9b860613b5d042ff59.png"},28453:(e,t,s)=>{s.d(t,{R:()=>c,x:()=>d});var r=s(296540);const i={},n=r.createContext(i);function c(e){const t=r.useContext(n);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(n.Provider,{value:t},e.children)}}}]);