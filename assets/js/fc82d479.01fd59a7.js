"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[34964],{35626:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>n,toc:()=>a});const n=JSON.parse('{"id":"cwa/scripts/c8638470-bc69-4bc9-ac97-b0496e546d07","title":"CVE-2013-3900 WinVerifyTrust Signature Vulnerability","description":"This document outlines the process for detecting and remediating the CVE-2013-3900 WinVerifyTrust Signature Vulnerability using a specific script. It includes details on dependencies, variables, output, and ticketing procedures necessary for effective management of the vulnerability.","source":"@site/docs/cwa/scripts/CVE-2013-3900 WinVerifyTrust Signature Vulnerability.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/c8638470-bc69-4bc9-ac97-b0496e546d07","permalink":"/docs/cwa/scripts/c8638470-bc69-4bc9-ac97-b0496e546d07","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/CVE-2013-3900 WinVerifyTrust Signature Vulnerability.md","tags":[{"inline":false,"label":"CVE","permalink":"/docs/tags/cve","description":"Documents related to Common Vulnerabilities and Exposures (CVE)"},{"inline":false,"label":"Logging","permalink":"/docs/tags/logging","description":"Documents related to log management and analysis for systems"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"c8638470-bc69-4bc9-ac97-b0496e546d07","title":"CVE-2013-3900 WinVerifyTrust Signature Vulnerability","title_meta":"CVE-2013-3900 WinVerifyTrust Signature Vulnerability","keywords":["cve","remediation","vulnerability","detection","signature"],"description":"This document outlines the process for detecting and remediating the CVE-2013-3900 WinVerifyTrust Signature Vulnerability using a specific script. It includes details on dependencies, variables, output, and ticketing procedures necessary for effective management of the vulnerability.","tags":["cve","logging","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"CVE-2013-3900 Ticketing - Per Client","permalink":"/docs/cwa/scripts/db14cafc-cfb9-4303-be49-ffeb16ae082d"},"next":{"title":"CVE-2016-2115 - SMB Signing","permalink":"/docs/cwa/scripts/b0bd8d59-9491-4669-8226-fd7df87c722d"}}');var s=i(474848),r=i(28453);const d={id:"c8638470-bc69-4bc9-ac97-b0496e546d07",title:"CVE-2013-3900 WinVerifyTrust Signature Vulnerability",title_meta:"CVE-2013-3900 WinVerifyTrust Signature Vulnerability",keywords:["cve","remediation","vulnerability","detection","signature"],description:"This document outlines the process for detecting and remediating the CVE-2013-3900 WinVerifyTrust Signature Vulnerability using a specific script. It includes details on dependencies, variables, output, and ticketing procedures necessary for effective management of the vulnerability.",tags:["cve","logging","windows"],draft:!1,unlisted:!1},c=void 0,l={},a=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Variables",id:"variables",level:2},{value:"EDFs",id:"edfs",level:3},{value:"Output",id:"output",level:2},{value:"Ticketing",id:"ticketing",level:2}];function o(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsx)(t.p,{children:"This script was created to run the detection and remediation for CVE-2013-3900 WinVerifyTrust Signature Vulnerability based on the EDFs option selected on the agent."}),"\n",(0,s.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Sample Run Image",src:i(124409).A+"",width:"719",height:"591"})}),"\n",(0,s.jsxs)(t.p,{children:["It is required to execute this script after importing with the setting ",(0,s.jsx)(t.code,{children:"SetEnvironment = 1"}),"."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Sample Run Image",src:i(141474).A+"",width:"720",height:"596"})}),"\n",(0,s.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{href:"/docs/cwa/monitors/c3ebfed8-a883-43c7-acf2-f232ded8d122",children:"CWA Remote Monitor - CVE-2013-3900 WinVerifyTrust Signature Validation"})}),"\n",(0,s.jsx)(t.h2,{id:"variables",children:"Variables"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Name"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"DetectionOnly"}),(0,s.jsx)(t.td,{children:"This collects client-EDF 'CVE Vulnerability Detection Only' data for the agent where the script is deployed. If it is 1, then the CVE-2013-3900-only detection will run and register to the dataview without remediation."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Detection-Remediation"}),(0,s.jsxs)(t.td,{children:["This collects data from client-EDF 'CVE-2013-3900 Vul Detection and Remediation' for the agent where the script is deployed. If it is 1, then the CVE-2013-3900 vulnerability will be detected. If found vulnerable, it will attempt to remediate it and log the result to the dataview ",(0,s.jsx)(t.a,{href:"/docs/cwa/dataviews/41996204-9673-4a7d-9334-262cdaf82110",children:"CWA Dataview - CVE-2013-3900 WinVerifyTrust Signature Audit"}),"."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"RemediationStatusCheck"}),(0,s.jsx)(t.td,{children:"This contains a report on whether the remediation was successful or not."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"psout"}),(0,s.jsx)(t.td,{children:"It contains the complete output of the PowerShell execution for the CVE detection/remediation action."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"TicketCreation"}),(0,s.jsxs)(t.td,{children:["It contains the ticket category ID applied on the monitor ",(0,s.jsx)(t.a,{href:"/docs/cwa/monitors/c3ebfed8-a883-43c7-acf2-f232ded8d122",children:"CWA Remote Monitor - CVE-2013-3900 WinVerifyTrust Signature Validation"}),". A ticket will only be created if the category is set."]})]})]})]}),"\n",(0,s.jsx)(t.h3,{id:"edfs",children:"EDFs"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Name"}),(0,s.jsx)(t.th,{children:"Level"}),(0,s.jsx)(t.th,{children:"Type"}),(0,s.jsx)(t.th,{children:"Example"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CVE-2013-3900 Status"}),(0,s.jsx)(t.td,{children:"Computer"}),(0,s.jsx)(t.td,{children:"Text"}),(0,s.jsx)(t.td,{children:"Remediation Successful"}),(0,s.jsx)(t.td,{children:"This stores the status of CVE-2013-3900 after script execution."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CVE-2013-3900 Logging"}),(0,s.jsx)(t.td,{children:"Computer"}),(0,s.jsx)(t.td,{children:"Text"}),(0,s.jsx)(t.td,{children:"@psout@"}),(0,s.jsx)(t.td,{children:"This stores the script's PowerShell execution output for logging."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CVE-2013-3900 Detection Date"}),(0,s.jsx)(t.td,{children:"Computer"}),(0,s.jsx)(t.td,{children:"Text"}),(0,s.jsx)(t.td,{children:"2024-05-01 00:00:00"}),(0,s.jsx)(t.td,{children:"This stores the date and time when the last CVE-2013-3900 status was detected via the script."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CVE-2013-3900 Vulnerability"}),(0,s.jsx)(t.td,{children:"Computer"}),(0,s.jsx)(t.td,{children:"Text"}),(0,s.jsx)(t.td,{children:"Not Vulnerable"}),(0,s.jsx)(t.td,{children:"This indicates whether the device is vulnerable or not based on the script output detection."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CVE-2013-3900 Vul Detection and Remediation"}),(0,s.jsx)(t.td,{children:"Client"}),(0,s.jsx)(t.td,{children:"Flag"}),(0,s.jsx)(t.td,{children:"1"}),(0,s.jsx)(t.td,{children:'If this client EDF is checked, then the CVE-2013-3900 detection and remediation will be performed by the script as the client will be added to the group "CVE-2013-3900 Detection & Remediation".'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CVE Vulnerability Detection Only"}),(0,s.jsx)(t.td,{children:"Client"}),(0,s.jsx)(t.td,{children:"Flag"}),(0,s.jsx)(t.td,{children:"1"}),(0,s.jsx)(t.td,{children:'If this client EDF is checked, then the CVE-2013-3900 detection only will be performed by the script as the agents will be added to the group "CVE Vulnerability Detection Only".'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CVE-2013-3900 Vul Detection and Remediation Exclude"}),(0,s.jsx)(t.td,{children:"Location"}),(0,s.jsx)(t.td,{children:"Flag"}),(0,s.jsx)(t.td,{children:"0"}),(0,s.jsx)(t.td,{children:"If this location EDF is checked, then the CVE-2013-3900 detection and remediation will be excluded from all agents of the location."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CVE-2013-3900 Vul Detection and Remediation Exclude"}),(0,s.jsx)(t.td,{children:"Computer"}),(0,s.jsx)(t.td,{children:"Flag"}),(0,s.jsx)(t.td,{children:"0"}),(0,s.jsx)(t.td,{children:"If this EDF is checked, then the CVE-2013-3900 detection and remediation will be excluded from the agent."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CVE-2013-3900 Vul Detection and Remediation"}),(0,s.jsx)(t.td,{children:"Computer"}),(0,s.jsx)(t.td,{children:"Flag"}),(0,s.jsx)(t.td,{children:"1"}),(0,s.jsx)(t.td,{children:'If this EDF is checked, then the agent will be added to the group "CVE-2013-3900 Detection & Remediation".'})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Script log"}),"\n",(0,s.jsx)(t.li,{children:"Dataview"}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"ticketing",children:"Ticketing"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"How to Enable Ticket:"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:'Navigate to the group "CVE-2013-3900 Detection & Remediation" > Open group > Go to Computers > Remote Monitors.'}),"\n",(0,s.jsxs)(t.li,{children:["Select the remote monitor ",(0,s.jsx)(t.a,{href:"/docs/cwa/monitors/c3ebfed8-a883-43c7-acf2-f232ded8d122",children:"CWA Remote Monitor - CVE-2013-3900 WinVerifyTrust Signature Validation"})," and check the ticket category."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Ticket Category Image",src:i(31979).A+"",width:"1000",height:"463"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"If this ticket category is set, then only the script will be able to create a ticket for the remediation step."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Failure:"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Subject:"})," CVE-2013-3900 WinVerifyTrust Signature Vulnerability is Detected on %ComputerName%"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Body:"})," @TicketComment@ The remediation was attempted for the vulnerability fix on the computer name %computername% but it failed. Refer to the logs: @psout@"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Success:"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Body:"})," The computer: %computername% is already safe from the vulnerability. Refer to the logs: @psout@ OR The vulnerability has been remediated successfully. Refer to the log information below: @psout@"]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},124409:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/image_1-d7d0fd3d001b68693f2ff9e3e969c2dc.png"},141474:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/image_2-e17f7ee6795deaff557c954fb486afdc.png"},31979:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/image_3-11db4784c0537a54f83c926acfd36f19.png"},28453:(e,t,i)=>{i.d(t,{R:()=>d,x:()=>c});var n=i(296540);const s={},r=n.createContext(s);function d(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);