"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[44627],{506454:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>l,frontMatter:()=>s,metadata:()=>n,toc:()=>R});const n=JSON.parse('{"id":"cwa/monitors/e2c56554-7f1d-4f1a-b1a2-37a0bd343629","title":"Import - Remote Monitor - _Automation Directory - Remove Obsolete .ps1 Change","description":"This document provides a step-by-step guide on how to remove obsolete PowerShell monitors in ConnectWise Automate by executing SQL queries to manage group agents effectively.","source":"@site/docs/cwa/monitors/Import - Remote Monitor - _Automation Directory - Remove Obsolete .ps1 Change.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/e2c56554-7f1d-4f1a-b1a2-37a0bd343629","permalink":"/docs/cwa/monitors/e2c56554-7f1d-4f1a-b1a2-37a0bd343629","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Import - Remote Monitor - _Automation Directory - Remove Obsolete .ps1 Change.md","tags":[{"inline":false,"label":"ConnectWise","permalink":"/docs/tags/connectwise","description":"Documents on ConnectWise platforms for IT service management"},{"inline":false,"label":"Database","permalink":"/docs/tags/database","description":"Documents related to database management systems and operations"},{"inline":false,"label":"Software","permalink":"/docs/tags/software","description":"Documents related to software applications and their lifecycle management"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"e2c56554-7f1d-4f1a-b1a2-37a0bd343629","title":"Import - Remote Monitor - _Automation Directory - Remove Obsolete .ps1 Change","title_meta":"Import - Remote Monitor - _Automation Directory - Remove Obsolete .ps1 Change","keywords":["connectwise","monitor","obsolete","powershell","automation"],"description":"This document provides a step-by-step guide on how to remove obsolete PowerShell monitors in ConnectWise Automate by executing SQL queries to manage group agents effectively.","tags":["connectwise","database","software","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Import - Remote Monitor - SMB1 Detection","permalink":"/docs/cwa/monitors/7c397ba6-0b68-421e-9315-3377ad5452b3"},"next":{"title":"Import-  Unresponsive Huntress Agents","permalink":"/docs/cwa/monitors/6c4f37b4-d460-464b-bc03-fd1d46be2b0a"}}');var o=r(474848),a=r(28453);const s={id:"e2c56554-7f1d-4f1a-b1a2-37a0bd343629",title:"Import - Remote Monitor - _Automation Directory - Remove Obsolete .ps1 Change",title_meta:"Import - Remote Monitor - _Automation Directory - Remove Obsolete .ps1 Change",keywords:["connectwise","monitor","obsolete","powershell","automation"],description:"This document provides a step-by-step guide on how to remove obsolete PowerShell monitors in ConnectWise Automate by executing SQL queries to manage group agents effectively.",tags:["connectwise","database","software","windows"],draft:!1,unlisted:!1},i=void 0,c={},R=[{value:"Step 1",id:"step-1",level:2},{value:"Step 2",id:"step-2",level:2},{value:"Step 3",id:"step-3",level:2},{value:"Step 4",id:"step-4",level:2},{value:"Step 5",id:"step-5",level:2},{value:"Step 6",id:"step-6",level:2}];function d(e){const t={br:"br",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h2,{id:"step-1",children:"Step 1"}),"\n",(0,o.jsx)(t.p,{children:"Obtain the group ID(s) of the group(s) that the remote monitor should be applied to. It is suggested to apply this monitor set to the Managed Windows Servers and Workstations groups."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Image",src:r(479656).A+"",width:"597",height:"568"})}),"\n",(0,o.jsx)(t.h2,{id:"step-2",children:"Step 2"}),"\n",(0,o.jsxs)(t.p,{children:["Copy the following query and replace ",(0,o.jsx)(t.strong,{children:"YOUR COMMA SEPARATED LIST OF GROUPID(S)"})," with the Group ID(s) of the relevant groups:",(0,o.jsx)(t.br,{}),"\n","(The string to replace can be found at the very bottom of the query, right after ",(0,o.jsx)(t.strong,{children:"WHERE"}),")"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"INSERT INTO groupagents \r\nSELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'ProVal - Production - _Automation Directory - Remove Obsolete .ps1 [Change]' as `Name`,\r\n'6' as `CheckAction`,\r\n'1' as `AlertAction`,\r\n'\\\\<No Alerts>~~~\\\\<No Alerts>!!!\\\\<No Alerts>~~~\\\\<No Alerts>' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'86400' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C://Windows//System32//WindowsPowerShell//v1.0//PowerShell.exe -ExecutionPolicy Bypass -command \"$path = /'C://ProgramData//_Automation/'; if ( Test-Path -Path $path ) { Get-ChildItem -Path $Path -Recurse | Where-Object { $_.CreationTime -lt (Get-Date).AddDays(-1) -and $_.Name -match /'//.ps1$/' } | Remove-Item -Force -Confirm:$false -ErrorAction SilentlyContinue }\"' as `DataOut`,\r\n'10' as `Comparor`,\r\n'((^((OK){0,}(//r//n){0,}[//r//n]{0,}//s{0,})$)|(^$))' as `DataIn`,\r\n'' as `IDField`,\r\n'1' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'21' as `Category`,\r\n'0' as `TicketCategory`,\r\n'1' as `ScriptTarget`,\r\nCONCAT(\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1)\r\n) as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (YOUR COMMA SEPARATED LIST OF GROUPID(S))\r\nAND m.groupid NOT IN (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Production - _Automation Directory - Remove Obsolete .ps1 [Change]')\n"})}),"\n",(0,o.jsx)(t.h2,{id:"step-3",children:"Step 3"}),"\n",(0,o.jsx)(t.p,{children:"An example of a query with a group ID:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"INSERT INTO groupagents \r\nSELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'ProVal - Production - _Automation Directory - Remove Obsolete .ps1 [Change]' as `Name`,\r\n'6' as `CheckAction`,\r\n'1' as `AlertAction`,\r\n'\\\\<No Alerts>~~~\\\\<No Alerts>!!!\\\\<No Alerts>~~~\\\\<No Alerts>' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'86400' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C://Windows//System32//WindowsPowerShell//v1.0//PowerShell.exe -ExecutionPolicy Bypass -command \"$path = /'C://ProgramData//_Automation/'; if ( Test-Path -Path $path ) { Get-ChildItem -Path $Path -Recurse | Where-Object { $_.CreationTime -lt (Get-Date).AddDays(-1) -and $_.Name -match /'//.ps1$/' } | Remove-Item -Force -Confirm:$false -ErrorAction SilentlyContinue }\"' as `DataOut`,\r\n'10' as `Comparor`,\r\n'((^((OK){0,}(//r//n){0,}[//r//n]{0,}//s{0,})$)|(^$))' as `DataIn`,\r\n'' as `IDField`,\r\n'1' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'21' as `Category`,\r\n'0' as `TicketCategory`,\r\n'1' as `ScriptTarget`,\r\nCONCAT(\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1)\r\n) as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (2,3,855,856)\r\nAND m.groupid NOT IN (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Production - _Automation Directory - Remove Obsolete .ps1 [Change]')\n"})}),"\n",(0,o.jsx)(t.h2,{id:"step-4",children:"Step 4"}),"\n",(0,o.jsx)(t.p,{children:"Now execute your query from a RAWSQL monitor set."}),"\n",(0,o.jsx)(t.h2,{id:"step-5",children:"Step 5"}),"\n",(0,o.jsx)(t.p,{children:"Locate your remote monitor by opening the group(s) remote monitors tab."}),"\n",(0,o.jsx)(t.h2,{id:"step-6",children:"Step 6"}),"\n",(0,o.jsx)(t.p,{children:"Do not apply any alert template to this remote monitor."})]})}function l(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},479656:(e,t,r)=>{r.d(t,{A:()=>n});const n=r.p+"assets/images/image_1-245556f0af79d1a1c824d959b7744f9f.png"},28453:(e,t,r)=>{r.d(t,{R:()=>s,x:()=>i});var n=r(296540);const o={},a=n.createContext(o);function s(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);