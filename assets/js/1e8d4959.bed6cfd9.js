"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[89958],{818585:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"cwa/scripts/a47f9f1e-356c-4b1c-aa02-47d70788ac05","title":"Offline Agents - Auto-Retire - Pre-Audit No Action,Email","description":"This document provides a comprehensive guide on a script that emails details of client agents that have been offline for a specified number of days in ConnectWise Automate. The script includes parameters for setting the threshold and options for ticket creation.","source":"@site/docs/cwa/scripts/Offline Agents - Auto-Retire - Pre-Audit No Action,Email.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/a47f9f1e-356c-4b1c-aa02-47d70788ac05","permalink":"/proval-docs/docs/cwa/scripts/a47f9f1e-356c-4b1c-aa02-47d70788ac05","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Offline Agents - Auto-Retire - Pre-Audit No Action,Email.md","tags":[{"inline":false,"label":"Email","permalink":"/proval-docs/docs/tags/email","description":"Documents about email systems and their management"},{"inline":false,"label":"Ticketing","permalink":"/proval-docs/docs/tags/ticketing","description":"Documents related to ticketing systems and IT support management"}],"version":"current","frontMatter":{"id":"a47f9f1e-356c-4b1c-aa02-47d70788ac05","title":"Offline Agents - Auto-Retire - Pre-Audit No Action,Email","title_meta":"Offline Agents - Auto-Retire - Pre-Audit No Action,Email","keywords":["email","offline","agents","automate","script","notification"],"description":"This document provides a comprehensive guide on a script that emails details of client agents that have been offline for a specified number of days in ConnectWise Automate. The script includes parameters for setting the threshold and options for ticket creation.","tags":["email","ticketing"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Offline Agents - Auto-Retire - Manual Execution","permalink":"/proval-docs/docs/cwa/scripts/90249a1b-07b1-4ac5-8e3e-3b910d4d7b9a"},"next":{"title":"Offline Machines Detection per client Global","permalink":"/proval-docs/docs/cwa/scripts/cbc62993-0c72-4826-bdfa-bf0aa498891f"}}');var n=i(474848),r=i(28453);const l={id:"a47f9f1e-356c-4b1c-aa02-47d70788ac05",title:"Offline Agents - Auto-Retire - Pre-Audit No Action,Email",title_meta:"Offline Agents - Auto-Retire - Pre-Audit No Action,Email",keywords:["email","offline","agents","automate","script","notification"],description:"This document provides a comprehensive guide on a script that emails details of client agents that have been offline for a specified number of days in ConnectWise Automate. The script includes parameters for setting the threshold and options for ticket creation.",tags:["email","ticketing"],draft:!1,unlisted:!1},d=void 0,a={},c=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Global Parameters",id:"global-parameters",level:2},{value:"User Parameters",id:"user-parameters",level:3},{value:"System Properties",id:"system-properties",level:3},{value:"Extra Data Fields",id:"extra-data-fields",level:3},{value:"Implementation",id:"implementation",level:2}];function o(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,n.jsxs)(t.p,{children:["This script aims to email the details of the client agents that are offline in Automate for more than the days defined in the ",(0,n.jsx)(t.code,{children:"Threshold"})," and are not ",(0,n.jsx)(t.code,{children:"Broken"})," agents."]}),"\n",(0,n.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,n.jsx)(t.p,{children:"For initial execution:"}),"\n",(0,n.jsxs)(t.p,{children:["Set the ",(0,n.jsx)(t.code,{children:"Set_Environment"})," value to 1 and set the ",(0,n.jsx)(t.code,{children:"Set_Global_Threshold_Days"})," value as per the client's requirement, suppose it's '180' days."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Sample Run",src:i(944508).A+"",width:"482",height:"486"})}),"\n",(0,n.jsxs)(t.p,{children:["Leave all parameters except ",(0,n.jsx)(t.code,{children:"Email_address"})," blank for an email regarding all the obsolete workstations."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Sample Run",src:i(228791).A+"",width:"484",height:"486"})}),"\n",(0,n.jsxs)(t.p,{children:["Set the ",(0,n.jsx)(t.code,{children:"Server"})," value to ",(0,n.jsx)(t.code,{children:"1"})," for an email regarding all the obsolete workstations as well as servers."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Sample Run",src:i(85774).A+"",width:"490",height:"484"})}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"Note: Since this is a client script, it must be executed on the client."})}),"\n",(0,n.jsx)(t.h2,{id:"global-parameters",children:"Global Parameters"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Name"}),(0,n.jsx)(t.th,{children:"Required"}),(0,n.jsx)(t.th,{children:"Example"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsx)(t.tbody,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"TicketCreationCategory"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"298"}),(0,n.jsx)(t.td,{children:"Mention the ticket creation category in order to direct the tickets to the right board in Manage."})]})})]}),"\n",(0,n.jsx)(t.h3,{id:"user-parameters",children:"User Parameters"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Name"}),(0,n.jsx)(t.th,{children:"Example"}),(0,n.jsx)(t.th,{children:"Required"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Set_Environment"}),(0,n.jsx)(t.td,{children:"1"}),(0,n.jsx)(t.td,{children:"Mandatory for the first run"}),(0,n.jsx)(t.td,{children:"For the script's initial execution, this parameter must be used. The dependent EDFs and the system property are essential for the script to function properly. These required EDFs and System Property are created when the script is executed with this parameter set to 1."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Set_Global_Threshold_Days"}),(0,n.jsx)(t.td,{children:"180"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"The global property 'AutoRetireThreshold_Days' is set when the value in 'Set_Global_Threshold_Days' is set. If left empty, the global property will be set to '90'."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Server"}),(0,n.jsx)(t.td,{children:"1"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsxs)(t.td,{children:["Set its value to ",(0,n.jsx)(t.code,{children:"1"})," if the client wants to retire servers along with workstations."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Email_Address"}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.a,{href:"mailto:xyz@something.com",children:"xyz@something.com"})}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"Email address where the partner wants to receive the details of obsolete agents."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Ticketing"}),(0,n.jsx)(t.td,{children:"1"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"Input its value as '1' if you would like to receive a ticket with a list of obsolete machines."})]})]})]}),"\n",(0,n.jsx)(t.h3,{id:"system-properties",children:"System Properties"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Name"}),(0,n.jsx)(t.th,{children:"Example"}),(0,n.jsx)(t.th,{children:"Required"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsx)(t.tbody,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"AutoRetireThreshold_Days"}),(0,n.jsx)(t.td,{children:"180"}),(0,n.jsx)(t.td,{children:"True"}),(0,n.jsx)(t.td,{children:"Threshold days to retire the offline computers. The default is 90. It can either be set during the first execution of the script or manually from the dashboard."})]})})]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"System Properties",src:i(921889).A+"",width:"893",height:"236"})}),"\n",(0,n.jsx)(t.h3,{id:"extra-data-fields",children:"Extra Data Fields"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Name"}),(0,n.jsx)(t.th,{children:"Level"}),(0,n.jsx)(t.th,{children:"Section"}),(0,n.jsx)(t.th,{children:"Type"}),(0,n.jsx)(t.th,{children:"Required"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Exclude From Auto-Retire Automation"}),(0,n.jsx)(t.td,{children:"Client"}),(0,n.jsx)(t.td,{children:"Exclusions"}),(0,n.jsx)(t.td,{children:"Check box"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"The script will not generate any tickets for the client if this EDF is checked."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Exclude From Auto-Retire Automation"}),(0,n.jsx)(t.td,{children:"Location"}),(0,n.jsx)(t.td,{children:"Exclusions"}),(0,n.jsx)(t.td,{children:"Check box"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"The script will not include any computer from the location in the ticket if this EDF is checked."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Exclude From Auto-Retire Automation"}),(0,n.jsx)(t.td,{children:"Computer"}),(0,n.jsx)(t.td,{children:"Exclusions"}),(0,n.jsx)(t.td,{children:"Check box"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"The script will not include the computer in the ticket if this EDF is checked."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"AutoRetire Threshold Days"}),(0,n.jsx)(t.td,{children:"Client"}),(0,n.jsx)(t.td,{children:"Default"}),(0,n.jsx)(t.td,{children:"TextBox"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsxs)(t.td,{children:["To overwrite the threshold set in the Global Property ",(0,n.jsx)(t.code,{children:"AutoRetireThreshold_Days"})," for the client."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"AutoRetire Threshold Days"}),(0,n.jsx)(t.td,{children:"Location"}),(0,n.jsx)(t.td,{children:"Default"}),(0,n.jsx)(t.td,{children:"TextBox"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsxs)(t.td,{children:["To overwrite the threshold set in the Global Property ",(0,n.jsx)(t.code,{children:"AutoRetireThreshold_Days"})," and Client-Level EDF ",(0,n.jsx)(t.code,{children:"AutoRetire Threshold Days"})," for the location."]})]})]})]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsxs)(t.strong,{children:["Following EDFs can be used to overwrite the Threshold Days defined in the System property ",(0,n.jsx)(t.code,{children:"AutoRetireThreshold_Days"}),":"]})}),"\n",(0,n.jsx)(t.p,{children:'Client-Level EDF: "AutoRetire Threshold Days"'}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Client-Level EDF",src:i(953624).A+"",width:"1000",height:"370"})}),"\n",(0,n.jsx)(t.p,{children:'Location-Level EDF: "AutoRetireThreshold_Days"'}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Location-Level EDF",src:i(128115).A+"",width:"1000",height:"656"})}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"Following EDFs can be used to exclude a client/location/computer from retirement:"})}),"\n",(0,n.jsx)(t.p,{children:'Client-Level EDF: "Exclude From Auto-Retire Automation"'}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Client-Level EDF",src:i(972906).A+"",width:"775",height:"462"})}),"\n",(0,n.jsx)(t.p,{children:'Location-Level EDF: "Exclude From Auto-Retire Automation"'}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Location-Level EDF",src:i(723325).A+"",width:"723",height:"329"})}),"\n",(0,n.jsx)(t.p,{children:'Computer-Level EDF: "Exclude From Auto-Retire Automation"'}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Computer-Level EDF",src:i(985844).A+"",width:"761",height:"629"})}),"\n",(0,n.jsx)(t.h2,{id:"implementation",children:"Implementation"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"Import the script using the ProSync Plugin."}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"Reload the System Cache."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Reload Cache",src:i(944582).A+"",width:"224",height:"169"})}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"Configure the script as follows:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Navigate to Automation \u2192 Scripts within the CWA Control Center and open the script."}),"\n",(0,n.jsxs)(t.li,{children:["Debug the script against any client with the ",(0,n.jsx)(t.code,{children:"Set_Environment"})," parameter set to 1 and ",(0,n.jsx)(t.code,{children:"Set_Global_Threshold_Days"})," set to the number of days for the global property ",(0,n.jsx)(t.code,{children:"AutoRetireThreshold_Days"}),".","\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Validate that the system property was set correctly by navigating to 'System \u2192 Configuration \u2192 Dashboard \u2192 Config \u2192 Configurations \u2192 Properties' \u2192 Check the property 'AutoRetireThreshold_Days'."}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.li,{children:"Run the script against the desired client."}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(o,{...e})}):o(e)}},944508:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_1-1e0f85f5da3e6c278aa0b2bb8b7bbaa9.png"},944582:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_10-182664ae580e48a65786c31f7616a220.png"},228791:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_2-299b5976ef7f90d80294b8a8927998d9.png"},85774:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_3-9a7da053b60917df8f6ca30cb43c5d4f.png"},921889:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_4-00911198ca73b7d9b605233dbd5dfd58.png"},953624:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_5-365f2832eeb71bf8bdbe2ed1dacd86a4.png"},128115:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_6-1b2f4f3fb301f6ed6a8899f4fcf8df91.png"},972906:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_7-f4a2b303b06a1ec1b6bcc697275a1b2a.png"},723325:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_8-3c60ec0d99b9319528d7f0b74277c136.png"},985844:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_9-9a69274ba0b25d3bfca28f944b32ae80.png"},28453:(e,t,i)=>{i.d(t,{R:()=>l,x:()=>d});var s=i(296540);const n={},r=s.createContext(n);function l(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);