"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[55047],{8128:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"cwa/scripts/90249a1b-07b1-4ac5-8e3e-3b910d4d7b9a","title":"Offline Agents - Auto-Retire - Manual Execution","description":"This document explains the process of retiring offline agents in ConnectWise Automate that have been offline for a specified number of days. It covers the required parameters, system properties, and extra data fields needed for the script to function effectively, along with sample runs and implementation steps.","source":"@site/docs/cwa/scripts/Offline Agents - Auto-Retire - Manual Execution.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/90249a1b-07b1-4ac5-8e3e-3b910d4d7b9a","permalink":"/proval-docs/docs/cwa/scripts/90249a1b-07b1-4ac5-8e3e-3b910d4d7b9a","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Offline Agents - Auto-Retire - Manual Execution.md","tags":[],"version":"current","frontMatter":{"id":"90249a1b-07b1-4ac5-8e3e-3b910d4d7b9a","title":"Offline Agents - Auto-Retire - Manual Execution","title_meta":"Offline Agents - Auto-Retire - Manual Execution","keywords":["retire","offline","agents","automate","client"],"description":"This document explains the process of retiring offline agents in ConnectWise Automate that have been offline for a specified number of days. It covers the required parameters, system properties, and extra data fields needed for the script to function effectively, along with sample runs and implementation steps.","tags":[],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Office Update Enable","permalink":"/proval-docs/docs/cwa/scripts/62b1555c-706c-433c-a053-329a63db0dd0"},"next":{"title":"Offline Agents - Auto-Retire - Pre-Audit No Action,Email","permalink":"/proval-docs/docs/cwa/scripts/a47f9f1e-356c-4b1c-aa02-47d70788ac05"}}');var n=s(474848),r=s(28453);const d={id:"90249a1b-07b1-4ac5-8e3e-3b910d4d7b9a",title:"Offline Agents - Auto-Retire - Manual Execution",title_meta:"Offline Agents - Auto-Retire - Manual Execution",keywords:["retire","offline","agents","automate","client"],description:"This document explains the process of retiring offline agents in ConnectWise Automate that have been offline for a specified number of days. It covers the required parameters, system properties, and extra data fields needed for the script to function effectively, along with sample runs and implementation steps.",tags:[],draft:!1,unlisted:!1},l=void 0,a={},o=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"User Parameters",id:"user-parameters",level:4},{value:"System Properties",id:"system-properties",level:4},{value:"Extra Data Fields",id:"extra-data-fields",level:4},{value:"Implementation",id:"implementation",level:2}];function c(e){const t={code:"code",h2:"h2",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,n.jsxs)(t.p,{children:["The purpose of this script is to retire the client agents that are offline in Automate for more than the days defined in the ",(0,n.jsx)(t.code,{children:"Threshold"})," and are not ",(0,n.jsx)(t.code,{children:"Broken"})," agents."]}),"\n",(0,n.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,n.jsx)(t.p,{children:"For the initial execution:"}),"\n",(0,n.jsxs)(t.p,{children:["Set the ",(0,n.jsx)(t.code,{children:"Set_Environment"})," value to 1 and set the ",(0,n.jsx)(t.code,{children:"Set_Global_Threshold_Days"})," value as per the client's requirement, suppose it's '180' days."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Sample Run Image 1",src:s(267715).A+"",width:"485",height:"457"})}),"\n",(0,n.jsx)(t.p,{children:"Leave all parameters blank to retire just workstations."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Sample Run Image 2",src:s(405736).A+"",width:"485",height:"456"})}),"\n",(0,n.jsxs)(t.p,{children:["Set the ",(0,n.jsx)(t.code,{children:"Server"})," value to ",(0,n.jsx)(t.code,{children:"1"})," to retire both workstations and servers."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Sample Run Image 3",src:s(854129).A+"",width:"486",height:"459"})}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"Note: Since this is a client script, it must be executed on the client."})}),"\n",(0,n.jsx)(t.h4,{id:"user-parameters",children:"User Parameters"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Name"}),(0,n.jsx)(t.th,{children:"Example"}),(0,n.jsx)(t.th,{children:"Required"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Set_Environment"}),(0,n.jsx)(t.td,{children:"1"}),(0,n.jsx)(t.td,{children:"Mandatory for the first run"}),(0,n.jsx)(t.td,{children:"For the script's initial execution, this parameter must be used. The dependent EDFs and the system property are essential for the script to function properly. These required EDFs and System Property are created when the script is executed with this parameter set to 1."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Set_Global_Threshold_Days"}),(0,n.jsx)(t.td,{children:"180"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"The global property 'AutoRetireThreshold_Days' is set when the value in 'Set_Global_Threshold_Days' is specified. If left empty, the global property will be set to '90'."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Server"}),(0,n.jsx)(t.td,{children:"1"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsxs)(t.td,{children:["Set its value to ",(0,n.jsx)(t.code,{children:"1"})," if the client wants to retire servers along with workstations. ",(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:[(0,n.jsx)(t.code,{children:"1"})," - Set its value to 1 to remove servers along with workstations"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)(t.code,{children:"0"})," - Set its value to 0 to retire workstations only."]})]})]})]})]})]}),"\n",(0,n.jsx)(t.h4,{id:"system-properties",children:"System Properties"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Name"}),(0,n.jsx)(t.th,{children:"Example"}),(0,n.jsx)(t.th,{children:"Required"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsx)(t.tbody,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"AutoRetireThreshold_Days"}),(0,n.jsx)(t.td,{children:"180"}),(0,n.jsx)(t.td,{children:"True"}),(0,n.jsx)(t.td,{children:"Threshold days to retire the offline computers. The default is 90. It can either be set during the first execution of the script or manually from the dashboard."})]})})]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"System Properties Image",src:s(809566).A+"",width:"893",height:"236"})}),"\n",(0,n.jsx)(t.h4,{id:"extra-data-fields",children:"Extra Data Fields"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Name"}),(0,n.jsx)(t.th,{children:"Level"}),(0,n.jsx)(t.th,{children:"Section"}),(0,n.jsx)(t.th,{children:"Type"}),(0,n.jsx)(t.th,{children:"Required"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Exclude From Auto-Retire Automation"}),(0,n.jsx)(t.td,{children:"Client"}),(0,n.jsx)(t.td,{children:"Exclusions"}),(0,n.jsx)(t.td,{children:"Check box"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"The script will not generate any tickets for the client if this EDF is checked."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Exclude From Auto-Retire Automation"}),(0,n.jsx)(t.td,{children:"Location"}),(0,n.jsx)(t.td,{children:"Exclusions"}),(0,n.jsx)(t.td,{children:"Check box"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"The script will not include any computer from the location in the ticket if this EDF is checked."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Exclude From Auto-Retire Automation"}),(0,n.jsx)(t.td,{children:"Computer"}),(0,n.jsx)(t.td,{children:"Exclusions"}),(0,n.jsx)(t.td,{children:"Check box"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"The script will not include the computer in the ticket if this EDF is checked."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"AutoRetire Threshold Days"}),(0,n.jsx)(t.td,{children:"Client"}),(0,n.jsx)(t.td,{children:"Default"}),(0,n.jsx)(t.td,{children:"TextBox"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsxs)(t.td,{children:["To overwrite the threshold set in the Global Property ",(0,n.jsx)(t.code,{children:"AutoRetireThreshold_Days"})," for the client."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"AutoRetire Threshold Days"}),(0,n.jsx)(t.td,{children:"Location"}),(0,n.jsx)(t.td,{children:"Default"}),(0,n.jsx)(t.td,{children:"TextBox"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsxs)(t.td,{children:["To overwrite the threshold set in the Global Property ",(0,n.jsx)(t.code,{children:"AutoRetireThreshold_Days"})," and Client-Level EDF ",(0,n.jsx)(t.code,{children:"AutoRetire Threshold Days"})," for the location."]})]})]})]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsxs)(t.strong,{children:["The following EDFs can be used to overwrite the Threshold Days defined in the System property ",(0,n.jsx)(t.code,{children:"AutoRetireThreshold_Days"}),":"]})}),"\n",(0,n.jsx)(t.p,{children:'Client-Level EDF: "AutoRetire Threshold Days"'}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Client-Level EDF",src:s(985351).A+"",width:"1000",height:"370"})}),"\n",(0,n.jsx)(t.p,{children:'Location-Level EDF: "AutoRetireThreshold_Days"'}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Location-Level EDF",src:s(218316).A+"",width:"1000",height:"656"})}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"The following EDFs can be used to exclude a client/location/computer from retirement:"})}),"\n",(0,n.jsx)(t.p,{children:'Client-Level EDF: "Exclude From Auto-Retire Automation"'}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Client-Level EDF Exclusion",src:s(129941).A+"",width:"775",height:"462"})}),"\n",(0,n.jsx)(t.p,{children:'Location-Level EDF: "Exclude From Auto-Retire Automation"'}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Location-Level EDF Exclusion",src:s(600786).A+"",width:"723",height:"329"})}),"\n",(0,n.jsx)(t.p,{children:'Computer-Level EDF: "Exclude From Auto-Retire Automation"'}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Computer-Level EDF Exclusion",src:s(922331).A+"",width:"761",height:"629"})}),"\n",(0,n.jsx)(t.h2,{id:"implementation",children:"Implementation"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsx)(t.li,{children:"Import the script using the ProSync Plugin."}),"\n",(0,n.jsx)(t.li,{children:"Reload the System Cache."}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Reload System Cache",src:s(941931).A+"",width:"224",height:"169"})}),"\n",(0,n.jsxs)(t.ol,{start:"3",children:["\n",(0,n.jsxs)(t.li,{children:["Configure the script as follows:","\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Navigate to Automation --\x3e Scripts within the CWA Control Center and open the script."}),"\n",(0,n.jsxs)(t.li,{children:["Debug the script against any client with the ",(0,n.jsx)(t.code,{children:"Set_Environment"})," parameter set to 1 and ",(0,n.jsx)(t.code,{children:"Set_Global_Threshold_Days"})," set to the number of days for the global property ",(0,n.jsx)(t.code,{children:"AutoRetireThreshold_Days"}),".","\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Validate that the system property was set correctly by navigating to System --\x3e Configuration --\x3e Dashboard --\x3e Config --\x3e Configurations --\x3e Properties --\x3e Check the property 'AutoRetireThreshold_Days'."}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.li,{children:"Run the script against the desired client."}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},267715:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_1-6b065073b37cb7985c7c332a39a37f29.png"},941931:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_10-182664ae580e48a65786c31f7616a220.png"},405736:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_2-6ad46e61a2cd9d80050a864e5a7345c5.png"},854129:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_3-03e1a774caa2dc23824f0b24221ebe5d.png"},809566:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_4-00911198ca73b7d9b605233dbd5dfd58.png"},985351:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_5-365f2832eeb71bf8bdbe2ed1dacd86a4.png"},218316:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_6-1b2f4f3fb301f6ed6a8899f4fcf8df91.png"},129941:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_7-f4a2b303b06a1ec1b6bcc697275a1b2a.png"},600786:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_8-3c60ec0d99b9319528d7f0b74277c136.png"},922331:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_9-9a69274ba0b25d3bfca28f944b32ae80.png"},28453:(e,t,s)=>{s.d(t,{R:()=>d,x:()=>l});var i=s(296540);const n={},r=i.createContext(n);function d(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:d(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);