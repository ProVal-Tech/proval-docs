"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[59200],{167313:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>l,frontMatter:()=>a,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"cwa/monitors/88f2c503-bd4b-4bb5-83d0-72f5fb6a0137","title":"DNS Service Monitoring","description":"This document outlines the implementation steps for setting up DNS service monitoring using SQL queries in a RAWSQL monitor. It includes detailed instructions for executing the necessary SQL commands and verifying the configuration in the ConnectWise Automate platform.","source":"@site/docs/cwa/monitors/DNS Service Monitoring.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/88f2c503-bd4b-4bb5-83d0-72f5fb6a0137","permalink":"/proval-docs/docs/cwa/monitors/88f2c503-bd4b-4bb5-83d0-72f5fb6a0137","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/DNS Service Monitoring.md","tags":[{"inline":false,"label":"DNS","permalink":"/proval-docs/docs/tags/dns","description":"Documents focused on Domain Name System management and configuration"},{"inline":false,"label":"SQL","permalink":"/proval-docs/docs/tags/sql","description":"Documents discussing Structured Query Language and database interactions"}],"version":"current","frontMatter":{"id":"88f2c503-bd4b-4bb5-83d0-72f5fb6a0137","title":"DNS Service Monitoring","title_meta":"DNS Service Monitoring","keywords":["dns","monitoring","sql","alert","service"],"description":"This document outlines the implementation steps for setting up DNS service monitoring using SQL queries in a RAWSQL monitor. It includes detailed instructions for executing the necessary SQL commands and verifying the configuration in the ConnectWise Automate platform.","tags":["dns","sql"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"DNS Service Check","permalink":"/proval-docs/docs/cwa/monitors/200c48e8-a828-43da-8ae5-f31a3280893b"},"next":{"title":"DRV - Fragmentation  30 %","permalink":"/proval-docs/docs/cwa/monitors/3e90ea38-4ca4-4dd1-b338-d7700bba9742"}}');var i=t(474848),o=t(28453);const a={id:"88f2c503-bd4b-4bb5-83d0-72f5fb6a0137",title:"DNS Service Monitoring",title_meta:"DNS Service Monitoring",keywords:["dns","monitoring","sql","alert","service"],description:"This document outlines the implementation steps for setting up DNS service monitoring using SQL queries in a RAWSQL monitor. It includes detailed instructions for executing the necessary SQL commands and verifying the configuration in the ConnectWise Automate platform.",tags:["dns","sql"],draft:!1,unlisted:!1},s=void 0,c={},d=[{value:"Implementation Steps",id:"implementation-steps",level:2}];function S(e){const n={br:"br",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"implementation-steps",children:"Implementation Steps"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Execute the following SQL query from a RAWSQL monitor set to import the monitor:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"SET @Groupid = (SELECT Groupid FROM MasterGroups WHERE `GUID` = '3ac86a4d-f1fb-11e1-b4ec-1231391d2d19');\r\nSET @Alertaction = (SELECT alertactionid FROM alerttemplate WHERE `GUID` = 'ee4bc754-faf7-4667-8bba-8d3923c22c3e');\r\nINSERT INTO groupagents \r\nSELECT '' AS `AgentID`,\r\n`groupid` AS `GroupID`,\r\n'0' AS `SearchID`,\r\n'ProVal - Production - DNS Service Monitoring' AS `Name`,\r\n'6' AS `CheckAction`,\r\n@Alertaction AS `AlertAction`,\r\n'DNS Service Not Running on %ComputerName%~~~Service is running now.!!!DNS Service Not Running on %ComputerName%~~~//DNS// service is stopped on %ComputerName%. Automate attempted to start the service but failed.' AS `AlertMessage`,\r\n'0' AS `ContactID`,\r\n'600' AS `interval`,\r\n'127.0.0.1' AS `Where`,\r\n'7' AS `What`,\r\n'C://Windows//System32//WindowsPowerShell//v1.0//powershell.exe -ExecutionPolicy Bypass -Command \"$service = (Get-Service -Name //DNS// -ErrorAction SilentlyContinue); if ($Service) { if ($Service.Status -ne //Running//) { try { Restart-Service -Name //DNS// -Force -WarningAction SilentlyContinue -ErrorAction Stop } catch { return /////\"Failed to start the //DNS// service. Reason: $($Error[0].Exception.Message)/////\"; } } }\"' AS `DataOut`,\r\n'16' AS `Comparor`,\r\n'10|((^((OK){0,}(//r//n){0,}[//r//n]{0,}//s{0,})$)%7C(^$))|11|((^((OK){0,}(//r//n){0,}[//r//n]{0,}//s{0,})$)%7C(^$))%7C(^((//r//n){0,}[//r//n]{0,}//s{0,})Failed to start the)|10|^((//r//n){0,}[//r//n]{0,}//s{0,})Failed to start the' AS `DataIn`,\r\n'0' AS `IDField`,\r\n'1' AS `AlertStyle`,\r\n'0' AS `ScriptID`,\r\n'' AS `datacollector`,\r\n'5' AS `Category`,\r\n'0' AS `TicketCategory`,\r\n'1' AS `ScriptTarget`,\r\nCONCAT(\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1)\r\n) AS `GUID`,\r\n'root' AS `UpdatedBy`,\r\n(NOW()) AS `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid = @groupid\r\nAND m.groupid NOT IN (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Production - DNS Service Monitoring')\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Open the ",(0,i.jsx)(n.code,{children:"Windows DNS Servers"})," group",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.img,{alt:"Windows DNS Servers",src:t(249967).A+"",width:"550",height:"274"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Check the remote monitor and ensure the proper alert template is applied to it.",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.img,{alt:"Check Remote Monitor",src:t(559124).A+"",width:"1000",height:"466"})]}),"\n"]}),"\n"]})]})}function l(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(S,{...e})}):S(e)}},249967:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/image_1-18da70583a6344daff4e7ea92797b322.png"},559124:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/image_2-78f2e3b2ca2f8f29b3609360f6913632.png"},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>s});var r=t(296540);const i={},o=r.createContext(i);function a(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);