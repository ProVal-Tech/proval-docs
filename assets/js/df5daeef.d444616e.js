"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[35929],{333203:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>r,contentTitle:()=>a,default:()=>m,frontMatter:()=>d,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"cwa/monitors/25040f3b-ef1d-4ebb-af45-e0df3d12ebae","title":"Active - Directory - GPO Modified","description":"This document provides a detailed implementation guide for a Custom RAWSQL monitor that tracks GPO modifications on Domain Controllers, alerting when changes have occurred within the last day. It includes setup instructions, dependencies, and a sample ticket template for notifying administrators of detected modifications.","source":"@site/docs/cwa/monitors/active-directory-gpo-modified.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/25040f3b-ef1d-4ebb-af45-e0df3d12ebae","permalink":"/docs/cwa/monitors/25040f3b-ef1d-4ebb-af45-e0df3d12ebae","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/active-directory-gpo-modified.md","tags":[{"inline":false,"label":"Ticketing","permalink":"/docs/tags/ticketing","description":"Documents related to ticketing systems and IT support management"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"25040f3b-ef1d-4ebb-af45-e0df3d12ebae","title":"Active - Directory - GPO Modified","title_meta":"Active - Directory - GPO Modified","keywords":["gpo","monitor","domain","controller","alert"],"description":"This document provides a detailed implementation guide for a Custom RAWSQL monitor that tracks GPO modifications on Domain Controllers, alerting when changes have occurred within the last day. It includes setup instructions, dependencies, and a sample ticket template for notifying administrators of detected modifications.","tags":["ticketing","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Workaround - Windows Search Protocol VulnerabilityG","permalink":"/docs/cwa/monitors/d097987d-79c7-4a2f-a57a-ed959c676b20"},"next":{"title":"_Automation Directory - Remove Obsolete .ps1 Change","permalink":"/docs/cwa/monitors/e2c56554-7f1d-4f1a-b1a2-37a0bd343629"}}');var o=i(474848),s=i(28453);const d={id:"25040f3b-ef1d-4ebb-af45-e0df3d12ebae",title:"Active - Directory - GPO Modified",title_meta:"Active - Directory - GPO Modified",keywords:["gpo","monitor","domain","controller","alert"],description:"This document provides a detailed implementation guide for a Custom RAWSQL monitor that tracks GPO modifications on Domain Controllers, alerting when changes have occurred within the last day. It includes setup instructions, dependencies, and a sample ticket template for notifying administrators of detected modifications.",tags:["ticketing","windows"],draft:!1,unlisted:!1},a=void 0,r={},c=[{value:"Summary",id:"summary",level:2},{value:"Implementation",id:"implementation",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Target",id:"target",level:2},{value:"Alert Template",id:"alert-template",level:2},{value:"Ticketing",id:"ticketing",level:2}];function l(e){const t={a:"a",br:"br",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,o.jsx)(t.p,{children:"This Custom RAWSQL monitor shows the GPO modified time on the computer if the GPO was modified in the last day."}),"\n",(0,o.jsx)(t.h2,{id:"implementation",children:"Implementation"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["Replace ",(0,o.jsx)(t.code,{children:"\\\\<MonitorID>"})," in the additional condition with the ID of the monitor set.",(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.img,{alt:"Image 1",src:i(979173).A+"",width:"866",height:"1000"}),(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.img,{alt:"Image 2",src:i(208814).A+"",width:"728",height:"993"})]}),"\n",(0,o.jsxs)(t.li,{children:["Ensure that the monitor set is targeted on the Domain Controllers group.",(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.img,{alt:"Image 3",src:i(154391).A+"",width:"680",height:"349"})]}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.a,{href:"/docs/cwa/tables/c7cf649a-dd80-4e9d-8c80-eb95b813b7c9",children:"plugin_proval_ad_gpo"})}),"\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.a,{href:"/docs/cwa/scripts/2e5f5f2b-7c81-4aec-a76a-623a465f959a",children:"Group Policy Audit"})}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"target",children:"Target"}),"\n",(0,o.jsx)(t.p,{children:"Domain Controller"}),"\n",(0,o.jsx)(t.h2,{id:"alert-template",children:"Alert Template"}),"\n",(0,o.jsx)(t.p,{children:"\u25b3 Custom - Ticket Creation - Computer"}),"\n",(0,o.jsx)(t.h2,{id:"ticketing",children:"Ticketing"}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Subject:"})," ",(0,o.jsx)(t.code,{children:"GPO Modification detected on %COMPUTERNAME%"})]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.strong,{children:"Ticket Body:"})}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"A GPO modification was detected on %COMPUTERNAME% for %DOMAIN%. Please review if necessary.\r\nNumber of GPO(s) Modified: %RESULT%\r\nDetails:  \r\n%FIELDNAME%\n"})}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"%RESULT%:"})," Total number of modified GPOs"]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"%FIELDNAME%:"})," GPO: ",(0,o.jsx)(t.code,{children:"\\\\<Name of GPO>"})," (Modified Time: ",(0,o.jsx)(t.code,{children:"\\\\<Modification Time of GPO>"}),")"]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Sample Ticket:"}),(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.img,{alt:"Sample Ticket Image",src:i(905400).A+"",width:"1000",height:"640"})]})]})}function m(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},979173:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/image_1-d08ba9833527b0b74585176999ddad9d.png"},208814:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/image_2-f1b62558f20917e9a0b71e7c3f51ca6f.png"},154391:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/image_3-6893c479e9db9acb722887157ae8dc9e.png"},905400:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/image_4-443b3f1714c99f4e9d226a18b035e9cc.png"},28453:(e,t,i)=>{i.d(t,{R:()=>d,x:()=>a});var n=i(296540);const o={},s=n.createContext(o);function d(e){const t=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:d(e.components),n.createElement(s.Provider,{value:t},e.children)}}}]);