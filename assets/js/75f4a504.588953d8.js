"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[74367],{69989:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"cwa/scripts/113349eb-9de0-4b42-b773-cf873f87f2f0","title":"Audit WMI Patch History","description":"This script audits the current patch history from .NET to a custom table (plugin_proval_wmipatchesinstalled). It is designed for use on Windows OS machines and requires PowerShell v2 or greater on the agent. The process includes creating the necessary table if it does not exist, deleting existing data for the target machine, gathering patch information, and inserting new data into the table.","source":"@site/docs/cwa/scripts/Audit WMI Patch History.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/113349eb-9de0-4b42-b773-cf873f87f2f0","permalink":"/docs/cwa/scripts/113349eb-9de0-4b42-b773-cf873f87f2f0","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Audit WMI Patch History.md","tags":[{"inline":false,"label":"Database","permalink":"/docs/tags/database","description":"Documents related to database management systems and operations"},{"inline":false,"label":"Update","permalink":"/docs/tags/update","description":"Documents discussing software and system updates and their management"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"113349eb-9de0-4b42-b773-cf873f87f2f0","title":"Audit WMI Patch History","title_meta":"Audit WMI Patch History","keywords":["audit","dotnet","patch","history","windows"],"description":"This script audits the current patch history from .NET to a custom table (plugin_proval_wmipatchesinstalled). It is designed for use on Windows OS machines and requires PowerShell v2 or greater on the agent. The process includes creating the necessary table if it does not exist, deleting existing data for the target machine, gathering patch information, and inserting new data into the table.","tags":["database","update","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Audit Diskpart to Custom DV","permalink":"/docs/cwa/scripts/b61566b1-676d-433c-ab86-d7272efe5717"},"next":{"title":"Auto AAD to Autopilot - Client Specific (IT Synergy)","permalink":"/docs/cwa/scripts/8b128210-5b70-4155-ade6-83ab5365911c"}}');var n=i(474848),a=i(28453);const r={id:"113349eb-9de0-4b42-b773-cf873f87f2f0",title:"Audit WMI Patch History",title_meta:"Audit WMI Patch History",keywords:["audit","dotnet","patch","history","windows"],description:"This script audits the current patch history from .NET to a custom table (plugin_proval_wmipatchesinstalled). It is designed for use on Windows OS machines and requires PowerShell v2 or greater on the agent. The process includes creating the necessary table if it does not exist, deleting existing data for the target machine, gathering patch information, and inserting new data into the table.",tags:["database","update","windows"],draft:!1,unlisted:!1},o=void 0,d={},c=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2}];function l(e){const t={a:"a",br:"br",code:"code",h2:"h2",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,n.jsxs)(t.p,{children:["This script audits the current patch history from .NET to a custom table (plugin_proval_wmipatchesinstalled).",(0,n.jsx)(t.br,{}),"\n","The script should be run against Windows OS machines, and PowerShell v2 or greater is required on the agent."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Time Saved by Automation:"})," 15 Minutes"]}),"\n",(0,n.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Sample Run",src:i(8352).A+"",width:"482",height:"349"})}),"\n",(0,n.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"@plugin_proval_wmipatchesinstalled"}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"/docs/cwa/dataviews/70484928-22c8-4aed-a32b-861646feaaaf",children:"Windows - Rollup Audit (WMI) [Script]"})}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"process",children:"Process"}),"\n",(0,n.jsxs)(t.p,{children:["This script audits the current patch history from .NET to a custom table (plugin_proval_wmipatchesinstalled). The script creates the ",(0,n.jsx)(t.code,{children:"plugin_proval_wmipatchesinstalled"})," table if it does not exist and deletes the current data for the target machine from the table. Then it executes the PowerShell to gather the patch information and inserts the new data into the table."]}),"\n",(0,n.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"The output will be populated in the Dataview Windows - Rollup Audit (WMI) [Script]"}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},8352:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_1-8b45da942a69f30d17139f8014eebf53.png"},28453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>o});var s=i(296540);const n={},a=s.createContext(n);function r(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);