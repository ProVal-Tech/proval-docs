"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[81800],{993835:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>s,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"cwa/monitors/b025f2ba-7f7a-40f2-a742-908dc28d3962","title":"Bitlocker - Recovery Password Automate Backup Missing","description":"This document provides a comprehensive overview of a monitoring script designed to identify target machines with specific Bitlocker monitoring criteria. It includes dependencies, target recommendations, translated SQL queries, and a visual representation of ticketing processes.","source":"@site/docs/cwa/monitors/Bitlocker - Recovery Password Automate Backup Missing.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/b025f2ba-7f7a-40f2-a742-908dc28d3962","permalink":"/docs/cwa/monitors/b025f2ba-7f7a-40f2-a742-908dc28d3962","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Bitlocker - Recovery Password Automate Backup Missing.md","tags":[{"inline":false,"label":"Database","permalink":"/docs/tags/database","description":"Documents related to database management systems and operations"},{"inline":false,"label":"Encryption","permalink":"/docs/tags/encryption","description":"Documents discussing encryption technologies for data protection"},{"inline":false,"label":"Report","permalink":"/docs/tags/report","description":"Documents focused on generating and managing reports"},{"inline":false,"label":"Security","permalink":"/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"}],"version":"current","frontMatter":{"id":"b025f2ba-7f7a-40f2-a742-908dc28d3962","title":"Bitlocker - Recovery Password Automate Backup Missing","title_meta":"Bitlocker - Recovery Password Automate Backup Missing","keywords":["bitlocker","monitoring","encryption","security","audit"],"description":"This document provides a comprehensive overview of a monitoring script designed to identify target machines with specific Bitlocker monitoring criteria. It includes dependencies, target recommendations, translated SQL queries, and a visual representation of ticketing processes.","tags":["database","encryption","report","security"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Bitlocker - OS Volume Encryption Disabled","permalink":"/docs/cwa/monitors/369dac26-3df5-4591-8d51-47fc1cd7204c"},"next":{"title":"BlackPoint SnapAgent Deployment","permalink":"/docs/cwa/monitors/8dad86ab-7d59-43ef-b148-f4ab7df0b8f0"}}');var r=n(474848),a=n(28453);const s={id:"b025f2ba-7f7a-40f2-a742-908dc28d3962",title:"Bitlocker - Recovery Password Automate Backup Missing",title_meta:"Bitlocker - Recovery Password Automate Backup Missing",keywords:["bitlocker","monitoring","encryption","security","audit"],description:"This document provides a comprehensive overview of a monitoring script designed to identify target machines with specific Bitlocker monitoring criteria. It includes dependencies, target recommendations, translated SQL queries, and a visual representation of ticketing processes.",tags:["database","encryption","report","security"],draft:!1,unlisted:!1},o=void 0,d={},c=[{value:"Summary",id:"summary",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Target",id:"target",level:2},{value:"Translated SQL",id:"translated-sql",level:2},{value:"Ticketing",id:"ticketing",level:2}];function l(e){const t={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(t.p,{children:"This monitor will return any target machine whose client has the 'Bitlocker Monitoring' EDF checked, the target's 'Bitlocker Monitoring Exclusion' is not checked, its 'C' drive is listed as a mount point in 'plugin_proval_bitlocker_audit', and the RecoveryPassword in 'plugin_proval_bitlocker_audit' does not exist in the 'plugin_proval_ad_bitlocker_keyprotectors' table for that target."}),"\n",(0,r.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"/docs/cwa/tables/bb3eaac8-80f6-43b9-90f1-75886c06bf14",children:"SEC - Encryption - Custom Table - plugin_proval_bitlocker_audit"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"/docs/solutions/f41e4d71-7074-4c28-8246-b8e3036c1212",children:"SEC - Encryption - Solution - Bitlocker"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"/docs/cwa/tables/23777e5f-2cdd-414c-9938-2293223df3ac",children:"SEC - Encryption - Custom Table - plugin_proval_ad_bitlocker_keyprotectors"})}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"target",children:"Target"}),"\n",(0,r.jsx)(t.p,{children:"Please follow the recommended target for the Bitlocker solution."}),"\n",(0,r.jsx)(t.h2,{id:"translated-sql",children:"Translated SQL"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sql",children:"SELECT computers.username AS TestValue\r\n    ,computers.NAME AS IdentityField\r\n    ,computers.computerid\r\n    ,clients.NAME AS `Client Name`\r\n    ,computers.domain AS `Computer Domain`\r\n    ,IFNULL(IFNULL(edfAssigned1.Value, edfDefault1.value), '0') AS `Computer - Client - Extra Data Field - Security Compliance - Bitlocker Monitoring`\r\n    ,IFNULL(IFNULL(edfAssigned2.Value, edfDefault2.value), '0') AS `Computer - Extra Data Field - Security Compliance - Bitlocker Monitoring Exclusion`\r\n    ,a.noalerts\r\n    ,a.uptimestart\r\n    ,a.uptimeend\r\n    ,computers.DateAdded\r\nFROM Computers\r\nLEFT JOIN inv_operatingsystem ON (Computers.ComputerId = inv_operatingsystem.ComputerId)\r\nLEFT JOIN Clients ON (Computers.ClientId = Clients.ClientId)\r\nLEFT JOIN Locations ON (Computers.LocationId = Locations.LocationID)\r\nLEFT JOIN plugin_proval_bitlocker_audit ppba ON (computers.ComputerID = ppba.ComputerID)\r\nLEFT JOIN agentcomputerdata a ON computers.computerid = a.computerid\r\nLEFT JOIN ExtraFieldData edfAssigned1 ON (\r\n        edfAssigned1.id = Clients.ClientId\r\n        AND edfAssigned1.ExtraFieldId = (\r\n            SELECT ExtraField.id\r\n            FROM ExtraField\r\n            WHERE LTGuid = '1e005883-98be-4325-b374-e0538a744efa'\r\n            )\r\n        )\r\nLEFT JOIN ExtraFieldData edfDefault1 ON (\r\n        edfDefault1.id = 0\r\n        AND edfDefault1.ExtraFieldId = (\r\n            SELECT ExtraField.id\r\n            FROM ExtraField\r\n            WHERE LTGuid = '1e005883-98be-4325-b374-e0538a744efa'\r\n            )\r\n        )\r\nLEFT JOIN ExtraFieldData edfAssigned2 ON (\r\n        edfAssigned2.id = Computers.ComputerId\r\n        AND edfAssigned2.ExtraFieldId = (\r\n            SELECT ExtraField.id\r\n            FROM ExtraField\r\n            WHERE LTGuid = '45a37cb2-d1d0-44eb-b359-22630a61a2c2'\r\n            )\r\n        )\r\nLEFT JOIN ExtraFieldData edfDefault2 ON (\r\n        edfDefault2.id = 0\r\n        AND edfDefault2.ExtraFieldId = (\r\n            SELECT ExtraField.id\r\n            FROM ExtraField\r\n            WHERE LTGuid = '45a37cb2-d1d0-44eb-b359-22630a61a2c2'\r\n            )\r\n        )\r\nWHERE (\r\n        (\r\n            (\r\n                (IFNULL(IFNULL(edfAssigned1.Value, edfDefault1.value), '0') <> 0)\r\n                AND (IFNULL(IFNULL(edfAssigned2.Value, edfDefault2.value), '0') = 0)\r\n                )\r\n            )\r\n        )\r\n    AND (\r\n        (ppba.MountPoint = 'C:')\r\n        AND (ppba.`RecoveryPassword` != '')\r\n        AND (\r\n            ppba.RecoveryPassword NOT IN (\r\n                SELECT RecoveryPassword\r\n                FROM plugin_proval_ad_bitlocker_keyprotectors ppabk\r\n                WHERE ppabk.ComputerID = ppba.ComputerID\r\n                )\r\n            )\r\n        ) AND (\r\n              computers.DateAdded < DATE_SUB(NOW(), INTERVAL 7 DAY)\r\n              )\n"})}),"\n",(0,r.jsx)(t.h2,{id:"ticketing",children:"Ticketing"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Ticketing Image",src:n(969593).A+"",width:"1000",height:"489"})})]})}function p(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},969593:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image_1-3ec778e4e34ca407473f4692f1d81176.png"},28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>o});var i=n(296540);const r={},a=i.createContext(r);function s(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);