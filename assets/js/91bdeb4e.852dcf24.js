"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[20047],{101524:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>i,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"powershell/ps-invoke-wingetprocessor","title":"Invoke-WingetProcessor","description":"Documentation for the Invoke-WingetProcessor command to manage software packages using Winget in PowerShell.","source":"@site/docs/powershell/Invoke-WingetProcessor.md","sourceDirName":"powershell","slug":"/powershell/ps-invoke-wingetprocessor","permalink":"/proval-docs/docs/powershell/ps-invoke-wingetprocessor","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/powershell/Invoke-WingetProcessor.md","tags":[{"inline":false,"label":"Installation","permalink":"/proval-docs/docs/tags/installation","description":"Documents on installing software and configuring systems"},{"inline":false,"label":"Software","permalink":"/proval-docs/docs/tags/software","description":"Documents related to software applications and their lifecycle management"},{"inline":false,"label":"Update","permalink":"/proval-docs/docs/tags/update","description":"Documents discussing software and system updates and their management"}],"version":"current","frontMatter":{"id":"ps-invoke-wingetprocessor","title":"Invoke-WingetProcessor","title_meta":"Invoke-WingetProcessor","keywords":["winget","package","install","update"],"description":"Documentation for the Invoke-WingetProcessor command to manage software packages using Winget in PowerShell.","tags":["installation","software","update"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Invoke-VolumeOptimization","permalink":"/proval-docs/docs/powershell/ps-invoke-volumeoptimization"},"next":{"title":"Join-Domain","permalink":"/proval-docs/docs/powershell/ps-join-domain"}}');var o=n(474848),r=n(28453);const l={id:"ps-invoke-wingetprocessor",title:"Invoke-WingetProcessor",title_meta:"Invoke-WingetProcessor",keywords:["winget","package","install","update"],description:"Documentation for the Invoke-WingetProcessor command to manage software packages using Winget in PowerShell.",tags:["installation","software","update"],draft:!1,unlisted:!1},i=void 0,a={},d=[{value:"Description",id:"description",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Usage",id:"usage",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Output",id:"output",level:2}];function c(e){const t={code:"code",h2:"h2",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h2,{id:"description",children:"Description"}),"\n",(0,o.jsx)(t.p,{children:"WinGetProcessor is a wrapper for Winget for PowerShell."}),"\n",(0,o.jsx)(t.h2,{id:"requirements",children:"Requirements"}),"\n",(0,o.jsx)(t.p,{children:"VLibs must be installed on the endpoint for Winget to function. The script will attempt to install this dependency if Winget is not yet installed."}),"\n",(0,o.jsx)(t.h2,{id:"usage",children:"Usage"}),"\n",(0,o.jsxs)(t.p,{children:["WingetProcessor wraps most Winget functions in a function called ",(0,o.jsx)(t.code,{children:"Invoke-WingetCommand"}),", which wraps the Winget executable in a script block and executes it with ",(0,o.jsx)(t.code,{children:"Invoke-Command"}),". The Winget executable path is dynamically determined based on user context. If Winget is not installed on the endpoint and is being run as NT Authority\\SYSTEM, the package and dependencies will be installed as a ProvisionedAppXPackage."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-powershell",children:"PS C:\\> Invoke-WingetProcessor.ps1 -Install -PackageId 'Postman.Postman','Google.Chrome' -AllowUpdate\r\n    Installs Google Chrome and Postman API Toolbox, allowing the applications to be updated if already installed.\r\nPS C:\\> Invoke-WingetProcessor.ps1 -Install -Name 'Postman x86_64 10.0.1','Google Chrome'\r\n    Installs Google Chrome and Postman API Toolbox, skipping any action if already installed.\r\nPS C:\\> Invoke-WingetProcessor.ps1 -Uninstall -Name 'Google Chrome'\r\n    Uninstalls Google Chrome from the endpoint.\r\nPS C:\\> Invoke-WingetProcessor.ps1 -UpdateAll\r\n    Updates all WinGet-compatible packages on the endpoint.\r\nPS C:\\> Invoke-WingetProcessor.ps1 -Export C:\\Users\\Dev\\Desktop\\Export.json\r\n    Exports a list of installed software to the specified path and returns an object containing that data.\r\nPS C:\\> Invoke-WingetProcessor.ps1 -Import C:\\Users\\Dev\\Desktop\\SoftwareList.json\r\n    Imports a list of previously exported software from the specified path. No changes are made to software on the endpoint exceeding the version listed in the JSON.\r\nPS C:\\> Invoke-WingetProcessor.ps1 -Import C:\\Users\\Dev\\Desktop\\SoftwareList.json -AllowUpdate\r\n    Imports a list of previously exported software from the specified path. All software in the JSON will be installed at the latest available version, regardless of software pre-existing on the endpoint.\r\nPS C:\\> Invoke-WingetProcessor.ps1 -Install -PackageID 'Microsoft.Teams.Classic' -Source 'winget' -AllowUpdate -OptionalParameter '--Scope', 'machine'\r\n    Installs Teams Machine-Wide Installer for all users, allowing the applications to be updated if already installed.\n"})}),"\n",(0,o.jsx)(t.h2,{id:"parameters",children:"Parameters"}),"\n",(0,o.jsxs)(t.table,{children:[(0,o.jsx)(t.thead,{children:(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.th,{children:"Parameter"}),(0,o.jsx)(t.th,{children:"Required"}),(0,o.jsx)(t.th,{children:"Type"}),(0,o.jsx)(t.th,{children:"Parameter Sets"}),(0,o.jsx)(t.th,{children:"Description"})]})}),(0,o.jsxs)(t.tbody,{children:[(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:(0,o.jsx)(t.code,{children:"Install"})}),(0,o.jsx)(t.td,{children:"True"}),(0,o.jsx)(t.td,{children:"Bool"}),(0,o.jsx)(t.td,{children:"InstallByPackage, InstallByName"}),(0,o.jsx)(t.td,{children:"Installs one or more packages on the endpoint"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:(0,o.jsx)(t.code,{children:"AllowUpdate"})}),(0,o.jsx)(t.td,{children:"False"}),(0,o.jsx)(t.td,{children:"Bool"}),(0,o.jsx)(t.td,{children:"InstallByPackage, InstallByName, InstallByImport"}),(0,o.jsxs)(t.td,{children:["Allows ",(0,o.jsx)(t.code,{children:"-Install"})," and ",(0,o.jsx)(t.code,{children:"-Import"})," to update pre-installed packages"]})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:(0,o.jsx)(t.code,{children:"Uninstall"})}),(0,o.jsx)(t.td,{children:"True"}),(0,o.jsx)(t.td,{children:"Bool"}),(0,o.jsx)(t.td,{children:"UninstallByPackage, UninstallByName"}),(0,o.jsx)(t.td,{children:"Uninstalls one or more packages on the endpoint"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:(0,o.jsx)(t.code,{children:"PackageId"})}),(0,o.jsx)(t.td,{children:"True"}),(0,o.jsx)(t.td,{children:"String Array"}),(0,o.jsx)(t.td,{children:"InstallByPackage, UninstallByPackage"}),(0,o.jsx)(t.td,{children:"Install or Uninstall by PackageId(s)"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:(0,o.jsx)(t.code,{children:"Name"})}),(0,o.jsx)(t.td,{children:"True"}),(0,o.jsx)(t.td,{children:"String Array"}),(0,o.jsx)(t.td,{children:"InstallByName, UninstallByName"}),(0,o.jsx)(t.td,{children:"Install or Uninstall by Package Name(s)"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:(0,o.jsx)(t.code,{children:"UpdateAll"})}),(0,o.jsx)(t.td,{children:"True"}),(0,o.jsx)(t.td,{children:"Bool"}),(0,o.jsx)(t.td,{children:"UpdateAll"}),(0,o.jsx)(t.td,{children:"Updates all packages on the endpoint to the latest available version"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:(0,o.jsx)(t.code,{children:"Export"})}),(0,o.jsx)(t.td,{children:"True"}),(0,o.jsx)(t.td,{children:"Bool"}),(0,o.jsx)(t.td,{children:"Export"}),(0,o.jsx)(t.td,{children:"Exports a JSON and returns an object of installed applications on the endpoint."})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:(0,o.jsx)(t.code,{children:"Import"})}),(0,o.jsx)(t.td,{children:"True"}),(0,o.jsx)(t.td,{children:"Bool"}),(0,o.jsx)(t.td,{children:"InstallByImport"}),(0,o.jsx)(t.td,{children:"Imports a list of software in JSON format and installs it on the endpoint."})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:(0,o.jsx)(t.code,{children:"Source"})}),(0,o.jsx)(t.td,{children:"True"}),(0,o.jsx)(t.td,{children:"String"}),(0,o.jsx)(t.td,{children:"InstallByPackage, InstallByName, UpdateAll"}),(0,o.jsx)(t.td,{children:"Specifies winget or msstore as the source for package installation"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:(0,o.jsx)(t.code,{children:"OptionalParameter"})}),(0,o.jsx)(t.td,{children:"False"}),(0,o.jsx)(t.td,{children:"String"}),(0,o.jsx)(t.td,{children:"InstallByPackage, InstallByName, UpdateAll, UninstallByName, UninstallByPackage"}),(0,o.jsx)(t.td,{children:"Specifies optional parameters to deploy/update/remove the application(s)"})]})]})]}),"\n",(0,o.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,o.jsx)(t.p,{children:"Location of output for log, result, and error files."}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:".\\Invoke-WingetProcessor-log.txt\r\n.\\Invoke-WingetProcessor-error.txt\n"})})]})}function p(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>i});var s=n(296540);const o={},r=s.createContext(o);function l(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);