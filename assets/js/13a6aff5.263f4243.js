"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[35272],{544487:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"solutions/34794e27-c775-4d58-953b-5f8a61132cae","title":"Windows User Profiles","description":"This document provides detailed instructions on gathering and displaying information about Windows user profiles using various scripts and monitors. It includes associated scripts, monitors, and optional configurations for effective management of user profiles.","source":"@site/docs/solutions/Windows User Profiles.md","sourceDirName":"solutions","slug":"/solutions/34794e27-c775-4d58-953b-5f8a61132cae","permalink":"/docs/solutions/34794e27-c775-4d58-953b-5f8a61132cae","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/solutions/Windows User Profiles.md","tags":[{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"34794e27-c775-4d58-953b-5f8a61132cae","title":"Windows User Profiles","title_meta":"Windows User Profiles","keywords":["windows","user","profile","information","gathering","monitor"],"description":"This document provides detailed instructions on gathering and displaying information about Windows user profiles using various scripts and monitors. It includes associated scripts, monitors, and optional configurations for effective management of user profiles.","tags":["windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Windows Update Report","permalink":"/docs/solutions/affc0b47-f0fe-43f9-95f6-0e0d1205b4d6"},"next":{"title":"Winget Auto Update","permalink":"/docs/solutions/92b2ccf2-534f-46b6-b1d1-dd77dea47ba8"}}');var t=s(474848),r=s(28453);const o={id:"34794e27-c775-4d58-953b-5f8a61132cae",title:"Windows User Profiles",title_meta:"Windows User Profiles",keywords:["windows","user","profile","information","gathering","monitor"],description:"This document provides detailed instructions on gathering and displaying information about Windows user profiles using various scripts and monitors. It includes associated scripts, monitors, and optional configurations for effective management of user profiles.",tags:["windows"],draft:!1,unlisted:!1},c=void 0,d={},l=[{value:"Purpose",id:"purpose",level:2},{value:"Associated Content",id:"associated-content",level:2},{value:"Optional Content",id:"optional-content",level:2},{value:"Other Content",id:"other-content",level:2},{value:"Implementation",id:"implementation",level:2},{value:"Optional Configuration (Client Performed):",id:"optional-configuration-client-performed",level:3}];function a(e){const n={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"purpose",children:"Purpose"}),"\n",(0,t.jsx)(n.p,{children:"Gathers and displays information about Windows user profiles."}),"\n",(0,t.jsx)(n.h2,{id:"associated-content",children:"Associated Content"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Content"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Function"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"/docs/cwa/scripts/91d80bf6-68c8-4025-b285-d07390b860c8",children:"Script - User Profile - Get Information"})}),(0,t.jsx)(n.td,{children:"Script"}),(0,t.jsx)(n.td,{children:"Gathers information about user profiles."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"/docs/cwa/dataviews/da3a0d43-7bdd-4408-99ce-138337eecb43",children:"Dataview - Windows - User Profiles"})}),(0,t.jsx)(n.td,{children:"Dataview"}),(0,t.jsxs)(n.td,{children:["Displays Windows user profile information gathered from the ",(0,t.jsx)(n.a,{href:"/docs/cwa/scripts/91d80bf6-68c8-4025-b285-d07390b860c8",children:"Script - User Profile - Get Information"}),"."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"/docs/cwa/scripts/765d906e-33c3-4615-9cd6-9c01a9eeaebb",children:"Script - User Profile - Remove"})}),(0,t.jsx)(n.td,{children:"Script"}),(0,t.jsxs)(n.td,{children:["Deletes a user profile and removes the user account if local. Runs the ",(0,t.jsx)(n.a,{href:"/docs/cwa/scripts/91d80bf6-68c8-4025-b285-d07390b860c8",children:"Script - User Profile - Get Information"})," after successful deletion."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"/docs/cwa/monitors/36a5ce5d-5c24-4fe0-9dc7-bc6fc429f4a1",children:"Internal Monitor - Execute Script - User Profile - Get Information"})}),(0,t.jsx)(n.td,{children:"Internal Monitor"}),(0,t.jsxs)(n.td,{children:["Executes the ",(0,t.jsx)(n.a,{href:"/docs/cwa/scripts/91d80bf6-68c8-4025-b285-d07390b860c8",children:"Script - User Profile - Get Information"})," once every 7 days."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"\u25b3 Custom - Execute Script - Windows - User Profile - Get Information"})}),(0,t.jsx)(n.td,{children:"Alert Template"}),(0,t.jsxs)(n.td,{children:["This alert template is used with ",(0,t.jsx)(n.a,{href:"/docs/cwa/monitors/36a5ce5d-5c24-4fe0-9dc7-bc6fc429f4a1",children:"Internal Monitor - Execute Script - User Profile - Get Information"})," to run ",(0,t.jsx)(n.a,{href:"/docs/cwa/scripts/91d80bf6-68c8-4025-b285-d07390b860c8",children:"Script - User Profile - Get Information"})," as an autofix."]})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"optional-content",children:"Optional Content"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Content"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Function"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"/docs/cwa/monitors/ba7bb64b-e12b-4d21-a86f-572ce95b78d7",children:"Internal Monitor - Unknown User Profiles Detection"})}),(0,t.jsx)(n.td,{children:"Internal Monitor"}),(0,t.jsx)(n.td,{children:"Identifies machines that have unknown user profiles."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"https://proval.itglue.com/5078775/docs/17974580",children:"Remote Monitor - Domain Trust Relationship Check"})}),(0,t.jsx)(n.td,{children:"Remote Monitor"}),(0,t.jsx)(n.td,{children:"This monitor generates a ticket whenever the trust relationship between the domain and the workstation is broken. The results of this monitor are used to exclude results from the Unknown User Profiles Detection monitor."})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"other-content",children:"Other Content"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Content"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Function"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"/docs/powershell/ps-get-userprofiles",children:"EPM - Accounts - Agnostic - Get-UserProfiles"})}),(0,t.jsx)(n.td,{children:"Agnostic"}),(0,t.jsxs)(n.td,{children:["Gathers information about user profiles and is used in the script ",(0,t.jsx)(n.a,{href:"/docs/cwa/scripts/91d80bf6-68c8-4025-b285-d07390b860c8",children:"EPM - Accounts - Script - User Profile - Get Information"}),"."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"/docs/powershell/ps-remove-userprofile",children:"EPM - Accounts - Agnostic - Remove-UserProfile"})}),(0,t.jsx)(n.td,{children:"Agnostic"}),(0,t.jsx)(n.td,{children:"Deletes a user profile and removes the user account if local."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"/docs/cwa/tables/7a87abf3-b410-491b-bbc1-534092e61f55",children:"EPM - Accounts - Custom Table - plugin_proval_userprofiles"})}),(0,t.jsx)(n.td,{children:"Custom Table"}),(0,t.jsxs)(n.td,{children:["Stores Windows user profile information. Data is filled by ",(0,t.jsx)(n.a,{href:"/docs/cwa/scripts/91d80bf6-68c8-4025-b285-d07390b860c8",children:"EPM - Accounts - Script - User Profile - Get Information"})," and displayed in ",(0,t.jsx)(n.a,{href:"/docs/cwa/dataviews/da3a0d43-7bdd-4408-99ce-138337eecb43",children:"EPM - Accounts - Dataview - Windows - User Profiles"}),"."]})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"implementation",children:"Implementation"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Import the following scripts using the ProSync plugin:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/cwa/scripts/91d80bf6-68c8-4025-b285-d07390b860c8",children:"EPM - Accounts - Script - User Profile - Get Information"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/cwa/scripts/765d906e-33c3-4615-9cd6-9c01a9eeaebb",children:"EPM - Accounts - Script - User Profile - Remove"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Import the following monitor using the ProSync Plugin:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/cwa/monitors/36a5ce5d-5c24-4fe0-9dc7-bc6fc429f4a1",children:"Internal Monitor - Execute Script - User Profile - Get Information"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Import the following alert templates using the ProSync plugin:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"\u25b3 Custom - Execute Script - Windows - User Profile - Get Information"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Import the following dataviews using the ProSync Plugin:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/cwa/dataviews/da3a0d43-7bdd-4408-99ce-138337eecb43",children:"Dataview - Windows - User Profiles"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Reload the System Cache",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.img,{alt:"Reload System Cache",src:s(687565).A+"",width:"187",height:"177"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Configure the solution as follows:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Navigate to Automation \u2192 Scripts to perform the following task:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Execute the ",(0,t.jsx)(n.a,{href:"/docs/cwa/scripts/91d80bf6-68c8-4025-b285-d07390b860c8",children:"Script - User Profile - Get Information"})," on any Windows machine except the DC server to create the ",(0,t.jsx)(n.a,{href:"/docs/cwa/tables/7a87abf3-b410-491b-bbc1-534092e61f55",children:"Custom Table - plugin_proval_userprofiles"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Navigate to Automation \u2192 Monitors within the CWA Control Center and set up the following:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/docs/cwa/monitors/36a5ce5d-5c24-4fe0-9dc7-bc6fc429f4a1",children:"Internal Monitor - Execute Script - User Profile - Get Information"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Configure with the alert template: ",(0,t.jsx)(n.code,{children:"\u25b3 Custom - Execute Script - Windows - User Profile - Get Information"})]}),"\n",(0,t.jsx)(n.li,{children:"Right-click and Run Now to start the monitor."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["After performing the above steps and verifying that the script has been executed on some machines, check if ",(0,t.jsx)(n.a,{href:"/docs/cwa/dataviews/da3a0d43-7bdd-4408-99ce-138337eecb43",children:"Dataview - Windows - User Profiles"})," is populating data."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"optional-configuration-client-performed",children:"Optional Configuration (Client Performed):"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["If a partner requires the deletion of a particular user profile and also wants it removed if it is a local account, use the script below. Read the associated content thoroughly. ",(0,t.jsx)(n.strong,{children:"This script must be used very cautiously"}),".","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/cwa/scripts/765d906e-33c3-4615-9cd6-9c01a9eeaebb",children:"Script - User Profile - Remove"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["If a partner wants tickets for the unknown user profiles, import and configure the ",(0,t.jsx)(n.a,{href:"/docs/cwa/monitors/ba7bb64b-e12b-4d21-a86f-572ce95b78d7",children:"Unknown User Profiles Detection"})," internal monitor.","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Navigate to Automation \u2192 Monitors within the CWA Control Center and set up the following:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/docs/cwa/monitors/ba7bb64b-e12b-4d21-a86f-572ce95b78d7",children:"Internal Monitor - Unknown User Profiles Detection"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Configure with the alert template: ",(0,t.jsx)(n.code,{children:"\u25b3 Custom - Ticket Creation - Computer"})]}),"\n",(0,t.jsx)(n.li,{children:"Right-click and Run Now to start the monitor."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Use the mentioned ",(0,t.jsx)(n.a,{href:"https://proval.itglue.com/5078775/docs/17975723",children:"Remote Monitor"})," to exclude any domain trust relationship issues."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},687565:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_1-e2435e9a3c6a1eb254214832a52a9e0c.png"},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var i=s(296540);const t={},r=i.createContext(t);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);