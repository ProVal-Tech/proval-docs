"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[53545],{711928:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>i});const t=JSON.parse('{"id":"vsa/procedures/986e2bee-68f3-456a-afd3-8634c26b877f","title":"Sophos Removal","description":"This document provides a comprehensive guide on removing the Sophos Endpoint Agent from an endpoint, including example logs, dependencies, and the process involved in the uninstallation. It details the use of SophosZap and necessary configurations for successful removal.","source":"@site/docs/vsa/procedures/Sophos Removal.md","sourceDirName":"vsa/procedures","slug":"/vsa/procedures/986e2bee-68f3-456a-afd3-8634c26b877f","permalink":"/docs/vsa/procedures/986e2bee-68f3-456a-afd3-8634c26b877f","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/vsa/procedures/Sophos Removal.md","tags":[{"inline":false,"label":"Cleanup","permalink":"/docs/tags/cleanup","description":"Documents on system cleanup processes and tools to free up resources"},{"inline":false,"label":"Security","permalink":"/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Software","permalink":"/docs/tags/software","description":"Documents related to software applications and their lifecycle management"},{"inline":false,"label":"Uninstallation","permalink":"/docs/tags/uninstallation","description":"Documents related to software removal and uninstallation processes"}],"version":"current","frontMatter":{"id":"986e2bee-68f3-456a-afd3-8634c26b877f","title":"Sophos Removal","title_meta":"Sophos Removal","keywords":["sophos","endpoint","uninstall","zap","agent"],"description":"This document provides a comprehensive guide on removing the Sophos Endpoint Agent from an endpoint, including example logs, dependencies, and the process involved in the uninstallation. It details the use of SophosZap and necessary configurations for successful removal.","tags":["cleanup","security","software","uninstallation"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Soji Disk Cleaner","permalink":"/docs/vsa/procedures/72784e6a-7954-4965-871a-ab9a0a13d298"},"next":{"title":"Splashtop Uninstall","permalink":"/docs/vsa/procedures/39a825db-06ff-4ac3-9dce-30b6f72f3eb0"}}');var d=n(474848),l=n(28453);const r={id:"986e2bee-68f3-456a-afd3-8634c26b877f",title:"Sophos Removal",title_meta:"Sophos Removal",keywords:["sophos","endpoint","uninstall","zap","agent"],description:"This document provides a comprehensive guide on removing the Sophos Endpoint Agent from an endpoint, including example logs, dependencies, and the process involved in the uninstallation. It details the use of SophosZap and necessary configurations for successful removal.",tags:["cleanup","security","software","uninstallation"],draft:!1,unlisted:!1},o=void 0,c={},i=[{value:"Summary",id:"summary",level:2},{value:"Example Agent Procedure Log",id:"example-agent-procedure-log",level:2},{value:"If Tamper Protection is NOT disabled, this is what appears in the log:",id:"if-tamper-protection-is-not-disabled-this-is-what-appears-in-the-log",level:3},{value:"Dependencies",id:"dependencies",level:2},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2}];function a(e){const s={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.h2,{id:"summary",children:"Summary"}),"\n",(0,d.jsxs)(s.p,{children:["This document explains how to remove the Sophos Endpoint Agent from an endpoint. It utilizes ",(0,d.jsx)(s.a,{href:"/docs/powershell/ps-remove-sophos",children:"SWM - Software Uninstall - Agnostic - Remove-Sophos"}),"."]}),"\n",(0,d.jsx)(s.h2,{id:"example-agent-procedure-log",children:"Example Agent Procedure Log"}),"\n",(0,d.jsxs)(s.table,{children:[(0,d.jsx)(s.thead,{children:(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.th,{children:"Time"}),(0,d.jsx)(s.th,{children:"Action"}),(0,d.jsx)(s.th,{children:"Result"}),(0,d.jsx)(s.th,{children:"User"})]})}),(0,d.jsxs)(s.tbody,{children:[(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:36:46 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Sophos Removal"}),(0,d.jsx)(s.td,{children:"Success THEN"}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:36:45 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Sophos Removal-0003"}),(0,d.jsx)(s.td,{children:"Log: 2023-01-30 09:36:36 INIT..."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:36:45 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Sophos Removal-0001"}),(0,d.jsx)(s.td,{children:"Raw PS1 Data:"}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:36:45 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command (64-bit, Run As System)"}),(0,d.jsx)(s.td,{children:"Success THEN"}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:36:45 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command (64-bit, Run As System)-0016"}),(0,d.jsx)(s.td,{children:"Powershell command complete..."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:36:45 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command (64-bit, Run As System)-0016"}),(0,d.jsx)(s.td,{children:"Informational: GetFile command overwrote..."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:36:43 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command (64-bit, Run As System)-0011"}),(0,d.jsx)(s.td,{children:"Executing 64-bit Powershell command as System: ..."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:36:43 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command (64-bit, Run As System)-0013"}),(0,d.jsx)(s.td,{children:"Sending output to global variable."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:36:42 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command (64-bit, Run As System)-0008"}),(0,d.jsx)(s.td,{children:"Custom commands detected as ..."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:36:42 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command (64-bit, Run As System)-0003"}),(0,d.jsx)(s.td,{children:"No Powershell file variable detected."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:36:41 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command (64-bit, Run As System)-0002"}),(0,d.jsx)(s.td,{children:"Powershell is present."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:36:39 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command"}),(0,d.jsx)(s.td,{children:"Success THEN"}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:36:38 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command-0011"}),(0,d.jsx)(s.td,{children:"Powershell command completed!"}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:36:37 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command-0011"}),(0,d.jsx)(s.td,{children:"Executing Powershell ..."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:36:37 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command-0010"}),(0,d.jsx)(s.td,{children:"Not sending output to variable."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:36:37 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command-0008"}),(0,d.jsx)(s.td,{children:"New command variable is: ..."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:36:37 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command-0008"}),(0,d.jsx)(s.td,{children:"Custom commands detected as ..."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:36:35 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command-0002"}),(0,d.jsx)(s.td,{children:"Powershell is present."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:32:29 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command (64-bit, Run As System)-0011"}),(0,d.jsx)(s.td,{children:"Executing 64-bit Powershell command as System: ..."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:32:29 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command (64-bit, Run As System)-0013"}),(0,d.jsx)(s.td,{children:"Sending output to global variable."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:32:28 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command (64-bit, Run As System)-0008"}),(0,d.jsx)(s.td,{children:"Custom commands detected as ..."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:32:28 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command (64-bit, Run As System)-0003"}),(0,d.jsx)(s.td,{children:"No Powershell file variable detected."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:32:26 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command (64-bit, Run As System)-0002"}),(0,d.jsx)(s.td,{children:"Powershell is present."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:32:23 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command"}),(0,d.jsx)(s.td,{children:"Success THEN"}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:32:23 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command-0011"}),(0,d.jsx)(s.td,{children:"Powershell command completed!"}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:32:20 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command-0011"}),(0,d.jsx)(s.td,{children:"Executing Powershell ..."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:32:20 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command-0010"}),(0,d.jsx)(s.td,{children:"Not sending output to variable."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:32:20 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command-0008"}),(0,d.jsx)(s.td,{children:"New command variable is: ..."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:32:20 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command-0008"}),(0,d.jsx)(s.td,{children:"Custom commands detected as ..."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:32:15 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Execute Powershell Command-0002"}),(0,d.jsx)(s.td,{children:"Powershell is present."}),(0,d.jsx)(s.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"10:32:06 am 30-Jan-23"}),(0,d.jsx)(s.td,{children:"Run Now - Sophos Removal"}),(0,d.jsx)(s.td,{children:"Admin provaltech.com/dan.hicks scheduled procedure Run Now - Sophos Removal to run at Jan 30 2023 10:32 AM"}),(0,d.jsx)(s.td,{})]})]})]}),"\n",(0,d.jsx)(s.h3,{id:"if-tamper-protection-is-not-disabled-this-is-what-appears-in-the-log",children:"If Tamper Protection is NOT disabled, this is what appears in the log:"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{children:"9:46:23 am 30-Jan-23    Sophos Removal    Success THEN    provaltech.com/dan.hicks\r\n9:46:23 am 30-Jan-23    Sophos Removal-0005    ERROR: 2023-01-30 09:45:40 Error ERROR: SophosZap was not found in the script directory.    provaltech.com/dan.hicks\r\n9:46:22 am 30-Jan-23    Sophos Removal-0003    Log: 2023-01-30 09:36:36 INIT...    provaltech.com/dan.hicks\r\n...\n"})}),"\n",(0,d.jsx)(s.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,d.jsxs)(s.p,{children:[(0,d.jsx)(s.a,{href:"https://download.sophos.com/tools/SophosZap.exe",children:"SophosZap"})," needs to be in the managed files, and the AP needs to be modified to point to it. Otherwise, SkipZap MUST be enabled on run, or the AP will fail.",(0,d.jsx)(s.br,{}),"\n","Agnostic Content: ",(0,d.jsx)(s.a,{href:"/docs/powershell/ps-remove-sophos",children:"SWM - Software Uninstall - Agnostic - Remove-Sophos"})]}),"\n",(0,d.jsx)(s.h2,{id:"process",children:"Process"}),"\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsx)(s.li,{children:"Runs the Sophos Endpoint Uninstaller"}),"\n",(0,d.jsx)(s.li,{children:"Runs Sophos Zap"}),"\n",(0,d.jsx)(s.li,{children:"Cleans up remnants."}),"\n"]}),"\n",(0,d.jsx)(s.h2,{id:"output",children:"Output"}),"\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsx)(s.li,{children:"./Remove-Sophos-Log.txt"}),"\n",(0,d.jsx)(s.li,{children:"./Remove-Sophos-Error.txt"}),"\n",(0,d.jsx)(s.li,{children:"Agent Procedure Log"}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,d.jsx)(s,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>o});var t=n(296540);const d={},l=t.createContext(d);function r(e){const s=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:r(e.components),t.createElement(l.Provider,{value:s},e.children)}}}]);