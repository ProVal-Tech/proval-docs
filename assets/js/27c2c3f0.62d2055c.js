"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[80457],{594306:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>d,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"vsa/procedures/b50eaaf9-9ec6-412b-85a6-44e6e82c43f9","title":"Removable Storage Disable","description":"This document details the procedure to disable removable storage devices on endpoints, ensuring enhanced security by preventing unauthorized access to removable media. It includes notes on reboot requirements, example agent procedure logs, and the registry modifications necessary for implementation.","source":"@site/docs/vsa/procedures/Removable Storage Disable.md","sourceDirName":"vsa/procedures","slug":"/vsa/procedures/b50eaaf9-9ec6-412b-85a6-44e6e82c43f9","permalink":"/proval-docs/docs/vsa/procedures/b50eaaf9-9ec6-412b-85a6-44e6e82c43f9","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/vsa/procedures/Removable Storage Disable.md","tags":[{"inline":false,"label":"Security","permalink":"/proval-docs/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Update","permalink":"/proval-docs/docs/tags/update","description":"Documents discussing software and system updates and their management"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"b50eaaf9-9ec6-412b-85a6-44e6e82c43f9","title":"Removable Storage Disable","title_meta":"Removable Storage Disable","keywords":["removable","storage","disable","endpoint","security"],"description":"This document details the procedure to disable removable storage devices on endpoints, ensuring enhanced security by preventing unauthorized access to removable media. It includes notes on reboot requirements, example agent procedure logs, and the registry modifications necessary for implementation.","tags":["security","update","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Registry contents Removal","permalink":"/proval-docs/docs/vsa/procedures/a6e179d1-ac12-482b-b315-f0fae1b83353"},"next":{"title":"Removable Storage Enable","permalink":"/proval-docs/docs/vsa/procedures/e6349f40-ad92-422c-88d9-654b9bb87b49"}}');var r=s(474848),n=s(28453);const d={id:"b50eaaf9-9ec6-412b-85a6-44e6e82c43f9",title:"Removable Storage Disable",title_meta:"Removable Storage Disable",keywords:["removable","storage","disable","endpoint","security"],description:"This document details the procedure to disable removable storage devices on endpoints, ensuring enhanced security by preventing unauthorized access to removable media. It includes notes on reboot requirements, example agent procedure logs, and the registry modifications necessary for implementation.",tags:["security","update","windows"],draft:!1,unlisted:!1},i=void 0,a={},c=[{value:"Summary",id:"summary",level:2},{value:"Notes",id:"notes",level:2},{value:"Example Agent Procedure Log",id:"example-agent-procedure-log",level:2},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2}];function l(e){const t={h2:"h2",li:"li",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(t.p,{children:"Disables removable storage devices on the endpoint."}),"\n",(0,r.jsx)(t.h2,{id:"notes",children:"Notes"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"No reboot is required unless a removable device is already connected to the endpoint."}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"example-agent-procedure-log",children:"Example Agent Procedure Log"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Time"}),(0,r.jsx)(t.th,{children:"Action"}),(0,r.jsx)(t.th,{children:"Status"}),(0,r.jsx)(t.th,{children:"User"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"4:23:54 pm 1-Nov-22"}),(0,r.jsx)(t.td,{children:"Removable Storage Disable"}),(0,r.jsx)(t.td,{children:"Success THEN"}),(0,r.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"4:23:54 pm 1-Nov-22"}),(0,r.jsx)(t.td,{children:"Removable Storage Disable"}),(0,r.jsx)(t.td,{children:"Removable Storage has been disallowed on this endpoint."}),(0,r.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"4:23:54 pm 1-Nov-22"}),(0,r.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)"}),(0,r.jsx)(t.td,{children:"Success THEN"}),(0,r.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"4:23:54 pm 1-Nov-22"}),(0,r.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0014"}),(0,r.jsx)(t.td,{children:"Powershell command completed!"}),(0,r.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"4:23:54 pm 1-Nov-22"}),(0,r.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0011"}),(0,r.jsx)(t.td,{children:'Executing 64-bit Powershell command as System: "" -command "$ItemPath = \'HKLM://SOFTWARE//Policies//Microsoft//Windows//RemovableStorageDevices\';if (!(Test-Path -Path $ItemPath)) {New-Item -Path $ItemPath -Force};Set-ItemProperty -Path $ItemPath -Name \'Deny_All\' -Value 1 -Force" ""'}),(0,r.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"4:23:54 pm 1-Nov-22"}),(0,r.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0013"}),(0,r.jsx)(t.td,{children:"Not sending output to variable."}),(0,r.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"4:23:54 pm 1-Nov-22"}),(0,r.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0008"}),(0,r.jsx)(t.td,{children:"Custom commands detected as $ItemPath = 'HKLM://SOFTWARE//Policies//Microsoft//Windows//RemovableStorageDevices';if (!(Test-Path -Path $ItemPath)) {New-Item -Path $ItemPath -Force};Set-ItemProperty -Path $ItemPath -Name 'Deny_All' -Value 1 -Force"}),(0,r.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"4:23:54 pm 1-Nov-22"}),(0,r.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0003"}),(0,r.jsx)(t.td,{children:"No powershell file variable detected."}),(0,r.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"4:23:53 pm 1-Nov-22"}),(0,r.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0002"}),(0,r.jsx)(t.td,{children:"Powershell is present."}),(0,r.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"4:23:45 pm 1-Nov-22"}),(0,r.jsx)(t.td,{children:"Run Now - Removable Storage Disable"}),(0,r.jsx)(t.td,{children:"Admin provaltech.com/dan.hicks scheduled procedure Run Now - Removable Storage Disable to run at Nov 1 2022 4:23 PM"}),(0,r.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"process",children:"Process"}),"\n",(0,r.jsx)(t.p,{children:"Sets HKLM://SOFTWARE//Policies//Microsoft//Windows//RemovableStorageDevices//Deny_All to 1"}),"\n",(0,r.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,r.jsx)(t.p,{children:"AP Log"})]})}function h(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>d,x:()=>i});var o=s(296540);const r={},n=o.createContext(r);function d(e){const t=o.useContext(n);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),o.createElement(n.Provider,{value:t},e.children)}}}]);