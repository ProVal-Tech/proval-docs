"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[83836],{283052:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>o,contentTitle:()=>a,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"solutions/2910ca09-a0c7-4b44-8ea4-ef6e71304df8","title":"Queue Script Next Checkin","description":"This document explains how to schedule a script in ConnectWise Automate to run on a computer the next time it checks in, specifically targeting offline machines. It covers the implementation process, associated content, and answers to frequently asked questions regarding the script queueing process.","source":"@site/docs/solutions/Queue Script Next Checkin.md","sourceDirName":"solutions","slug":"/solutions/2910ca09-a0c7-4b44-8ea4-ef6e71304df8","permalink":"/docs/solutions/2910ca09-a0c7-4b44-8ea4-ef6e71304df8","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/solutions/Queue Script Next Checkin.md","tags":[{"inline":false,"label":"Setup","permalink":"/docs/tags/setup","description":"Documents on setting up software and hardware configurations"}],"version":"current","frontMatter":{"id":"2910ca09-a0c7-4b44-8ea4-ef6e71304df8","title":"Queue Script Next Checkin","title_meta":"Queue Script Next Checkin","keywords":["script","offline","automate","queue","computer"],"description":"This document explains how to schedule a script in ConnectWise Automate to run on a computer the next time it checks in, specifically targeting offline machines. It covers the implementation process, associated content, and answers to frequently asked questions regarding the script queueing process.","tags":["setup"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"ProVal Content Audit","permalink":"/docs/solutions/54ca5ad4-d580-4056-92f0-fc3896ac5438"},"next":{"title":"QuickPass Agent Deployment","permalink":"/docs/solutions/65d0dbb6-29c1-4242-841c-1da9b92edab6"}}');var c=s(474848),n=s(28453);const r={id:"2910ca09-a0c7-4b44-8ea4-ef6e71304df8",title:"Queue Script Next Checkin",title_meta:"Queue Script Next Checkin",keywords:["script","offline","automate","queue","computer"],description:"This document explains how to schedule a script in ConnectWise Automate to run on a computer the next time it checks in, specifically targeting offline machines. It covers the implementation process, associated content, and answers to frequently asked questions regarding the script queueing process.",tags:["setup"],draft:!1,unlisted:!1},a=void 0,o={},d=[{value:"Purpose",id:"purpose",level:2},{value:"Associated Content",id:"associated-content",level:2},{value:"Implementation",id:"implementation",level:2},{value:"FAQ",id:"faq",level:2}];function l(e){const t={a:"a",br:"br",em:"em",h2:"h2",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(t.h2,{id:"purpose",children:"Purpose"}),"\n",(0,c.jsx)(t.p,{children:"This solution provides a way to schedule a script in Automate to run on a computer the next time it checks in. It is intended for offline computers, in cases where you are unsure of when this computer will become available again; however, it can be utilized to schedule any script to run on any machine."}),"\n",(0,c.jsx)(t.h2,{id:"associated-content",children:"Associated Content"}),"\n",(0,c.jsxs)(t.table,{children:[(0,c.jsx)(t.thead,{children:(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.th,{children:"Content"}),(0,c.jsx)(t.th,{children:"Type"}),(0,c.jsx)(t.th,{children:"Function"})]})}),(0,c.jsxs)(t.tbody,{children:[(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.td,{children:(0,c.jsx)(t.a,{href:"/docs/cwa/tables/a20befa8-ecca-4cf9-9d18-c4140f87aafc",children:"CWM - Automate - Custom Table - plugin_proval_queued_scripts"})}),(0,c.jsx)(t.td,{children:"Custom Table"}),(0,c.jsx)(t.td,{children:"Stores queued scripts and their requested parameters."})]}),(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.td,{children:"'Machines With Queued Scripts' Group"}),(0,c.jsx)(t.td,{children:"Group"}),(0,c.jsxs)(t.td,{children:["Members will be computers with pending queued scripts. The group has the ",(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/f60f4501-a2ea-43f0-87ee-99fc8ee15031",children:"CWM - Automate - Script - Run Queued Scripts"})," script scheduled to run every 3 days."]})]}),(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.td,{children:(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/c96624e1-038a-45ca-a6d0-645a629af721",children:"CWM - Automate - Script - Queue Script"})}),(0,c.jsx)(t.td,{children:"Script"}),(0,c.jsx)(t.td,{children:"Creates the table, group, and scheduled script on the group if required. Adds the target agent to the created group and stores the target script ID and parameters in the custom table."})]}),(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.td,{children:(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/f60f4501-a2ea-43f0-87ee-99fc8ee15031",children:"CWM - Automate - Script - Run Queued Scripts"})}),(0,c.jsx)(t.td,{children:"Script"}),(0,c.jsx)(t.td,{children:"Collects script information for the target agent from the table and executes the script(s) with the requested parameters. The script then removes executed script entries from the custom table and removes the computer from the group."})]}),(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.td,{children:(0,c.jsx)(t.a,{href:"/docs/cwa/monitors/41b393a9-cb59-4418-8536-9fe911cb4c9d",children:"CWM - Automate - Monitor - Monitor~~ Autofix - Run Queued Scripts"})}),(0,c.jsx)(t.td,{children:"Internal Monitor"}),(0,c.jsxs)(t.td,{children:["This monitor is created by the ",(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/c96624e1-038a-45ca-a6d0-645a629af721",children:"CWM - Automate - Script - Queue Script"})," automate script. It returns failed if the computer is offline, and success when online."]})]})]})]}),"\n",(0,c.jsx)(t.h2,{id:"implementation",children:"Implementation"}),"\n",(0,c.jsxs)(t.p,{children:["Import both scripts.",(0,c.jsx)(t.br,{}),"\n","Run the ",(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/c96624e1-038a-45ca-a6d0-645a629af721",children:"CWM - Automate - Script - Queue Script"})," script; this sets up the environment on the first run. No additional setup is required."]}),"\n",(0,c.jsx)(t.h2,{id:"faq",children:"FAQ"}),"\n",(0,c.jsxs)(t.ol,{children:["\n",(0,c.jsxs)(t.li,{children:["\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.em,{children:"How does this work?"})}),"\n",(0,c.jsxs)(t.ol,{children:["\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/c96624e1-038a-45ca-a6d0-645a629af721",children:"CWM - Automate - Script - Queue Script"}),"\n",(0,c.jsxs)(t.ol,{children:["\n",(0,c.jsxs)(t.li,{children:["If you run ",(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/c96624e1-038a-45ca-a6d0-645a629af721",children:"CWM - Automate - Script - Queue Script"})," on an online machine, the script will schedule the desired script to run immediately."]}),"\n",(0,c.jsxs)(t.li,{children:["The script, ",(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/c96624e1-038a-45ca-a6d0-645a629af721",children:"CWM - Automate - Script - Queue Script"}),", creates the custom table, ",(0,c.jsx)(t.a,{href:"/docs/cwa/tables/a20befa8-ecca-4cf9-9d18-c4140f87aafc",children:"CWM - Automate - Custom Table - plugin_proval_queued_scripts"}),", if it does not exist, when running on an offline machine."]}),"\n",(0,c.jsxs)(t.li,{children:["The script, ",(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/c96624e1-038a-45ca-a6d0-645a629af721",children:"CWM - Automate - Script - Queue Script"}),", creates the 'Machines With Queued Scripts' group if it does not exist and assigns an internal monitor to that group if it's not already assigned. This monitor will check for a recent check-in from the agent; if a recent check-in has been found, then the monitor autofix will run ",(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/f60f4501-a2ea-43f0-87ee-99fc8ee15031",children:"CWM - Automate - Script - Run Queued Scripts"}),"."]}),"\n",(0,c.jsxs)(t.li,{children:["The script, ",(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/c96624e1-038a-45ca-a6d0-645a629af721",children:"CWM - Automate - Script - Queue Script"}),", then adds the target computer to that group if the computer is not already a member."]}),"\n",(0,c.jsxs)(t.li,{children:["After the computer is verified to be a member of the group, the script, ",(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/c96624e1-038a-45ca-a6d0-645a629af721",children:"CWM - Automate - Script - Queue Script"}),", will populate the custom table, ",(0,c.jsx)(t.a,{href:"/docs/cwa/tables/a20befa8-ecca-4cf9-9d18-c4140f87aafc",children:"CWM - Automate - Custom Table - plugin_proval_queued_scripts"}),", with the requested script and parameters, ",(0,c.jsx)(t.strong,{children:"if that computer does not already have that script scheduled."})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(t.li,{children:["\n",(0,c.jsx)(t.p,{children:"'Machines With Queued Scripts' Group"}),"\n",(0,c.jsxs)(t.ol,{children:["\n",(0,c.jsx)(t.li,{children:"The group, 'Machines With Queued Scripts', holds all computers that have any queued scripts using this solution."}),"\n",(0,c.jsxs)(t.li,{children:["This group's intention is to ensure that only computers with queued scripts are targeted with the ",(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/f60f4501-a2ea-43f0-87ee-99fc8ee15031",children:"CWM - Automate - Script - Run Queued Scripts"})," script."]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(t.li,{children:["\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.a,{href:"/docs/cwa/tables/a20befa8-ecca-4cf9-9d18-c4140f87aafc",children:"CWM - Automate - Custom Table - plugin_proval_queued_scripts"})}),"\n",(0,c.jsxs)(t.ol,{children:["\n",(0,c.jsxs)(t.li,{children:["The custom table, ",(0,c.jsx)(t.a,{href:"/docs/cwa/tables/a20befa8-ecca-4cf9-9d18-c4140f87aafc",children:"CWM - Automate - Custom Table - plugin_proval_queued_scripts"}),", is intended to hold a memory of any script for any target machine that you would like to execute the next time the computer checks in."]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(t.li,{children:["\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/f60f4501-a2ea-43f0-87ee-99fc8ee15031",children:"CWM - Automate - Script - Run Queued Scripts"})}),"\n",(0,c.jsxs)(t.ol,{children:["\n",(0,c.jsxs)(t.li,{children:["The script, ",(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/f60f4501-a2ea-43f0-87ee-99fc8ee15031",children:"CWM - Automate - Script - Run Queued Scripts"}),", is executed from an internal monitor's alert action 'Monitor~~Autofix - Run Queued Scripts'."]}),"\n",(0,c.jsxs)(t.li,{children:["This script will execute any script(s) found in ",(0,c.jsx)(t.a,{href:"/docs/cwa/tables/a20befa8-ecca-4cf9-9d18-c4140f87aafc",children:"CWM - Automate - Custom Table - plugin_proval_queued_scripts"})," for the target machine with its associated desired parameters either silently or with natural logging."]}),"\n",(0,c.jsxs)(t.li,{children:["This script will remove any queued scripts from ",(0,c.jsx)(t.a,{href:"/docs/cwa/tables/a20befa8-ecca-4cf9-9d18-c4140f87aafc",children:"CWM - Automate - Custom Table - plugin_proval_queued_scripts"})," upon execution of that script."]}),"\n",(0,c.jsx)(t.li,{children:"This script will remove the computer from the group 'Machines With Queued Scripts' at the completion of the script."}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(t.li,{children:["\n",(0,c.jsxs)(t.p,{children:[(0,c.jsx)(t.em,{children:"I have scheduled a script on a target machine, and I want to schedule that same script again. Can I?"}),(0,c.jsx)(t.br,{}),"\n","Unfortunately, no. The system safeguards against duplicate entries in the ",(0,c.jsx)(t.a,{href:"/docs/cwa/tables/a20befa8-ecca-4cf9-9d18-c4140f87aafc",children:"CWM - Automate - Custom Table - plugin_proval_queued_scripts"})," table and will not allow a target to schedule the same script on the same computer twice at the next check-in."]}),"\n"]}),"\n",(0,c.jsxs)(t.li,{children:["\n",(0,c.jsxs)(t.p,{children:[(0,c.jsx)(t.em,{children:"I have been running this, and I am noticing that my scripting engine is suffering. What can I do?"}),(0,c.jsx)(t.br,{}),"\n","A silent parameter is present in the ",(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/f60f4501-a2ea-43f0-87ee-99fc8ee15031",children:"CWM - Automate - Script - Run Queued Scripts"})," script. Modify the ",(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/f60f4501-a2ea-43f0-87ee-99fc8ee15031",children:"CWM - Automate - Script - Run Queued Scripts"})," script, setting the script's global silent switch to 'Yes'. This will transfer the running of the queued scripts from the script engine to simply being called directly from the ",(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/f60f4501-a2ea-43f0-87ee-99fc8ee15031",children:"CWM - Automate - Script - Run Queued Scripts"})," script. Keep in mind this means that your queued scripts will not show up in the script history or on the computer's scripts page, and all logging for any script called in this manner will be displayed under the ",(0,c.jsx)(t.a,{href:"/docs/cwa/scripts/f60f4501-a2ea-43f0-87ee-99fc8ee15031",children:"CWM - Automate - Script - Run Queued Scripts"})," log on the computer's script page."]}),"\n"]}),"\n"]})]})}function u(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,c.jsx)(t,{...e,children:(0,c.jsx)(l,{...e})}):l(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>a});var i=s(296540);const c={},n=i.createContext(c);function r(e){const t=i.useContext(n);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:r(e.components),i.createElement(n.Provider,{value:t},e.children)}}}]);