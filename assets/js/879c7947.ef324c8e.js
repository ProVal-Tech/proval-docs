"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[32487],{144553:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"cwa/roles/d4cae7e3-3abd-44b5-a9d9-7a0668834050","title":"Mimikatz - Potential Threat","description":"This document provides an overview of how to check the Windows registry for the stored credentials flag related to WDigest. It explains the implications of the flag being set or not and highlights potential vulnerabilities associated with it, including references to Mimikatz.","source":"@site/docs/cwa/roles/Mimikatz - Potential Threat.md","sourceDirName":"cwa/roles","slug":"/cwa/roles/d4cae7e3-3abd-44b5-a9d9-7a0668834050","permalink":"/proval-docs/docs/cwa/roles/d4cae7e3-3abd-44b5-a9d9-7a0668834050","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/roles/Mimikatz - Potential Threat.md","tags":[{"inline":false,"label":"Registry","permalink":"/proval-docs/docs/tags/registry","description":"Documents concerning system registry management and troubleshooting"},{"inline":false,"label":"Security","permalink":"/proval-docs/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Vulnerability","permalink":"/proval-docs/docs/tags/vulnerability","description":"Documents about system vulnerabilities and methods for their mitigation"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"d4cae7e3-3abd-44b5-a9d9-7a0668834050","title":"Mimikatz - Potential Threat","title_meta":"Mimikatz - Potential Threat","keywords":["registry","credentials","security","vulnerability","threat"],"description":"This document provides an overview of how to check the Windows registry for the stored credentials flag related to WDigest. It explains the implications of the flag being set or not and highlights potential vulnerabilities associated with it, including references to Mimikatz.","tags":["registry","security","vulnerability","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Microsoft - On-premises DRS Joined","permalink":"/proval-docs/docs/cwa/roles/de9337ff-a8ec-4d42-b182-436178eecbc6"},"next":{"title":"Mimikatz - Vulnerable","permalink":"/proval-docs/docs/cwa/roles/58ebf02f-0bcc-458d-bc99-7ee5cc89a6d2"}}');var r=i(474848),n=i(28453);const a={id:"d4cae7e3-3abd-44b5-a9d9-7a0668834050",title:"Mimikatz - Potential Threat",title_meta:"Mimikatz - Potential Threat",keywords:["registry","credentials","security","vulnerability","threat"],description:"This document provides an overview of how to check the Windows registry for the stored credentials flag related to WDigest. It explains the implications of the flag being set or not and highlights potential vulnerabilities associated with it, including references to Mimikatz.",tags:["registry","security","vulnerability","windows"],draft:!1,unlisted:!1},o=void 0,l={},c=[{value:"Summary",id:"summary",level:2},{value:"Settings",id:"settings",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(t.p,{children:"This document checks the registry for the value of the stored credentials flag."}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Registry Path:"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest:UseLogonCredential\n"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"If the flag is set, there is a potential threat associated with using it."}),"\n",(0,r.jsxs)(t.li,{children:["If the flag is not set but exists, the system is vulnerable. For more information, see ",(0,r.jsx)(t.a,{href:"/proval-docs/docs/cwa/roles/58ebf02f-0bcc-458d-bc99-7ee5cc89a6d2",children:"Mimikatz - Vulnerable"}),"."]}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"settings",children:"Settings"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Detection String"}),(0,r.jsx)(t.th,{children:"Comparator"}),(0,r.jsx)(t.th,{children:"Result"}),(0,r.jsx)(t.th,{children:"Applicable OS"})]})}),(0,r.jsx)(t.tbody,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"{%-HKLM/SYSTEM/CurrentControlSet/Control/SecurityProviders/WDigest:UseLogonCredential-%}"})}),(0,r.jsx)(t.td,{children:"Equals"}),(0,r.jsx)(t.td,{children:"1"}),(0,r.jsx)(t.td,{children:"Windows"})]})})]})]})}function h(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,t,i)=>{i.d(t,{R:()=>a,x:()=>o});var s=i(296540);const r={},n=s.createContext(r);function a(e){const t=s.useContext(n);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(n.Provider,{value:t},e.children)}}}]);