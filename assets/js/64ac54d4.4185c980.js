"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[14758],{585574:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"cwa/monitors/de574ff4-5a24-4ccd-83d3-499b1b274893","title":"RSM - Active Directory- AD Account Lockout Detection","description":"This document outlines the setup for monitoring event ID 4740 to detect account lockouts in Active Directory. It includes configuration details for alert generation, dependencies, implementation instructions, and ticketing format for incidents.","source":"@site/docs/cwa/monitors/RSM - Active Directory- AD Account Lockout Detection.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/de574ff4-5a24-4ccd-83d3-499b1b274893","permalink":"/proval-docs/docs/cwa/monitors/de574ff4-5a24-4ccd-83d3-499b1b274893","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/RSM - Active Directory- AD Account Lockout Detection.md","tags":[{"inline":false,"label":"Active Directory","permalink":"/proval-docs/docs/tags/active-directory","description":"Documents related to Active Directory services and management"},{"inline":false,"label":"Ticketing","permalink":"/proval-docs/docs/tags/ticketing","description":"Documents related to ticketing systems and IT support management"}],"version":"current","frontMatter":{"id":"de574ff4-5a24-4ccd-83d3-499b1b274893","title":"RSM - Active Directory- AD Account Lockout Detection","title_meta":"RSM - Active Directory- AD Account Lockout Detection","keywords":["monitoring","alert","eventid","domaincontroller","ticketing"],"description":"This document outlines the setup for monitoring event ID 4740 to detect account lockouts in Active Directory. It includes configuration details for alert generation, dependencies, implementation instructions, and ticketing format for incidents.","tags":["active-directory","ticketing"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"RDS Hosts - Allow New Connections Status","permalink":"/proval-docs/docs/cwa/monitors/18fd9d3f-f0cd-4040-b89f-ec059c405609"},"next":{"title":"RSM - Active Directory- Active Directory Replication Anomaly Monitoring","permalink":"/proval-docs/docs/cwa/monitors/495df667-0690-48e0-b929-f7671e9fc92c"}}');var o=n(474848),c=n(28453);const r={id:"de574ff4-5a24-4ccd-83d3-499b1b274893",title:"RSM - Active Directory- AD Account Lockout Detection",title_meta:"RSM - Active Directory- AD Account Lockout Detection",keywords:["monitoring","alert","eventid","domaincontroller","ticketing"],description:"This document outlines the setup for monitoring event ID 4740 to detect account lockouts in Active Directory. It includes configuration details for alert generation, dependencies, implementation instructions, and ticketing format for incidents.",tags:["active-directory","ticketing"],draft:!1,unlisted:!1},s=void 0,d={},a=[{value:"Summary",id:"summary",level:2},{value:"Details",id:"details",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Target",id:"target",level:2},{value:"Implementation",id:"implementation",level:2},{value:"Ticketing",id:"ticketing",level:2}];function l(e){const t={a:"a",br:"br",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,c.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,o.jsx)(t.p,{children:"The monitoring system is set up to gather data on event ID 4740 that occurred within the last 15 minutes and to generate an alert with the relevant information."}),"\n",(0,o.jsx)(t.h2,{id:"details",children:"Details"}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:'Suggested "Limit to"'}),": Primary Domain Controllers of Each Domain ",(0,o.jsx)(t.code,{children:"<Distinct Domain Controller Per Client>"})]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Suggested Alert Style"}),": Continuous"]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Suggested Alert Template"}),": \u25b3 Custom - Ticket Creation Computer - Failures Only"]}),"\n",(0,o.jsx)(t.p,{children:"Insert the details of the monitor in the table below."}),"\n",(0,o.jsxs)(t.table,{children:[(0,o.jsx)(t.thead,{children:(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.th,{children:"Check Action"}),(0,o.jsx)(t.th,{children:"Server Address"}),(0,o.jsx)(t.th,{children:"Check Type"}),(0,o.jsx)(t.th,{children:"Execute Info"}),(0,o.jsx)(t.th,{children:"Comparator"}),(0,o.jsx)(t.th,{children:"Interval"}),(0,o.jsx)(t.th,{children:"Result"})]})}),(0,o.jsx)(t.tbody,{children:(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"System"}),(0,o.jsx)(t.td,{children:"127.0.0.1"}),(0,o.jsx)(t.td,{children:"Run File"}),(0,o.jsx)(t.td,{children:(0,o.jsx)(t.strong,{children:"REDACTED"})}),(0,o.jsx)(t.td,{children:"State Based"}),(0,o.jsx)(t.td,{children:"900"}),(0,o.jsx)(t.td,{children:"<Screenshot Below>"})]})})]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Screenshot",src:n(254697).A+"",width:"1000",height:"120"})}),"\n",(0,o.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.a,{href:"/proval-docs/docs/cwa/scripts/e14bf501-f10d-44d7-a19a-2284fd5c5cc9",children:"CWM - Automate - Script - Ticket Creation - Computer [Failures Only]"})}),"\n",(0,o.jsx)(t.h2,{id:"target",children:"Target"}),"\n",(0,o.jsxs)(t.p,{children:["Domain Controllers",(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.img,{alt:"Image",src:n(163986).A+"",width:"1000",height:"450"}),(0,o.jsx)(t.br,{}),"\n","The monitor set should be limited to the ",(0,o.jsx)(t.code,{children:"<Server Role - AD - Infrastructure Master>"})," search.",(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.img,{alt:"Image",src:n(61851).A+"",width:"633",height:"316"})]}),"\n",(0,o.jsx)(t.h2,{id:"implementation",children:"Implementation"}),"\n",(0,o.jsxs)(t.p,{children:["Please follow the instructions provided in the implementation article to implement the solution:",(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.a,{href:"/proval-docs/docs/cwa/monitors/2549fcf6-30b5-497b-b44d-7329334bb32c",children:"Implement - Remote Monitor - AD Account LockOut Detection"})]}),"\n",(0,o.jsx)(t.h2,{id:"ticketing",children:"Ticketing"}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Subject:"})," ",(0,o.jsx)(t.code,{children:"<AD Account LockOut Detected on %COMPUTERNAME%>"})]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Body:"}),(0,o.jsx)(t.br,{}),"\n","Here are the details of the user(s) who were locked out:",(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.code,{children:"%RESULT%."})]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.strong,{children:"Sample %RESULT%:"})}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"EventID    :    4740\r\nEventDate   :   1/24/2024 7:34:50 AM\r\nUsername    :   TestUser1\r\nEndpoint    :    DEV-Win11DomainJoined\r\nDomain      :    provaltestdomain.local\r\nDC          :    DEV-SERVER-2019$\n"})})]})}function h(e={}){const{wrapper:t}={...(0,c.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},254697:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image_1-c2d0a3fddd4896b52f4eb37edc8efc92.png"},163986:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image_2-ab795f10aff9eab351a2a4bf354e6795.png"},61851:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image_3-7378042566655b9171c44c47c51cdb17.png"},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>s});var i=n(296540);const o={},c=i.createContext(o);function r(e){const t=i.useContext(c);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),i.createElement(c.Provider,{value:t},e.children)}}}]);