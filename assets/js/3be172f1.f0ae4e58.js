"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[96378],{878274:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>i,metadata:()=>n,toc:()=>r});const n=JSON.parse('{"id":"cwa/scripts/4c3c9d4c-cf60-4252-85f3-a4db1510fa49","title":"Agent Deployment - GPO","description":"This document provides a comprehensive guide on the implementation of the Automate Deploy Group Policy Object (GPO) for ConnectWise Automate. It explains how to create both a startup script GPO and a scheduled task GPO to effectively deploy the Automate agent across devices in a network. The document includes details on user parameters, dependencies, implementation steps, and frequently asked questions.","source":"@site/docs/cwa/scripts/Agent Deployment - GPO.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/4c3c9d4c-cf60-4252-85f3-a4db1510fa49","permalink":"/proval-docs/docs/cwa/scripts/4c3c9d4c-cf60-4252-85f3-a4db1510fa49","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Agent Deployment - GPO.md","tags":[{"inline":false,"label":"ConnectWise","permalink":"/proval-docs/docs/tags/connectwise","description":"Documents on ConnectWise platforms for IT service management"},{"inline":false,"label":"Deployment","permalink":"/proval-docs/docs/tags/deployment","description":"Documents on deploying software and services in various environments"},{"inline":false,"label":"GPO","permalink":"/proval-docs/docs/tags/gpo","description":"Documents covering Group Policy Objects management and deployment"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"4c3c9d4c-cf60-4252-85f3-a4db1510fa49","title":"Agent Deployment - GPO","title_meta":"Agent Deployment - GPO","keywords":["automate","gpo","deployment","connectwise","script","policy"],"description":"This document provides a comprehensive guide on the implementation of the Automate Deploy Group Policy Object (GPO) for ConnectWise Automate. It explains how to create both a startup script GPO and a scheduled task GPO to effectively deploy the Automate agent across devices in a network. The document includes details on user parameters, dependencies, implementation steps, and frequently asked questions.","tags":["connectwise","deployment","gpo","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Agent Deploy - Generate Installers with Tokens","permalink":"/proval-docs/docs/cwa/scripts/cf4fb3ae-3228-4621-be94-467b16f97090"},"next":{"title":"Agent ID assignment discrepancy Autofix","permalink":"/proval-docs/docs/cwa/scripts/fc20710b-81b8-4383-a3ad-42ebef9dd930"}}');var o=s(474848),a=s(28453);const i={id:"4c3c9d4c-cf60-4252-85f3-a4db1510fa49",title:"Agent Deployment - GPO",title_meta:"Agent Deployment - GPO",keywords:["automate","gpo","deployment","connectwise","script","policy"],description:"This document provides a comprehensive guide on the implementation of the Automate Deploy Group Policy Object (GPO) for ConnectWise Automate. It explains how to create both a startup script GPO and a scheduled task GPO to effectively deploy the Automate agent across devices in a network. The document includes details on user parameters, dependencies, implementation steps, and frequently asked questions.",tags:["connectwise","deployment","gpo","windows"],draft:!1,unlisted:!1},c=void 0,l={},r=[{value:"Summary",id:"summary",level:2},{value:"Automate-Deploy GPO",id:"automate-deploy-gpo",level:2},{value:"Automate-Deploy Scheduled Task GPO",id:"automate-deploy-scheduled-task-gpo",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Implementation",id:"implementation",level:2},{value:"User Parameters",id:"user-parameters",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Output",id:"output",level:2},{value:"FAQ",id:"faq",level:2}];function d(e){const t={a:"a",br:"br",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,o.jsxs)(t.p,{children:["This document outlines the implementation of the ",(0,o.jsx)(t.a,{href:"https://proval.itglue.com/DOC-5078775-10798933",children:"Install-AutomateAgentGPO.ps1"})," agnostic script. The script can create a ConnectWise Automate Agent Deployment Group Policy Object that will generate a startup script (or a Scheduled Task) policy and apply that policy to the root forest in Group Policy Management."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Name of the Startup Script GPO:"})," ",(0,o.jsx)(t.code,{children:"Automate-Deploy"})]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Name of the Scheduled Task GPO:"})," ",(0,o.jsx)(t.code,{children:"Automate-Deploy Scheduled Task"})]}),"\n",(0,o.jsx)(t.p,{children:"The startup script GPO executes a PowerShell script on startup (after the computer restarts). In contrast, the scheduled task GPO will immediately execute the PowerShell script to install or fix the Automate agent as soon as the policy is applied on the computer."}),"\n",(0,o.jsx)(t.h2,{id:"automate-deploy-gpo",children:"Automate-Deploy GPO"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Automate-Deploy GPO Image 1",src:s(419929).A+"",width:"1000",height:"473"})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Automate-Deploy GPO Image 2",src:s(871746).A+"",width:"1000",height:"185"})}),"\n",(0,o.jsx)(t.h2,{id:"automate-deploy-scheduled-task-gpo",children:"Automate-Deploy Scheduled Task GPO"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Automate-Deploy Scheduled Task GPO Image 1",src:s(92875).A+"",width:"1000",height:"473"})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Automate-Deploy Scheduled Task GPO Image 2",src:s(46964).A+"",width:"1000",height:"492"})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Automate-Deploy Scheduled Task GPO Image 3",src:s(268093).A+"",width:"1000",height:"128"})}),"\n",(0,o.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.strong,{children:"To Create a Startup Script GPO:"})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Create Startup Script GPO",src:s(226854).A+"",width:"1000",height:"818"})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.strong,{children:"To Create a Scheduled Task GPO:"})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Create Scheduled Task GPO",src:s(265871).A+"",width:"1000",height:"825"})}),"\n",(0,o.jsx)(t.h2,{id:"implementation",children:"Implementation"}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"Import the Automate - Agent Deployment - GPO."}),"\n",(0,o.jsx)(t.li,{children:"Schedule the script to run on all primary domain controllers (PDC Emulator Role) once every 11 months. (Using 11 months on a 12-month token lease will ensure that broken agents are never installed or attempted)."}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"user-parameters",children:"User Parameters"}),"\n",(0,o.jsxs)(t.table,{children:[(0,o.jsx)(t.thead,{children:(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.th,{children:"Name"}),(0,o.jsx)(t.th,{children:"Example"}),(0,o.jsx)(t.th,{children:"Required"}),(0,o.jsx)(t.th,{children:"Description"})]})}),(0,o.jsx)(t.tbody,{children:(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"ScheduledTaskGPO"}),(0,o.jsx)(t.td,{children:"1"}),(0,o.jsx)(t.td,{children:"False"}),(0,o.jsx)(t.td,{children:"Set it to 1 to create a Scheduled Task GPO instead of a startup script GPO."})]})})]}),"\n",(0,o.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.a,{href:"https://proval.itglue.com/DOC-5078775-10798933",children:"CWM - Automate - Agnostic - Install-AutomateAgentGPO.ps1"})}),"\n",(0,o.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Script log"}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"faq",children:"FAQ"}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Q."})," The script was working, but now it has stopped working. Why?",(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.strong,{children:"A."})," The most likely cause of this situation is that the token has expired, and the script is not scheduled to run at the recommended 11-month interval."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Q."})," I have followed the steps above, and I am not seeing any change in the number of devices at my client.",(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.strong,{children:"A."})," For a Group Policy Object to take effect on a target machine, that target must receive a group policy update. Additionally, because it's a startup script, the computer must restart. If either of these conditions is not met, then the group policy will not be enforced."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Q."})," Does installing the Scheduled Task GPO remove the existing Startup Script GPO?",(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.strong,{children:"A."})," No, both ",(0,o.jsx)(t.code,{children:"Automate-Deploy"})," and ",(0,o.jsx)(t.code,{children:"Automate-Deploy Scheduled Task"})," are individual GPOs and do not remove or update each other while being created."]})]})}function p(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},419929:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_1-418d5b5a378ae406c123e04999f3ea1f.png"},871746:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_2-c593a75812680187835f03433c6b9835.png"},92875:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_3-6b87770fd37f8f412b41e9ac9c25b098.png"},46964:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_4-7553aa656e891c4db8f215918cc22be8.png"},268093:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_5-ce5305740e84bd28aa36e1097f5145c7.png"},226854:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_6-51bbbd2e924f028889c2f410bbc895da.png"},265871:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_7-5b45232b6c6274da46f65bcbc146b766.png"},28453:(e,t,s)=>{s.d(t,{R:()=>i,x:()=>c});var n=s(296540);const o={},a=n.createContext(o);function i(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);