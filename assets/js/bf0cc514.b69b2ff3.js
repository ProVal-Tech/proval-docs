"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[71051],{604979:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"cwa/monitors/2fee5750-3a75-4256-b1b6-fcf2b81dccd6","title":"Import - Remote Monitor - Windows Cluster Shared Volume Detection","description":"This document provides a step-by-step guide for implementing a Windows Cluster Shared Volume Detection monitor in ConnectWise Automate. It includes instructions for obtaining group IDs, executing SQL queries, and validating monitor settings to ensure proper functionality.","source":"@site/docs/cwa/monitors/Import-Remote-Monitor-Windows-Cluster-Shared-Volume-Detection.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/2fee5750-3a75-4256-b1b6-fcf2b81dccd6","permalink":"/docs/cwa/monitors/2fee5750-3a75-4256-b1b6-fcf2b81dccd6","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Import-Remote-Monitor-Windows-Cluster-Shared-Volume-Detection.md","tags":[{"inline":false,"label":"Setup","permalink":"/docs/tags/setup","description":"Documents on setting up software and hardware configurations"},{"inline":false,"label":"SQL","permalink":"/docs/tags/sql","description":"Documents discussing Structured Query Language and database interactions"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"2fee5750-3a75-4256-b1b6-fcf2b81dccd6","title":"Import - Remote Monitor - Windows Cluster Shared Volume Detection","title_meta":"Import - Remote Monitor - Windows Cluster Shared Volume Detection","keywords":["windows","cluster","shared","volume","detection","monitoring"],"description":"This document provides a step-by-step guide for implementing a Windows Cluster Shared Volume Detection monitor in ConnectWise Automate. It includes instructions for obtaining group IDs, executing SQL queries, and validating monitor settings to ensure proper functionality.","tags":["setup","sql","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Import - Remote Monitor - Update Orchestrator - Reboot Prevention [Change]","permalink":"/docs/cwa/monitors/95f64d6e-cb10-4c2c-9d40-c55941a7d7bc"},"next":{"title":"Import - Unresponsive Huntress Agents","permalink":"/docs/cwa/monitors/6c4f37b4-d460-464b-bc03-fd1d46be2b0a"}}');var r=n(474848),s=n(28453);const i={id:"2fee5750-3a75-4256-b1b6-fcf2b81dccd6",title:"Import - Remote Monitor - Windows Cluster Shared Volume Detection",title_meta:"Import - Remote Monitor - Windows Cluster Shared Volume Detection",keywords:["windows","cluster","shared","volume","detection","monitoring"],description:"This document provides a step-by-step guide for implementing a Windows Cluster Shared Volume Detection monitor in ConnectWise Automate. It includes instructions for obtaining group IDs, executing SQL queries, and validating monitor settings to ensure proper functionality.",tags:["setup","sql","windows"],draft:!1,unlisted:!1},a=void 0,c={},d=[{value:"Implementation",id:"implementation",level:2}];function l(e){const t={code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"implementation",children:"Implementation"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"Obtain the group ID(s) of the group(s) that the remote monitor should be applied to."}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"Copy the following query and execute it as a RAWSQL directly:"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sql",children:"   SET @TicketCategorySet = 0;\r\n   SET @DefaultCreateTicket = (SELECT alertactionid FROM alerttemplate WHERE NAME = 'Default - Do Nothing');\r\n   INSERT INTO groupagents\xa0\r\n   \xa0SELECT '' as `AgentID`,\r\n   `groupid` as `GroupID`,\r\n   '' as `SearchID`,\r\n   'Windows Cluster Shared Volume Detection' as `Name`,\r\n   '6' as `CheckAction`,\r\n   @DefaultCreateTicket as `AlertAction`,\r\n   'Windows Cluster Shared Volume - Free Space Under 10 Percent at %computername%~~~Windows Cluster Shared Volume - Free Space Above 10 Percent at %computername%/%clientname%!!!Windows Cluster Shared Volume - Free Space Under 10 Percent at %computername%~~~Windows Cluster Shared Volume - Free Space Under 10 Percent at %computername%/%clientname%' as `AlertMessage`,\r\n   '0' as `ContactID`,\r\n   '3600' as `interval`,\r\n   '127.0.0.1' as `Where`,\r\n   '7' as `What`,\r\n   'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command \"$ErroractionPreference = \\'SilentlyContinue\\';$diskStatuses = @();Get-ClusterSharedVolume | ForEach-Object {$freeSpacePercent = [math]::Round((($_.SharedVolumeInfo.Partition.FreeSpace) / ($_.SharedVolumeInfo.Partition.Size) * 100), 2);if ($freeSpacePercent -lt 10) {$diskStatuses += \\'Failed\\'} elseif ($freeSpacePercent -ge 10 -and $freeSpacePercent -le 20) {$diskStatuses += \\'Warning\\'} else {$diskStatuses += \\'Success\\'}};if ($diskStatuses -contains \\'Failed\\') {\\'Failed\\'} elseif ($diskStatuses -contains \\'Warning\\') {\\'Warning\\'} else {\\'Success\\'}\"' as `DataOut`,\r\n   '16' as `Comparor`,\r\n   '10|(^(\\\\r\\\\n%7COK%7CSuccess))|5|Warning|5|Failed' as `DataIn`,\r\n   '' as `IDField`,\r\n   '1' as `AlertStyle`,\r\n   '0' as `ScriptID`,\r\n   '' as `datacollector`,\r\n   '19' as `Category`,\r\n   '0' as `TicketCategory`,\r\n   @TicketCategorySet as `ScriptTarget`,\r\n   UUID() as `GUID`,\r\n   'root' as `UpdatedBy`,\r\n   (NOW()) as `UpdateDate`\r\n   FROM mastergroups m\r\n   WHERE m.groupid IN (SELECT groupid FROM mastergroups WHERE NAME = 'Cluster Detected')\r\n   AND m.groupid NOT IN (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'Windows Cluster Shared Volume Detection')\n"})}),"\n",(0,r.jsxs)(t.ol,{start:"3",children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"Now execute your query from a RAWSQL monitor set."}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Once the query is executed, reload the system cache.","\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.img,{alt:"Image",src:n(622132).A+"",width:"309",height:"351"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:["Reopen the group where the monitor is created (It should be the ",(0,r.jsx)(t.code,{children:"Cluster Detected"})," group)."]}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Validate that the monitor is limited to the search 'Windows 10/11 Machines'."}),"\n",(0,r.jsxs)(t.li,{children:["Apply the alert template: ",(0,r.jsx)(t.code,{children:"\u25b3 CUSTOM - Execute Script - Windows Cluster Shared Volume"}),"."]}),"\n"]}),"\n"]}),"\n"]})]})}function u(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},622132:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/image_1-5299c8ddfd764baa3fde4787aa31c5b8.png"},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>a});var o=n(296540);const r={},s=o.createContext(r);function i(e){const t=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),o.createElement(s.Provider,{value:t},e.children)}}}]);