"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[54243],{68634:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>n,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"cwa/scripts/dc9e4596-2cce-49b2-9f64-d6dfd46ac1ec","title":"Shared Folder Audit","description":"This document describes a script that collects detailed information about shared folder access, including share names, paths, types, user permissions, and access rights. The automation of this process saves approximately 10 minutes of manual work.","source":"@site/docs/cwa/scripts/Shared Folder Audit.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/dc9e4596-2cce-49b2-9f64-d6dfd46ac1ec","permalink":"/docs/cwa/scripts/dc9e4596-2cce-49b2-9f64-d6dfd46ac1ec","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Shared Folder Audit.md","tags":[{"inline":false,"label":"Networking","permalink":"/docs/tags/networking","description":"Documents related to network infrastructure and management practices"},{"inline":false,"label":"Security","permalink":"/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"dc9e4596-2cce-49b2-9f64-d6dfd46ac1ec","title":"Shared Folder Audit","title_meta":"Shared Folder Audit","keywords":["shared","folder","audit","permissions","access"],"description":"This document describes a script that collects detailed information about shared folder access, including share names, paths, types, user permissions, and access rights. The automation of this process saves approximately 10 minutes of manual work.","tags":["networking","security","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"ShadowControl Uninstall v2","permalink":"/docs/cwa/scripts/b5ffbe82-a523-4104-8e8f-c60cfa2f8419"},"next":{"title":"Show Hidden Files - EnableDisable","permalink":"/docs/cwa/scripts/be2a3cab-5528-4b53-a636-713198b10fa1"}}');var r=t(474848),a=t(28453);const n={id:"dc9e4596-2cce-49b2-9f64-d6dfd46ac1ec",title:"Shared Folder Audit",title_meta:"Shared Folder Audit",keywords:["shared","folder","audit","permissions","access"],description:"This document describes a script that collects detailed information about shared folder access, including share names, paths, types, user permissions, and access rights. The automation of this process saves approximately 10 minutes of manual work.",tags:["networking","security","windows"],draft:!1,unlisted:!1},c=void 0,o={},d=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Variables",id:"variables",level:2},{value:"Script States",id:"script-states",level:4},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2}];function l(e){const s={a:"a",code:"code",h2:"h2",h4:"h4",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(s.p,{children:"This script collects information about shared folder details such as Share Name, Shared Path, Shared Type, Users having access to the shared folder, Permission Type (Allow or Deny), and Permission Rights (Full, Read, Change, or No Access)."}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Time Saved by Automation:"})," 10 Minutes"]}),"\n",(0,r.jsx)(s.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Sample Run",src:t(358359).A+"",width:"478",height:"345"})}),"\n",(0,r.jsx)(s.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.a,{href:"/docs/cwa/dataviews/1f703da4-d3a2-4a39-9549-58c280665eeb",children:"Shared Folder Audit"})}),"\n",(0,r.jsx)(s.h2,{id:"variables",children:"Variables"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"@PowerShellout@"})," - The results from the PowerShell script"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"@LoopCounter@"})," - Used to loop through the data based on how much data is returned in the script"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"@NameLoop@"})," - The name of the share"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"@ResourceLoop@"})," - The resource information about the share"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"@RemarkLoop@"})," - The remark information about the share"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"@AccountNameLoop@"})," - The AccountName information about the share"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"@AccessControlType@"})," - The Access Control Type information about the share"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"@AccessRight@"})," - The Access Right information about the share"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"@Check@"})," - Used to check the loop counter"]}),"\n"]}),"\n",(0,r.jsx)(s.h4,{id:"script-states",children:"Script States"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Example"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"ShareFolder@loopcounter@"}),(0,r.jsx)(s.td,{children:"Example -- Resource -- Remark -- AccountName -- AccessControlType -- AccessRight"}),(0,r.jsx)(s.td,{children:"This is a concatenated string of the values above and is used to display the data in the associated Dataview"})]})})]}),"\n",(0,r.jsx)(s.h2,{id:"process",children:"Process"}),"\n",(0,r.jsx)(s.p,{children:"The script will run a PowerShell script to gather data from the endpoint. It will then use a specially designed SQL loop to separate the results from the PowerShell run into different script state lines. Once the loop encounters a bad value, the script will stop the loop and finish processing the script states for the machine."}),"\n",(0,r.jsx)(s.h2,{id:"output",children:"Output"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Script States to be displayed in a Dataview"}),"\n",(0,r.jsx)(s.li,{children:"Script Log Messages"}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},358359:(e,s,t)=>{t.d(s,{A:()=>i});const i=t.p+"assets/images/image_1-d3287bc70fca44d5e5374bc97beae013.png"},28453:(e,s,t)=>{t.d(s,{R:()=>n,x:()=>c});var i=t(296540);const r={},a=i.createContext(r);function n(e){const s=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:n(e.components),i.createElement(a.Provider,{value:s},e.children)}}}]);