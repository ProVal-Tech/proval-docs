"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[14218],{436890:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"cwa/monitors/75f8c13f-04d5-45fd-b650-3b010353a8c0","title":"New Account Detection","description":"This document details a remote monitor designed to detect the creation of new user accounts on local machines by querying the event log. It includes suggested configurations for alert styles and templates, as well as example check actions and values for implementation.","source":"@site/docs/cwa/monitors/New Account Detection.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/75f8c13f-04d5-45fd-b650-3b010353a8c0","permalink":"/docs/cwa/monitors/75f8c13f-04d5-45fd-b650-3b010353a8c0","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/New Account Detection.md","tags":[{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"75f8c13f-04d5-45fd-b650-3b010353a8c0","title":"New Account Detection","title_meta":"New Account Detection","keywords":["monitor","user","account","event","log","windows","server","workstation"],"description":"This document details a remote monitor designed to detect the creation of new user accounts on local machines by querying the event log. It includes suggested configurations for alert styles and templates, as well as example check actions and values for implementation.","tags":["windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"NTLMv1.1 Detection","permalink":"/docs/cwa/monitors/8e107867-6d8d-4b6c-aa10-20f8da59fdca"},"next":{"title":"New Domain Admin","permalink":"/docs/cwa/monitors/226dd436-7d87-428c-a9ca-5309f5ad6c2f"}}');var i=n(474848),o=n(28453);const r={id:"75f8c13f-04d5-45fd-b650-3b010353a8c0",title:"New Account Detection",title_meta:"New Account Detection",keywords:["monitor","user","account","event","log","windows","server","workstation"],description:"This document details a remote monitor designed to detect the creation of new user accounts on local machines by querying the event log. It includes suggested configurations for alert styles and templates, as well as example check actions and values for implementation.",tags:["windows"],draft:!1,unlisted:!1},c=void 0,a={},d=[{value:"Summary",id:"summary",level:2},{value:"Details",id:"details",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Target",id:"target",level:2}];function l(e){const t={br:"br",h2:"h2",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(t.p,{children:"This remote monitor determines whether a new user account has been created on the local machine by querying the event log."}),"\n",(0,i.jsx)(t.h2,{id:"details",children:"Details"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:'Suggested "Limit to"'}),": Windows Server, Workstations (Optional).",(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.strong,{children:"Suggested Alert Style"}),": Once",(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.strong,{children:"Suggested Alert Template"}),": Default - Create Ticket"]}),"\n",(0,i.jsx)(t.p,{children:"Insert the details of the monitor in the table below."}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Check Action"}),(0,i.jsx)(t.th,{children:"Server Address"}),(0,i.jsx)(t.th,{children:"Check Type"}),(0,i.jsx)(t.th,{children:"Check Value"}),(0,i.jsx)(t.th,{children:"Comparator"}),(0,i.jsx)(t.th,{children:"Interval"}),(0,i.jsx)(t.th,{children:"Result"})]})}),(0,i.jsx)(t.tbody,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"System"}),(0,i.jsx)(t.td,{children:"127.0.0.1"}),(0,i.jsx)(t.td,{children:"Run File"}),(0,i.jsx)(t.td,{children:"See Below"}),(0,i.jsx)(t.td,{children:"Missing"}),(0,i.jsx)(t.td,{children:"900"}),(0,i.jsx)(t.td,{})]})})]}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsx)(t.tr,{children:(0,i.jsx)(t.th,{children:"Check Value"})})}),(0,i.jsx)(t.tbody,{children:(0,i.jsx)(t.tr,{children:(0,i.jsx)(t.td,{children:"C:/Windows/System32/WindowsPowerShell/v1.0/powershell.exe \"$events = Get-EventLog security -ErrorAction silentlycontinue -After (Get-Date).AddMinutes(-15) -InstanceId 4720; foreach($event in $events) { $messageArray = $($event.Message -split /`n/); $newAccountIndex = $null; for($i = 0; $i -lt $messageArray.Length; $i++) { if($messageArray[$i] -match /^New Account:/) { $newAccountIndex = $i }} $newAccountLine = $null; for($i = $newAccountIndex; $i -lt $messageArray.Length; $i++) { if($messageArray[$i] -match /Account Name:/) { $newAccountLine = $($messageArray[$i].Trim() -replace /Account Name: */, ''); $result = $newAccountLine.Trim(); break }} $result }\""})})})]}),"\n",(0,i.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,i.jsx)(t.h2,{id:"target",children:"Target"}),"\n",(0,i.jsx)(t.p,{children:"The suggested target for the monitor is Service Plan(s) for Servers and Workstations."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Examples:"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Windows Servers"}),": Should be run on all Windows-based servers."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Windows Workstations"}),": Should be run on all Windows workstations (Optional)."]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>c});var s=n(296540);const i={},o=s.createContext(i);function r(e){const t=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:t},e.children)}}}]);