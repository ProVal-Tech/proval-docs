"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[60954],{170845:(e,s,d)=>{d.r(s),d.d(s,{assets:()=>c,contentTitle:()=>i,default:()=>a,frontMatter:()=>t,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"powershell/4d0324cd-a8bc-4278-b906-6a0e54de5314","title":"Measure-VolumeSpace","description":"Guide to measuring volume space and identifying low space volumes using PowerShell.","source":"@site/docs/powershell/Measure-VolumeSpace.md","sourceDirName":"powershell","slug":"/powershell/4d0324cd-a8bc-4278-b906-6a0e54de5314","permalink":"/docs/powershell/4d0324cd-a8bc-4278-b906-6a0e54de5314","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/powershell/Measure-VolumeSpace.md","tags":[{"inline":false,"label":"Performance","permalink":"/docs/tags/performance","description":"Documents related to enhancing system and application performance"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"4d0324cd-a8bc-4278-b906-6a0e54de5314","title":"Measure-VolumeSpace","title_meta":"Measure-VolumeSpace","keywords":["volume","space","threshold","disk","storage"],"description":"Guide to measuring volume space and identifying low space volumes using PowerShell.","tags":["performance","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Join-Domain","permalink":"/docs/powershell/fb3e4906-6520-4b5b-bc35-db7b79b45f7d"},"next":{"title":"New-DJoinFile","permalink":"/docs/powershell/e0acd656-10bc-48d6-9182-41d1ff78007a"}}');var l=d(474848),n=d(28453);const t={id:"4d0324cd-a8bc-4278-b906-6a0e54de5314",title:"Measure-VolumeSpace",title_meta:"Measure-VolumeSpace",keywords:["volume","space","threshold","disk","storage"],description:"Guide to measuring volume space and identifying low space volumes using PowerShell.",tags:["performance","windows"],draft:!1,unlisted:!1},i=void 0,c={},o=[{value:"Description",id:"description",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Usage",id:"usage",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Output",id:"output",level:2}];function h(e){const s={code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.h2,{id:"description",children:"Description"}),"\n",(0,l.jsx)(s.p,{children:"This document provides a guide to measuring volume space and determining if volumes are low on space based on specified parameters."}),"\n",(0,l.jsx)(s.h2,{id:"requirements",children:"Requirements"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"PowerShell v5"}),"\n",(0,l.jsx)(s.li,{children:"Must be run as an Administrator"}),"\n"]}),"\n",(0,l.jsx)(s.h2,{id:"usage",children:"Usage"}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsx)(s.li,{children:"All parameters are validated before processing."}),"\n",(0,l.jsx)(s.li,{children:"Volumes to process are gathered based on the passed parameters."}),"\n",(0,l.jsxs)(s.li,{children:["Each gathered volume is then looped through:","\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"Determine the size type (Small, Medium, Large, X-Large) of the volume."}),"\n",(0,l.jsx)(s.li,{children:"Apply the threshold rule set based on the size type."}),"\n",(0,l.jsx)(s.li,{children:"Add the volume to the list of low space volumes if it is found to be low."}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.li,{children:"Return the list of low space volumes."}),"\n"]}),"\n",(0,l.jsx)(s.p,{children:"Searches for all fixed volumes with drive letters and returns those that are low on space based on the default parameters."}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:".\\Measure-VolumeSpace.ps1\n"})}),"\n",(0,l.jsx)(s.p,{children:"Searches for all fixed volumes with drive letters and a size greater than or equal to 100MB, returning volumes that are low on space. The maximum size for a 'small' drive is 20GB, meaning that medium drives will be between 20GB and the default 1024GB. The medium drive type uses a percentage-based threshold of 20%."}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:".\\Measure-VolumeSpace.ps1 -MinimumSize 100MB -SmallVolumeMaxSize 20GB -MediumVolumeThresholdType 'Percent' -MediumVolumeThreshold 20\n"})}),"\n",(0,l.jsx)(s.p,{children:"Searches for all fixed and removable volumes, with or without drive letters, returning those that are low on space based on the default parameters."}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:".\\Measure-VolumeSpace.ps1 -d 'Fixed', 'Removable' -u\n"})}),"\n",(0,l.jsx)(s.p,{children:"Searches for all fixed volumes with drive letters except 'C', returning those that are low on space based on the default parameters."}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:".\\Measure-VolumeSpace.ps1 -e 'C'\n"})}),"\n",(0,l.jsx)(s.p,{children:"Searches for all fixed volumes with drive letters, suppressing all console output except for the return object, and returning volumes that are low on space based on the default parameters."}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:".\\Measure-VolumeSpace.ps1 -Quiet\n"})}),"\n",(0,l.jsx)(s.h2,{id:"parameters",children:"Parameters"}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Alias"}),(0,l.jsx)(s.th,{children:"Required"}),(0,l.jsx)(s.th,{children:"Default"}),(0,l.jsx)(s.th,{children:"Type"}),(0,l.jsx)(s.th,{children:"Description"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"MinimumSize"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"sm"})}),(0,l.jsx)(s.td,{children:"False"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"1MB"})}),(0,l.jsx)(s.td,{children:"Int64"}),(0,l.jsx)(s.td,{children:"The minimum size of the volume to search for. Any volume under this limit will be excluded."})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"SmallVolumeMaxSize"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"ss"})}),(0,l.jsx)(s.td,{children:"False"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"256GB"})}),(0,l.jsx)(s.td,{children:"Int64"}),(0,l.jsx)(s.td,{children:"The maximum size of what should be considered a 'small' drive."})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"SmallVolumeThreshold"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"st"})}),(0,l.jsx)(s.td,{children:"False"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"11"})}),(0,l.jsx)(s.td,{children:"Int64"}),(0,l.jsxs)(s.td,{children:["The threshold to consider a 'small' volume low on space. If ",(0,l.jsx)(s.code,{children:"$SmallVolumeThresholdType"})," is set to ",(0,l.jsx)(s.code,{children:"'Percent'"}),", this should be less than or equal to ",(0,l.jsx)(s.code,{children:"100"}),"."]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"SmallVolumeThresholdType"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"stt"})}),(0,l.jsx)(s.td,{children:"False"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"'Percent'"})}),(0,l.jsx)(s.td,{children:"String"}),(0,l.jsxs)(s.td,{children:["The type of threshold calculation to perform for 'small' drives. Valid options are ",(0,l.jsx)(s.code,{children:"'Percent'"})," and ",(0,l.jsx)(s.code,{children:"'Number'"}),"."]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"MediumVolumeMaxSize"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"ms"})}),(0,l.jsx)(s.td,{children:"False"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"1024GB"})}),(0,l.jsx)(s.td,{children:"Int64"}),(0,l.jsx)(s.td,{children:"The maximum size of what should be considered a 'medium' drive."})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"MediumVolumeThreshold"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"mt"})}),(0,l.jsx)(s.td,{children:"False"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"11"})}),(0,l.jsx)(s.td,{children:"Int64"}),(0,l.jsxs)(s.td,{children:["The threshold to consider a 'medium' volume low on space. If ",(0,l.jsx)(s.code,{children:"$MediumVolumeThresholdType"})," is set to ",(0,l.jsx)(s.code,{children:"'Percent'"}),", this should be less than or equal to ",(0,l.jsx)(s.code,{children:"100"}),"."]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"MediumVolumeThresholdType"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"mtt"})}),(0,l.jsx)(s.td,{children:"False"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"'Percent'"})}),(0,l.jsx)(s.td,{children:"String"}),(0,l.jsxs)(s.td,{children:["The type of threshold calculation to perform for 'medium' drives. Valid options are ",(0,l.jsx)(s.code,{children:"'Percent'"})," and ",(0,l.jsx)(s.code,{children:"'Number'"}),"."]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"LargeVolumeMaxSize"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"ls"})}),(0,l.jsx)(s.td,{children:"False"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"2048GB"})}),(0,l.jsx)(s.td,{children:"Int64"}),(0,l.jsx)(s.td,{children:"The maximum size of what should be considered a 'large' drive."})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"LargeVolumeThreshold"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"lt"})}),(0,l.jsx)(s.td,{children:"False"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"5"})}),(0,l.jsx)(s.td,{children:"Int64"}),(0,l.jsxs)(s.td,{children:["The threshold to consider a 'large' volume low on space. If ",(0,l.jsx)(s.code,{children:"$LargeVolumeThresholdType"})," is set to ",(0,l.jsx)(s.code,{children:"'Percent'"}),", this should be less than or equal to ",(0,l.jsx)(s.code,{children:"100"}),"."]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"LargeVolumeThresholdType"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"ltt"})}),(0,l.jsx)(s.td,{children:"False"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"'Percent'"})}),(0,l.jsx)(s.td,{children:"Int64"}),(0,l.jsxs)(s.td,{children:["The type of threshold calculation to perform for 'large' drives. Valid options are ",(0,l.jsx)(s.code,{children:"'Percent'"})," and ",(0,l.jsx)(s.code,{children:"'Number'"}),"."]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"XLargeVolumeThreshold"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"xt"})}),(0,l.jsx)(s.td,{children:"False"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"5"})}),(0,l.jsx)(s.td,{children:"Int64"}),(0,l.jsxs)(s.td,{children:["The threshold to consider an 'x-large' volume low on space. If ",(0,l.jsx)(s.code,{children:"$XLargeVolumeThresholdType"})," is set to ",(0,l.jsx)(s.code,{children:"'Percent'"}),", this should be less than or equal to ",(0,l.jsx)(s.code,{children:"100"}),"."]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"XLargeVolumeThresholdType"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"xtt"})}),(0,l.jsx)(s.td,{children:"False"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"'Percent'"})}),(0,l.jsx)(s.td,{children:"Int64"}),(0,l.jsxs)(s.td,{children:["The type of threshold calculation to perform for 'x-large' drives. Valid options are ",(0,l.jsx)(s.code,{children:"'Percent'"})," and ",(0,l.jsx)(s.code,{children:"'Number'"}),"."]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"DriveTypes"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"d"})}),(0,l.jsx)(s.td,{children:"False"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"'Fixed'"})}),(0,l.jsx)(s.td,{children:"String[]"}),(0,l.jsxs)(s.td,{children:["A list of the types of drives to review space for. Valid options are:",(0,l.jsx)("br",{}),"- 'Unknown'",(0,l.jsx)("br",{}),"- 'Invalid Root Path'",(0,l.jsx)("br",{}),"- 'Removable'",(0,l.jsx)("br",{}),"- 'Fixed'",(0,l.jsx)("br",{}),"- 'Remote'",(0,l.jsx)("br",{}),"- 'CD-ROM'",(0,l.jsx)("br",{}),"- 'RAM Disk'"]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"IncludeUnassignedVolumes"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"u"})}),(0,l.jsx)(s.td,{children:"False"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"False"})}),(0,l.jsx)(s.td,{children:"Switch"}),(0,l.jsx)(s.td,{children:"Use this switch to include volumes that have not been assigned a drive letter."})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"ExcludeDriveLetters"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"e"})}),(0,l.jsx)(s.td,{children:"False"}),(0,l.jsx)(s.td,{}),(0,l.jsx)(s.td,{children:"String[]"}),(0,l.jsx)(s.td,{children:"A list of drive letters to exclude from the review."})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"Quiet"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"q"})}),(0,l.jsx)(s.td,{children:"False"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"False"})}),(0,l.jsx)(s.td,{children:"Switch"}),(0,l.jsx)(s.td,{children:"Suppresses all console output other than the return object by overwriting the Write-Host function."})]})]})]}),"\n",(0,l.jsx)(s.h2,{id:"output",children:"Output"}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.code,{children:"Microsoft.Management.Infrastructure.CimInstance#ROOT/Microsoft/Windows/Storage/MSFT_Volume"})}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.code,{children:".\\Measure-VolumeSpace-log.txt"})}),"\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.code,{children:".\\Measure-VolumeSpace-error.txt"})}),"\n"]})]})}function a(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}},28453:(e,s,d)=>{d.d(s,{R:()=>t,x:()=>i});var r=d(296540);const l={},n=r.createContext(l);function t(e){const s=r.useContext(n);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),r.createElement(n.Provider,{value:s},e.children)}}}]);