"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[48509],{549371:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"cwa/scripts/3aab837d-cb64-4669-aa35-040cce21c575","title":"Toast Notification","description":"This script downloads and executes the New-ToastNotification.ps1, providing a customizable interface to display toast notifications. It supports scenarios such as system reboots, password expiration warnings, and general user notifications. Users can add custom titles, images, buttons, and deadlines to their notifications. A scheduled task is created for repetitive notifications.","source":"@site/docs/cwa/scripts/toast-notification.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/3aab837d-cb64-4669-aa35-040cce21c575","permalink":"/docs/cwa/scripts/3aab837d-cb64-4669-aa35-040cce21c575","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/toast-notification.md","tags":[{"inline":true,"label":"notification","permalink":"/docs/tags/notification"},{"inline":false,"label":"Reboot","permalink":"/docs/tags/reboot","description":"Documents related to system reboot processes and their management"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"3aab837d-cb64-4669-aa35-040cce21c575","title":"Toast Notification","title_meta":"Toast Notification","keywords":["toast","notification","reminder","reboot"],"description":"This script downloads and executes the New-ToastNotification.ps1, providing a customizable interface to display toast notifications. It supports scenarios such as system reboots, password expiration warnings, and general user notifications. Users can add custom titles, images, buttons, and deadlines to their notifications. A scheduled task is created for repetitive notifications.","tags":["notification","reboot","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Toast Notification - Template","permalink":"/docs/cwa/scripts/e6115fa5-78ac-4b04-8b3f-d0dd0c2e559f"},"next":{"title":"Unapproved Patches Count Audit","permalink":"/docs/cwa/scripts/595e85de-299d-4242-a569-f5367be6b1c9"}}');var n=i(474848),o=i(28453);const a={id:"3aab837d-cb64-4669-aa35-040cce21c575",title:"Toast Notification",title_meta:"Toast Notification",keywords:["toast","notification","reminder","reboot"],description:"This script downloads and executes the New-ToastNotification.ps1, providing a customizable interface to display toast notifications. It supports scenarios such as system reboots, password expiration warnings, and general user notifications. Users can add custom titles, images, buttons, and deadlines to their notifications. A scheduled task is created for repetitive notifications.",tags:["notification","reboot","windows"],draft:!1,unlisted:!1},r=void 0,d={},c=[{value:"Summary",id:"summary",level:2},{value:"File Hash",id:"file-hash",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Variables",id:"variables",level:2},{value:"Output",id:"output",level:2}];function l(e){const t={a:"a",code:"code",h2:"h2",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,n.jsxs)(t.p,{children:["It is the CW Automate implementation of the agnostic script ",(0,n.jsx)(t.a,{href:"/docs/powershell/426118d9-ff83-444e-9744-30a0e26cb490",children:"Invoke-ToastNotification.ps1"}),"."]}),"\n",(0,n.jsx)(t.p,{children:"This script downloads and executes the New-ToastNotification.ps1, providing a customizable interface to display toast notifications. It supports scenarios such as system reboots, password expiration warnings, and general user notifications. Users can add custom titles, images, buttons, and deadlines to their notifications. A scheduled task is created for repetitive notifications."}),"\n",(0,n.jsx)(t.h2,{id:"file-hash",children:"File Hash"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"File Path:"})," ",(0,n.jsx)(t.code,{children:"C:\\ProgramData\\_automation\\Script\\New-ToastNotification\\New-ToastNotification\\New-ToastNotification.ps1"})]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"File Hash (Sha256):"})," ",(0,n.jsx)(t.code,{children:"C0F7E5A29D59E1946B65648CF59661B49779252D5F9DA2DFA020D44762B74CA4"})]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"File Hash (MD5):"})," ",(0,n.jsx)(t.code,{children:"6ABAC1DE688E93CD27001887A3F92B27"})]}),"\n",(0,n.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,n.jsxs)(t.p,{children:["This script is a function script and should not be manually executed.\r\nUtilize the ",(0,n.jsx)(t.a,{href:"/docs/cwa/scripts/e6115fa5-78ac-4b04-8b3f-d0dd0c2e559f",children:"Toast Notification - Template"})," to get a copy of all potential variables and paste the else section into any script that should use Prompter."]}),"\n",(0,n.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.a,{href:"/docs/cwa/scripts/e6115fa5-78ac-4b04-8b3f-d0dd0c2e559f",children:"Toast Notification - Template"})}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.a,{href:"/docs/powershell/426118d9-ff83-444e-9744-30a0e26cb490",children:"Invoke-ToastNotification"})}),"\n",(0,n.jsx)(t.h2,{id:"variables",children:"Variables"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Name"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"NotificationType"}),(0,n.jsx)(t.td,{children:"The type of notification to send. The accepted values for @NotificationType@ are generic, PendingRebootUptime, PendingRebootCheck, and ADPasswordExpiration. It is a mandatory variable."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{}),(0,n.jsxs)(t.td,{children:["- ",(0,n.jsx)(t.strong,{children:"Generic:"})," Enables a static, generic toast notification."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{}),(0,n.jsxs)(t.td,{children:["- ",(0,n.jsx)(t.strong,{children:"PendingRebootUptime:"})," Displays a toast notification reminding users to restart their system after exceeding the maximum uptime."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{}),(0,n.jsxs)(t.td,{children:["- ",(0,n.jsx)(t.strong,{children:"PendingRebootCheck:"})," Displays a toast notification when a pending reboot is detected through the system registry or WMI."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{}),(0,n.jsxs)(t.td,{children:["- ",(0,n.jsx)(t.strong,{children:"ADPasswordExpiration:"})," Sends a toast notification to users when their Active Directory password is nearing expiration."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"RebootButton"}),(0,n.jsxs)(t.td,{children:["Set @RebootButton@ to 1 to enable the ",(0,n.jsx)(t.code,{children:"Reboot"})," button in the notification. Setting it to ",(0,n.jsx)(t.code,{children:"0"})," or deleting the variable will disable it. @RebootButton@ is available for ",(0,n.jsx)(t.code,{children:"Generic"}),", ",(0,n.jsx)(t.code,{children:"PendingRebootUptime"}),", and ",(0,n.jsx)(t.code,{children:"PendingRebootCheck"})," notification types."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"LearnMoreButton"}),(0,n.jsxs)(t.td,{children:["Set @LearnMore@ to 1 to enable the ",(0,n.jsx)(t.code,{children:"Learn More"})," button in the notification. Setting it to ",(0,n.jsx)(t.code,{children:"0"})," or deleting the variable will disable it."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"LearnMoreUrl"}),(0,n.jsxs)(t.td,{children:["Set the URL to navigate by clicking the ",(0,n.jsx)(t.code,{children:"Learn More"})," button in the notification. ",(0,n.jsx)(t.code,{children:"@LearnMoreButton@"})," should be enabled or set to ",(0,n.jsx)(t.code,{children:"1"})," to allow the ",(0,n.jsx)(t.code,{children:"@LearnMoreUrl@"})," variable."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"SnoozeButton"}),(0,n.jsxs)(t.td,{children:["Set @SnoozeButton@ to 1 to enable the ",(0,n.jsx)(t.code,{children:"Snooze"})," button in the notification. Setting it to ",(0,n.jsx)(t.code,{children:"0"})," or deleting the variable will disable it. The ",(0,n.jsx)(t.code,{children:"@LearnMoreButton@"})," and the ",(0,n.jsx)(t.code,{children:"@SnoozeButton@"})," cannot be enabled simultaneously."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"DismissButtonText"}),(0,n.jsxs)(t.td,{children:["Set the string in the @DismissButtonText@ variable to customize the dismiss button's text. Delete the variable or leave it blank to return to the default value, ",(0,n.jsx)(t.code,{children:"Dismiss"}),"."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"TitleText"}),(0,n.jsx)(t.td,{children:"Sets the title of the notification in the @TitleText@ variable. It is mandatory to set this variable."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"AttributionText"}),(0,n.jsx)(t.td,{children:"Sets the attribution text in the @AttributionText@ variable. It can be a company name or website, for authenticity."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"BodyText1"}),(0,n.jsx)(t.td,{children:"@BodyText1@ stores the main text content of the notification body. It is a mandatory variable."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"BodyText2"}),(0,n.jsx)(t.td,{children:"@BodyText2@ stores the secondary text content of the notification body."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"LogoImage"}),(0,n.jsx)(t.td,{children:"@LogoImage@ stores the URL or local path for the logo image in the notification. Clear or remove the variable to generate the notification with the default logo."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"HeroImage"}),(0,n.jsx)(t.td,{children:"@HeroImage@ stores the URL or local path for the primary image in the notification. Clear or remove the variable to generate the notification with the default image."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Deadline"}),(0,n.jsxs)(t.td,{children:["@Deadline@ stores the deadline for the notification in the format yyyy-MM-dd HH:mm",":ss",". To avoid prompting any deadline, the variable can either be deleted or left blank."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"NotificationAppName"}),(0,n.jsxs)(t.td,{children:["@NotificationAppName@ specifies the name of the application that will display the notification. Delete the variable or leave it blank to fall back to the default value. The default value is ",(0,n.jsx)(t.code,{children:"Windows PowerShell"})]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"MaxUptimeDays"}),(0,n.jsxs)(t.td,{children:["@MaxUptimeDays@ stores the maximum uptime (in days) for the PendingRebootUptime parameter. The default is 30 days. @MaxUptimeDays@ is available for the ",(0,n.jsx)(t.code,{children:"PendingRebootUptime"})," notification type. Delete the variable or leave it blank to fall back to the default value."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"ADPasswordExpirationDays"}),(0,n.jsxs)(t.td,{children:["@ADPasswordExpirationDays@ stores the number of days before password expiration when reminders should start. The default is 7 days. The default is 30 days. @ADPasswordExpirationDays@ is available for the ",(0,n.jsx)(t.code,{children:"ADPasswordExpiration"})," notification type. Delete the variable or leave it blank to fall back to the default value."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Repeat"}),(0,n.jsxs)(t.td,{children:["@Repeat@ specifies how frequently the notification should repeat. Options: Once, Hourly, XXMinutes, XXHours, Daily, XXDays. Delete the variable or leave it blank to fall back to the default value. The default is ",(0,n.jsx)(t.code,{children:"Once"}),"."]})]})]})]}),"\n",(0,n.jsx)(t.p,{children:"**These variables should be set in the script running/calling this script."}),"\n",(0,n.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Script logs"}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},28453:(e,t,i)=>{i.d(t,{R:()=>a,x:()=>r});var s=i(296540);const n={},o=s.createContext(n);function a(e){const t=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),s.createElement(o.Provider,{value:t},e.children)}}}]);