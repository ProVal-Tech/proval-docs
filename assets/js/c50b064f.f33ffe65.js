"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[69497],{45184:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>a});const n=JSON.parse('{"id":"vsa/procedures/847585fe-5c51-4479-9562-9524ab687330","title":"Enable Authenticode Verification","description":"This document provides a detailed guide on enabling Authenticode Verification on Windows machines. It includes an example agent procedure log that demonstrates the successful execution of the script and the necessary reboot to apply changes.","source":"@site/docs/vsa/procedures/Enable Authenticode Verification.md","sourceDirName":"vsa/procedures","slug":"/vsa/procedures/847585fe-5c51-4479-9562-9524ab687330","permalink":"/proval-docs/docs/vsa/procedures/847585fe-5c51-4479-9562-9524ab687330","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/vsa/procedures/Enable Authenticode Verification.md","tags":[{"inline":false,"label":"Recovery","permalink":"/proval-docs/docs/tags/recovery","description":"Documents on data recovery and system restoration strategies"},{"inline":false,"label":"Security","permalink":"/proval-docs/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Setup","permalink":"/proval-docs/docs/tags/setup","description":"Documents on setting up software and hardware configurations"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"847585fe-5c51-4479-9562-9524ab687330","title":"Enable Authenticode Verification","title_meta":"Enable Authenticode Verification","keywords":["authenticode","verification","windows","script","reboot"],"description":"This document provides a detailed guide on enabling Authenticode Verification on Windows machines. It includes an example agent procedure log that demonstrates the successful execution of the script and the necessary reboot to apply changes.","tags":["recovery","security","setup","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Egnyte - Install","permalink":"/proval-docs/docs/vsa/procedures/04d18467-ad93-4ed2-8da9-52796031d41c"},"next":{"title":"Enable Bitlocker","permalink":"/proval-docs/docs/vsa/procedures/afd016fa-315e-4822-8278-0f33863e3fc0"}}');var s=r(474848),d=r(28453);const o={id:"847585fe-5c51-4479-9562-9524ab687330",title:"Enable Authenticode Verification",title_meta:"Enable Authenticode Verification",keywords:["authenticode","verification","windows","script","reboot"],description:"This document provides a detailed guide on enabling Authenticode Verification on Windows machines. It includes an example agent procedure log that demonstrates the successful execution of the script and the necessary reboot to apply changes.",tags:["recovery","security","setup","windows"],draft:!1,unlisted:!1},i=void 0,c={},a=[{value:"Summary",id:"summary",level:2},{value:"Example Agent Procedure Log",id:"example-agent-procedure-log",level:2},{value:"Output",id:"output",level:2}];function l(e){const t={h2:"h2",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,d.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsx)(t.p,{children:"This script is used to enable the Authenticode Verification on Windows machines. A reboot is required for the changes to take effect."}),"\n",(0,s.jsx)(t.h2,{id:"example-agent-procedure-log",children:"Example Agent Procedure Log"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Time"}),(0,s.jsx)(t.th,{children:"Action"}),(0,s.jsx)(t.th,{children:"Result"}),(0,s.jsx)(t.th,{children:"User"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:25 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Enable Authenticode Verification"}),(0,s.jsx)(t.td,{children:"Success ELSE"}),(0,s.jsx)(t.td,{children:"kunal.kumar"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:25 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Execute Powershell Command"}),(0,s.jsx)(t.td,{children:"Success THEN"}),(0,s.jsx)(t.td,{children:"kunal.kumar"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:24 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Execute Powershell Command-0012"}),(0,s.jsxs)(t.td,{children:["Results returned to global variable #global",":psresult","# and saved in Documents tab of server."]}),(0,s.jsx)(t.td,{children:"kunal.kumar"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:24 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Execute Powershell Command-0012"}),(0,s.jsx)(t.td,{children:"Informational: GetFile command overwrote the server file C:/Kaseya/UserProfiles/160248129727106/GetFiles/../docs/psoutput.txt with the new contents from c:/kworking/psoutput.txt in THEN step 2."}),(0,s.jsx)(t.td,{children:"kunal.kumar"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:24 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Execute Powershell Command-0011"}),(0,s.jsx)(t.td,{children:"Powershell command completed!"}),(0,s.jsx)(t.td,{children:"kunal.kumar"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:22 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Execute Powershell Command-0011"}),(0,s.jsx)(t.td,{children:'Executing powershell "" -Command "New-Item -Path "HKLM:/Software/Wow6432Node/Microsoft/Cryptography/Wintrust/Config" -Force'}),(0,s.jsx)(t.td,{children:'Out-Null; Set-ItemProperty -Path "HKLM:/Software/Wow6432Node/Microsoft/Cryptography/Wintrust/Config" -Name "EnableCertPaddingCheck" -Value 1 -Type DWord -Force" >"c:/kworking/psoutput.txt"'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:22 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Execute Powershell Command-0010"}),(0,s.jsx)(t.td,{children:"Sending output to global variable."}),(0,s.jsx)(t.td,{children:"kunal.kumar"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:22 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Execute Powershell Command-0008"}),(0,s.jsx)(t.td,{children:'New command variable is: -Command "New-Item -Path "HKLM:/Software/Wow6432Node/Microsoft/Cryptography/Wintrust/Config" -Force'}),(0,s.jsx)(t.td,{children:'Out-Null; Set-ItemProperty -Path "HKLM:/Software/Wow6432Node/Microsoft/Cryptography/Wintrust/Config" -Name "EnableCertPaddingCheck" -Value 1 -Type DWord -Force"'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:22 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Execute Powershell Command-0008"}),(0,s.jsx)(t.td,{children:'Custom commands detected as New-Item -Path "HKLM:/Software/Wow6432Node/Microsoft/Cryptography/Wintrust/Config" -Force'}),(0,s.jsx)(t.td,{children:'Out-Null; Set-ItemProperty -Path "HKLM:/Software/Wow6432Node/Microsoft/Cryptography/Wintrust/Config" -Name "EnableCertPaddingCheck" -Value 1 -Type DWord -Force'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:16 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Execute Powershell Command-0002"}),(0,s.jsx)(t.td,{children:"Powershell is present."}),(0,s.jsx)(t.td,{children:"kunal.kumar"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:15 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Execute Powershell Command"}),(0,s.jsx)(t.td,{children:"Success THEN"}),(0,s.jsx)(t.td,{children:"kunal.kumar"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:15 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Execute Powershell Command-0012"}),(0,s.jsxs)(t.td,{children:["Results returned to global variable #global",":psresult","# and saved in Documents tab of server."]}),(0,s.jsx)(t.td,{children:"kunal.kumar"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:15 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Execute Powershell Command-0012"}),(0,s.jsx)(t.td,{children:"Informational: GetFile command overwrote the server file C:/Kaseya/UserProfiles/160248129727106/GetFiles/../docs/psoutput.txt with the new contents from c:/kworking/psoutput.txt in THEN step 2."}),(0,s.jsx)(t.td,{children:"kunal.kumar"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:14 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Execute Powershell Command-0011"}),(0,s.jsx)(t.td,{children:"Powershell command completed!"}),(0,s.jsx)(t.td,{children:"kunal.kumar"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:12 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Execute Powershell Command-0011"}),(0,s.jsx)(t.td,{children:'Executing powershell "" -Command "New-Item -Path "HKLM:/Software/Microsoft/Cryptography/Wintrust/Config" -Force'}),(0,s.jsx)(t.td,{children:'Out-Null; Set-ItemProperty -Path "HKLM:/Software/Microsoft/Cryptography/Wintrust/Config" -Name "EnableCertPaddingCheck" -Value 1 -Type DWord -Force" >"c:/kworking/psoutput.txt"'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:12 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Execute Powershell Command-0010"}),(0,s.jsx)(t.td,{children:"Sending output to global variable."}),(0,s.jsx)(t.td,{children:"kunal.kumar"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:12 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Execute Powershell Command-0008"}),(0,s.jsx)(t.td,{children:'New command variable is: -Command "New-Item -Path "HKLM:/Software/Microsoft/Cryptography/Wintrust/Config" -Force'}),(0,s.jsx)(t.td,{children:'Out-Null; Set-ItemProperty -Path "HKLM:/Software/Microsoft/Cryptography/Wintrust/Config" -Name "EnableCertPaddingCheck" -Value 1 -Type DWord -Force"'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:12 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Execute Powershell Command-0008"}),(0,s.jsx)(t.td,{children:'Custom commands detected as New-Item -Path "HKLM:/Software/Microsoft/Cryptography/Wintrust/Config" -Force'}),(0,s.jsx)(t.td,{children:'Out-Null; Set-ItemProperty -Path "HKLM:/Software/Microsoft/Cryptography/Wintrust/Config" -Name "EnableCertPaddingCheck" -Value 1 -Type DWord -Force'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:06 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Execute Powershell Command-0002"}),(0,s.jsx)(t.td,{children:"Powershell is present."}),(0,s.jsx)(t.td,{children:"kunal.kumar"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:05 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Windows - 32 or 64 bit OS"}),(0,s.jsx)(t.td,{children:"Success THEN"}),(0,s.jsx)(t.td,{children:"kunal.kumar"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:36:05 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Windows - 32 or 64 bit OS-0011"}),(0,s.jsx)(t.td,{children:"Windows OS is 64-bit."}),(0,s.jsx)(t.td,{children:"kunal.kumar"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"10:35:57 am 23-Dec-24"}),(0,s.jsx)(t.td,{children:"Run Now - Enable Authenticode Verification"}),(0,s.jsx)(t.td,{children:"Admin kunal.kumar scheduled procedure Run Now - Enable Authenticode Verification to run at Dec 23 2024 10:35 AM"}),(0,s.jsx)(t.td,{children:"kunal.kumar"})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,s.jsx)(t.p,{children:"Agent procedure log."})]})}function h(e={}){const{wrapper:t}={...(0,d.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},28453:(e,t,r)=>{r.d(t,{R:()=>o,x:()=>i});var n=r(296540);const s={},d=n.createContext(s);function o(e){const t=n.useContext(d);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(d.Provider,{value:t},e.children)}}}]);