"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[383],{7764:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>d,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"powershell/ps-get-vsaauditreports","title":"Get-VSAAuditReports","description":"Documentation for the Get-VSAAuditReports command to perform a Kaseya Onboarding Audit and output results to an Excel spreadsheet.","source":"@site/docs/powershell/Get-VSAAuditReports.md","sourceDirName":"powershell","slug":"/powershell/ps-get-vsaauditreports","permalink":"/proval-docs/docs/powershell/ps-get-vsaauditreports","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/docs/tree/main/packages/create-docusaurus/templates/shared/docs/powershell/Get-VSAAuditReports.md","tags":[{"inline":false,"label":"Configuration","permalink":"/proval-docs/docs/tags/configuration","description":"Content related to configuring a device."},{"inline":false,"label":"Report","permalink":"/proval-docs/docs/tags/report","description":"Content related to generating reports."},{"inline":false,"label":"Software","permalink":"/proval-docs/docs/tags/software","description":"Content related to software."}],"version":"current","frontMatter":{"id":"ps-get-vsaauditreports","title":"Get-VSAAuditReports","title_meta":"Get-VSAAuditReports Command","keywords":["kaseya","audit","report","excel"],"description":"Documentation for the Get-VSAAuditReports command to perform a Kaseya Onboarding Audit and output results to an Excel spreadsheet.","tags":["configuration","report","software"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Get-UserRegistryValue","permalink":"/proval-docs/docs/powershell/ps-get-userregistryvalue"},"next":{"title":"Get-VolumeExhaustionEstimate","permalink":"/proval-docs/docs/powershell/ps-get-volumeexhaustionestimate"}}');var n=r(4848),a=r(8453);const o={id:"ps-get-vsaauditreports",title:"Get-VSAAuditReports",title_meta:"Get-VSAAuditReports Command",keywords:["kaseya","audit","report","excel"],description:"Documentation for the Get-VSAAuditReports command to perform a Kaseya Onboarding Audit and output results to an Excel spreadsheet.",tags:["configuration","report","software"],draft:!1,unlisted:!1},i=void 0,d={},c=[{value:"Description",id:"description",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Usage",id:"usage",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Output",id:"output",level:2}];function l(e){const t={code:"code",h2:"h2",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"description",children:"Description"}),"\n",(0,n.jsx)(t.p,{children:"Performs much of the Kaseya Onboarding Audit, outputs to an excel spreadsheet in the script dir."}),"\n",(0,n.jsx)(t.h2,{id:"requirements",children:"Requirements"}),"\n",(0,n.jsx)(t.p,{children:"Requires an API User account with Both REST and DataWarehouse access configured in the VSA\r\nOn-Prem Audit requires ip whitelisting to access. In lieu of whitelisting, the script can be run on the VSA server\r\nREST API requires a NATIVE VSA user. If 'UserName must be an email address' is enabled in System>Configuration>Default Settings, this must be temporarily disabled during API account creation."}),"\n",(0,n.jsx)(t.h2,{id:"usage",children:"Usage"}),"\n",(0,n.jsx)(t.p,{children:"Uses VSAAPI to perform the following REST API Requests and saves the results in CSV format in the 'CSVs' subfolder if data was returned.\r\nSystem\\Users\r\nSystem\\Roles\r\nSystem\\Scopes\r\nAutomation\\AgentProcs\r\nAssetmgmt\\Agents\r\nUses VSAAPI to perform the following Data Warehouse API Requests and saves the results in CSV format in the 'CSVs' subfolder if data was returned.\r\nDiscoveryActiveDirectoryDomainSummary\r\nDiscoveryLanWatchNetworks\r\nLanCacheAssignments\r\nPatchPolicyMembers\r\nPatches\r\nPatchConfigurations\r\nSoftwareManagementAlertProfiles\r\nSoftwareManagementByAgentStats\r\nSoftwareManagementDeploymentProfiles\r\nMonitorEventSetAgentAssignments\r\nMonitorSetAgentAssignments\r\nMonitorSNMPSetAgentAssignments\r\nUses the ImportExcel Module to write data to individual worksheets in an Excel Spreadsheet named AuditResults.xlsx\r\nAutomatically creates the following pivot tables according to auditing best practices, if data for the category was returned by the API.\r\nWindows Build Versions\r\nPatch Management Policies\r\nPatch Reboot Actions\r\nPatch AutoUpdate Configurations\r\nPatch Statuses\r\nMissing Approved Patches\r\nSM Analysis Profiles\r\nSM Assigned Deploy Profiles\r\nSM Compliance\r\nSM Missing Patches\r\nCounter Monitors\r\nEvent Monitors\r\nSNMP Monitors"}),"\n",(0,n.jsx)(t.p,{children:"Requires all parameters. API Account must be configured in VSA prior to running, and REST API / DataWarehouse scopes must be provided. DataWareHouse token must be gathered as well."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-powershell",children:"./Get-VSAAuditReports.ps1 -BaseURL https://vsa.provaltech.com -VsaUserName apiServiceAccount -RestApiToken abcd-1234-efgh-5678 -DataWarehouseApiToken abcd-1234-efgh-5678\n"})}),"\n",(0,n.jsx)(t.h2,{id:"parameters",children:"Parameters"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Parameter"}),(0,n.jsx)(t.th,{children:"Required"}),(0,n.jsx)(t.th,{children:"Type"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"Server"})}),(0,n.jsx)(t.td,{children:"True"}),(0,n.jsx)(t.td,{children:"String"}),(0,n.jsx)(t.td,{children:"VSA Base URL"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"APIUser"})}),(0,n.jsx)(t.td,{children:"True"}),(0,n.jsx)(t.td,{children:"String"}),(0,n.jsx)(t.td,{children:"API User Name"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"RestApiToken"})}),(0,n.jsx)(t.td,{children:"True"}),(0,n.jsx)(t.td,{children:"String"}),(0,n.jsx)(t.td,{children:"REST API Token"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"DataWarehouseApiToken"})}),(0,n.jsx)(t.td,{children:"True"}),(0,n.jsx)(t.td,{children:"String"}),(0,n.jsx)(t.td,{children:"Data Warehouse API Token"})]})]})]}),"\n",(0,n.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,n.jsx)(t.p,{children:"Location of output for log, result, and error files."}),"\n",(0,n.jsxs)(t.p,{children:[".\\Get-VSAAuditReports-log.txt\r\n.\\Get-VSAAuditReports-error.txt\r\n$env",":ProgramData","_automation\\Audit\\AuditResults.xlsx\r\n$env",":ProgramData","_automation\\Audit\\CSVs\\AgentProcedures.csv\r\n$env",":ProgramData","_automation\\Audit\\CSVs\\Agents.csv\r\n$env",":ProgramData","_automation\\Audit\\CSVs\\discoveryDomainList.csv\r\n$env",":ProgramData","_automation\\Audit\\CSVs\\discoveryLanWatchNetworks.csv\r\n$env",":ProgramData","_automation\\Audit\\CSVs\\LanCacheAssignments.csv\r\n$env",":ProgramData","_automation\\Audit\\CSVs\\MachineGroups.csv\r\n$env",":ProgramData","_automation\\Audit\\CSVs\\MonitorEventSetAgentAssignments.csv\r\n$env",":ProgramData","_automation\\Audit\\CSVs\\MonitorSetAgentAssignments.csv\r\n$env",":ProgramData","_automation\\Audit\\CSVs\\MonitorSNMPSetAgentAssignments.csv\r\n$env",":ProgramData","_automation\\Audit\\CSVs\\PatchConfigurations.csv\r\n$env",":ProgramData","_automation\\Audit\\CSVs\\Patches.csv\r\n$env",":ProgramData","_automation\\Audit\\CSVs\\PatchPolicyMembers.csv\r\n$env",":ProgramData","_automation\\Audit\\CSVs\\Roles.csv\r\n$env",":ProgramData","_automation\\Audit\\CSVs\\Scopes.csv\r\n$env",":ProgramData","_automation\\Audit\\CSVs\\SoftwareManagementAlertProfiles.csv\r\n$env",":ProgramData","_automation\\Audit\\CSVs\\SoftwareManagementByAgentStats.csv\r\n$env",":ProgramData","_automation\\Audit\\CSVs\\SoftwareManagementDeploymentProfiles.csv\r\n$env",":ProgramData","_automation\\Audit\\CSVs\\Users.csv"]})]})}function u(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},8453:(e,t,r)=>{r.d(t,{R:()=>o,x:()=>i});var s=r(6540);const n={},a=s.createContext(n);function o(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);