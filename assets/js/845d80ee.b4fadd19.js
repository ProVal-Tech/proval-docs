"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[62274],{892264:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"cwrmm/tasks/1ce60c7e-e23d-4313-bb00-7e89ae031d7f","title":"Disable Windows OptionalAutomatic Updates","description":"This document details the steps to disable Windows optional automatic updates using a script. It includes a sample run, dependencies, and a comprehensive implementation guide with visuals for each step.","source":"@site/docs/cwrmm/tasks/Disable Windows OptionalAutomatic Updates.md","sourceDirName":"cwrmm/tasks","slug":"/cwrmm/tasks/1ce60c7e-e23d-4313-bb00-7e89ae031d7f","permalink":"/proval-docs/docs/cwrmm/tasks/1ce60c7e-e23d-4313-bb00-7e89ae031d7f","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwrmm/tasks/Disable Windows OptionalAutomatic Updates.md","tags":[{"inline":false,"label":"Patching","permalink":"/proval-docs/docs/tags/patching","description":"Documents on software patch management and update installations"},{"inline":false,"label":"Registry","permalink":"/proval-docs/docs/tags/registry","description":"Documents concerning system registry management and troubleshooting"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"1ce60c7e-e23d-4313-bb00-7e89ae031d7f","title":"Disable Windows OptionalAutomatic Updates","title_meta":"Disable Windows OptionalAutomatic Updates","keywords":["windows","updates","registry","automation","patching"],"description":"This document details the steps to disable Windows optional automatic updates using a script. It includes a sample run, dependencies, and a comprehensive implementation guide with visuals for each step.","tags":["patching","registry","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Disable SMB1","permalink":"/proval-docs/docs/cwrmm/tasks/10055a68-f513-4580-bdc1-73272516866f"},"next":{"title":"Domain Join","permalink":"/proval-docs/docs/cwrmm/tasks/a0374bc3-b579-4299-b952-5bb3d0440c52"}}');var n=i(474848),a=i(28453);const o={id:"1ce60c7e-e23d-4313-bb00-7e89ae031d7f",title:"Disable Windows OptionalAutomatic Updates",title_meta:"Disable Windows OptionalAutomatic Updates",keywords:["windows","updates","registry","automation","patching"],description:"This document details the steps to disable Windows optional automatic updates using a script. It includes a sample run, dependencies, and a comprehensive implementation guide with visuals for each step.",tags:["patching","registry","windows"],draft:!1,unlisted:!1},r=void 0,c={},d=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Implementation",id:"implementation",level:2},{value:"Create Task",id:"create-task",level:3},{value:"Script",id:"script",level:2},{value:"Row 1: Function: Script Log",id:"row-1-function-script-log",level:3},{value:"Row 2: Function: PowerShell Script",id:"row-2-function-powershell-script",level:3},{value:"Row 3: Function: Script Log",id:"row-3-function-script-log",level:3},{value:"Output",id:"output",level:3},{value:"Row 4: Logic: If/Then",id:"row-4-logic-ifthen",level:3},{value:"Row 4a: Condition: Output Contains",id:"row-4a-condition-output-contains",level:3},{value:"Row 4b: Condition: Script Exit",id:"row-4b-condition-script-exit",level:3},{value:"Row 5: Function: Set Custom Field",id:"row-5-function-set-custom-field",level:3},{value:"Row 6: Complete",id:"row-6-complete",level:3}];function l(e){const t={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,n.jsx)(t.p,{children:"This task will disable the Windows optional automatic updates."}),"\n",(0,n.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.img,{alt:"Sample Run 1",src:i(413706).A+"",width:"494",height:"273"}),(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.img,{alt:"Sample Run 2",src:i(444289).A+"",width:"1000",height:"698"})]}),"\n",(0,n.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.a,{href:"/proval-docs/docs/cwrmm/custom-fields/a2035a6f-bcbc-41a2-ace1-fc08b7ad2511",children:"CW RMM Custom Field - Windows Optional Update Disabled"})}),"\n",(0,n.jsx)(t.h2,{id:"implementation",children:"Implementation"}),"\n",(0,n.jsx)(t.h3,{id:"create-task",children:"Create Task"}),"\n",(0,n.jsxs)(t.p,{children:['To implement this script, please create a new "PowerShell" style script in the system.',(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.img,{alt:"Create Task",src:i(223160).A+"",width:"384",height:"644"})]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Name:"})," Disable Windows Optional/Automatic Updates",(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.strong,{children:"Description:"})," This task will disable the Windows optional automatic updates.",(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.strong,{children:"Category:"})," Patching",(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.img,{alt:"Task Details",src:i(955799).A+"",width:"665",height:"473"})]}),"\n",(0,n.jsx)(t.h2,{id:"script",children:"Script"}),"\n",(0,n.jsxs)(t.p,{children:['Start by making three separate rows. You can do this by clicking the "Add Row" button at the bottom of the script page.',(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.img,{alt:"Add Row",src:i(526574).A+"",width:"475",height:"212"})]}),"\n",(0,n.jsx)(t.h3,{id:"row-1-function-script-log",children:"Row 1: Function: Script Log"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Script Log",src:i(780581).A+"",width:"1000",height:"144"})}),"\n",(0,n.jsxs)(t.p,{children:["In the script log message, type ",(0,n.jsx)(t.code,{children:"Running the PowerShell to set NoAutoUpdates and Hide Automatic Updates Options."})," so that the script will send the results of the PowerShell script above to the output on the Automation tab for the target device.",(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.img,{alt:"Log Message",src:i(214044).A+"",width:"830",height:"218"})]}),"\n",(0,n.jsx)(t.h3,{id:"row-2-function-powershell-script",children:"Row 2: Function: PowerShell Script"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.img,{alt:"PowerShell Script",src:i(223531).A+"",width:"1000",height:"140"}),(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.img,{alt:"PowerShell Script 2",src:i(2402).A+"",width:"1000",height:"625"})]}),"\n",(0,n.jsxs)(t.p,{children:["Paste in the following PowerShell script and set the expected time of script execution to ",(0,n.jsx)(t.code,{children:"900"})," seconds."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-powershell",children:'# Define the registry paths\r\n$mainRegPath = "HKLM:/SOFTWARE/Policies/Microsoft/Windows/WindowsUpdate/AU"\r\n$auOptionsRegPath = "HKLM:/SOFTWARE/Policies/Microsoft/Windows/WindowsUpdate/AU/AUOptions"\r\n\r\n# Check if the main registry key exists\r\nif (-not(Test-Path -Path $mainRegPath)) {\r\n    # If not, create it\r\n    New-Item -Path $mainRegPath -Force | Out-Null\r\n}\r\n\r\n# Check if the AUOptions registry key exists\r\nif (Test-Path -Path $auOptionsRegPath) {\r\n    # If it does, remove it\r\n    Remove-Item -Path $auOptionsRegPath -Force\r\n}\r\n\r\n# Check if the AUOptions property exists under the main registry key\r\nif ($null -ne (Get-ItemProperty -Path $mainRegPath -EA SilentlyContinue).AUOptions) {\r\n    # If it does, remove it\r\n    Remove-ItemProperty -Path $mainRegPath -Name "AUOptions" -Force\r\n}\r\n\r\n# Set the NoAutoUpdate DWORD value to 1\r\nSet-ItemProperty -Path $mainRegPath -Name "NoAutoUpdate" -Value 1 -Type DWord -Force\r\n\r\n# Check if the registry was set properly\r\nif ((Get-ItemProperty -Path $mainRegPath).NoAutoUpdate -eq 1) {\r\n    Write-Output "Registry set properly."\r\n} else {\r\n    Write-Output "Failed to set registry."\r\n}\n'})}),"\n",(0,n.jsx)(t.h3,{id:"row-3-function-script-log",children:"Row 3: Function: Script Log"}),"\n",(0,n.jsx)(t.h3,{id:"output",children:"Output"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Output",src:i(780581).A+"",width:"1000",height:"144"})}),"\n",(0,n.jsxs)(t.p,{children:["In the script log message, type ",(0,n.jsx)(t.code,{children:"%output%"})," so that the script will send the results of the PowerShell script above to the output on the Automation tab for the target device.",(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.img,{alt:"Output Message",src:i(67984).A+"",width:"338",height:"272"})]}),"\n",(0,n.jsx)(t.h3,{id:"row-4-logic-ifthen",children:"Row 4: Logic: If/Then"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.img,{alt:"If/Then Logic 1",src:i(74233).A+"",width:"408",height:"215"}),(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.img,{alt:"If/Then Logic 2",src:i(91298).A+"",width:"1000",height:"301"})]}),"\n",(0,n.jsx)(t.h3,{id:"row-4a-condition-output-contains",children:"Row 4a: Condition: Output Contains"}),"\n",(0,n.jsxs)(t.p,{children:["In the IF part, enter ",(0,n.jsx)(t.code,{children:"Failed to set registry"}),' in the right box of the "Output Contains" part.',(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.img,{alt:"Output Contains",src:i(981803).A+"",width:"1000",height:"100"})]}),"\n",(0,n.jsx)(t.h3,{id:"row-4b-condition-script-exit",children:"Row 4b: Condition: Script Exit"}),"\n",(0,n.jsxs)(t.p,{children:["Add a new row by clicking on the Add row button.",(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.img,{alt:"Add Row Exit",src:i(31892).A+"",width:"1000",height:"158"})]}),"\n",(0,n.jsxs)(t.p,{children:["In the script exit message, simply type ",(0,n.jsx)(t.code,{children:"Failed to set the registry HKLM:/SOFTWARE/Policies/Microsoft/Windows/WindowsUpdate/AU -Name NoAutoUpdate -Value 1. Exiting script with error."}),(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.img,{alt:"Exit Message",src:i(253021).A+"",width:"1000",height:"251"})]}),"\n",(0,n.jsx)(t.h3,{id:"row-5-function-set-custom-field",children:"Row 5: Function: Set Custom Field"}),"\n",(0,n.jsxs)(t.p,{children:["Select Function 'Set Custom Field'. When you select ",(0,n.jsx)(t.code,{children:"set custom field"}),", it will open up a new window."]}),"\n",(0,n.jsxs)(t.p,{children:["In this window, search for the ",(0,n.jsx)(t.code,{children:"Windows Optional Update Disabled"})," field."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Custom Field:"})," Windows Optional Update Disabled",(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.strong,{children:"Value:"})," ",(0,n.jsx)(t.code,{children:"Disabled"}),(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.img,{alt:"Set Custom Field",src:i(471814).A+"",width:"457",height:"243"})]}),"\n",(0,n.jsx)(t.h3,{id:"row-6-complete",children:"Row 6: Complete"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Complete",src:i(537007).A+"",width:"1000",height:"445"})})]})}function p(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},413706:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_1-b3fc647a3a6b3e867963b60b89098fcd.png"},67984:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_10-39c2357a125d769e7f35e934d2dd5e61.png"},74233:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_11-5d2309362a79f59fafd5dc06f0ade299.png"},91298:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_12-1943dcd1e74ccceac7b6a2711aef7bc5.png"},981803:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_13-bf74202349de6cdfd45889cffcd8940d.png"},31892:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_14-98331990b0af52b16b19979ac677f91c.png"},253021:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_15-8bbc47366d340d6f494faedc5607a081.png"},471814:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_16-137e85c9e3cca3d4b700a630666032c3.png"},537007:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_17-2db2a80881243a1ab26df78fb6f9aa51.png"},444289:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_2-91971dae8918b36a613147a2ca5c475a.png"},223160:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_3-50c2bf241a3ac8dc08079c68c51442fa.png"},955799:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_4-05f79cfa9f292994ae4596477ee30b50.png"},526574:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_5-e32fc53110844f5a76fb36ae7bc74477.png"},780581:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_6-3bea2c2255dc3d9e86a7fab01f1eff2f.png"},214044:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_7-1bf02d6c7fa1d6d3a95bd7da955af620.png"},223531:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_8-dc24ca511c3a463db969905b2db12c6f.png"},2402:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_9-8f95da7c14ac2271922e175617986ddb.png"},28453:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>r});var s=i(296540);const n={},a=s.createContext(n);function o(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);