"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[70646],{14030:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"vsa/procedures/8beb5e09-23af-40e8-8810-ec1a030c600b","title":"OS Install Date","description":"This document outlines a procedure to determine the initial install date of the operating system using PowerShell. It provides a detailed example of the agent procedure log, dependencies required for execution, and the expected output of the procedure.","source":"@site/docs/vsa/procedures/OS Install Date.md","sourceDirName":"vsa/procedures","slug":"/vsa/procedures/8beb5e09-23af-40e8-8810-ec1a030c600b","permalink":"/proval-docs/docs/vsa/procedures/8beb5e09-23af-40e8-8810-ec1a030c600b","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/vsa/procedures/OS Install Date.md","tags":[{"inline":false,"label":"Performance","permalink":"/proval-docs/docs/tags/performance","description":"Documents related to enhancing system and application performance"},{"inline":false,"label":"Software","permalink":"/proval-docs/docs/tags/software","description":"Documents related to software applications and their lifecycle management"},{"inline":false,"label":"Update","permalink":"/proval-docs/docs/tags/update","description":"Documents discussing software and system updates and their management"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"8beb5e09-23af-40e8-8810-ec1a030c600b","title":"OS Install Date","title_meta":"OS Install Date","keywords":["os","install","date","powershell","agent","procedure"],"description":"This document outlines a procedure to determine the initial install date of the operating system using PowerShell. It provides a detailed example of the agent procedure log, dependencies required for execution, and the expected output of the procedure.","tags":["performance","software","update","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Network Detective Workstation  Server","permalink":"/proval-docs/docs/vsa/procedures/6c3d68e8-61cd-4e74-a13f-d6be1516feec"},"next":{"title":"Office Activation Status Audit","permalink":"/proval-docs/docs/vsa/procedures/cb7d4500-3e57-454a-8c47-3c31bf79db80"}}');var d=r(474848),n=r(28453);const i={id:"8beb5e09-23af-40e8-8810-ec1a030c600b",title:"OS Install Date",title_meta:"OS Install Date",keywords:["os","install","date","powershell","agent","procedure"],description:"This document outlines a procedure to determine the initial install date of the operating system using PowerShell. It provides a detailed example of the agent procedure log, dependencies required for execution, and the expected output of the procedure.",tags:["performance","software","update","windows"],draft:!1,unlisted:!1},o=void 0,l={},a=[{value:"Summary",id:"summary",level:2},{value:"Example Agent Procedure Log",id:"example-agent-procedure-log",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Output",id:"output",level:2}];function c(e){const t={a:"a",br:"br",h2:"h2",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,d.jsx)(t.p,{children:"This agent procedure runs PowerShell to determine the initial install date of the OS. This always pulls the oldest version and will not be overwritten with feature updates or upgrades to a new OS."}),"\n",(0,d.jsx)(t.h2,{id:"example-agent-procedure-log",children:"Example Agent Procedure Log"}),"\n",(0,d.jsxs)(t.table,{children:[(0,d.jsx)(t.thead,{children:(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.th,{children:"Time"}),(0,d.jsx)(t.th,{children:"Action"}),(0,d.jsx)(t.th,{children:"Status"}),(0,d.jsx)(t.th,{children:"User"})]})}),(0,d.jsxs)(t.tbody,{children:[(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:22:46 pm 13-Apr-23"}),(0,d.jsx)(t.td,{children:"OS Install Date"}),(0,d.jsx)(t.td,{children:"Success THEN"}),(0,d.jsx)(t.td,{children:"derek.joniak"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:22:46 pm 13-Apr-23"}),(0,d.jsx)(t.td,{children:"OS Install Date"}),(0,d.jsx)(t.td,{children:"OS Install Date: 03/29/2022"}),(0,d.jsx)(t.td,{children:"derek.joniak"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:22:46 pm 13-Apr-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)"}),(0,d.jsx)(t.td,{children:"Success THEN"}),(0,d.jsx)(t.td,{children:"derek.joniak"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:22:46 pm 13-Apr-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0016"}),(0,d.jsxs)(t.td,{children:["Powershell command complete. Results returned to global variable #global",":psresult","# and saved in Agent's Documents tab of server."]}),(0,d.jsx)(t.td,{children:"derek.joniak"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:22:46 pm 13-Apr-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0016"}),(0,d.jsx)(t.td,{children:"Informational: GetFile command overwrote the server file C:/Kaseya/UserProfiles/211658173702177/GetFiles/../docs/psoutput.txt with the new contents from c:/kworking/psoutput.txt in THEN step 3."}),(0,d.jsx)(t.td,{children:"derek.joniak"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:22:44 pm 13-Apr-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0011"}),(0,d.jsx)(t.td,{children:'Executing 64-bit Powershell command as System: "" -command "$OS=@(Get-ChildItem -Path \'HKLM:/System/Setup/Source*\''}),(0,d.jsx)(t.td,{children:"ForEach-Object {Get-ItemProperty -Path Registry::$_})+@(Get-ItemProperty 'HKLM:/SOFTWARE/Microsoft/Windows NT/CurrentVersion')"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:22:44 pm 13-Apr-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0013"}),(0,d.jsx)(t.td,{children:"Sending output to global variable."}),(0,d.jsx)(t.td,{children:"derek.joniak"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:22:44 pm 13-Apr-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0008"}),(0,d.jsx)(t.td,{children:"Custom commands detected as $OS=@(Get-ChildItem -Path 'HKLM:/System/Setup/Source*'"}),(0,d.jsx)(t.td,{children:"ForEach-Object {Get-ItemProperty -Path Registry::$_})+@(Get-ItemProperty 'HKLM:/SOFTWARE/Microsoft/Windows NT/CurrentVersion')"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:22:44 pm 13-Apr-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0003"}),(0,d.jsx)(t.td,{children:"No Powershell file variable detected."}),(0,d.jsx)(t.td,{children:"derek.joniak"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:22:42 pm 13-Apr-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0002"}),(0,d.jsx)(t.td,{children:"Powershell is present."}),(0,d.jsx)(t.td,{children:"derek.joniak"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:22:42 pm 13-Apr-23"}),(0,d.jsx)(t.td,{children:"OS Install Date"}),(0,d.jsx)(t.td,{children:"Detecting OS Install Date"}),(0,d.jsx)(t.td,{children:"derek.joniak"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:22:35 pm 13-Apr-23"}),(0,d.jsx)(t.td,{children:"Run Now - OS Install Date"}),(0,d.jsx)(t.td,{children:"Admin derek.joniak scheduled procedure Run Now - OS Install Date to run at Apr 13 2023 5:22 PM"}),(0,d.jsx)(t.td,{children:"derek.joniak"})]})]})]}),"\n",(0,d.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,d.jsxs)(t.p,{children:["The agent procedure requires the custom field to be created in order to successfully run:",(0,d.jsx)(t.br,{}),"\n",(0,d.jsx)(t.a,{href:"/proval-docs/docs/vsa/custom-fields/0fbf0989-b499-4d26-8cec-29e3d32d0ada",children:"Custom Field Documentation"})]}),"\n",(0,d.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,d.jsx)(t.p,{children:"The agent procedure updates the custom field."})]})}function h(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,d.jsx)(t,{...e,children:(0,d.jsx)(c,{...e})}):c(e)}},28453:(e,t,r)=>{r.d(t,{R:()=>i,x:()=>o});var s=r(296540);const d={},n=s.createContext(d);function i(e){const t=s.useContext(n);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:i(e.components),s.createElement(n.Provider,{value:t},e.children)}}}]);