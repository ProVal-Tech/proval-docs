"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[82325],{104105:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"cwa/scripts/cbc62993-0c72-4826-bdfa-bf0aa498891f","title":"Offline Machines Detection per client Global","description":"This document outlines the process for creating a client-level ticket that includes information about all machines that have been offline for more than a specified number of days. It provides a template for the ticket subject and body, ensuring that clients are informed about their offline machines and can take appropriate action.","source":"@site/docs/cwa/scripts/Offline Machines Detection per client Global.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/cbc62993-0c72-4826-bdfa-bf0aa498891f","permalink":"/proval-docs/docs/cwa/scripts/cbc62993-0c72-4826-bdfa-bf0aa498891f","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Offline Machines Detection per client Global.md","tags":[{"inline":false,"label":"Report","permalink":"/proval-docs/docs/tags/report","description":"Documents focused on generating and managing reports"},{"inline":false,"label":"Ticketing","permalink":"/proval-docs/docs/tags/ticketing","description":"Documents related to ticketing systems and IT support management"}],"version":"current","frontMatter":{"id":"cbc62993-0c72-4826-bdfa-bf0aa498891f","title":"Offline Machines Detection per client Global","title_meta":"Offline Machines Detection per client Global","keywords":["ticketing","offline","machines","client","monitoring"],"description":"This document outlines the process for creating a client-level ticket that includes information about all machines that have been offline for more than a specified number of days. It provides a template for the ticket subject and body, ensuring that clients are informed about their offline machines and can take appropriate action.","tags":["report","ticketing"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Offline Agents - Auto-Retire - Pre-Audit No Action,Email","permalink":"/proval-docs/docs/cwa/scripts/a47f9f1e-356c-4b1c-aa02-47d70788ac05"},"next":{"title":"OneDrive - Backup Status","permalink":"/proval-docs/docs/cwa/scripts/bf26e767-9125-4b51-a950-ec3d3dc32f8b"}}');var r=t(474848),a=t(28453);const s={id:"cbc62993-0c72-4826-bdfa-bf0aa498891f",title:"Offline Machines Detection per client Global",title_meta:"Offline Machines Detection per client Global",keywords:["ticketing","offline","machines","client","monitoring"],description:"This document outlines the process for creating a client-level ticket that includes information about all machines that have been offline for more than a specified number of days. It provides a template for the ticket subject and body, ensuring that clients are informed about their offline machines and can take appropriate action.",tags:["report","ticketing"],draft:!1,unlisted:!1},o=void 0,l={},c=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Global Variables",id:"global-variables",level:4},{value:"Output",id:"output",level:2},{value:"Ticketing",id:"ticketing",level:2}];function d(e){const n={br:"br",code:"code",h2:"h2",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(n.p,{children:"Create a client-level ticket with the information of all the machines that have been offline for more than X days."}),"\n",(0,r.jsx)(n.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{alt:"Sample Run",src:t(5769).A+"",width:"1000",height:"317"}),(0,r.jsx)(n.br,{}),"\n","It is a client script. Schedule it to run every ",(0,r.jsx)(n.code,{children:"@Threshold_Offline_Days@"})," days."]}),"\n",(0,r.jsx)(n.h4,{id:"global-variables",children:"Global Variables"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Name"}),(0,r.jsx)(n.th,{children:"Default"}),(0,r.jsx)(n.th,{children:"Required"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Threshold_Offline_Days"}),(0,r.jsx)(n.td,{children:"30"}),(0,r.jsx)(n.td,{children:"True"}),(0,r.jsx)(n.td,{children:"This sets the threshold for how long offline agents are detected."})]})})]}),"\n",(0,r.jsx)(n.h2,{id:"output",children:"Output"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Tickets"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"ticketing",children:"Ticketing"}),"\n",(0,r.jsx)(n.p,{children:"For clients with multiple offline machines:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Subject:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"LT - X Machines Offline > @Threshold_Offline_Days@ Days at %ClientName%\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"There were X machines found to be offline at %ClientName%. Please review the following list of computers and determine if these can be turned on or if they need to be decommissioned.\r\n\r\nThe PCs in question have been listed below:\r\nPC Name: %ComputerName1% (Last login: %LastUserName%)\r\nLast Contact: %LastContact%\r\nPC Model: %PCModel% (OS: %OS%)\r\nS/N OF PC: %SerialNumber%\r\n\r\nPC Name: %ComputerName2% (Last login: %LastUserName%)\r\nLast Contact: %LastContact%\r\nPC Model: %PCModel% (OS: %OS%)\r\nS/N OF PC: %SerialNumber%\r\n\r\nPC Name: %ComputerName3% (Last login: %LastUserName%)\r\nLast Contact: %LastContact%\r\nPC Model: %PCModel% (OS: %OS%)\r\nS/N OF PC: %SerialNumber%\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Example:"}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.strong,{children:"Subject:"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"LT - 8 Machines Offline > 10 Days at Development\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"There were 8 machines found to be offline at Development. Please review the following list of computers and determine if these can be turned on or if they need to be decommissioned.\r\n\r\nThe PCs in question have been listed below:\r\nPC Name: DEV-SERVER2012R (Last login: DEV-SERVER2012R/Administrator)\r\nLast Contact: 2022-11-04 13:57:20\r\nPC Model: Virtual Machine (OS: Microsoft Windows Server 2012 R2 Standard Evaluation x64)\r\nS/N OF PC: 9167-1404-2630-6589-4651-1615-71\r\n\r\nPC Name: DEV-WIN10-2 (Last login: DEV-WIN10-2/Test)\r\nLast Contact: 2023-03-02 11:07:08\r\nPC Model: Virtual Machine (OS: Microsoft Windows 10 Enterprise x64)\r\nS/N OF PC: 8204-9944-0772-2209-1214-6947-22\r\n\r\nPC Name: DEV-WIN10-3 (Last login: )\r\nLast Contact: 0000-00-00 00:00:00\r\nPC Model:  (OS: Microsoft Windows 10 Enterprise x64)\r\nS/N OF PC: 8204-9944-0772-\r\n\r\nPC Name: DEV-HYPERVHOST (Last login: DEV-HYPERVHOST/Administrator)\r\nLast Contact: 2023-01-23 04:06:35\r\nPC Model: Virtual Machine (OS: Microsoft Windows Server 2022 Standard x64)\r\nS/N OF PC: 0639-6643-9989-8482-7167-0159-76\r\n\r\nPC Name: DESKTOP-P8QCK3M (Last login: DESKTOP-P8QCK3M/MyPC)\r\nLast Contact: 2022-11-08 10:53:37\r\nPC Model: 20T1S2A200 (OS: Microsoft Windows 10 Pro x64)\r\nS/N OF PC: PC1QTPZC\r\n\r\nPC Name: CALVERLEYWIN7VM (Last login: CalverleyWin7VM/Calverley)\r\nLast Contact: 2023-02-22 15:28:08\r\nPC Model: Virtual Machine (OS: Microsoft Windows 7 Professional x64)\r\nS/N OF PC: 7541-5254-6929-9698-2400-4251-79\r\n\r\nPC Name: DESKTOP-T3MCJ00 (Last login: DESKTOP-T3MCJ00/User)\r\nLast Contact: 2023-02-02 00:39:21\r\nPC Model: Virtual Machine (OS: Microsoft Windows 10 Pro x64)\r\nS/N OF PC: 5321-4078-3633-5397-0764-9709-12\r\n\r\nPC Name: DEV-W81-CALV (Last login: DEV-W81-CALV/chris)\r\nLast Contact: 2023-02-16 13:52:03\r\nPC Model: Virtual Machine (OS: Microsoft Windows 8.1 Pro x64)\r\nS/N OF PC: 7236-6914-8520-4476-5686-2377-81\n"})}),"\n",(0,r.jsx)(n.p,{children:"For clients with a single offline machine:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Subject:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"LT - %computername% offline > @Threshold_Offline_Days@ days at %ClientName%/%LocationName%\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"The computer %computername% at %ClientName%/%LocationName% has not checked in since %LastContact%. Please find out why this machine is offline and if it should be decommissioned.\r\n\r\nThe PC information is outlined below:\r\nPC Name: %ComputerName% (Last login: %LastLoggedonUser%)\r\nLast Contact: %LastContact%\r\nPC Model: %PCModel%\r\nOS: %OS%\r\nS/N OF PC: %SerialNumber%\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Example:"}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.strong,{children:"Subject:"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"LT - DEV-WIN10-3 offline > 90 days at Development/Dev\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"The computer DEV-WIN10-3 at Development/Dev has not checked in since 2023-02-22 15:28:08. Please find out why this machine is offline and if it should be decommissioned.\r\n\r\nThe PC information is outlined below:\r\nPC Name: DEV-WIN10-3 (Last login: DEV-WIN10-3/User)\r\nLast Contact: 2023-02-22 15:28:08\r\nPC Model: Virtual Machine\r\nOS: Microsoft Windows 10 Enterprise x64\r\nS/N OF PC: 8204-9944-0772-5397-0764-9709-12\n"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},5769:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/image_1-c51bf3991c51b91d0a80b97d73d5db18.png"},28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>o});var i=t(296540);const r={},a=i.createContext(r);function s(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);