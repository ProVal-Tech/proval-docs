"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[4086],{8576:(e,s,l)=>{l.r(s),l.d(s,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"powershell/ps-disable-powershellversion2","title":"Disable-PowerShellVersion2","description":"Documentation for the Disable-PowerShellVersion2 command to disable Windows PowerShell v2 feature if a newer version is installed.","source":"@site/docs/powershell/Disable-PowershellVersion2.md","sourceDirName":"powershell","slug":"/powershell/ps-disable-powershellversion2","permalink":"/docs/powershell/ps-disable-powershellversion2","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/docs/tree/main/packages/create-docusaurus/templates/shared/docs/powershell/Disable-PowershellVersion2.md","tags":[{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Content related to the Windows operating system."},{"inline":false,"label":"Configuration","permalink":"/docs/tags/configuration","description":"Content related to configuring a device."},{"inline":false,"label":"Updates","permalink":"/docs/tags/update","description":"Content related to updating software."},{"inline":false,"label":"Security","permalink":"/docs/tags/security","description":"Content related to security."}],"version":"current","frontMatter":{"id":"ps-disable-powershellversion2","title":"Disable-PowerShellVersion2","title_meta":"Disable-PowerShellVersion2 Command","keywords":["disable","powershell","version","update"],"description":"Documentation for the Disable-PowerShellVersion2 command to disable Windows PowerShell v2 feature if a newer version is installed.","tags":["windows","configuration","update","security"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Disable-DotNet3","permalink":"/docs/powershell/ps-disable-dotnet3"},"next":{"title":"Enable-PowerPlan","permalink":"/docs/powershell/ps-enable-powerplan"}}');var t=l(4848),n=l(8453);const r={id:"ps-disable-powershellversion2",title:"Disable-PowerShellVersion2",title_meta:"Disable-PowerShellVersion2 Command",keywords:["disable","powershell","version","update"],description:"Documentation for the Disable-PowerShellVersion2 command to disable Windows PowerShell v2 feature if a newer version is installed.",tags:["windows","configuration","update","security"],draft:!1,unlisted:!1},o=void 0,a={},d=[{value:"Description",id:"description",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Usage",id:"usage",level:2},{value:"Output",id:"output",level:2}];function c(e){const s={code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...(0,n.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h2,{id:"description",children:"Description"}),"\n",(0,t.jsx)(s.p,{children:"This Script will disable Windows PowerShell v2 feature.\r\nIf no new version of PowerShell exists the script will not disable Powershell V2."}),"\n",(0,t.jsx)(s.h2,{id:"requirements",children:"Requirements"}),"\n",(0,t.jsx)(s.p,{children:"A version of PowerShell greater than v2 must be installed to disable PowerShell v2, this script will attempt to satisfy that requirement before disabling anything.\r\nThe removal of the .Net 3.0 feature requires a reboot."}),"\n",(0,t.jsx)(s.h2,{id:"usage",children:"Usage"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"If there is a powershell version installed greater than v2, then we will disable Powershell V2"}),"\n",(0,t.jsxs)(s.li,{children:["If there is no powershell versions installed greater than v2","\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"Install the latest approved chocolatey version of PowerShell."}),"\n",(0,t.jsx)(s.li,{children:"Verify that the installation was successful, error if not."}),"\n",(0,t.jsx)(s.li,{children:"Disable PowerShell version 2."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-powershell",children:".\\Disable-PowershellVersion2.ps1\n"})}),"\n",(0,t.jsx)(s.p,{children:"Checks for a version of PowerShell greater than v2, if there is one present disables the PowerShell V2. feature, if it's not present it attempts to install a newer PowerShell version so v2 can be disabled."}),"\n",(0,t.jsx)(s.h2,{id:"output",children:"Output"}),"\n",(0,t.jsx)(s.p,{children:".\\Disable-PowershellVersion2-log.txt\r\n.\\Disable-PowershellVersion2-error.txt"})]})}function h(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,s,l)=>{l.d(s,{R:()=>r,x:()=>o});var i=l(6540);const t={},n=i.createContext(t);function r(e){const s=i.useContext(n);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(n.Provider,{value:s},e.children)}}}]);