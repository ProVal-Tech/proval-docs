"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[89999],{308246:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>r,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"solutions/67bf4b52-4294-4773-b4df-7d75c9387954","title":"Sysmon","description":"This document provides a comprehensive guide on how to install and uninstall the Sysmon application on Windows computers, including optional enhancements for monitoring configurations and services. It covers the necessary scripts, parameters, and variables required for effective deployment and management of Sysmon.","source":"@site/docs/solutions/Sysmon.md","sourceDirName":"solutions","slug":"/solutions/67bf4b52-4294-4773-b4df-7d75c9387954","permalink":"/proval-docs/docs/solutions/67bf4b52-4294-4773-b4df-7d75c9387954","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/solutions/Sysmon.md","tags":[{"inline":false,"label":"Installation","permalink":"/proval-docs/docs/tags/installation","description":"Documents on installing software and configuring systems"},{"inline":false,"label":"Uninstallation","permalink":"/proval-docs/docs/tags/uninstallation","description":"Documents related to software removal and uninstallation processes"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"67bf4b52-4294-4773-b4df-7d75c9387954","title":"Sysmon","title_meta":"Sysmon","keywords":["sysmon","windows","monitor","service","configuration","installation","uninstallation","endpoint"],"description":"This document provides a comprehensive guide on how to install and uninstall the Sysmon application on Windows computers, including optional enhancements for monitoring configurations and services. It covers the necessary scripts, parameters, and variables required for effective deployment and management of Sysmon.","tags":["installation","uninstallation","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Stolen Devices","permalink":"/proval-docs/docs/solutions/7284d09c-ce9b-4916-847b-b61688aff7f0"},"next":{"title":"Threatlocker - Set Learning Mode Implement and Audit","permalink":"/proval-docs/docs/solutions/5e48c013-4305-4bfb-9cdd-1aa518d8f729"}}');var t=s(474848),l=s(28453);const o={id:"67bf4b52-4294-4773-b4df-7d75c9387954",title:"Sysmon",title_meta:"Sysmon",keywords:["sysmon","windows","monitor","service","configuration","installation","uninstallation","endpoint"],description:"This document provides a comprehensive guide on how to install and uninstall the Sysmon application on Windows computers, including optional enhancements for monitoring configurations and services. It covers the necessary scripts, parameters, and variables required for effective deployment and management of Sysmon.",tags:["installation","uninstallation","windows"],draft:!1,unlisted:!1},a=void 0,r={},d=[{value:"Summary",id:"summary",level:2},{value:"Base Scripts:",id:"base-scripts",level:3},{value:"Optional Script Enhancement Suggestions:",id:"optional-script-enhancement-suggestions",level:3},{value:"Install Sysmon on an Endpoint (Sysmon - Install)",id:"install-sysmon-on-an-endpoint-sysmon---install",level:2},{value:"Uninstall Sysmon From an Endpoint (Sysmon - Uninstall)",id:"uninstall-sysmon-from-an-endpoint-sysmon---uninstall",level:2},{value:"Optional Script Enhancement Suggestions",id:"optional-script-enhancement-suggestions-1",level:3},{value:"Variables",id:"variables",level:2},{value:"Sysmon - Install",id:"sysmon---install",level:3},{value:"Sysmon - Uninstall",id:"sysmon---uninstall",level:3},{value:"Output",id:"output",level:2}];function c(n){const e={code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsx)(e.p,{children:"This solution handles the optional application Sysmon."}),"\n",(0,t.jsx)(e.h3,{id:"base-scripts",children:"Base Scripts:"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"Install Sysmon application"}),"\n",(0,t.jsx)(e.li,{children:"Uninstall Sysmon application"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"optional-script-enhancement-suggestions",children:"Optional Script Enhancement Suggestions:"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"Monitor Configuration"}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Intended Target:"})," Windows Computers"]}),"\n",(0,t.jsx)(e.h2,{id:"install-sysmon-on-an-endpoint-sysmon---install",children:"Install Sysmon on an Endpoint (Sysmon - Install)"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"Import the Sysmon Install Script."}),"\n",(0,t.jsx)(e.li,{children:"Set the optional config file as a user parameter, or leave it blank if you do not have a specified config file."}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.img,{alt:"Image",src:s(369762).A+"",width:"484",height:"400"})," or ",(0,t.jsx)(e.img,{alt:"Image",src:s(225849).A+"",width:"484",height:"400"})]}),"\n",(0,t.jsx)(e.h2,{id:"uninstall-sysmon-from-an-endpoint-sysmon---uninstall",children:"Uninstall Sysmon From an Endpoint (Sysmon - Uninstall)"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"Import the Sysmon Uninstall Script."}),"\n",(0,t.jsx)(e.li,{children:"Run the script."}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"Image",src:s(219600).A+"",width:"484",height:"352"})}),"\n",(0,t.jsx)(e.h3,{id:"optional-script-enhancement-suggestions-1",children:"Optional Script Enhancement Suggestions"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["Service Monitor","\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"Sysmon64 - 64-bit service"}),"\n",(0,t.jsx)(e.li,{children:"Sysmon - 32-bit service"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["Pick an appropriate group that you would like to monitor for Sysmon services and set up a remote monitor.","\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"Name: \u25b3 Sysmon Service Monitor"}),"\n",(0,t.jsx)(e.li,{children:"Limit to: Feel free to add a limit if desired."}),"\n",(0,t.jsx)(e.li,{children:"Alert style: Once"}),"\n",(0,t.jsx)(e.li,{children:"Alert Template: Service - Restart autocorrect script template."}),"\n",(0,t.jsx)(e.li,{children:"Check Action: System"}),"\n",(0,t.jsx)(e.li,{children:"Check Type: Run File"}),"\n",(0,t.jsxs)(e.li,{children:["Execute Info: ",(0,t.jsx)(e.code,{children:"C:/Windows/System32/WindowsPowerShell/v1.0/powershell.exe -ExecutionPolicy Bypass -Command \"If ((Get-Service | Where-Object -Property Name -Match 'Sysmon').count -eq 0) {return} else { Get-Service | Where-Object -Property Name -Match 'Sysmon' | ForEach-Object { if ($_.status -ne 'Running') { return $_.DisplayName; } else { return } } }\""})]}),"\n",(0,t.jsx)(e.li,{children:"Condition: Missing"}),"\n",(0,t.jsx)(e.li,{children:"Interval: 300"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.img,{alt:"Image",src:s(815471).A+"",width:"854",height:"828"})," ",(0,t.jsx)(e.img,{alt:"Image",src:s(776454).A+"",width:"854",height:"828"})]}),"\n",(0,t.jsx)(e.h2,{id:"variables",children:"Variables"}),"\n",(0,t.jsx)(e.h3,{id:"sysmon---install",children:"Sysmon - Install"}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"Name"}),(0,t.jsx)(e.th,{children:"Description"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Local File Location"}),(0,t.jsx)(e.td,{children:"The folder location of where the config file and the zip file will be downloaded."})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Sysmon File Name"}),(0,t.jsx)(e.td,{children:"The name of the Sysmon executable file (changes based on bitness)."})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Command Arguments"}),(0,t.jsx)(e.td,{children:"The arguments that follow the installation command when installing or uninstalling the application."})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"ExtractResult"}),(0,t.jsx)(e.td,{children:"Outcome of the PowerShell script downloading and extracting the Sysmon installer."})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"%Shellresult%"}),(0,t.jsx)(e.td,{children:"Outcome of the Sysmon installation command."})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Full Command"}),(0,t.jsx)(e.td,{children:"The full command being run to install/uninstall the application."})]})]})]}),"\n",(0,t.jsx)(e.h3,{id:"sysmon---uninstall",children:"Sysmon - Uninstall"}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"Name"}),(0,t.jsx)(e.th,{children:"Description"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Local File Location"}),(0,t.jsx)(e.td,{children:"The folder location of where the config file and the zip file will be downloaded."})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Sysmon File Name"}),(0,t.jsx)(e.td,{children:"The name of the Sysmon executable file (changes based on bitness)."})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Command Arguments"}),(0,t.jsx)(e.td,{children:"The arguments that follow the installation command when installing or uninstalling the application."})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Full Command"}),(0,t.jsx)(e.td,{children:"The full command being run to install/uninstall the application."})]})]})]}),"\n",(0,t.jsx)(e.h2,{id:"output",children:"Output"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Script log"}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(c,{...n})}):c(n)}},369762:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_1-2508ddeb06285e65b7abab523ce3655a.png"},225849:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_2-680124c50117925e42e503dcf644f6c6.png"},219600:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_3-2322b0bed146b67874532ca53f2494ae.png"},815471:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_4-5be2d59c32531ae4e86c467146dde280.png"},776454:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_5-661f4b5185c96382f2e751a9639a0825.png"},28453:(n,e,s)=>{s.d(e,{R:()=>o,x:()=>a});var i=s(296540);const t={},l=i.createContext(t);function o(n){const e=i.useContext(l);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:o(n.components),i.createElement(l.Provider,{value:e},n.children)}}}]);