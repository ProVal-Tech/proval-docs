"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[9728],{958249:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>d,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"cwrmm/tasks/41c0732d-0740-40d4-bd2f-98edd91cc559","title":"Set Windows Updates to Default","description":"This document provides a detailed guide on removing registry entries that may prevent Windows updates and restoring the default Windows Update settings to fully re-enable updates for users. It includes step-by-step instructions for task creation and implementation using a PowerShell script.","source":"@site/docs/cwrmm/tasks/Set Windows Updates to Default.md","sourceDirName":"cwrmm/tasks","slug":"/cwrmm/tasks/41c0732d-0740-40d4-bd2f-98edd91cc559","permalink":"/docs/cwrmm/tasks/41c0732d-0740-40d4-bd2f-98edd91cc559","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwrmm/tasks/Set Windows Updates to Default.md","tags":[{"inline":false,"label":"Registry","permalink":"/docs/tags/registry","description":"Documents concerning system registry management and troubleshooting"},{"inline":false,"label":"Software","permalink":"/docs/tags/software","description":"Documents related to software applications and their lifecycle management"},{"inline":false,"label":"Update","permalink":"/docs/tags/update","description":"Documents discussing software and system updates and their management"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"41c0732d-0740-40d4-bd2f-98edd91cc559","title":"Set Windows Updates to Default","title_meta":"Set Windows Updates to Default","keywords":["windows","updates","registry","default","settings"],"description":"This document provides a detailed guide on removing registry entries that may prevent Windows updates and restoring the default Windows Update settings to fully re-enable updates for users. It includes step-by-step instructions for task creation and implementation using a PowerShell script.","tags":["registry","software","update","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Set Windows Update Registry Values","permalink":"/docs/cwrmm/tasks/bd00b8d9-5f7f-449a-bf03-90a0ee610d3a"},"next":{"title":"Set-NetAdapterDNS","permalink":"/docs/cwrmm/tasks/7a02abe9-e98a-49d4-a164-d05d1e053e94"}}');var n=r(474848),i=r(28453);const o={id:"41c0732d-0740-40d4-bd2f-98edd91cc559",title:"Set Windows Updates to Default",title_meta:"Set Windows Updates to Default",keywords:["windows","updates","registry","default","settings"],description:"This document provides a detailed guide on removing registry entries that may prevent Windows updates and restoring the default Windows Update settings to fully re-enable updates for users. It includes step-by-step instructions for task creation and implementation using a PowerShell script.",tags:["registry","software","update","windows"],draft:!1,unlisted:!1},a=void 0,d={},c=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Task Creation",id:"task-creation",level:2},{value:"Task",id:"task",level:2},{value:"Row 1 Function: PowerShell Script",id:"row-1-function-powershell-script",level:3},{value:"Row 2: Function: Script Log",id:"row-2-function-script-log",level:3},{value:"Completed Task",id:"completed-task",level:2},{value:"Output",id:"output",level:2}];function l(e){const t={br:"br",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,n.jsx)(t.p,{children:"This task removes any registry entries that may be preventing Windows updates and restores the default Windows Update settings, fully re-enabling updates for the user."}),"\n",(0,n.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.img,{alt:"Sample Run Image 1",src:r(556447).A+"",width:"724",height:"450"}),(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.img,{alt:"Sample Run Image 2",src:r(960118).A+"",width:"901",height:"705"})]}),"\n",(0,n.jsx)(t.h2,{id:"task-creation",children:"Task Creation"}),"\n",(0,n.jsxs)(t.p,{children:["Create a new ",(0,n.jsx)(t.code,{children:"Script Editor"})," style script in the system to implement this task."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.img,{alt:"Task Creation Image 1",src:r(59945).A+"",width:"319",height:"673"}),(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.img,{alt:"Task Creation Image 2",src:r(605120).A+"",width:"485",height:"279"})]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Name:"})," Set Windows Updates to Default",(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.strong,{children:"Description:"})," This task removes all the possible registry entries that disable Windows Update on a machine.",(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.strong,{children:"Category:"})," Custom"]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Task Creation Image 3",src:r(383451).A+"",width:"510",height:"281"})}),"\n",(0,n.jsx)(t.h2,{id:"task",children:"Task"}),"\n",(0,n.jsxs)(t.p,{children:["Navigate to the Script Editor section and start by adding a row. You can do this by clicking the ",(0,n.jsx)(t.code,{children:"Add Row"})," button at the bottom of the script page."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Add Row Image",src:r(969234).A+"",width:"302",height:"292"})}),"\n",(0,n.jsx)(t.p,{children:"A blank function will appear."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Blank Function Image",src:r(498389).A+"",width:"1000",height:"237"})}),"\n",(0,n.jsx)(t.h3,{id:"row-1-function-powershell-script",children:"Row 1 Function: PowerShell Script"}),"\n",(0,n.jsxs)(t.p,{children:["Search and select the ",(0,n.jsx)(t.code,{children:"PowerShell Script"})," function."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"PowerShell Script Selection",src:r(129292).A+"",width:"1000",height:"242"})}),"\n",(0,n.jsx)(t.p,{children:"The following function will pop up on the screen:"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"PowerShell Function Popup",src:r(720350).A+"",width:"951",height:"597"})}),"\n",(0,n.jsxs)(t.p,{children:["Paste in the following PowerShell script and set the expected time of script execution to 600 seconds. Click the ",(0,n.jsx)(t.code,{children:"Save"})," button."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-powershell",children:"#region Strapper\r\n[Net.ServicePointManager]::SecurityProtocol = [Enum]::ToObject([Net.SecurityProtocolType], 3072)\r\nGet-PackageProvider -Name NuGet -ForceBootstrap | Out-Null\r\nSet-PSRepository -Name PSGallery -InstallationPolicy Trusted\r\ntry {\r\n    Update-Module -Name Strapper -ErrorAction Stop\r\n} catch {\r\n    Install-Module -Name Strapper -Repository PSGallery -SkipPublisherCheck -Force\r\n    Get-Module -Name Strapper -ListAvailable | Where-Object { $_.Version -ne (Get-InstalledModule -Name Strapper).Version } | ForEach-Object { Uninstall-Module -Name Strapper -MaximumVersion $_.Version }\r\n}\r\n(Import-Module -Name 'Strapper') 3>&1 2>&1 1>$null\r\nSet-StrapperEnvironment\r\n#endregion\r\n\r\n$failures = @()\r\n$properties = @(\r\n    'NoAutoUpdate',\r\n    'NoWindowsUpdate',\r\n    'DisableWindowsUpdateAccess',\r\n    'SetDisableUXWUAccess'\r\n)\r\n\r\n# For Computer and System account\r\n$pathArray = @(\r\n    'HKLM://Software//Policies//Microsoft//Windows//WindowsUpdate',\r\n    'HKLM://Software//Policies//Microsoft//Windows//WindowsUpdate//AU',\r\n    'HKLM://Software//Microsoft//Windows//CurrentVersion//Policies//WindowsUpdate',\r\n    'HKLM://Software//Microsoft//Windows//CurrentVersion//Policies//WindowsUpdate//AU',\r\n    'HKLM://SYSTEM//Internet Communication Management//Internet Communication',\r\n    'Registry::HKEY_USERS//S-1-5-18//Software//Policies//Microsoft//Windows//WindowsUpdate',\r\n    'Registry::HKEY_USERS//S-1-5-18//Software//Policies//Microsoft//Windows//WindowsUpdate//AU',\r\n    'Registry::HKEY_USERS//S-1-5-18//Software//Microsoft//Windows//CurrentVersion//Policies//WindowsUpdate',\r\n    'Registry::HKEY_USERS//S-1-5-18//Software//Microsoft//Windows//CurrentVersion//Policies//WindowsUpdate//AU'\r\n)\r\n\r\nforeach ($regPath in $pathArray) {\r\n    foreach ($property in $properties) {\r\n        if (Get-ItemProperty -Path $regPath -Name $property -ErrorAction SilentlyContinue) {\r\n            try {\r\n                Set-ItemProperty -Path $regPath -Name $property -Value 0 -Force -ErrorAction Stop\r\n            } catch {\r\n                $failure = [pscustomobject]@{\r\n                    RegistryPath = $regPath\r\n                    PropertyName = $property\r\n                    FailureMessage = \"Failed to set property: $($Error[0].Exception.Message)\"\r\n                }\r\n                $failures += $failure\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n# For User Account\r\n$pathArray = @(\r\n    'Software//Policies//Microsoft//Windows//WindowsUpdate',\r\n    'Software//Policies//Microsoft//Windows//WindowsUpdate//AU',\r\n    'Software//Microsoft//Windows//CurrentVersion//Policies//WindowsUpdate',\r\n    'Software//Microsoft//Windows//CurrentVersion//Policies//WindowsUpdate//AU',\r\n    'Software//Microsoft//Windows//CurrentVersion//Policies//Explorer'\r\n)\r\n\r\nforeach ($regPath in $pathArray) {\r\n    foreach ($property in $properties) {\r\n        if (Get-UserRegistryKeyProperty -Path $regPath -Name $property -ErrorAction SilentlyContinue) {\r\n            try {\r\n                Set-UserRegistryKeyProperty -Path $regPath -Name $property -Value 0 -Force -ErrorAction Stop\r\n            } catch {\r\n                $failure = [pscustomobject]@{\r\n                    RegistryPath = $regPath\r\n                    PropertyName = $property\r\n                    FailureMessage = \"Failed to set property: $($Error[0].Exception.Message)\"\r\n                }\r\n                $failures += $failure\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nif ($failures) {\r\n    throw ($failures | Out-String)\r\n} else {\r\n    return 'Success'\r\n}\n"})}),"\n",(0,n.jsx)(t.h3,{id:"row-2-function-script-log",children:"Row 2: Function: Script Log"}),"\n",(0,n.jsxs)(t.p,{children:["In the script log message, simply type ",(0,n.jsx)(t.code,{children:"%output%"})," so that the script will send the results of the PowerShell script above to the output on the Automation tab for the target device."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.img,{alt:"Script Log Image",src:r(896135).A+"",width:"1000",height:"121"}),(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.img,{alt:"Script Log Output",src:r(645452).A+"",width:"338",height:"272"})]}),"\n",(0,n.jsx)(t.h2,{id:"completed-task",children:"Completed Task"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Completed Task Image",src:r(557077).A+"",width:"971",height:"379"})}),"\n",(0,n.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Script Log"}),"\n"]})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},720350:(e,t,r)=>{r.d(t,{A:()=>s});const s=r.p+"assets/images/image_10-eb64abab1ad2853fc1d526a31b0b0ea0.png"},896135:(e,t,r)=>{r.d(t,{A:()=>s});const s=r.p+"assets/images/image_11-71331c55db40f840729c9fd55f99269e.png"},645452:(e,t,r)=>{r.d(t,{A:()=>s});const s=r.p+"assets/images/image_12-39c2357a125d769e7f35e934d2dd5e61.png"},557077:(e,t,r)=>{r.d(t,{A:()=>s});const s=r.p+"assets/images/image_13-36218b184ad2c5cc810153947be8c3c6.png"},556447:(e,t,r)=>{r.d(t,{A:()=>s});const s=r.p+"assets/images/image_2-a4c02dff7f9457b141c15a0828851ff9.png"},960118:(e,t,r)=>{r.d(t,{A:()=>s});const s=r.p+"assets/images/image_3-69e6b3d41e4b25778e34a20625c0edd9.png"},59945:(e,t,r)=>{r.d(t,{A:()=>s});const s=r.p+"assets/images/image_4-90a2d4880463c30ae83540ced3c30561.png"},605120:(e,t,r)=>{r.d(t,{A:()=>s});const s=r.p+"assets/images/image_5-69211544b73189ff8535050361ae8f20.png"},383451:(e,t,r)=>{r.d(t,{A:()=>s});const s=r.p+"assets/images/image_6-ae19143052e16e84cea604592b54de4f.png"},969234:(e,t,r)=>{r.d(t,{A:()=>s});const s=r.p+"assets/images/image_7-f9f7e1395f9d88161e6e54cf71936f32.png"},498389:(e,t,r)=>{r.d(t,{A:()=>s});const s=r.p+"assets/images/image_8-8ae4adc0439b09df626c3427b22db7f6.png"},129292:(e,t,r)=>{r.d(t,{A:()=>s});const s=r.p+"assets/images/image_9-9d42f657589671db9e7e2593ccf47cbb.png"},28453:(e,t,r)=>{r.d(t,{R:()=>o,x:()=>a});var s=r(296540);const n={},i=s.createContext(n);function o(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);