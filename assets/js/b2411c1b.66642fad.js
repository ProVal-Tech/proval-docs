"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[86419],{28106:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>d,contentTitle:()=>a,default:()=>u,frontMatter:()=>c,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"cwa/scripts/f60f4501-a2ea-43f0-87ee-99fc8ee15031","title":"Run Queued Scripts","description":"This document outlines a scheduled script designed to run every 3 days on the \\"Machines With Queued Scripts\\" group in ConnectWise Automate. It ensures that the script does not enter the \\"Fizzled\\" state by requeuing itself and retrieves stored data to execute scripts on target machines. The document includes dependencies, variables, user parameters, and a step-by-step process for the script execution.","source":"@site/docs/cwa/scripts/Run Queued Scripts.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/f60f4501-a2ea-43f0-87ee-99fc8ee15031","permalink":"/docs/cwa/scripts/f60f4501-a2ea-43f0-87ee-99fc8ee15031","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Run Queued Scripts.md","tags":[{"inline":false,"label":"ConnectWise","permalink":"/docs/tags/connectwise","description":"Documents on ConnectWise platforms for IT service management"}],"version":"current","frontMatter":{"id":"f60f4501-a2ea-43f0-87ee-99fc8ee15031","title":"Run Queued Scripts","title_meta":"Run Queued Scripts","keywords":["script","automation","queue","execution","connectwise"],"description":"This document outlines a scheduled script designed to run every 3 days on the \\"Machines With Queued Scripts\\" group in ConnectWise Automate. It ensures that the script does not enter the \\"Fizzled\\" state by requeuing itself and retrieves stored data to execute scripts on target machines. The document includes dependencies, variables, user parameters, and a step-by-step process for the script execution.","tags":["connectwise"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Role Definition - Change Param","permalink":"/docs/cwa/scripts/5c2faf09-3e8f-4dd0-978c-5863b443a3b9"},"next":{"title":"Run Script On Next Patching Schedule","permalink":"/docs/cwa/scripts/bab32968-8269-421b-a312-7b9bf30b8172"}}');var i=s(474848),n=s(28453);const c={id:"f60f4501-a2ea-43f0-87ee-99fc8ee15031",title:"Run Queued Scripts",title_meta:"Run Queued Scripts",keywords:["script","automation","queue","execution","connectwise"],description:'This document outlines a scheduled script designed to run every 3 days on the "Machines With Queued Scripts" group in ConnectWise Automate. It ensures that the script does not enter the "Fizzled" state by requeuing itself and retrieves stored data to execute scripts on target machines. The document includes dependencies, variables, user parameters, and a step-by-step process for the script execution.',tags:["connectwise"],draft:!1,unlisted:!1},a=void 0,d={},l=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Variables",id:"variables",level:2},{value:"User Parameters",id:"user-parameters",level:2},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2}];function o(e){const t={a:"a",h2:"h2",li:"li",ol:"ol",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsxs)(t.p,{children:["This script is scheduled to run every 3 days on the 'Machines With Queued Scripts' group by the ",(0,i.jsx)(t.a,{href:"/docs/cwa/scripts/c96624e1-038a-45ca-a6d0-645a629af721",children:"CWM - Automate - Script - Queue Script"})," script."]}),"\n",(0,i.jsx)(t.p,{children:"This script is designed to requeue itself every 3 days to ensure that it never enters the 'Fizzled' state."}),"\n",(0,i.jsxs)(t.p,{children:["The script retrieves stored data from the ",(0,i.jsx)(t.a,{href:"/docs/cwa/tables/a20befa8-ecca-4cf9-9d18-c4140f87aafc",children:"CWM - Automate - Custom Table - plugin_proval_queued_scripts"})," table and executes the stored instances of scripts on the target machine."]}),"\n",(0,i.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,i.jsx)(t.p,{children:"This script should not be run manually."}),"\n",(0,i.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/solutions/2910ca09-a0c7-4b44-8ea4-ef6e71304df8",children:"CWM - Automate - Solution - Queue Script Next Checkin"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/cwa/tables/a20befa8-ecca-4cf9-9d18-c4140f87aafc",children:"CWM - Automate - Custom Table - plugin_proval_queued_scripts"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/cwa/scripts/c96624e1-038a-45ca-a6d0-645a629af721",children:"CWM - Automate - Script - Queue Script"})}),"\n",(0,i.jsx)(t.li,{children:"'Machines With Queued Scripts' Group"}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"variables",children:"Variables"}),"\n",(0,i.jsx)(t.p,{children:"Document the various variables in the script. Delete any section that is not relevant to your script."}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Name"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"TableName"}),(0,i.jsx)(t.td,{children:"What the variable represents."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"sqlscriptId"}),(0,i.jsxs)(t.td,{children:["The script ID gathered from ",(0,i.jsx)(t.a,{href:"/docs/cwa/tables/a20befa8-ecca-4cf9-9d18-c4140f87aafc",children:"CWM - Automate - Custom Table - plugin_proval_queued_scripts"}),"."]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"sqlscriptparameters"}),(0,i.jsxs)(t.td,{children:["The parameters for the script ID to be called, gathered from ",(0,i.jsx)(t.a,{href:"/docs/cwa/tables/a20befa8-ecca-4cf9-9d18-c4140f87aafc",children:"CWM - Automate - Custom Table - plugin_proval_queued_scripts"}),"."]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"GroupID"}),(0,i.jsx)(t.td,{children:"The Group ID for the 'Machines With Queued Scripts' Group."})]})]})]}),"\n",(0,i.jsx)(t.h2,{id:"user-parameters",children:"User Parameters"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Name"}),(0,i.jsx)(t.th,{children:"Example"}),(0,i.jsx)(t.th,{children:"Required"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsx)(t.tbody,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Silent"}),(0,i.jsx)(t.td,{children:"Yes"}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:"When toggled to yes, the script will not utilize the scripting engine to run the selected scripts. Each script will be called with a Run Script command from this script. This means that you will not see the requested script in the scripts table or on the computer itself; however, any logging on the requested script will show up under the Run Queued Scripts entry in the target machine's script. The intention of this option is to provide a less intrusive method of executing the scripts. If you notice script engine slowdown or inflation, try this silent setting."})]})})]}),"\n",(0,i.jsx)(t.h2,{id:"process",children:"Process"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"Retrieve the target computer's queued scripts from the custom table."}),"\n",(0,i.jsx)(t.li,{children:"Iterate through every entry for that target, executing each script with its parameters either silently or openly, depending on the silent value."}),"\n",(0,i.jsx)(t.li,{children:"Remove the queued script from the table after it has been executed."}),"\n",(0,i.jsx)(t.li,{children:"Once all scripts are executed, remove the machine from the group."}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Script log"}),"\n"]})]})}function u(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>c,x:()=>a});var r=s(296540);const i={},n=r.createContext(i);function c(e){const t=r.useContext(n);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(n.Provider,{value:t},e.children)}}}]);