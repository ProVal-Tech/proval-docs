"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[23008],{953818:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>n,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"cwa/scripts/f7d7af7b-0b1e-463a-bda5-e9d30901e0b6","title":"Sophos - Disable Tamper Protection","description":"This document describes a script that reboots a Windows machine into safe mode and modifies the registry keys related to tamper protection for systems with Sophos Tamper Protection enabled, ultimately streamlining the process of disabling this feature.","source":"@site/docs/cwa/scripts/Sophos - Disable Tamper Protection.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/f7d7af7b-0b1e-463a-bda5-e9d30901e0b6","permalink":"/docs/cwa/scripts/f7d7af7b-0b1e-463a-bda5-e9d30901e0b6","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Sophos - Disable Tamper Protection.md","tags":[{"inline":false,"label":"Recovery","permalink":"/docs/tags/recovery","description":"Documents on data recovery and system restoration strategies"},{"inline":false,"label":"Security","permalink":"/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Setup","permalink":"/docs/tags/setup","description":"Documents on setting up software and hardware configurations"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"f7d7af7b-0b1e-463a-bda5-e9d30901e0b6","title":"Sophos - Disable Tamper Protection","title_meta":"Sophos - Disable Tamper Protection","keywords":["sophos","tamper","protection","reboot","safe","mode","registry"],"description":"This document describes a script that reboots a Windows machine into safe mode and modifies the registry keys related to tamper protection for systems with Sophos Tamper Protection enabled, ultimately streamlining the process of disabling this feature.","tags":["recovery","security","setup","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Soji - Disk Space Management","permalink":"/docs/cwa/scripts/47f53d1e-f609-46f8-b407-ccdf11eeede4"},"next":{"title":"Sophos Endpoint - Uninstaller","permalink":"/docs/cwa/scripts/d560e8b6-9195-4bc3-a89a-6939c984d47a"}}');var o=s(474848),r=s(28453);const a={id:"f7d7af7b-0b1e-463a-bda5-e9d30901e0b6",title:"Sophos - Disable Tamper Protection",title_meta:"Sophos - Disable Tamper Protection",keywords:["sophos","tamper","protection","reboot","safe","mode","registry"],description:"This document describes a script that reboots a Windows machine into safe mode and modifies the registry keys related to tamper protection for systems with Sophos Tamper Protection enabled, ultimately streamlining the process of disabling this feature.",tags:["recovery","security","setup","windows"],draft:!1,unlisted:!1},n=void 0,c={},l=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Variables",id:"variables",level:2},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2}];function d(e){const t={code:"code",h2:"h2",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,o.jsx)(t.p,{children:"This script will reboot a machine into safe mode and change the registry keys related to tamper protection for machines with Sophos Tamper Protection enabled."}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Time Saved by Automation:"})," 20 Minutes"]}),"\n",(0,o.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Sample Run",src:s(214606).A+"",width:"476",height:"346"})}),"\n",(0,o.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"The target machine must have Sophos installed."}),"\n",(0,o.jsx)(t.li,{children:"The target machine must be running a Windows operating system."}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"variables",children:"Variables"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.code,{children:"@Result@"})," - Used to verify if the tamper protection was disabled properly."]}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"process",children:"Process"}),"\n",(0,o.jsx)(t.p,{children:"The script will first verify that the target device has Sophos installed. It will then reboot the machine into safe mode and wait for the machine to come back up. The script will stop the Sophos services and change the appropriate registry keys to disable tamper protection. After that, it will restart the Sophos services and reboot the machine back to normal mode. Finally, the script will verify that tamper protection was properly disabled; if successful, it will exit with a success log message. If the script fails, it will exit with an error log message."}),"\n",(0,o.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,o.jsx)(t.p,{children:"Script log messages only."})]})}function p(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},214606:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_1-60520265905e33a33437173210c40b29.png"},28453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>n});var i=s(296540);const o={},r=i.createContext(o);function a(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function n(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);