"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[69284],{549934:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"cwa/scripts/830beb63-113a-406e-aef2-046403de9cb9","title":"CWM - Automate - ESXi - Snapshot Delete Param","description":"This document provides a comprehensive guide on using a PowerShell script to delete a snapshot of a machine hosted on an ESXi host server utilizing the PowerCLI module. It covers prerequisites, dependencies, user parameters, and alerting mechanisms for successful execution.","source":"@site/docs/cwa/scripts/CWM - Automate - ESXi - Snapshot Delete Param.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/830beb63-113a-406e-aef2-046403de9cb9","permalink":"/proval-docs/docs/cwa/scripts/830beb63-113a-406e-aef2-046403de9cb9","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/CWM - Automate - ESXi - Snapshot Delete Param.md","tags":[{"inline":false,"label":"Alerting","permalink":"/proval-docs/docs/tags/alerting","description":"Documents related to creating or managing alert systems and notifications"},{"inline":false,"label":"Email","permalink":"/proval-docs/docs/tags/email","description":"Documents about email systems and their management"},{"inline":false,"label":"ESXi","permalink":"/proval-docs/docs/tags/esxi","description":"Documents covering VMware ESXi hypervisor and virtualization solutions"},{"inline":false,"label":"Logging","permalink":"/proval-docs/docs/tags/logging","description":"Documents related to log management and analysis for systems"}],"version":"current","frontMatter":{"id":"830beb63-113a-406e-aef2-046403de9cb9","title":"CWM - Automate - ESXi - Snapshot Delete Param","title_meta":"CWM - Automate - ESXi - Snapshot Delete Param","keywords":["esxi","snapshot","delete","virtualmachine","automation"],"description":"This document provides a comprehensive guide on using a PowerShell script to delete a snapshot of a machine hosted on an ESXi host server utilizing the PowerCLI module. It covers prerequisites, dependencies, user parameters, and alerting mechanisms for successful execution.","tags":["alerting","email","esxi","logging"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"CWM - Automate - Data Collection - SonicWall NetExtender - Latest Version Winget","permalink":"/proval-docs/docs/cwa/scripts/5eca56c8-7035-41f7-b5d0-ef8d58bf532a"},"next":{"title":"CWM - Automate - RMM+ Plugin Configuration","permalink":"/proval-docs/docs/cwa/scripts/f99ddaae-0cb3-4941-b2aa-dc93671dd246"}}');var i=s(474848),n=s(28453);const a={id:"830beb63-113a-406e-aef2-046403de9cb9",title:"CWM - Automate - ESXi - Snapshot Delete Param",title_meta:"CWM - Automate - ESXi - Snapshot Delete Param",keywords:["esxi","snapshot","delete","virtualmachine","automation"],description:"This document provides a comprehensive guide on using a PowerShell script to delete a snapshot of a machine hosted on an ESXi host server utilizing the PowerCLI module. It covers prerequisites, dependencies, user parameters, and alerting mechanisms for successful execution.",tags:["alerting","email","esxi","logging"],draft:!1,unlisted:!1},o=void 0,l={},d=[{value:"Summary",id:"summary",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Variables",id:"variables",level:2},{value:"User Parameters",id:"user-parameters",level:3},{value:"Output",id:"output",level:2},{value:"Alerting",id:"alerting",level:2}];function c(e){const t={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsxs)(t.p,{children:["This script can be used to delete a snapshot of a machine hosted on an ESXi host server. It utilizes the ",(0,i.jsx)(t.a,{href:"https://www.powershellgallery.com/packages/VMware.PowerCLI/12.0.0.15947286",children:"PowerCLI Module"})," to perform the required action."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Note:"})," The script must be executed from a machine that can reach the ESXi Host."]}),"\n",(0,i.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:".NET Framework 4.7.2+ (Release: 461808)"}),"\n",(0,i.jsx)(t.li,{children:"PowerShell v5.1+"}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"Create a credential entry on the client's password tab to connect with the ESXi Host. It must be an admin/root-level credential."}),"\n",(0,i.jsxs)(t.li,{children:["Add either the public or private IP address of the ESXi Host in the URL section of the entry. Do not use HTTP or HTTPS along with the IP address.",(0,i.jsx)(t.br,{}),"\n","e.g.,",(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:"http://10.0.0.4/io"})," ==> Incorrect",(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:"10.0.0.4"})," ==> Correct"]}),"\n",(0,i.jsxs)(t.li,{children:["Sample Screenshot:",(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.img,{alt:"Sample Screenshot",src:s(729526).A+"",width:"1000",height:"674"})]}),"\n",(0,i.jsxs)(t.li,{children:["Add proper parameters while executing the script.",(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.img,{alt:"Parameters Screenshot",src:s(161293).A+"",width:"484",height:"510"}),(0,i.jsx)(t.br,{}),"\n","The ",(0,i.jsx)(t.code,{children:"Password_Title"})," should be the title of the password entry created in the first step. In the above example, the script will attempt to remove the snapshot ",(0,i.jsx)(t.code,{children:"SnapShot 12-12-1997"})," from the virtual machine ",(0,i.jsx)(t.code,{children:"Test VM 1"}),". It will not generate any alerts on failure."]}),"\n",(0,i.jsxs)(t.li,{children:["For alerting on failure:",(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.img,{alt:"Alerting Screenshot",src:s(498052).A+"",width:"493",height:"512"}),(0,i.jsx)(t.br,{}),"\n","In this example, the script will attempt to remove the snapshot ",(0,i.jsx)(t.code,{children:"SnapShot 12-12-1997"})," from the virtual machine ",(0,i.jsx)(t.code,{children:"Test VM 1"}),". Additionally, the script will create a ticket if it fails to deliver the desired results and will send a failure email to the user running/scheduling the script. Either or both of the alerting options can be used."]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.a,{href:"/proval-docs/docs/cwa/scripts/a2b7d882-f8a5-4273-b237-cabe1662f195",children:"CWM - Automate - Script - ESXi - Snapshot Create [Param]"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Note:"})," This script can be scheduled with proper parameters to remove the snapshot created by the ",(0,i.jsx)(t.a,{href:"/proval-docs/docs/cwa/scripts/a2b7d882-f8a5-4273-b237-cabe1662f195",children:"CWM - Automate - Script - ESXi - Snapshot Create [Param]"})," script after ",(0,i.jsx)(t.code,{children:"@Hours_To_Keep@"})," hours."]}),"\n",(0,i.jsx)(t.h2,{id:"variables",children:"Variables"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Name"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"ProjectName"}),(0,i.jsx)(t.td,{children:"ESXi_RemoveSnapshot"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"WorkingDirectory"}),(0,i.jsx)(t.td,{children:"C:/ProgramData/_automation/script/ESXi_RemoveSnapshot"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"ESXiHost"}),(0,i.jsx)(t.td,{children:"IP Address of ESXi Host, fetched from the password entry"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"UserName"}),(0,i.jsx)(t.td,{children:"UserName to use to connect with the ESXi Host, fetched from the password entry"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Password"}),(0,i.jsx)(t.td,{children:"Password to use to connect with the ESXi Host, fetched from the password entry"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"psout"}),(0,i.jsx)(t.td,{children:"Output of the PowerShell script deleting the Snapshot"})]})]})]}),"\n",(0,i.jsx)(t.h3,{id:"user-parameters",children:"User Parameters"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Name"}),(0,i.jsx)(t.th,{children:"Example"}),(0,i.jsx)(t.th,{children:"Required"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"SnapshotName"}),(0,i.jsx)(t.td,{children:"CW-Automate-Temp-Snapshot_20230501_081958"}),(0,i.jsx)(t.td,{children:"True"}),(0,i.jsx)(t.td,{children:"Name of the Snapshot to remove"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"VMName"}),(0,i.jsx)(t.td,{children:"DEV_Test-win10"}),(0,i.jsx)(t.td,{children:"True"}),(0,i.jsx)(t.td,{children:"Name of the virtual machine from which to remove the snapshot"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Password_Title"}),(0,i.jsx)(t.td,{children:"Esxi_Host"}),(0,i.jsx)(t.td,{children:"True"}),(0,i.jsx)(t.td,{children:"Title of the password entry to use to connect with the ESXi Host"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Ticket_On_Failure"}),(0,i.jsx)(t.td,{children:"1"}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:"1 to enable ticketing for the script's failure."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Email_On_Failure"}),(0,i.jsx)(t.td,{children:"1"}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:"1 to enable email alerts for the script's failure. The email will be sent to the user running/scheduling the script."})]})]})]}),"\n",(0,i.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Script Logs"}),"\n",(0,i.jsx)(t.li,{children:"Ticket (If Enabled)"}),"\n",(0,i.jsx)(t.li,{children:"Email to the user running the script (if Enabled)"}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"alerting",children:"Alerting"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Subject:"}),"  ",(0,i.jsx)(t.code,{children:"Snapshot deletion failed for the VM @VMName@"})]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Body:"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"For Prerequisites Validation Failure:"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"Automate failed to delete the Snapshot @SnapShotName@ from the virtual machine @VMName@.\r\nThe prerequisite check failed for %ComputerName%, and the `ESXi - SnapShot Delete [Param]` script cannot be executed against %ComputerName%.\r\nPlease execute the script against another machine in the network to delete the Snapshot.\r\nPrerequisite Validation Command Output: %ShellResult%\n"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"For Snapshot Deletion Failure:"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"Automate failed to delete the Snapshot @SnapShotName@ from the virtual machine @VMName@. Please review manually.\r\nPowerShell script result: @psout@\n"})})]})}function h(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},729526:(e,t,s)=>{s.d(t,{A:()=>r});const r=s.p+"assets/images/image_1-550d08d5f81b23b015a25b65760c32d6.png"},161293:(e,t,s)=>{s.d(t,{A:()=>r});const r=s.p+"assets/images/image_2-0c9989ad06ad2bf90f83bb8cd07e5cc1.png"},498052:(e,t,s)=>{s.d(t,{A:()=>r});const r=s.p+"assets/images/image_3-778e1f6631cb537806c80fc7441e3ebe.png"},28453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>o});var r=s(296540);const i={},n=r.createContext(i);function a(e){const t=r.useContext(n);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(n.Provider,{value:t},e.children)}}}]);