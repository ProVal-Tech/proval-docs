"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[76522],{756776:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"cwa/scripts/144d7d52-8764-4aa4-bcce-205c756f6203","title":"Remote Event Log Monitor - Create","description":"This document provides a detailed guide on creating a state-based event log monitor in ConnectWise Automate, including configuration, parameters, and sample runs. It addresses PowerShell-related issues and suggests best practices for alerting on specific events.","source":"@site/docs/cwa/scripts/Remote Event Log Monitor - Create.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/144d7d52-8764-4aa4-bcce-205c756f6203","permalink":"/proval-docs/docs/cwa/scripts/144d7d52-8764-4aa4-bcce-205c756f6203","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Remote Event Log Monitor - Create.md","tags":[{"inline":false,"label":"ConnectWise","permalink":"/proval-docs/docs/tags/connectwise","description":"Documents on ConnectWise platforms for IT service management"}],"version":"current","frontMatter":{"id":"144d7d52-8764-4aa4-bcce-205c756f6203","title":"Remote Event Log Monitor - Create","title_meta":"Remote Event Log Monitor - Create","keywords":["event","monitor","log","connectwise","automate","alert","configuration","remote","script"],"description":"This document provides a detailed guide on creating a state-based event log monitor in ConnectWise Automate, including configuration, parameters, and sample runs. It addresses PowerShell-related issues and suggests best practices for alerting on specific events.","tags":["connectwise"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Remind User of Reboot Needed Autofix","permalink":"/proval-docs/docs/cwa/scripts/72c57df5-f535-4d8e-9c04-6acde4c93aef"},"next":{"title":"Remote Monitor - Emulate Send Fail After Success","permalink":"/proval-docs/docs/cwa/scripts/70f5868c-7006-4393-afed-156fbae86ab5"}}');var i=n(474848),s=n(28453);const o={id:"144d7d52-8764-4aa4-bcce-205c756f6203",title:"Remote Event Log Monitor - Create",title_meta:"Remote Event Log Monitor - Create",keywords:["event","monitor","log","connectwise","automate","alert","configuration","remote","script"],description:"This document provides a detailed guide on creating a state-based event log monitor in ConnectWise Automate, including configuration, parameters, and sample runs. It addresses PowerShell-related issues and suggests best practices for alerting on specific events.",tags:["connectwise"],draft:!1,unlisted:!1},a=void 0,d={},l=[{value:"Summary",id:"summary",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Variables",id:"variables",level:2},{value:"User Parameters",id:"user-parameters",level:3},{value:"Output",id:"output",level:2},{value:"Sample Remote Monitors",id:"sample-remote-monitors",level:2},{value:"Multiple Monitors:",id:"multiple-monitors",level:3},{value:"Configuration Tab:",id:"configuration-tab",level:3},{value:"Example Warning:",id:"example-warning",level:3},{value:"Example Failed:",id:"example-failed",level:3},{value:"Example Success:",id:"example-success",level:3},{value:"Alerting Tab:",id:"alerting-tab",level:3},{value:"Example %RESULT%",id:"example-result",level:3}];function c(e){const t={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(t.p,{children:'This Automate Script will create a state-based event log monitor on the specifically requested group. By default, it will set these monitors to the "Default - Do Nothing" alert template, which needs to be modified to fit your desired result after creation.'}),"\n",(0,i.jsxs)(t.p,{children:["PowerShell-related issues are addressed in the WARNING state. It is suggested to use the ",(0,i.jsx)(t.a,{href:"/proval-docs/docs/cwa/scripts/63beba3c-f4a6-41a5-98e2-d4e4ce885035",children:"CWM - Automate - Script - Ticket Creation - Computer"})," script for ERROR state alerting, as the remote monitor truncates the message while creating a default ticket using the alert template."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Note:"})," You must review the properties of the event log to determine the name."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Event Log Monitor",src:n(936473).A+"",width:"1000",height:"474"})}),"\n",(0,i.jsx)(t.h2,{id:"requirements",children:"Requirements"}),"\n",(0,i.jsx)(t.p,{children:"This script will create the remote monitor on a group with the default settings being:"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"Do nothing"}),"\n",(0,i.jsx)(t.li,{children:"No error actions"}),"\n",(0,i.jsx)(t.li,{children:"No alert actions"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"If you desire a different end result, the monitor will need to be modified manually."}),"\n",(0,i.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Intended Target:"})," Any Computer (offline Computer Script)"]}),"\n",(0,i.jsx)(t.p,{children:"The following parameters will configure a remote monitor on group ID 1675, restricted to search ID 75:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Monitor Name:"})," Application - Event 7040 - Level Informational"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Monitor Schedule:"})," Every 84000 seconds"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:'The aforementioned monitor will be designed to scan for Informational events from the Application log, which contain an event ID of 7040, the message within the event log containing the phrase "The Start Type of," and generated over the last 86400 seconds.'}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Monitor Configuration",src:n(422466).A+"",width:"601",height:"638"})}),"\n",(0,i.jsx)(t.p,{children:"The following parameters will be utilized to configure a remote monitor on group ID 1675, restricted to search ID 75:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Monitor Name:"})," Application - Event 7040,7041 - Provider Service Control Manager"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Monitor Schedule:"})," Every 300 seconds"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"The aforementioned monitor will be designed to scan for all events from the Application log, which contain an event ID of 7040 or 7041, with the provider name of 'Service Control Manager,' and have generated at least three times over the last 300 seconds (Monitor's interval)."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Event Monitor",src:n(186123).A+"",width:"600",height:"637"})}),"\n",(0,i.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"/proval-docs/docs/powershell/ps-get-recenteventlog",children:"EPM - Data Collection - Agnostic - Script - Get-RecentEventLog"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.a,{href:"https://app.myglue.com/help_center/documents/9751473",children:"Documentation Link"})]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"variables",children:"Variables"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Name"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"GroupID_SearchID"}),(0,i.jsx)(t.td,{children:"Holds parsed GroupID and SearchID from the user parameters"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"GroupID"}),(0,i.jsx)(t.td,{children:"Holds the Group ID you specified"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"SearchID"}),(0,i.jsx)(t.td,{children:"Holds the Search ID you specified"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"CheckAction"}),(0,i.jsx)(t.td,{children:"Holds the check action to be taken on the remote monitor (File)"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"AlertAction"}),(0,i.jsx)(t.td,{children:"Holds the alert action to be taken on the remote monitor (Default is Default Do Nothing)"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"ProjectName"}),(0,i.jsx)(t.td,{children:"Get-RecentEventLog"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"WorkingDirectory"}),(0,i.jsx)(t.td,{children:"C://ProgramData//_automation//script//Get-RecentEventLog"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"PS1Path"}),(0,i.jsx)(t.td,{children:"C://ProgramData//_automation//script//Get-RecentEventLog//Get-RecentEventLog.ps1"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"AdditionalParams"}),(0,i.jsx)(t.td,{children:"Additional Parameters provided from the user parameters"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Interval"}),(0,i.jsx)(t.td,{children:"Run time interval of the monitor set in seconds"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"LogNameSwitch"}),(0,i.jsx)(t.td,{children:"Converts the desired LogName to a formatted LogName switch for the agnostic script"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"EventIDSwitch"}),(0,i.jsx)(t.td,{children:"Converts the desired event ID to a formatted event ID switch for the agnostic script"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"ProviderSwitch"}),(0,i.jsx)(t.td,{children:"Converts the desired ProviderName to a formatted provider name switch for the agnostic script"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Message"}),(0,i.jsx)(t.td,{children:"Message passed in the additional params user parameter with SQL-compatible modifications"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"MessageSwitch"}),(0,i.jsx)(t.td,{children:"Converts the desired message to a formatted Message switch for the agnostic script"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"LevelSwitch"}),(0,i.jsx)(t.td,{children:"Converts the desired Level to a formatted Level switch for the agnostic script"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"SecondsSwitch"}),(0,i.jsx)(t.td,{children:"Converts the desired Seconds to a formatted Seconds switch for the agnostic script"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"AdditionalParameters"}),(0,i.jsx)(t.td,{children:"Formatted Additional Parameters provided from the user parameters"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"GUID"}),(0,i.jsx)(t.td,{children:"GUID for the remote monitor"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"ComparisonString"}),(0,i.jsx)(t.td,{children:"Formatted conditions to be used within the remote monitor for NORMAL, WARNING, and FAILED states"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"ExecuteString"}),(0,i.jsx)(t.td,{children:"Command to be used within the remote monitor"})]})]})]}),"\n",(0,i.jsx)(t.h3,{id:"user-parameters",children:"User Parameters"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Name"}),(0,i.jsx)(t.th,{children:"Example"}),(0,i.jsx)(t.th,{children:"Required"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"LogName"}),(0,i.jsx)(t.td,{children:"Application"}),(0,i.jsx)(t.td,{children:"True"}),(0,i.jsx)(t.td,{children:"The event log sub-container you wish to query."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"EventID"}),(0,i.jsx)(t.td,{children:"7040"}),(0,i.jsx)(t.td,{children:"True"}),(0,i.jsx)(t.td,{children:"The event ID you wish to query for in the log selected."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"GroupID_SearchID"}),(0,i.jsx)(t.td,{children:"1675_75"}),(0,i.jsx)(t.td,{children:"True"}),(0,i.jsx)(t.td,{children:"The ID of the group you wish to create the monitor upon, and the search ID to limit it."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Interval"}),(0,i.jsx)(t.td,{children:"3600"}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:"Interval to run the monitor set. Leaving it blank or setting it lower than 60 will default it to 60."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"AdditionalParams"}),(0,i.jsx)(t.td,{children:"seconds=86400"}),(0,i.jsx)(t.td,{children:"Level=Informational"}),(0,i.jsx)(t.td,{children:"Message=The start type of"})]})]})]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Note:"})," Do not enclose the parameters in quotations."]}),"\n",(0,i.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Script log"}),"\n",(0,i.jsx)(t.li,{children:"Remote Monitor"}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"sample-remote-monitors",children:"Sample Remote Monitors"}),"\n",(0,i.jsx)(t.h3,{id:"multiple-monitors",children:"Multiple Monitors:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Multiple Monitors",src:n(894132).A+"",width:"1000",height:"188"})}),"\n",(0,i.jsx)(t.h3,{id:"configuration-tab",children:"Configuration Tab:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Configuration Tab",src:n(115261).A+"",width:"631",height:"1000"})}),"\n",(0,i.jsx)(t.h3,{id:"example-warning",children:"Example Warning:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Example Warning",src:n(531494).A+"",width:"619",height:"1000"})}),"\n",(0,i.jsx)(t.h3,{id:"example-failed",children:"Example Failed:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Example Failed",src:n(816591).A+"",width:"618",height:"1000"})}),"\n",(0,i.jsx)(t.h3,{id:"example-success",children:"Example Success:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Example Success",src:n(14936).A+"",width:"619",height:"1000"})}),"\n",(0,i.jsx)(t.h3,{id:"alerting-tab",children:"Alerting Tab:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Alerting Tab",src:n(287649).A+"",width:"620",height:"1000"})}),"\n",(0,i.jsx)(t.h3,{id:"example-result",children:"Example %RESULT%"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"ProviderName: Service Control Manager\r\nTimeCreated                            Id LevelDisplayName Message\r\n-----------                            -- ---------------- -------\r\n4/18/2023 9:53:50 AM               7040 Information      The start type of the Background Intelligent Transfer Service s...\r\n4/18/2023 9:44:28 AM               7040 Information      The start type of the Background Intelligent Transfer Service s...\r\n4/18/2023 9:40:19 AM               7040 Information      The start type of the Background Intelligent Transfer Service s...\r\n4/18/2023 9:37:56 AM               7040 Information      The start type of the Background Intelligent Transfer Service s...\r\n4/18/2023 9:35:50 AM               7040 Information      The start type of the Background Intelligent Transfer Service s...\r\n4/18/2023 9:23:01 AM               7040 Information      The start type of the Background Intelligent Transfer Service s...\r\n4/18/2023 9:18:12 AM               7040 Information      The start type of the Background Intelligent Transfer Service s...\r\n4/18/2023 9:06:48 AM               7040 Information      The start type of the Background Intelligent Transfer Service s...\r\n4/18/2023 9:01:58 AM               7040 Information      The start type of the Background Intelligent Transfer Service s...\n"})})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},936473:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/image_1-9a12a06f44a5931b500aaf6c1e6b0d90.png"},422466:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/image_2-e4a13f03182cfcb75676f43d4ecedd9e.png"},186123:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/image_3-a6d319218b6a926cf2aab09bec26364b.png"},894132:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/image_4-08dc55550d0fb01bfae489e9e2e9b6f3.png"},115261:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/image_5-4d76767d10b0b55445b1a24f119c178f.png"},531494:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/image_6-a11a5011bb565b054b656588fef8bf30.png"},816591:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/image_7-ca2efe6db93b6d1c45cf44ca1742c2cc.png"},14936:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/image_8-0bb16568f6283ae4137ad1c3dc3d6f44.png"},287649:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/image_9-a50a4246b51d5013f04297785c52b84a.png"},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var r=n(296540);const i={},s=r.createContext(i);function o(e){const t=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);