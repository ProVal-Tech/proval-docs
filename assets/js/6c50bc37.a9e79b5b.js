"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[58750],{503377:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>R,frontMatter:()=>i,metadata:()=>t,toc:()=>s});const t=JSON.parse('{"id":"cwa/monitors/92ad2db8-528e-4bce-8011-ed0e3563e335","title":"Import- NTLMv1.1 Detection","description":"This document outlines the steps required to apply a remote monitor to specific groups in ConnectWise Automate. It includes instructions for obtaining group IDs, modifying a SQL query, executing the query, and locating the remote monitor within the group settings.","source":"@site/docs/cwa/monitors/Import- NTLMv1.1 Detection.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/92ad2db8-528e-4bce-8011-ed0e3563e335","permalink":"/proval-docs/docs/cwa/monitors/92ad2db8-528e-4bce-8011-ed0e3563e335","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Import- NTLMv1.1 Detection.md","tags":[{"inline":false,"label":"ConnectWise","permalink":"/proval-docs/docs/tags/connectwise","description":"Documents on ConnectWise platforms for IT service management"},{"inline":false,"label":"Database","permalink":"/proval-docs/docs/tags/database","description":"Documents related to database management systems and operations"}],"version":"current","frontMatter":{"id":"92ad2db8-528e-4bce-8011-ed0e3563e335","title":"Import- NTLMv1.1 Detection","title_meta":"Import- NTLMv1.1 Detection","keywords":["remote","monitor","groupid","query","alert"],"description":"This document outlines the steps required to apply a remote monitor to specific groups in ConnectWise Automate. It includes instructions for obtaining group IDs, modifying a SQL query, executing the query, and locating the remote monitor within the group settings.","tags":["connectwise","database"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Import- Memory Threshold Violation Monitor","permalink":"/proval-docs/docs/cwa/monitors/b630e3e4-3268-42ae-a8e6-c9228968f5cc"},"next":{"title":"Import- Security event logs cleareddeleted","permalink":"/proval-docs/docs/cwa/monitors/5e1d98fb-913a-4384-9674-653c57bf610b"}}');var o=r(474848),a=r(28453);const i={id:"92ad2db8-528e-4bce-8011-ed0e3563e335",title:"Import- NTLMv1.1 Detection",title_meta:"Import- NTLMv1.1 Detection",keywords:["remote","monitor","groupid","query","alert"],description:"This document outlines the steps required to apply a remote monitor to specific groups in ConnectWise Automate. It includes instructions for obtaining group IDs, modifying a SQL query, executing the query, and locating the remote monitor within the group settings.",tags:["connectwise","database"],draft:!1,unlisted:!1},c=void 0,d={},s=[{value:"Steps to Apply Remote Monitor",id:"steps-to-apply-remote-monitor",level:2},{value:"1.",id:"1",level:3},{value:"2.",id:"2",level:3},{value:"3.",id:"3",level:3},{value:"4.",id:"4",level:3},{value:"5.",id:"5",level:3}];function S(e){const n={br:"br",code:"code",em:"em",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h2,{id:"steps-to-apply-remote-monitor",children:"Steps to Apply Remote Monitor"}),"\n",(0,o.jsx)(n.h3,{id:"1",children:"1."}),"\n",(0,o.jsx)(n.p,{children:"Obtain the group ID(s) of the group(s) to which the remote monitor should be applied."}),"\n",(0,o.jsx)(n.h3,{id:"2",children:"2."}),"\n",(0,o.jsxs)(n.p,{children:["Copy the following query and replace ",(0,o.jsx)(n.strong,{children:"YOUR COMMA SEPARATED LIST OF GROUPID(S)"})," with the Group ID(s) of the relevant groups:",(0,o.jsx)(n.br,{}),"\n",(0,o.jsxs)(n.em,{children:["(The string to replace can be found at the very bottom of the query, right after ",(0,o.jsx)(n.strong,{children:"WHERE"}),")"]})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"INSERT INTO groupagents \r\nSELECT '' AS `AgentID`,\r\n`groupid` AS `GroupID`,\r\n'0' AS `SearchID`,\r\n'Proval - Production - NTLMv1.1 Detection' AS `Name`,\r\n'6' AS `CheckAction`,\r\n'1' AS `AlertAction`,\r\n'NTLMv1.1 is enabled on %COMPUTERNAME% at %CLIENTNAME~~~NTLMv1.1 is disabled on %COMPUTERNAME% at %CLIENTNAME!!!NTLMv1.1 is enabled on %COMPUTERNAME% at %CLIENTNAME~~~NTLMv1.1 found to be enabled on %COMPUTERNAME% at %CLIENTNAME' AS `AlertMessage`,\r\n'0' AS `ContactID`,\r\n'900' AS `interval`,\r\n'127.0.0.1' AS `Where`,\r\n'7' AS `What`,\r\n'C://Windows//System32//WindowsPowerShell//v1.0//powershell.exe -ExecutionPolicy Bypass -Command \\\"$US = (Get-itemproperty -Path HKLM://SYSTEM//CurrentControlSet//control//Lsa,HKLM://SYSTEM//CurrentControlSet//services//Lsa -ErrorAction SilentlyContinue);if($US) { foreach ($U in $US){if ($u.LmCompatibilityLevel -ne 5){return /'Enabled/'}}} else {return /'Enabled/'}\\\"' AS `DataOut`,\r\n'16' AS `Comparor`,\r\n'10|^(()%7C %7C(OK)%7C(//r//n))$|11|(^(()%7C %7C(OK)%7C(//r//n))$)%7C(Enabled)|10|(Enabled)' AS `DataIn`,\r\n'' AS `IDField`,\r\n'1' AS `AlertStyle`,\r\n'0' AS `ScriptID`,\r\n'' AS `datacollector`,\r\n'21' AS `Category`,\r\n'0' AS `TicketCategory`,\r\n'1' AS `ScriptTarget`,\r\nCONCAT(\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1)\r\n) AS `GUID`,\r\n'root' AS `UpdatedBy`,\r\n(NOW()) AS `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (YOUR COMMA SEPARATED LIST OF GROUPID(S))\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'Proval - Production - NTLMv1.1 Detection')\n"})}),"\n",(0,o.jsx)(n.h3,{id:"3",children:"3."}),"\n",(0,o.jsx)(n.p,{children:"An example of a query with a group ID:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"INSERT INTO groupagents \r\nSELECT '' AS `AgentID`,\r\n`groupid` AS `GroupID`,\r\n'0' AS `SearchID`,\r\n'Proval - Production - NTLMv1.1 Detection' AS `Name`,\r\n'6' AS `CheckAction`,\r\n'1' AS `AlertAction`,\r\n'NTLMv1.1 is enabled on %COMPUTERNAME% at %CLIENTNAME~~~NTLMv1.1 is disabled on %COMPUTERNAME% at %CLIENTNAME!!!NTLMv1.1 is enabled on %COMPUTERNAME% at %CLIENTNAME~~~NTLMv1.1 found to be enabled on %COMPUTERNAME% at %CLIENTNAME' AS `AlertMessage`,\r\n'0' AS `ContactID`,\r\n'900' AS `interval`,\r\n'127.0.0.1' AS `Where`,\r\n'7' AS `What`,\r\n'C://Windows//System32//WindowsPowerShell//v1.0//powershell.exe -ExecutionPolicy Bypass -Command \\\"$US = (Get-itemproperty -Path HKLM://SYSTEM//CurrentControlSet//control//Lsa,HKLM://SYSTEM//CurrentControlSet//services//Lsa -ErrorAction SilentlyContinue);if($US) { foreach ($U in $US){if ($u.LmCompatibilityLevel -ne 5){return /'Enabled/'}}} else {return /'Enabled/'}\\\"' AS `DataOut`,\r\n'16' AS `Comparor`,\r\n'10|^(()%7C %7C(OK)%7C(//r//n))$|11|(^(()%7C %7C(OK)%7C(//r//n))$)%7C(Enabled)|10|(Enabled)' AS `DataIn`,\r\n'' AS `IDField`,\r\n'1' AS `AlertStyle`,\r\n'0' AS `ScriptID`,\r\n'' AS `datacollector`,\r\n'21' AS `Category`,\r\n'0' AS `TicketCategory`,\r\n'1' AS `ScriptTarget`,\r\nCONCAT(\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1)\r\n) AS `GUID`,\r\n'root' AS `UpdatedBy`,\r\n(NOW()) AS `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (2,3,855,856)\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'Proval - Production - NTLMv1.1 Detection')\n"})}),"\n",(0,o.jsx)(n.h3,{id:"4",children:"4."}),"\n",(0,o.jsx)(n.p,{children:"Now execute your query from a RAWSQL monitor set."}),"\n",(0,o.jsx)(n.h3,{id:"5",children:"5."}),"\n",(0,o.jsxs)(n.p,{children:["Locate your remote monitor by opening the group(s) remote monitors tab.",(0,o.jsx)(n.br,{}),"\n",(0,o.jsx)(n.strong,{children:"DO NOT"})," apply any alert template to this monitor set."]})]})}function R(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(S,{...e})}):S(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>c});var t=r(296540);const o={},a=t.createContext(o);function i(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);