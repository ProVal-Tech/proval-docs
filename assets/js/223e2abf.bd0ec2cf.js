"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[76300],{748831:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"cwa/scripts/bddbb8dc-ff4c-499a-ab96-36714847f50d","title":"Hyper-V - Toggle Guest VMs","description":"This document provides a detailed overview of a script designed to start and stop virtual machines on a Hyper-V system. It includes parameters for lead time, error handling, and logging, ensuring smooth operation and management of VMs.","source":"@site/docs/cwa/scripts/Hyper-V - Toggle Guest VMs.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/bddbb8dc-ff4c-499a-ab96-36714847f50d","permalink":"/proval-docs/docs/cwa/scripts/bddbb8dc-ff4c-499a-ab96-36714847f50d","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Hyper-V - Toggle Guest VMs.md","tags":[{"inline":false,"label":"DNS","permalink":"/proval-docs/docs/tags/dns","description":"Documents focused on Domain Name System management and configuration"},{"inline":false,"label":"Hyper-V","permalink":"/proval-docs/docs/tags/hyper-v","description":"Documents on Microsoft Hyper-V virtualization and management"}],"version":"current","frontMatter":{"id":"bddbb8dc-ff4c-499a-ab96-36714847f50d","title":"Hyper-V - Toggle Guest VMs","title_meta":"Hyper-V - Toggle Guest VMs","keywords":["hyper-v","vm","automation","dns","shutdown","startup"],"description":"This document provides a detailed overview of a script designed to start and stop virtual machines on a Hyper-V system. It includes parameters for lead time, error handling, and logging, ensuring smooth operation and management of VMs.","tags":["dns","hyper-v"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Hyper-V - Guest VMs - StartStop","permalink":"/proval-docs/docs/cwa/scripts/52d001b4-7152-4616-92de-99a002e2d22c"},"next":{"title":"IISCrypto - Best Practices - SWEET32 Vulnerability Remediation Param","permalink":"/proval-docs/docs/cwa/scripts/10317de1-b363-4be0-a117-3c4553f44457"}}');var r=s(474848),i=s(28453);const o={id:"bddbb8dc-ff4c-499a-ab96-36714847f50d",title:"Hyper-V - Toggle Guest VMs",title_meta:"Hyper-V - Toggle Guest VMs",keywords:["hyper-v","vm","automation","dns","shutdown","startup"],description:"This document provides a detailed overview of a script designed to start and stop virtual machines on a Hyper-V system. It includes parameters for lead time, error handling, and logging, ensuring smooth operation and management of VMs.",tags:["dns","hyper-v"],draft:!1,unlisted:!1},a=void 0,d={},l=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Variables",id:"variables",level:2},{value:"User Parameters",id:"user-parameters",level:4},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2}];function c(e){const t={a:"a",code:"code",h2:"h2",h4:"h4",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsxs)(t.p,{children:["This script starts or stops a VM on a Hyper-V system. There is an optional parameter (",(0,r.jsx)(t.code,{children:"-LeadTime"}),") to determine the number of seconds to wait for the VM to start or stop, respectively."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Time Saved by Automation:"})," 5 Minutes"]}),"\n",(0,r.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Sample Run",src:s(506577).A+"",width:"479",height:"397"})}),"\n",(0,r.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://proval.itglue.com/DOC-5078775-7410870",children:"Toggle-VMGuests"})}),"\n",(0,r.jsx)(t.li,{children:"Only works on Hyper-V hosts (the role must be detected)"}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"variables",children:"Variables"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"@PS1Path@"})," -> Location of the PowerShell script"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"@PS1Log@"})," -> Location of the log output file"]}),"\n"]}),"\n",(0,r.jsx)(t.h4,{id:"user-parameters",children:"User Parameters"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Parameter"}),(0,r.jsx)(t.th,{children:"Alias"}),(0,r.jsx)(t.th,{children:"Required"}),(0,r.jsx)(t.th,{children:"Default"}),(0,r.jsx)(t.th,{children:"Type"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"Action"})}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{children:"True"}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{children:"String"}),(0,r.jsxs)(t.td,{children:["The action for the script to take. Limited to ",(0,r.jsx)(t.code,{children:'\\"Start\\"'})," and ",(0,r.jsx)(t.code,{children:'\\"Stop\\"'}),"."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"LeadTime"})}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{children:"False"}),(0,r.jsx)(t.td,{children:"300"}),(0,r.jsx)(t.td,{children:"Int"}),(0,r.jsx)(t.td,{children:"The number of seconds to wait for each VM before moving to the next or aborting."})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"process",children:"Process"}),"\n",(0,r.jsxs)(t.p,{children:["The script takes a mandatory parameter (",(0,r.jsx)(t.code,{children:"-Action"}),") to determine if it is going to start or stop VMs. There is an optional parameter (",(0,r.jsx)(t.code,{children:"-LeadTime"}),") to determine the number of seconds to wait for the VM to start or stop, respectively."]}),"\n",(0,r.jsx)(t.p,{children:"If stopping VMs, a SRV record DNS lookup is used to determine if any of the VMs are domain controllers. If any DCs are found, they will be shut down last. The process then begins, and the VMs shut down one at a time. If any VM fails to gracefully shut down, the process will be aborted, and all VMs will be brought back online. An error log is written in this case. A final offline check will be performed, and the process will be aborted, with all VMs booted back up, and an error log written if any VM is found to be online. If all VMs are shut down successfully, then XML files of the VM objects will be written for future processing: one file for found domain controllers and one file for all other VMs."}),"\n",(0,r.jsx)(t.p,{children:"If starting, the files generated by the stop process will be parsed to determine the VMs to start up. If no files exist, the script will exit. Any domain controllers will be booted first. If any VM fails to start within the startup threshold, an error log will be written, and the process will continue. Each VM will be given lead time before attempting to boot the next VM to ensure time to begin the boot process."}),"\n",(0,r.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Script log"}),"\n",(0,r.jsx)(t.li,{children:"Local file on the computer"}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},506577:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_1-fc53c384caaa5e79c440f55c8d2d5d9f.png"},28453:(e,t,s)=>{s.d(t,{R:()=>o,x:()=>a});var n=s(296540);const r={},i=n.createContext(r);function o(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);