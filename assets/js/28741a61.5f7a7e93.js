"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[70533],{275682:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"cwa/dataviews/388b4b61-34b7-4d40-b4de-507032df83d7","title":"PowerShell Version Audit","description":"This document provides a dataview that shows the current PowerShell versions installed on agents, along with details such as client name, location, operating system, and last contact information. It also includes SQL representation for querying this data.","source":"@site/docs/cwa/dataviews/PowerShell Version Audit.md","sourceDirName":"cwa/dataviews","slug":"/cwa/dataviews/388b4b61-34b7-4d40-b4de-507032df83d7","permalink":"/docs/cwa/dataviews/388b4b61-34b7-4d40-b4de-507032df83d7","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/dataviews/PowerShell Version Audit.md","tags":[{"inline":false,"label":"Database","permalink":"/docs/tags/database","description":"Documents related to database management systems and operations"}],"version":"current","frontMatter":{"id":"388b4b61-34b7-4d40-b4de-507032df83d7","title":"PowerShell Version Audit","title_meta":"PowerShell Version Audit","keywords":["agent","powershell","version","audit","rmm"],"description":"This document provides a dataview that shows the current PowerShell versions installed on agents, along with details such as client name, location, operating system, and last contact information. It also includes SQL representation for querying this data.","tags":["database"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"PowerShell Version Audit Role","permalink":"/docs/cwa/dataviews/9da26821-e8e6-44b4-9310-2495aebd0396"},"next":{"title":"PrintNightMare Detection","permalink":"/docs/cwa/dataviews/f016ea11-da3b-4834-a5f0-3a55e3e3ad53"}}');var r=n(474848),i=n(28453);const a={id:"388b4b61-34b7-4d40-b4de-507032df83d7",title:"PowerShell Version Audit",title_meta:"PowerShell Version Audit",keywords:["agent","powershell","version","audit","rmm"],description:"This document provides a dataview that shows the current PowerShell versions installed on agents, along with details such as client name, location, operating system, and last contact information. It also includes SQL representation for querying this data.",tags:["database"],draft:!1,unlisted:!1},o=void 0,d={},l=[{value:"Summary",id:"summary",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Columns",id:"columns",level:2},{value:"SQL Representation",id:"sql-representation",level:2}];function c(e){const t={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(t.p,{children:"This dataview shows the current agent PowerShell versions."}),"\n",(0,r.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.a,{href:"https://proval.itglue.com/DOC-5078775-10218295",children:"PowerShell Version Audit"})}),"\n",(0,r.jsx)(t.h2,{id:"columns",children:"Columns"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Column"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Client"}),(0,r.jsx)(t.td,{children:"Client name of the agent"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Location"}),(0,r.jsx)(t.td,{children:"Location name of the agent"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Computer"}),(0,r.jsx)(t.td,{children:"Computer name of the agent"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Operating System"}),(0,r.jsx)(t.td,{children:"Operating system of the agent"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Last Contact"}),(0,r.jsx)(t.td,{children:"Last contact of the agent with the RMM"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"PowerShell Version"}),(0,r.jsx)(t.td,{children:"PowerShell version on the agent"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Script Run Time"}),(0,r.jsx)(t.td,{children:"The last date when the PowerShell version was checked"})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"sql-representation",children:"SQL Representation"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sql",children:"SELECT \r\n  c.clientid, \r\n  c.locationid, \r\n  c.computerid, \r\n  cl.name AS `Client`, \r\n  l.name AS `Location`, \r\n  c.name AS `Computer`, \r\n  c.os AS `Operating System`, \r\n  c.LastContact, \r\n  TRIM(\r\n    SUBSTRING_INDEX(ss.value, '--', 1)\r\n  ) AS `Script Run Time`, \r\n  CASE WHEN TRIM(\r\n    SUBSTRING_INDEX(\r\n      SUBSTRING_INDEX(ss.value, '--', 2), \r\n      '--', \r\n      -1\r\n    )\r\n  ) = ' ' THEN 'Not Detected' ELSE TRIM(\r\n    SUBSTRING_INDEX(\r\n      SUBSTRING_INDEX(ss.value, '--', 2), \r\n      '--', \r\n      -1\r\n    )\r\n  ) END AS `PowerShell Version`\r\nFROM \r\n  computers c \r\n  LEFT JOIN clients cl ON cl.clientid = c.clientid \r\n  LEFT JOIN locations l ON l.locationid = c.locationid \r\n  LEFT JOIN scriptstate ss ON ss.computerid = c.computerid \r\nWHERE \r\n  ss.variable = 'PowershellVersion'\n"})})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>o});var s=n(296540);const r={},i=s.createContext(r);function a(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);