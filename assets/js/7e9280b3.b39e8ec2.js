"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[68879],{32025:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"cwrmm/tasks/296c457d-66d6-4de8-af91-4667c2321e12","title":"Internet Speed - Audit","description":"This document provides a comprehensive guide on how to run an internet speed test using the Ookla SpeedTest CLI application. It includes sample runs, dependencies, task creation steps, and detailed instructions on implementing the script in a system.","source":"@site/docs/cwrmm/tasks/Internet Speed - Audit.md","sourceDirName":"cwrmm/tasks","slug":"/cwrmm/tasks/296c457d-66d6-4de8-af91-4667c2321e12","permalink":"/proval-docs/docs/cwrmm/tasks/296c457d-66d6-4de8-af91-4667c2321e12","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwrmm/tasks/Internet Speed - Audit.md","tags":[{"inline":false,"label":"Networking","permalink":"/proval-docs/docs/tags/networking","description":"Documents related to network infrastructure and management practices"},{"inline":false,"label":"Performance","permalink":"/proval-docs/docs/tags/performance","description":"Documents related to enhancing system and application performance"},{"inline":false,"label":"Setup","permalink":"/proval-docs/docs/tags/setup","description":"Documents on setting up software and hardware configurations"}],"version":"current","frontMatter":{"id":"296c457d-66d6-4de8-af91-4667c2321e12","title":"Internet Speed - Audit","title_meta":"Internet Speed - Audit","keywords":["internet","speed","test","ookla","cli"],"description":"This document provides a comprehensive guide on how to run an internet speed test using the Ookla SpeedTest CLI application. It includes sample runs, dependencies, task creation steps, and detailed instructions on implementing the script in a system.","tags":["networking","performance","setup"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Install Windows 11","permalink":"/proval-docs/docs/cwrmm/tasks/50d6c9a0-11d6-4d2f-bbc3-47411502448e"},"next":{"title":"KRBTGT Account - Reset Keys","permalink":"/proval-docs/docs/cwrmm/tasks/6933151f-2a80-4b27-97dc-046c555a137c"}}');var r=n(474848),i=n(28453);const o={id:"296c457d-66d6-4de8-af91-4667c2321e12",title:"Internet Speed - Audit",title_meta:"Internet Speed - Audit",keywords:["internet","speed","test","ookla","cli"],description:"This document provides a comprehensive guide on how to run an internet speed test using the Ookla SpeedTest CLI application. It includes sample runs, dependencies, task creation steps, and detailed instructions on implementing the script in a system.",tags:["networking","performance","setup"],draft:!1,unlisted:!1},a=void 0,c={},d=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Task Creation",id:"task-creation",level:2},{value:"Task",id:"task",level:2},{value:"Row 1 Function: PowerShell Script",id:"row-1-function-powershell-script",level:3},{value:"Row 2: Function: Script Log",id:"row-2-function-script-log",level:3},{value:"Completed Task",id:"completed-task",level:2},{value:"Output",id:"output",level:2}];function l(e){const t={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(t.p,{children:"This document describes how to run an internet speed test using the Ookla SpeedTest CLI application."}),"\n",(0,r.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Sample Run 1",src:n(115108).A+"",width:"721",height:"460"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Sample Run 2",src:n(451967).A+"",width:"894",height:"710"})}),"\n",(0,r.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.a,{href:"https://file.provaltech.com/repo/script/Test-InternetSpeed.ps1",children:"Download Test-InternetSpeed.ps1"})}),"\n",(0,r.jsx)(t.h2,{id:"task-creation",children:"Task Creation"}),"\n",(0,r.jsxs)(t.p,{children:["Create a new ",(0,r.jsx)(t.code,{children:"Script Editor"})," style script in the system to implement this task."]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Task Creation",src:n(555030).A+"",width:"319",height:"673"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Task Creation Step 2",src:n(32337).A+"",width:"485",height:"279"})}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Name:"})," Internet Speed - Audit",(0,r.jsx)(t.br,{}),"\n",(0,r.jsx)(t.strong,{children:"Description:"})," Runs an internet speed test via the Ookla SpeedTest CLI application.",(0,r.jsx)(t.br,{}),"\n",(0,r.jsx)(t.strong,{children:"Category:"})," Custom"]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Task Creation Step 3",src:n(522120).A+"",width:"586",height:"284"})}),"\n",(0,r.jsx)(t.h2,{id:"task",children:"Task"}),"\n",(0,r.jsxs)(t.p,{children:["Navigate to the Script Editor section and start by adding a row. You can do this by clicking the ",(0,r.jsx)(t.code,{children:"Add Row"})," button at the bottom of the script page."]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Add Row",src:n(618658).A+"",width:"302",height:"292"})}),"\n",(0,r.jsx)(t.p,{children:"A blank function will appear."}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Blank Function",src:n(509163).A+"",width:"1000",height:"237"})}),"\n",(0,r.jsx)(t.h3,{id:"row-1-function-powershell-script",children:"Row 1 Function: PowerShell Script"}),"\n",(0,r.jsxs)(t.p,{children:["Search and select the ",(0,r.jsx)(t.code,{children:"PowerShell Script"})," function."]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Select PowerShell Script",src:n(595344).A+"",width:"1000",height:"242"})}),"\n",(0,r.jsx)(t.p,{children:"The following function will pop up on the screen:"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"PowerShell Function",src:n(601593).A+"",width:"951",height:"597"})}),"\n",(0,r.jsxs)(t.p,{children:["Paste in the following PowerShell script and set the expected time of script execution to ",(0,r.jsx)(t.code,{children:"600"})," seconds. Click the ",(0,r.jsx)(t.code,{children:"Save"})," button."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:'#region Setup - Variables\r\n$ProjectName = \'Test-InternetSpeed\'\r\n[Net.ServicePointManager]::SecurityProtocol = [enum]::ToObject([Net.SecurityProtocolType], 3072)\r\n$BaseURL = \'https://file.provaltech.com/repo\'\r\n$PS1URL = "$BaseURL/script/$ProjectName.ps1"\r\n$WorkingDirectory = "C:/ProgramData/_automation/script/$ProjectName"\r\n$PS1Path = "$WorkingDirectory/$ProjectName.ps1"\r\n$Workingpath = $WorkingDirectory\r\n$LogPath = "$WorkingDirectory/$ProjectName-log.txt"\r\n$ErrorLogPath = "$WorkingDirectory/$ProjectName-Error.txt"\r\n#endregion\r\n#region Setup - Folder Structure\r\nNew-Item -Path $WorkingDirectory -ItemType Directory -ErrorAction SilentlyContinue | Out-Null\r\n$response = Invoke-WebRequest -Uri $PS1URL -UseBasicParsing\r\nif (($response.StatusCode -ne 200) -and (!(Test-Path -Path $PS1Path))) {\r\n    throw "No pre-downloaded script exists and the script \'$PS1URL\' failed to download. Exiting."\r\n} elseif ($response.StatusCode -eq 200) {\r\n    Remove-Item -Path $PS1Path -ErrorAction SilentlyContinue\r\n    [System.IO.File]::WriteAllLines($PS1Path, $response.Content)\r\n}\r\nif (!(Test-Path -Path $PS1Path)) {\r\n    throw \'An error occurred and the script was unable to be downloaded. Exiting.\'\r\n}\n'})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"$result = & $PS1Path 2>$null 6>$null\r\nif($result.DownloadMbps) {\r\n    return \"(\r\n    '$([DateTime]::Parse($result.timestamp).ToString('yyyy-MM-dd HH:mm:ss'))',\r\n    $($result.ping.jitter),\r\n    $($result.ping.latency),\r\n    $($result.download.bandwidth),\r\n    $($result.download.bytes),\r\n    $($result.download.elapsed),\r\n    $($result.upload.bandwidth),\r\n    $($result.upload.bytes),\r\n    $($result.upload.elapsed),\r\n    $(if($result.packetloss) {$result.packetloss} else {0}),\r\n    '$($result.isp)',\r\n    '$($result.interface.internalIp)',\r\n    '$($result.interface.macAddr)',\r\n    $([int][bool]$result.interface.isVpn),\r\n    '$($result.interface.externalIp)',\r\n    '$($result.server.host)',\r\n    '$($result.server.name)',\r\n    '$($result.server.location)',\r\n    '$($result.server.country)',\r\n    '$($result.server.ip)',\r\n    '$($result.result.id)',\r\n    '$($result.result.url)',\r\n    $($result.downloadMbps),\r\n    $($result.uploadMbps)\r\n    )\"\r\n}\n"})}),"\n",(0,r.jsx)(t.h3,{id:"row-2-function-script-log",children:"Row 2: Function: Script Log"}),"\n",(0,r.jsxs)(t.p,{children:["In the script log message, simply type ",(0,r.jsx)(t.code,{children:"%output%"})," so that the script will send the results of the PowerShell script above to the output on the Automation tab for the target device."]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Script Log",src:n(999174).A+"",width:"338",height:"272"})}),"\n",(0,r.jsx)(t.h2,{id:"completed-task",children:"Completed Task"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Completed Task",src:n(580719).A+"",width:"971",height:"379"})}),"\n",(0,r.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Script Log"}),"\n"]})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},618658:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/image_10-f9f7e1395f9d88161e6e54cf71936f32.png"},509163:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/image_11-8ae4adc0439b09df626c3427b22db7f6.png"},595344:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/image_12-9d42f657589671db9e7e2593ccf47cbb.png"},601593:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/image_13-eb64abab1ad2853fc1d526a31b0b0ea0.png"},999174:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/image_14-39c2357a125d769e7f35e934d2dd5e61.png"},580719:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/image_15-36218b184ad2c5cc810153947be8c3c6.png"},115108:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/image_5-6a4a53cf6172aa695bf8394aaf8c2c38.png"},451967:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/image_6-6990512b34b81f5576f7230d0b97e688.png"},555030:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/image_7-90a2d4880463c30ae83540ced3c30561.png"},32337:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/image_8-69211544b73189ff8535050361ae8f20.png"},522120:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/image_9-5218632277bcb1ec59451c1edd60a7e7.png"},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var s=n(296540);const r={},i=s.createContext(r);function o(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);