"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[96630],{769313:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"cwa/monitors/7cd56a9d-67d5-4d67-a8bf-f61497a93059","title":"Disable Netbios on Network Interfaces","description":"This document provides a guide on how to implement a remote monitor that disables NetBIOS on all network interfaces for Windows operating systems. It includes details on alert styles, ticketing, and the import process.","source":"@site/docs/cwa/monitors/Disable Netbios on Network Interfaces.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/7cd56a9d-67d5-4d67-a8bf-f61497a93059","permalink":"/docs/cwa/monitors/7cd56a9d-67d5-4d67-a8bf-f61497a93059","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Disable Netbios on Network Interfaces.md","tags":[{"inline":false,"label":"Networking","permalink":"/docs/tags/networking","description":"Documents related to network infrastructure and management practices"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"7cd56a9d-67d5-4d67-a8bf-f61497a93059","title":"Disable Netbios on Network Interfaces","title_meta":"Disable Netbios on Network Interfaces","keywords":["netbios","remote","monitor","windows","network"],"description":"This document provides a guide on how to implement a remote monitor that disables NetBIOS on all network interfaces for Windows operating systems. It includes details on alert styles, ticketing, and the import process.","tags":["networking","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Disable AI Recall","permalink":"/docs/cwa/monitors/c9ef3af9-ea83-467d-a5b7-e34248ab65c5"},"next":{"title":"Disable RestrictDriverInstallationToAdministrators","permalink":"/docs/cwa/monitors/e79a2422-0089-451b-9522-a6110976c2f5"}}');var s=r(474848),o=r(28453);const a={id:"7cd56a9d-67d5-4d67-a8bf-f61497a93059",title:"Disable Netbios on Network Interfaces",title_meta:"Disable Netbios on Network Interfaces",keywords:["netbios","remote","monitor","windows","network"],description:"This document provides a guide on how to implement a remote monitor that disables NetBIOS on all network interfaces for Windows operating systems. It includes details on alert styles, ticketing, and the import process.",tags:["networking","windows"],draft:!1,unlisted:!1},i=void 0,l={},d=[{value:"Summary",id:"summary",level:2},{value:"Details",id:"details",level:2},{value:"Target",id:"target",level:2},{value:"Ticketing",id:"ticketing",level:2},{value:"How To Import",id:"how-to-import",level:2},{value:"Step 1",id:"step-1",level:3},{value:"Step 2",id:"step-2",level:3},{value:"Step 3",id:"step-3",level:3},{value:"Step 4",id:"step-4",level:3},{value:"Step 5",id:"step-5",level:3}];function c(e){const t={br:"br",code:"code",h2:"h2",h3:"h3",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsx)(t.p,{children:"This remote monitor disables NetBIOS on all network interfaces."}),"\n",(0,s.jsx)(t.h2,{id:"details",children:"Details"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:'Suggested "Limit to"'}),": Windows OS",(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.strong,{children:"Suggested Alert Style"}),": Continuous",(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.strong,{children:"Suggested Alert Template"}),": \u25b3 Custom - Ticket Creation - Computer"]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Check Action"}),(0,s.jsx)(t.th,{children:"Server Address"}),(0,s.jsx)(t.th,{children:"Check Type"}),(0,s.jsx)(t.th,{children:"Execute Info"}),(0,s.jsx)(t.th,{children:"Comparator"}),(0,s.jsx)(t.th,{children:"Interval"}),(0,s.jsx)(t.th,{children:"Result"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"System"}),(0,s.jsx)(t.td,{children:"127.0.0.1"}),(0,s.jsx)(t.td,{children:"Run File"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"REDACTED"})}),(0,s.jsx)(t.td,{children:"Does not Contain"}),(0,s.jsx)(t.td,{children:"21600"}),(0,s.jsx)(t.td,{children:"Failed to Set"})]})})]}),"\n",(0,s.jsx)(t.h2,{id:"target",children:"Target"}),"\n",(0,s.jsx)(t.p,{children:"Windows OS"}),"\n",(0,s.jsx)(t.h2,{id:"ticketing",children:"Ticketing"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Subject:"})," ",(0,s.jsx)(t.code,{children:"Failed to Disable NetBIOS on %CLIENTNAME%//%COMPUTERNAME% at %LOCATIONNAME%"})]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Success Body:"})," ",(0,s.jsx)(t.code,{children:"NetBIOS has been disabled on all Network Interfaces"})]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Failure Body:"})," ",(0,s.jsx)(t.code,{children:"Failed to Set NetBIOS on %CLIENTNAME%//%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%."})]}),"\n",(0,s.jsx)(t.h2,{id:"how-to-import",children:"How To Import"}),"\n",(0,s.jsx)(t.h3,{id:"step-1",children:"Step 1"}),"\n",(0,s.jsx)(t.p,{children:"Obtain the groupid(s) of the group(s) that the remote monitor should be applied to."}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"step-2",children:"Step 2"}),"\n",(0,s.jsxs)(t.p,{children:["Copy the following query and replace 'YOUR COMMA SEPARATED LIST OF GROUPID(S)' with the Groupid(s) of the relevant groups:\r\n(The string to replace can be found at the very bottom of the query, right after ",(0,s.jsx)(t.code,{children:"WHERE"}),")"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"INSERT INTO groupagents \r\n SELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'ProVal - Dev - Disable Netbios on Network Interfaces' as `Name`,\r\n'6' as `CheckAction`,\r\n'172' as `AlertAction`,\r\n'Failed to Disable NetBios on on %CLIENTNAME%\\\\%COMPUTERNAME% at %LOCATIONNAME%~~~Netbios has been disabled on all Network Interfaces!!!Failed to Disable NetBios on on %CLIENTNAME%\\\\%COMPUTERNAME% at %LOCATIONNAME%~~~Failed to Set Netbios on %CLIENTNAME%\\\\%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%.' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'21600' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command \";$path = \\'HKLM:\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\netbt\\\\Parameters\\\\interfaces\\'; $Paths = Get-ChildItem $path -ErrorAction SilentlyContinue; if ( $paths ) {$paths | ForEach-Object {try{ Set-ItemProperty -Path \\\\\"$path\\\\$_.pschildname\\\\\" -name NetBiosOptions -value 2 -ErrorAction Stop} catch {Write-Output \\\\\"Failed to Set \\'$path\\\\$_.pschildname\\'. Reason: $($Error[0].Exception.Message)\\\\\"}}} \"' as `DataOut`,\r\n'9' as `Comparor`,\r\n'Failed to Set' as `DataIn`,\r\n'' as `IDField`,\r\n'1' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'21' as `Category`,\r\n'0' as `TicketCategory`,\r\n'1' as `ScriptTarget`,\r\nUUID() as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (YOUR COMMA SEPARATED LIST OF GROUPID(S))\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Dev - Disable Netbios on Network Interfaces')\n"})}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"step-3",children:"Step 3"}),"\n",(0,s.jsx)(t.p,{children:"An example of a query with a groupid:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"INSERT INTO groupagents \r\n SELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'ProVal - Dev - Disable Netbios on Network Interfaces' as `Name`,\r\n'6' as `CheckAction`,\r\n'172' as `AlertAction`,\r\n'Failed to Disable NetBios on on %CLIENTNAME%\\\\%COMPUTERNAME% at %LOCATIONNAME%~~~Netbios has been disabled on all Network Interfaces!!!Failed to Disable NetBios on on %CLIENTNAME%\\\\%COMPUTERNAME% at %LOCATIONNAME%~~~Failed to Set Netbios on %CLIENTNAME%\\\\%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%.' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'21600' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command \";$path = \\'HKLM:\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\netbt\\\\Parameters\\\\interfaces\\'; $Paths = Get-ChildItem $path -ErrorAction SilentlyContinue; if ( $paths ) {$paths | ForEach-Object {try{ Set-ItemProperty -Path \\\\\"$path\\\\$_.pschildname\\\\\" -name NetBiosOptions -value 2 -ErrorAction Stop} catch {Write-Output \\\\\"Failed to Set \\'$path\\\\$_.pschildname\\'. Reason: $($Error[0].Exception.Message)\\\\\"}}} \"' as `DataOut`,\r\n'9' as `Comparor`,\r\n'Failed to Set' as `DataIn`,\r\n'' as `IDField`,\r\n'1' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'21' as `Category`,\r\n'0' as `TicketCategory`,\r\n'1' as `ScriptTarget`,\r\nUUID() as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (2,188)\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Dev - Disable Netbios on Network)\n"})}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"step-4",children:"Step 4"}),"\n",(0,s.jsx)(t.p,{children:"Now execute your query from a RAWSQL monitor set."}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"step-5",children:"Step 5"}),"\n",(0,s.jsx)(t.p,{children:"Locate your remote monitor by opening the group(s) remote monitors tab, then apply the appropriate alert template."}),"\n",(0,s.jsx)(t.hr,{})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,t,r)=>{r.d(t,{R:()=>a,x:()=>i});var n=r(296540);const s={},o=n.createContext(s);function a(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);