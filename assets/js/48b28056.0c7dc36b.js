"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[89386],{799038:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"cwa/scripts/4a0526ef-6e45-4053-9a64-27713b7f4d28","title":"Install Windows Upgrade","description":"This document provides a comprehensive overview of the script that installs the latest feature update on Windows 10 and 11 machines. It includes options for upgrading from Windows 10 to Windows 11, execution methods, user parameters, output logs, and ticketing details for handling failures.","source":"@site/docs/cwa/scripts/Install Windows Upgrade.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/4a0526ef-6e45-4053-9a64-27713b7f4d28","permalink":"/docs/cwa/scripts/4a0526ef-6e45-4053-9a64-27713b7f4d28","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Install Windows Upgrade.md","tags":[{"inline":false,"label":"Installation","permalink":"/docs/tags/installation","description":"Documents on installing software and configuring systems"},{"inline":false,"label":"Patching","permalink":"/docs/tags/patching","description":"Documents on software patch management and update installations"},{"inline":false,"label":"Ticketing","permalink":"/docs/tags/ticketing","description":"Documents related to ticketing systems and IT support management"},{"inline":false,"label":"Update","permalink":"/docs/tags/update","description":"Documents discussing software and system updates and their management"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"4a0526ef-6e45-4053-9a64-27713b7f4d28","title":"Install Windows Upgrade","title_meta":"Install Windows Upgrade","keywords":["windows","upgrade","feature","update","installation","patching"],"description":"This document provides a comprehensive overview of the script that installs the latest feature update on Windows 10 and 11 machines. It includes options for upgrading from Windows 10 to Windows 11, execution methods, user parameters, output logs, and ticketing details for handling failures.","tags":["installation","patching","ticketing","update","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Install Windows 11","permalink":"/docs/cwa/scripts/11c5b7d5-108d-4068-b3ea-68af8100aae4"},"next":{"title":"Install-Font","permalink":"/docs/cwa/scripts/c16a83d6-7845-4478-9b25-c4947aac8f5d"}}');var i=s(474848),n=s(28453);const o={id:"4a0526ef-6e45-4053-9a64-27713b7f4d28",title:"Install Windows Upgrade",title_meta:"Install Windows Upgrade",keywords:["windows","upgrade","feature","update","installation","patching"],description:"This document provides a comprehensive overview of the script that installs the latest feature update on Windows 10 and 11 machines. It includes options for upgrading from Windows 10 to Windows 11, execution methods, user parameters, output logs, and ticketing details for handling failures.",tags:["installation","patching","ticketing","update","windows"],draft:!1,unlisted:!1},l=void 0,a={},d=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Example Prompt",id:"example-prompt",level:3},{value:"Dependencies",id:"dependencies",level:2},{value:"User Parameters",id:"user-parameters",level:4},{value:"Output",id:"output",level:2},{value:"Ticketing",id:"ticketing",level:2},{value:"Local Log Files",id:"local-log-files",level:2},{value:"Information Log",id:"information-log",level:2},{value:"Error Log",id:"error-log",level:2},{value:"Script Output",id:"script-output",level:2},{value:"Local Log Files",id:"local-log-files-1",level:2},{value:"Information Log",id:"information-log-1",level:2},{value:"Error Log",id:"error-log-1",level:2},{value:"Script Output",id:"script-output-1",level:2},{value:"Local Log Files",id:"local-log-files-2",level:2},{value:"Local Log Files",id:"local-log-files-3",level:2},{value:"Local Log Files",id:"local-log-files-4",level:2},{value:"Local Log Files",id:"local-log-files-5",level:2},{value:"Information Log",id:"information-log-2",level:2},{value:"Error Log",id:"error-log-2",level:2},{value:"Setup Diag Result",id:"setup-diag-result",level:2}];function c(e){const t={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsxs)(t.p,{children:["This script installs the latest feature update on a Windows 10+ machine and provides an option to upgrade from Windows 10 to Windows 11. The script can be executed from the ",(0,i.jsx)(t.a,{href:"/docs/cwa/monitors/03e04bb6-5087-4e71-9d2f-a3596e9c291f",children:"ProVal - Production - Patching - Windows 10/11 Build Upgrades EOL Based"})," monitor set or executed manually."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Note:"})," The script can create a ticket for failures. If a ticket category is specified in the monitor set, the script will produce a ticket under that category by default. Otherwise, it will create a ticket under the default ticket category."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"File Path:"})," ",(0,i.jsx)(t.code,{children:"C:/ProgramData/_automation/script/Install-FeatureUpdate/Install-FeatureUpdateAI.ps1"})]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"File Hash:"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"SHA256:"})," ",(0,i.jsx)(t.code,{children:"FDC149710B3ABB35D5F61218AB658C9C8881FAEB18CC223E0F1666D8E0120CF9"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"MD5:"})," ",(0,i.jsx)(t.code,{children:"172D4F2C1BD272FEC4CB8568423DEB30"})]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,i.jsxs)(t.p,{children:["To upgrade a computer from Windows 10 to Windows 11, forcefully reboot it, skipping the Free Drive Space Check, and using a custom image/icon in the user's prompt:",(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.img,{alt:"Upgrade Prompt",src:s(429715).A+"",width:"484",height:"512"})]}),"\n",(0,i.jsxs)(t.p,{children:["To install the latest available feature pack on a Windows 10+ machine, without restarting and using the default image/icon in the user's prompt:",(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.img,{alt:"Install Prompt",src:s(83960).A+"",width:"481",height:"508"})]}),"\n",(0,i.jsx)(t.h3,{id:"example-prompt",children:"Example Prompt"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Example Prompt",src:s(305089).A+"",width:"640",height:"480"})}),"\n",(0,i.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/powershell/ps-install-featureupdate",children:"Install-FeatureUpdate"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/cwa/scripts/6042c7c0-dd54-4eda-8889-ef2ff879e5a2",children:"Get SetupDiag Report"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/cwa/scripts/d8a124df-ea81-4194-82fc-a082c7a036d8",children:"CWM - Automate - Script - Prompter"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/cwa/tables/938cd822-f6a3-4ee3-add2-62b407e45622",children:"SEC - Windows Patching - Custom Table - plugin_proval_windows_os_support"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/cwa/monitors/03e04bb6-5087-4e71-9d2f-a3596e9c291f",children:"ProVal - Production - Patching - Windows 10/11 Build Upgrades EOL Based"})}),"\n"]}),"\n",(0,i.jsx)(t.h4,{id:"user-parameters",children:"User Parameters"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Name"}),(0,i.jsx)(t.th,{children:"Example"}),(0,i.jsx)(t.th,{children:"Required"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Reboot"}),(0,i.jsx)(t.td,{children:"1"}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:"If set to 1, the script will reboot upon successful installation without prompting any currently logged-in user. Note: A reboot will be performed, ignoring this parameter, if no user is logged in. Set to 0 to disable."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"HeaderImage"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"https://icons.iconarchive.com/icons/martz90/circle-addon2/512/windows-update-icon.png",children:"Header Image"})}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsxs)(t.td,{children:["The header image to display in the user prompt. Defaults to: ",(0,i.jsx)(t.a,{href:"https://winaero.com/blog/wp-content/uploads/2015/05/Windows-10-banner-logo-nodevs-01.png",children:"Default Header Image"})]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Icon"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"https://icons.iconarchive.com/icons/martz90/circle-addon2/512/windows-update-icon.png",children:"Icon"})}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsxs)(t.td,{children:["The icon to use for the user prompt. Defaults to: ",(0,i.jsx)(t.a,{href:"https://icons.iconarchive.com/icons/martz90/circle-addon2/512/windows-update-icon.png",children:"Default Icon"})]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"SkipDriveCheck"}),(0,i.jsx)(t.td,{children:"1"}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:"If set to 1, the script will not check the free space available on the computer before performing the update/upgrade. Note: By default, the script does not perform an update/upgrade if free space is less than 20 GB."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"upgrade"}),(0,i.jsx)(t.td,{children:"1"}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:"If set to 1 for Windows 10 computers, the script will attempt to upgrade the computer to Windows 11."})]})]})]}),"\n",(0,i.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Script Logs"}),"\n",(0,i.jsx)(t.li,{children:"Tickets"}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"ticketing",children:"Ticketing"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Subject:"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"For Windows Upgrade Failure:"})," ",(0,i.jsx)(t.code,{children:"Windows Upgrade Failed for \\\\<ClientName>/\\\\<ComputerName>"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"For Windows Feature Update Failure:"})," ",(0,i.jsx)(t.code,{children:"Windows Feature Update Failed for \\\\<ClientName>/\\\\<ComputerName>"})]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Body:"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"For any Security Application/AV blocking Script Execution:"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:"The Windows upgrade script was unable to run on the computer because it was blocked by a security application or antivirus program. Please add the necessary exclusions to the program blocking it and re-run the script."})]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"For Premature Termination of the script:"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:"The upgrade process appears to have been interrupted because it terminated after %sqlresult% minutes, which is not enough time for an upgrade to be installed. Please review the below logs to determine the root cause."}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:"Further information about troubleshooting Windows upgrade failures can be found here: [Troubleshooting Guide](https://learn.microsoft.com/en-us/windows/deployment/upgrade/resolve-windows-10-upgrade-errors)"})]}),"\n",(0,i.jsx)(t.h2,{id:"local-log-files",children:"Local Log Files"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"\\\\<Path of log file on Local Computer>"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:"\\\\<Path of Error Log file on Local Computer>"})]}),"\n",(0,i.jsx)(t.h2,{id:"information-log",children:"Information Log"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.code,{children:"\\\\<Information Logs>"})}),"\n",(0,i.jsx)(t.h2,{id:"error-log",children:"Error Log"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.code,{children:"\\\\<Error Logs if any>"})}),"\n",(0,i.jsx)(t.h2,{id:"script-output",children:"Script Output"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.code,{children:"\\\\<PowerShell Script Output>"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"For Pre-Reboot Installation Failure:"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:"The script encountered an error when installing the Feature Update. Please review the below logs to determine the root cause."}),(0,i.jsx)(t.br,{}),"\n","Further information about troubleshooting Windows upgrade failures can be found here: ",(0,i.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/windows/deployment/upgrade/resolve-windows-10-upgrade-errors",children:"Troubleshooting Guide"})]}),"\n",(0,i.jsx)(t.h2,{id:"local-log-files-1",children:"Local Log Files"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"\\\\<Path of log file on Local Computer>"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:"\\\\<Path of Error Log file on Local Computer>"})]}),"\n",(0,i.jsx)(t.h2,{id:"information-log-1",children:"Information Log"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.code,{children:"\\\\<Information Logs>"})}),"\n",(0,i.jsx)(t.h2,{id:"error-log-1",children:"Error Log"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.code,{children:"\\\\<Error Logs if any>"})}),"\n",(0,i.jsx)(t.h2,{id:"script-output-1",children:"Script Output"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.code,{children:"\\\\<PowerShell Script Output>"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"PowerShell Execution Failure:"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:"The script encountered an error when installing the Feature Update. It is not able to run PowerShell on the machine: \\\\<PowerShell Script Output>"})]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"If Reboot is suppressed and logged-in user misses the reboot prompt:"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:'The active user on the machine has not responded to the reboot prompt after a successful Feature Update installation. Post-reboot log analysis will be skipped. If you would like to perform this analysis at a later time, please execute the "Get SetupDiag Report" script after the machine has rebooted.'})]}),"\n",(0,i.jsx)(t.h2,{id:"local-log-files-2",children:"Local Log Files"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"\\\\<Path of log file on Local Computer>"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:"\\\\<Path of Error Log file on Local Computer>"})]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"If Reboot is suppressed and user selects to reboot the computer later:"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:'The active user on the machine has chosen to forego rebooting after a successful Feature Update installation. Post-reboot log analysis will be skipped. If you would like to perform this analysis at a later time, please execute the "Get SetupDiag Report" script after the machine has rebooted.'})]}),"\n",(0,i.jsx)(t.h2,{id:"local-log-files-3",children:"Local Log Files"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"\\\\<Path of log file on Local Computer>"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:"\\\\<Path of Error Log file on Local Computer>"})]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"If computer fails to check back Automate post-reboot:"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:'\\\\<ScriptName> has attempted Feature Update on %computername% and has pushed a reboot on the machine after installing the updates, but \\\\<computername> has not come back online after 1 hour. Post-reboot analysis will be unavailable. Please run the "Get SetupDiag Report" script after check-in to perform post-reboot analysis.'})]}),"\n",(0,i.jsx)(t.h2,{id:"local-log-files-4",children:"Local Log Files"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"\\\\<Path of log file on Local Computer>"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:"\\\\<Path of Error Log file on Local Computer>"})]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"For Post Reboot Update/Upgrade Failures:"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:"The script detected a post-reboot failure from the Feature Update install. Please review the below logs to determine the root cause."}),(0,i.jsx)(t.br,{}),"\n","Further information about these issues can be found here: ",(0,i.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/windows/deployment/upgrade/setupdiag#rules",children:"Troubleshooting Guide"})]}),"\n",(0,i.jsx)(t.h2,{id:"local-log-files-5",children:"Local Log Files"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"\\\\<Path of log file on Local Computer>"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:"\\\\<Path of Error Log file on Local Computer>"})]}),"\n",(0,i.jsx)(t.h2,{id:"information-log-2",children:"Information Log"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.code,{children:"\\\\<Information Logs>"})}),"\n",(0,i.jsx)(t.h2,{id:"error-log-2",children:"Error Log"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.code,{children:"\\\\<Error Logs if any>"})}),"\n",(0,i.jsx)(t.h2,{id:"setup-diag-result",children:"Setup Diag Result"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.code,{children:"\\\\<Outcome of the SetupDiagTool verifying the upgrade process>"})})]})}function h(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},429715:(e,t,s)=>{s.d(t,{A:()=>r});const r=s.p+"assets/images/image_1-2f5355b2a3b9f54b4171d0d895111f7d.png"},83960:(e,t,s)=>{s.d(t,{A:()=>r});const r=s.p+"assets/images/image_2-57237971edb859a80de2c72d2e04a786.png"},305089:(e,t,s)=>{s.d(t,{A:()=>r});const r=s.p+"assets/images/image_3-631684548831ec9e2f71e808ab535384.png"},28453:(e,t,s)=>{s.d(t,{R:()=>o,x:()=>l});var r=s(296540);const i={},n=r.createContext(i);function o(e){const t=r.useContext(n);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(n.Provider,{value:t},e.children)}}}]);