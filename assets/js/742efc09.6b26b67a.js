"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[25125],{430803:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"cwa/monitors/28ddee2c-510a-4557-941a-168d155eacdc","title":"LTTray Detection","description":"This document outlines a remote monitor designed to detect discrepancies between the LTTray port value in the registry and the actual port being utilized by Windows. It includes suggested alert styles, templates, and check actions for effective monitoring on Windows machines.","source":"@site/docs/cwa/monitors/LTTray Detection.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/28ddee2c-510a-4557-941a-168d155eacdc","permalink":"/docs/cwa/monitors/28ddee2c-510a-4557-941a-168d155eacdc","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/LTTray Detection.md","tags":[{"inline":false,"label":"Performance","permalink":"/docs/tags/performance","description":"Documents related to enhancing system and application performance"},{"inline":false,"label":"Registry","permalink":"/docs/tags/registry","description":"Documents concerning system registry management and troubleshooting"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"28ddee2c-510a-4557-941a-168d155eacdc","title":"LTTray Detection","title_meta":"LTTray Detection","keywords":["lttray","port","registry","monitor","windows"],"description":"This document outlines a remote monitor designed to detect discrepancies between the LTTray port value in the registry and the actual port being utilized by Windows. It includes suggested alert styles, templates, and check actions for effective monitoring on Windows machines.","tags":["performance","registry","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"LTCache Monitoring","permalink":"/docs/cwa/monitors/1f389c5d-df7a-49a9-9db4-9e0442afbe7b"},"next":{"title":"Last Cumulative Update  45 Days and  60 Days","permalink":"/docs/cwa/monitors/6a68b349-fa31-41d0-9a6c-80eef1a13fdb"}}');var r=n(474848),i=n(28453);const o={id:"28ddee2c-510a-4557-941a-168d155eacdc",title:"LTTray Detection",title_meta:"LTTray Detection",keywords:["lttray","port","registry","monitor","windows"],description:"This document outlines a remote monitor designed to detect discrepancies between the LTTray port value in the registry and the actual port being utilized by Windows. It includes suggested alert styles, templates, and check actions for effective monitoring on Windows machines.",tags:["performance","registry","windows"],draft:!1,unlisted:!1},a=void 0,c={},d=[{value:"Summary",id:"summary",level:2},{value:"Details",id:"details",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Target",id:"target",level:2}];function l(e){const t={a:"a",br:"br",code:"code",h2:"h2",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(t.p,{children:"This remote monitor detects if the port value for the LTTray in the registry matches the actual port that is being used by Windows for the process."}),"\n",(0,r.jsx)(t.h2,{id:"details",children:"Details"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:'Suggested "Limit to"'}),": Windows Machines",(0,r.jsx)(t.br,{}),"\n",(0,r.jsx)(t.strong,{children:"Suggested Alert Style"}),": Continuous",(0,r.jsx)(t.br,{}),"\n",(0,r.jsx)(t.strong,{children:"Suggested Alert Template"}),": Autofix - LTTray Fix"]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Check Action"}),(0,r.jsx)(t.th,{children:"Server Address"}),(0,r.jsx)(t.th,{children:"Check Type"}),(0,r.jsx)(t.th,{children:"Check Value"}),(0,r.jsx)(t.th,{children:"Comparator"}),(0,r.jsx)(t.th,{children:"Interval"}),(0,r.jsx)(t.th,{children:"Result"})]})}),(0,r.jsx)(t.tbody,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"System"}),(0,r.jsx)(t.td,{children:"127.0.0.1"}),(0,r.jsx)(t.td,{children:"Run File"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"See below"})}),(0,r.jsx)(t.td,{children:"Contains"}),(0,r.jsx)(t.td,{children:"900"}),(0,r.jsx)(t.td,{children:"Ports are same"})]})})]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Check Value:"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-shell",children:'C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -ExecutionPolicy Bypass -Command "$process = Get-Process -Name "ltsvc" -ErrorAction SilentlyContinue | Select-Object -First 1;if($process){$netstatOut = netstat -ano | Where-Object {$_ -match \\" $($process.Id)$\\"} | Select-Object -First 1;$netstatFormatted = $netstatOut -split \' \' | Where-Object {$_};$port = ($netstatFormatted[1] -split \':\')[1];$TrayPort = Get-ItemProperty -Path \'HKLM:\\SOFTWARE\\LabTech\\Service\' | select-object -expandproperty TrayPort -ErrorAction SilentlyContinue;if($port -eq $TrayPort){write-host "Ports are Same"}else{write-host "Ports are not same. Netstat Port is: $Port and Registry Port is: $TrayPort"}}else{write-host "Ltsvc.exe process not detected"}"\n'})}),"\n",(0,r.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.a,{href:"/docs/cwa/scripts/cc09c16e-c62b-4001-9226-1b92097a6507",children:"LTTray Port Mapping with System Registry"})}),"\n",(0,r.jsx)(t.h2,{id:"target",children:"Target"}),"\n",(0,r.jsx)(t.p,{children:"Windows machine"})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var s=n(296540);const r={},i=s.createContext(r);function o(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);