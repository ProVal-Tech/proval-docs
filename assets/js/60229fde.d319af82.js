"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[10081],{920065:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"cwa/scripts/44296eb1-9cdc-4833-ac40-7f390eac3a7f","title":"Automate Agent - Duplicate Serial Number - Audit Only Email,Ticket","description":"This document provides a detailed overview of a script designed to audit duplicate agents in the Automate environment based on serial number, name, and client affiliation. It includes setup instructions, system properties, user parameters, and output details, ensuring effective management of duplicate agents.","source":"@site/docs/cwa/scripts/Automate Agent - Duplicate Serial Number - Audit Only Email,Ticket.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/44296eb1-9cdc-4833-ac40-7f390eac3a7f","permalink":"/proval-docs/docs/cwa/scripts/44296eb1-9cdc-4833-ac40-7f390eac3a7f","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Automate Agent - Duplicate Serial Number - Audit Only Email,Ticket.md","tags":[{"inline":false,"label":"Email","permalink":"/proval-docs/docs/tags/email","description":"Documents about email systems and their management"}],"version":"current","frontMatter":{"id":"44296eb1-9cdc-4833-ac40-7f390eac3a7f","title":"Automate Agent - Duplicate Serial Number - Audit Only Email,Ticket","title_meta":"Automate Agent - Duplicate Serial Number - Audit Only Email,Ticket","keywords":["automate","agent","duplicate","serial","audit","email","ticketing"],"description":"This document provides a detailed overview of a script designed to audit duplicate agents in the Automate environment based on serial number, name, and client affiliation. It includes setup instructions, system properties, user parameters, and output details, ensuring effective management of duplicate agents.","tags":["email"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Automate Agent - Auto Repair","permalink":"/proval-docs/docs/cwa/scripts/7c0947f0-306b-4ae0-9bd7-dd15dfb0008c"},"next":{"title":"Automate Agent - Duplicate Serial Number - Auto Retire Email,Ticket","permalink":"/proval-docs/docs/cwa/scripts/f9a0c7b8-2807-4e08-b1b7-c9342b89a493"}}');var n=i(474848),a=i(28453);const r={id:"44296eb1-9cdc-4833-ac40-7f390eac3a7f",title:"Automate Agent - Duplicate Serial Number - Audit Only Email,Ticket",title_meta:"Automate Agent - Duplicate Serial Number - Audit Only Email,Ticket",keywords:["automate","agent","duplicate","serial","audit","email","ticketing"],description:"This document provides a detailed overview of a script designed to audit duplicate agents in the Automate environment based on serial number, name, and client affiliation. It includes setup instructions, system properties, user parameters, and output details, ensuring effective management of duplicate agents.",tags:["email"],draft:!1,unlisted:!1},l=void 0,c={},d=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"System Properties",id:"system-properties",level:2},{value:"User Parameters",id:"user-parameters",level:2},{value:"Output",id:"output",level:2},{value:"Ticketing/Email",id:"ticketingemail",level:2}];function o(e){const t={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,n.jsxs)(t.p,{children:["This document is a duplicate of the ",(0,n.jsx)(t.a,{href:"https://proval.itglue.com/DOC-5081588-9095605",children:"CWM - Automate - Script - Automate Agent - Duplicate Serial Number - Retire"})," script. However, instead of retiring agents, it will audit the duplicate agents in the Automate environment. Duplicate agents will be identified based on serial number, name, and client affiliation."]}),"\n",(0,n.jsx)(t.p,{children:"This is a client script and will work only for physical machines. Virtual machines are excluded to prevent any accidental deletion. It can be set up to email the results to any email address, or a ticket can also be generated with the list of duplicate agents."}),"\n",(0,n.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,n.jsxs)(t.p,{children:["Set the parameter ",(0,n.jsx)(t.code,{children:"Set_environment"})," for the first execution."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Sample Run Image 1",src:i(358972).A+"",width:"481",height:"428"})}),"\n",(0,n.jsx)(t.p,{children:"Specify the email address where you would like to receive the output of the results."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Sample Run Image 2",src:i(643255).A+"",width:"483",height:"426"})}),"\n",(0,n.jsx)(t.h2,{id:"system-properties",children:"System Properties"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Name"}),(0,n.jsx)(t.th,{children:"Required"}),(0,n.jsx)(t.th,{children:"Example"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"_sysDuplicateAgentEmailAddress"})}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.a,{href:"mailto:xyz@something.com",children:"xyz@something.com"})}),(0,n.jsx)(t.td,{children:"Universal email address where you would like to receive the list of duplicate agents."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"_sysDuplicateAgentTicketingEnable"})}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"1"}),(0,n.jsx)(t.td,{children:"Set to '1' if you would like to receive a ticket with a list of duplicate agents; otherwise, leave it blank or set to '0'."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"_sysDuplicateAgentTicketCategory"})}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"234"}),(0,n.jsxs)(t.td,{children:["Mention the ticket creation category to direct the tickets to the right board in Manage. ",(0,n.jsx)(t.strong,{children:"Note:"})," If no ticket creation category is mentioned in this property, the script will use the universal ticket creation category mentioned in the global system property ",(0,n.jsx)(t.code,{children:"MonitorTicketCategory"}),"."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"_sysDuplicateAgent_NoDuplicate_Ticketing"})}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"0"}),(0,n.jsx)(t.td,{children:"Set its value to '1' to receive tickets/emails when there are no duplicate agents. The default value is '0', meaning by default, the script will not generate tickets/emails if no duplicate agents are found."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"_sysDuplicateAgent_Ticketing_DefaultClientid"})}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"1"}),(0,n.jsx)(t.td,{children:"Client ID of the client under which tickets should be generated. The default value is '1', meaning tickets will be generated under the client whose client ID is '1' in the environment."})]})]})]}),"\n",(0,n.jsx)(t.h2,{id:"user-parameters",children:"User Parameters"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Name"}),(0,n.jsx)(t.th,{children:"Required"}),(0,n.jsx)(t.th,{children:"Example"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"Email_Address"})}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.a,{href:"mailto:xyz@something.com",children:"xyz@something.com"})}),(0,n.jsxs)(t.td,{children:["Fill it with an email address where you would like to receive the result of the script. ",(0,n.jsx)(t.strong,{children:"Note:"})," If nothing is mentioned in this user parameter, the script will check the system property ",(0,n.jsx)(t.code,{children:"_sysDuplicateAgentEmailAddress"}),". If any email address is mentioned there, it will send an email to it. If not, it will send the email to the user who ran the script at the email address used for that user in Automate."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"Set_Environment"})}),(0,n.jsx)(t.td,{children:"True (For First execution)"}),(0,n.jsx)(t.td,{children:"1"}),(0,n.jsx)(t.td,{children:"Set it to '1' to create the system properties if they are not already made in the environment. It must be set to '1' for the first execution."})]})]})]}),"\n",(0,n.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Script Logs"}),"\n",(0,n.jsx)(t.li,{children:"Ticketing"}),"\n",(0,n.jsx)(t.li,{children:"Email"}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"ticketingemail",children:"Ticketing/Email"}),"\n",(0,n.jsxs)(t.p,{children:["Tickets will only be generated if the system property ",(0,n.jsx)(t.code,{children:"_sysDuplicateAgentTicketingEnable"})," is set to '1'."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Subject:"})," ",(0,n.jsx)(t.code,{children:"Duplicate Agents Based on Serial Numbers"})]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Body:"})," ",(0,n.jsx)(t.code,{children:"Please review the following duplicates. These are instances where multiple Automate agent IDs have the same serial number. This usually happens when a computer is re-imaged and the old agent is not retired first. Typically, any agent IDs with the oldest Last Contact dates can be retired, but these should be verified first."})]}),"\n",(0,n.jsx)(t.p,{children:"Keeping this list clean prevents false positive alerts from generating from the old agent instance and frees up Automate agent licenses. If all of the older copies of the agents listed below are deemed safe for removal, you can run the script (ProVal Script - noted below) to retire them all at once. Please use the Audit Only version of the script first if you would like to see a report of what the automation would do first."}),"\n",(0,n.jsx)(t.p,{children:"Script Name - Automate Agent - Duplicate Serial Number - Auto Retire [Email, Ticket]"}),"\n",(0,n.jsx)(t.p,{children:"Duplicate Agents are listed below:"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.code,{children:"@DuplicateMachines@"})}),"\n",(0,n.jsx)(t.p,{children:"In case there is no duplicate serial number:"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.code,{children:"No duplicate machines identified based on Serial Number."})})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(o,{...e})}):o(e)}},358972:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_1-07091810f6379b327f9f420af9aade74.png"},643255:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_2-210a96fbcb138627147bf7fdca60b262.png"},28453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>l});var s=i(296540);const n={},a=s.createContext(n);function r(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);