"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[34086],{833334:(e,s,l)=>{l.r(s),l.d(s,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"powershell/ps-disable-powershellversion2","title":"Disable-PowershellVersion2","description":"Documentation for the Disable-PowerShellVersion2 command to disable the Windows PowerShell v2 feature if a newer version is installed.","source":"@site/docs/powershell/Disable-PowershellVersion2.md","sourceDirName":"powershell","slug":"/powershell/ps-disable-powershellversion2","permalink":"/docs/powershell/ps-disable-powershellversion2","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/powershell/Disable-PowershellVersion2.md","tags":[{"inline":false,"label":"Security","permalink":"/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Update","permalink":"/docs/tags/update","description":"Documents discussing software and system updates and their management"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"ps-disable-powershellversion2","title":"Disable-PowershellVersion2","title_meta":"Disable-PowershellVersion2","keywords":["disable","powershell","version","update"],"description":"Documentation for the Disable-PowerShellVersion2 command to disable the Windows PowerShell v2 feature if a newer version is installed.","tags":["security","update","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Disable-DotNet3","permalink":"/docs/powershell/ps-disable-dotnet3"},"next":{"title":"Enable-PowerPlan","permalink":"/docs/powershell/ps-enable-powerplan"}}');var t=l(474848),n=l(28453);const r={id:"ps-disable-powershellversion2",title:"Disable-PowershellVersion2",title_meta:"Disable-PowershellVersion2",keywords:["disable","powershell","version","update"],description:"Documentation for the Disable-PowerShellVersion2 command to disable the Windows PowerShell v2 feature if a newer version is installed.",tags:["security","update","windows"],draft:!1,unlisted:!1},o=void 0,a={},d=[{value:"Description",id:"description",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Usage",id:"usage",level:2},{value:"Output",id:"output",level:2}];function c(e){const s={code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,n.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h2,{id:"description",children:"Description"}),"\n",(0,t.jsx)(s.p,{children:"This script will disable the Windows PowerShell v2 feature. If no newer version of PowerShell exists, the script will not disable PowerShell v2."}),"\n",(0,t.jsx)(s.h2,{id:"requirements",children:"Requirements"}),"\n",(0,t.jsx)(s.p,{children:"A version of PowerShell greater than v2 must be installed to disable PowerShell v2. This script will attempt to satisfy that requirement before disabling anything. The removal of the .NET 3.0 feature requires a reboot."}),"\n",(0,t.jsx)(s.h2,{id:"usage",children:"Usage"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"If there is a PowerShell version installed greater than v2, then PowerShell v2 will be disabled."}),"\n",(0,t.jsxs)(s.li,{children:["If there are no PowerShell versions installed greater than v2:","\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"Install the latest approved Chocolatey version of PowerShell."}),"\n",(0,t.jsx)(s.li,{children:"Verify that the installation was successful; return an error if not."}),"\n",(0,t.jsx)(s.li,{children:"Disable PowerShell version 2."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-powershell",children:".\\Disable-PowerShellVersion2.ps1\n"})}),"\n",(0,t.jsx)(s.p,{children:"This command checks for a version of PowerShell greater than v2. If one is present, it disables the PowerShell v2 feature. If not, it attempts to install a newer PowerShell version so that v2 can be disabled."}),"\n",(0,t.jsx)(s.h2,{id:"output",children:"Output"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:".\\Disable-PowerShellVersion2-log.txt"}),"\n",(0,t.jsx)(s.li,{children:".\\Disable-PowerShellVersion2-error.txt"}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,s,l)=>{l.d(s,{R:()=>r,x:()=>o});var i=l(296540);const t={},n=i.createContext(t);function r(e){const s=i.useContext(n);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(n.Provider,{value:s},e.children)}}}]);