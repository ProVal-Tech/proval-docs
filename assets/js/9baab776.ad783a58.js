"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[83842],{136259:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"cwa/scripts/0fd5ce6e-ad48-4198-a69f-55dc16865b05","title":"Lockdown Browsers Autofill","description":"This document provides a comprehensive guide to configuring lockdown settings for browsers within a ConnectWise Automate environment. It includes steps for importing client, location, and computer level Extra Data Fields (EDFs), creating searches and groups, and setting up remote monitors to ensure effective management of browser lockdown features.","source":"@site/docs/cwa/scripts/Lockdown Browsers Autofill.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/0fd5ce6e-ad48-4198-a69f-55dc16865b05","permalink":"/proval-docs/docs/cwa/scripts/0fd5ce6e-ad48-4198-a69f-55dc16865b05","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Lockdown Browsers Autofill.md","tags":[{"inline":false,"label":"Security","permalink":"/proval-docs/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Setup","permalink":"/proval-docs/docs/tags/setup","description":"Documents on setting up software and hardware configurations"},{"inline":false,"label":"Software","permalink":"/proval-docs/docs/tags/software","description":"Documents related to software applications and their lifecycle management"}],"version":"current","frontMatter":{"id":"0fd5ce6e-ad48-4198-a69f-55dc16865b05","title":"Lockdown Browsers Autofill","title_meta":"Lockdown Browsers Autofill","keywords":["lockdown","browsers","configuration","edfs","remote","monitors"],"description":"This document provides a comprehensive guide to configuring lockdown settings for browsers within a ConnectWise Automate environment. It includes steps for importing client, location, and computer level Extra Data Fields (EDFs), creating searches and groups, and setting up remote monitors to ensure effective management of browser lockdown features.","tags":["security","setup","software"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Lock Stolen System","permalink":"/proval-docs/docs/cwa/scripts/3fec514c-c0b2-4b19-92b7-d77c78e678a3"},"next":{"title":"Log4J (Log4Shell) File Scan","permalink":"/proval-docs/docs/cwa/scripts/a8eab72d-3794-4808-9009-b01bf3c9bcba"}}');var s=n(474848),t=n(28453);const a={id:"0fd5ce6e-ad48-4198-a69f-55dc16865b05",title:"Lockdown Browsers Autofill",title_meta:"Lockdown Browsers Autofill",keywords:["lockdown","browsers","configuration","edfs","remote","monitors"],description:"This document provides a comprehensive guide to configuring lockdown settings for browsers within a ConnectWise Automate environment. It includes steps for importing client, location, and computer level Extra Data Fields (EDFs), creating searches and groups, and setting up remote monitors to ensure effective management of browser lockdown features.",tags:["security","setup","software"],draft:!1,unlisted:!1},i=void 0,d={},l=[{value:"Step 1",id:"step-1",level:2},{value:"Step 2",id:"step-2",level:2},{value:"Remove Existing Content",id:"remove-existing-content",level:3},{value:"Step 3",id:"step-3",level:2},{value:"Create EDFs",id:"create-edfs",level:3},{value:"Step 4",id:"step-4",level:2},{value:"Create Searches",id:"create-searches",level:3},{value:"Step 5",id:"step-5",level:2},{value:"Create Groups",id:"create-groups",level:3},{value:"Step 6",id:"step-6",level:2},{value:"Create Remote Monitors",id:"create-remote-monitors",level:3},{value:"Step 7",id:"step-7",level:2},{value:"Step 8",id:"step-8",level:2},{value:"Step 9",id:"step-9",level:2}];function c(e){const r={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.h2,{id:"step-1",children:"Step 1"}),"\n",(0,s.jsx)(r.p,{children:"Execute the provided SQL query from a RAWSQL monitor set in the provided order to import the following contents:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Client Level EDFs:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Lockdown Browsers Password Manager"}),"\n",(0,s.jsx)(r.li,{children:"Lockdown Browsers Credit Card Autofill"}),"\n",(0,s.jsx)(r.li,{children:"Lockdown Browsers Address Autofill"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Location Level EDFs:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Exclude Browser Lockdown"}),"\n",(0,s.jsx)(r.li,{children:"Exclude Browser Credit Card Lockdown"}),"\n",(0,s.jsx)(r.li,{children:"Lockdown Browsers Address Autofill"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Computer Level EDFs:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Exclude Browser Lockdown"}),"\n",(0,s.jsx)(r.li,{children:"Exclude Browser Credit Card Lockdown"}),"\n",(0,s.jsx)(r.li,{children:"Lockdown Browsers Address Autofill"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Searches:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Lockdown Browsers Autofill"}),"\n",(0,s.jsx)(r.li,{children:"Lockdown Browsers Password Manager"}),"\n",(0,s.jsx)(r.li,{children:"Lockdown Browsers Credit Card Autofill"}),"\n",(0,s.jsx)(r.li,{children:"Lockdown Browsers Address Autofill"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Groups:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["\u25b3 System Monitoring","\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"\u25b3 Lockdown Browsers Autofill"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Remote Monitors:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"ProVal - Production - Lockdown Browsers Password Manager"}),"\n",(0,s.jsx)(r.li,{children:"ProVal - Production - Lockdown Chromium Browsers Credit Card Autofill"}),"\n",(0,s.jsx)(r.li,{children:"ProVal - Production - Lockdown Chromium Browsers Address Autofill"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"step-2",children:"Step 2"}),"\n",(0,s.jsx)(r.h3,{id:"remove-existing-content",children:"Remove Existing Content"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"DELETE FROM groupagents WHERE groupid = (SELECT DISTINCT groupid FROM mastergroups WHERE `GUID` = 'eea5f14b-c12a-11ee-a53f-960002890dfa');\r\nDELETE FROM mastergroups WHERE `GUID` = 'eea5f14b-c12a-11ee-a53f-960002890dfa';\r\nDELETE FROM sensorchecks WHERE `GUID` = '80d153cb-440b-4312-9191-a9f5dd20744a';\n"})}),"\n",(0,s.jsx)(r.h2,{id:"step-3",children:"Step 3"}),"\n",(0,s.jsx)(r.h3,{id:"create-edfs",children:"Create EDFs"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"INSERT IGNORE INTO `extrafield`\r\n  (`Form`, `Name`, `Sort`, `NoBreak`, `FType`, `Section`, `UnEditable`, `Collapsed`, `Fill`, `LtGuid`, `IsPassword`, `IsEncrypted`, `IsHidden`, `IsRestricted`, `ViewPermissions`, `EditPermissions`)\r\nVALUES\r\n  (1, 'Exclude Browser Password Lockdown', 0, 0, 1, 'Exclusions', 0, 0, '', '427b21d2-e43a-4638-b692-3a15f56f7092', 0, 0, 0, 0, '', ''),\r\n  (2, 'Exclude Browser Password Lockdown', 0, 0, 1, 'Exclusions', 0, 0, '', '5dd1e888-f7f8-4e2d-af53-b6cac8c00efb', 0, 0, 0, 0, '', ''),\r\n  (1, 'Exclude Browser Address Autofill Lockdown', 0, 0, 1, 'Exclusions', 0, 0, '', '2de882af-81ea-4300-b410-d6c155239a83', 0, 0, 0, 0, '', ''),\r\n  (2, 'Exclude Browser Credit Card Lockdown', 0, 0, 1, 'Exclusions', 0, 0, '', '5126b37d-1d63-456c-b44b-180871bd5d97', 0, 0, 0, 0, '', ''),\r\n  (1, 'Exclude Browser Credit Card Lockdown', 0, 0, 1, 'Exclusions', 0, 0, '', '3eb6042d-68f3-4c87-b2cf-72d69bb57e45', 0, 0, 0, 0, '', ''),\r\n  (2, 'Exclude Browser Address Autofill Lockdown', 0, 0, 1, 'Exclusions', 0, 0, '', 'ffd807a0-62a6-4cfa-86e6-d90cfc9f0f3c', 0, 0, 0, 0, '', ''),\r\n  (3, 'Lockdown Browsers Password Manager', 0, 0, 1, 'Security', 0, 0, '', '611dcf5a-b316-4986-a624-a176efe4b5c6', 0, 0, 0, 0, '', ''),\r\n  (3, 'Lockdown Browsers Credit Card Autofill', 0, 0, 1, 'Security', 0, 0, '', 'e74a03bc-b190-4ccb-9c29-95d7f3b23c1f', 0, 0, 0, 0, '', ''),\r\n  (3, 'Lockdown Browsers Address Autofill', 0, 0, 1, 'Security', 0, 0, '', '3c002fdd-a25a-4bc2-bb1e-1a6f7af67432', 0, 0, 0, 0, '', '');\r\nCALL v_extradata(1,'computers');\r\nCALL v_ExtraDataRefresh(1,'computers');\r\nCALL v_extradata(2,'locations');\r\nCALL v_ExtraDataRefresh(2,'locations');\r\nCALL v_extradata(3,'clients');\r\nCALL v_ExtraDataRefresh(3,'clients');\n"})}),"\n",(0,s.jsx)(r.h2,{id:"step-4",children:"Step 4"}),"\n",(0,s.jsx)(r.h3,{id:"create-searches",children:"Create Searches"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"INSERT INTO `sensorchecks`\r\n  (`Name`, `SQL`, `QueryType`, `ListDATA`, `FolderID`, `GUID`, `SearchXML`)\r\nSELECT\r\n  'Lockdown Browsers Autofill' AS `Name`,\r\n  'SELECT \r\n    computers.computerid AS `Computer Id`,\r\n    computers.name AS `Computer Name`,\r\n    clients.name AS `Client Name`,\r\n    computers.domain AS `Computer Domain`,\r\n    computers.username AS `Computer User`,\r\n    IF(INSTR(IFNULL(inv_operatingsystem.Name, Computers.OS), /'windows/') > 0, 1, IF(INSTR(IFNULL(inv_operatingsystem.Name, Computers.OS), /'darwin/') > 0, 2, 3)) AS `Computer.OS.Type`,\r\n    IFNULL(IFNULL(edfAssigned1.Value, edfDefault1.value), '0') AS `Computer - Client - Extra Data Field - Security - Lockdown Browsers Password Manager`,\r\n    IFNULL(IFNULL(edfAssigned2.Value, edfDefault2.value), '0') AS `Computer - Client - Extra Data Field - Security - Lockdown Browsers Credit Card Autofill`,\r\n    IFNULL(IFNULL(edfAssigned3.Value, edfDefault3.value), '0') AS `Computer - Client - Extra Data Field - Security - Lockdown Browsers Address Autofill`\r\nFROM Computers \r\nLEFT JOIN inv_operatingsystem ON (Computers.ComputerId = inv_operatingsystem.ComputerId)\r\nLEFT JOIN Clients ON (Computers.ClientId = Clients.ClientId)\r\nLEFT JOIN Locations ON (Computers.LocationId = Locations.LocationID)\r\nLEFT JOIN ExtraFieldData edfAssigned1 ON (edfAssigned1.id = Clients.ClientId AND edfAssigned1.ExtraFieldId = (SELECT ExtraField.id FROM ExtraField WHERE LTGuid = '611dcf5a-b316-4986-a624-a176efe4b5c6'))\r\nLEFT JOIN ExtraFieldData edfDefault1 ON (edfDefault1.id = 0 AND edfDefault1.ExtraFieldId = (SELECT ExtraField.id FROM ExtraField WHERE LTGuid = '611dcf5a-b316-4986-a624-a176efe4b5c6'))\r\nLEFT JOIN ExtraFieldData edfAssigned2 ON (edfAssigned2.id = Clients.ClientId AND edfAssigned2.ExtraFieldId = (SELECT ExtraField.id FROM ExtraField WHERE LTGuid = 'e74a03bc-b190-4ccb-9c29-95d7f3b23c1f'))\r\nLEFT JOIN ExtraFieldData edfDefault2 ON (edfDefault2.id = 0 AND edfDefault2.ExtraFieldId = (SELECT ExtraField.id FROM ExtraField WHERE LTGuid = 'e74a03bc-b190-4ccb-9c29-95d7f3b23c1f'))\r\nLEFT JOIN ExtraFieldData edfAssigned3 ON (edfAssigned3.id = Clients.ClientId AND edfAssigned3.ExtraFieldId = (SELECT ExtraField.id FROM ExtraField WHERE LTGuid = '3c002fdd-a25a-4bc2-bb1e-1a6f7af67432'))\r\nLEFT JOIN ExtraFieldData edfDefault3 ON (edfDefault3.id = 0 AND edfDefault3.ExtraFieldId = (SELECT ExtraField.id FROM ExtraField WHERE LTGuid = '3c002fdd-a25a-4bc2-bb1e-1a6f7af67432'))\r\nWHERE \r\n((((IF(INSTR(IFNULL(inv_operatingsystem.Name, Computers.OS), 'windows') > 0, 1, IF(INSTR(IFNULL(inv_operatingsystem.Name, Computers.OS), 'darwin') > 0, 2, 3)) = '1') AND (((IFNULL(IFNULL(edfAssigned1.Value, edfDefault1.value), '0') <> 0) OR (IFNULL(IFNULL(edfAssigned2.Value, edfDefault2.value), '0') <> 0) OR (IFNULL(IFNULL(edfAssigned3.Value, edfDefault3.value), '0') <> 0))))))' AS `SQL`,\r\n  '4' AS `QueryType`,\r\n  'Select||=||=||=|^Select|||||||^' AS `ListData`,\r\n  '0' AS `FolderID`,\r\n  '80d153cb-440b-4312-9191-a9f5dd20744a' AS `GUID`,\r\n  '\\\\<LabTechAbstractSearch>\\\\<asn>\\\\<st>AndNode\\\\</st>\\\\<cn>\\\\<asn>\\\\<st>AndNode\\\\</st>\\\\<cn>\\\\<asn>\\\\<st>ComparisonNode\\\\</st>\\\\<lon>Computer.OS.Type\\\\</lon>\\\\<lok>Computer.OS.Type\\\\</lok>\\\\<lmo>Equals\\\\</lmo>\\\\<dv>Windows\\\\</dv>\\\\<dk>1\\\\</dk>\\\\</asn>\\\\<asn>\\\\<st>OrNode\\\\</st>\\\\<cn>\\\\<asn>\\\\<st>ComparisonNode\\\\</st>\\\\<lon>Computer.Client.Extra Data Field.Security.Lockdown Browsers Password Manager\\\\</lon>\\\\<lok>Computer.Client.Edf.611dcf5a-b316-4986-a624-a176efe4b5c6\\\\</lok>\\\\<lmo>IsTrue\\\\</lmo>\\\\<dv>NULL\\\\</dv>\\\\<dk>NULL\\\\</dk>\\\\</asn>\\\\<asn>\\\\<st>ComparisonNode\\\\</st>\\\\<lon>Computer.Client.Extra Data Field.Security.Lockdown Browsers Credit Card Autofill\\\\</lon>\\\\<lok>Computer.Client.Edf.e74a03bc-b190-4ccb-9c29-95d7f3b23c1f\\\\</lok>\\\\<lmo>IsTrue\\\\</lmo>\\\\<dv>NULL\\\\</dv>\\\\<dk>NULL\\\\</dk>\\\\</asn>\\\\<asn>\\\\<st>ComparisonNode\\\\</st>\\\\<lon>Computer.Client.Extra Data Field.Security.Lockdown Browsers Address Autofill\\\\</lon>\\\\<lok>Computer.Client.Edf.3c002fdd-a25a-4bc2-bb1e-1a6f7af67432\\\\</lok>\\\\<lmo>IsTrue\\\\</lmo>\\\\<dv>NULL\\\\</dv>\\\\<dk>NULL\\\\</dk>\\\\</asn>\\\\</cn>\\\\</asn>\\\\</cn>\\\\</asn>\\\\</cn>\\\\</LabTechAbstractSearch>' AS `SearchXML`\r\nFROM  \r\n  (SELECT MIN(computerid) FROM computers) a\r\nWHERE  \r\n  (SELECT COUNT(*) FROM SensorChecks WHERE `GUID` = '80d153cb-440b-4312-9191-a9f5dd20744a') = 0;\n"})}),"\n",(0,s.jsx)(r.h2,{id:"step-5",children:"Step 5"}),"\n",(0,s.jsx)(r.h3,{id:"create-groups",children:"Create Groups"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"INSERT IGNORE INTO `mastergroups` (\r\n  `ParentID`, `Parents`, `Children`,\r\n  `depth`, `Name`, `FullName`, `Permissions`,\r\n  `Template`, `AutoJoinScript`, `Master`,\r\n  `LimitToParent`, `Control`, `ControlID`,\r\n  `Notes`, `MaintenanceID`, `MaintWindowApplied`,\r\n  `GroupType`, `Priority`, `GUID`,\r\n  `assetID`, `NetworkPermissions`,\r\n  `NetworkJoin`, `NetworkJoinOptions`,\r\n  `ContactPermissions`, `ContactJoin`,\r\n  `ContactJoinOptions`\r\n) \r\nVALUES \r\n(\r\n  0,\r\n  ',',\r\n  ',',\r\n  0,\r\n  '\u25b3 System Monitoring',\r\n  '\u25b3 System Monitoring',\r\n  0,\r\n  0,\r\n  0,\r\n  2,\r\n  0,\r\n  0,\r\n  0,\r\n  '',\r\n  0,\r\n  (NOW()),\r\n  5,\r\n  5,\r\n  '1749280f-9114-11ed-9c83-000c295e5f17',\r\n  NULL,\r\n  NULL,\r\n  0,\r\n  0,\r\n  NULL,\r\n  0,\r\n  0\r\n);\r\nSET \r\n  @searchid = (\r\n    SELECT \r\n      DISTINCT sensid \r\n    FROM \r\n      sensorchecks \r\n    WHERE \r\n      `GUID` = '80d153cb-440b-4312-9191-a9f5dd20744a'\r\n  );\r\nSET \r\n  @parentid = (\r\n    SELECT \r\n      groupid \r\n    FROM \r\n      mastergroups \r\n    WHERE \r\n      GUID = '1749280f-9114-11ed-9c83-000c295e5f17'\r\n  );\r\nSET \r\n  @parents = CONCAT(',', @parentid, ',');\r\nINSERT IGNORE INTO `mastergroups` (\r\n  `ParentID`, `Parents`, `Children`,\r\n  `depth`, `Name`, `FullName`, `Permissions`,\r\n  `Template`, `AutoJoinScript`, `Master`,\r\n  `LimitToParent`, `Control`, `ControlID`,\r\n  `Notes`, `MaintenanceID`, `MaintWindowApplied`,\r\n  `GroupType`, `Priority`, `GUID`,\r\n  `NetworkJoin`, `NetworkJoinOptions`,\r\n  `ContactJoin`, `ContactJoinOptions`\r\n) \r\nVALUES \r\n(\r\n  @parentid, @parents, ',', 1, '\u25b3 Lockdown Browsers Autofill',\r\n  '\u25b3 System Monitoring.\u25b3 Lockdown Browsers Autofill',\r\n  0, 0, @searchid, 2, 1, 0, 0, '', 0, NOW(),\r\n  5, 5, 'eea5f14b-c12a-11ee-a53f-960002890dfa',\r\n  0, 0, 0, 0\r\n);\n"})}),"\n",(0,s.jsx)(r.h2,{id:"step-6",children:"Step 6"}),"\n",(0,s.jsx)(r.h3,{id:"create-remote-monitors",children:"Create Remote Monitors"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"SET @groupid = (SELECT groupid FROM mastergroups WHERE `GUID` = 'eea5f14b-c12a-11ee-a53f-960002890dfa');\r\nSET @searchid = (SELECT SensID FROM sensorchecks WHERE `GUID` = '40d97d6b-8726-48f3-ac28-eeaed20f75d7');\r\nINSERT INTO groupagents \r\n  SELECT '' AS `AgentID`,\r\n  `groupid` AS `GroupID`,\r\n  @Searchid AS `SearchID`,\r\n  'ProVal - Production - Lockdown Browsers Password Manager' AS `Name`,\r\n  '6' AS `CheckAction`,\r\n  '1' AS `AlertAction`,\r\n  'Browsers Password Manager Lockdown - Failed on %CLIENTNAME%////%COMPUTERNAME%~~~Successfully Disabled the Password Manager for the Installed Browsers. !!!Browsers Password Manager Lockdown - Failed on %CLIENTNAME%////%COMPUTERNAME%~~~Password Manager Lockdown failed on %CLIENTNAME%////%COMPUTERNAME%. The script was unable to disable the Password Manager on the following browsers:%RESULT%Manual investigation is required.' AS `AlertMessage`,\r\n  '0' AS `ContactID`,\r\n  '604800' AS `interval`,\r\n  '127.0.0.1' AS `Where`,\r\n  '7' AS `What`,\r\n  'C:////Windows////System32////WindowsPowerShell////v1.0////powershell.exe -ExecutionPolicy Bypass -Command /\\\"$erroractionpreference = //'silentlycontinue//'; $browsers = @{//'Google Chrome//' = //'HKLM:////Software////Policies////Google////Chrome//'; //'Microsoft Edge//' = //'HKLM:////SOFTWARE////Policies////Microsoft////Edge//'; Brave = //'HKLM:////SOFTWARE////Policies////BraveSoftware////Brave//'; //'Mozilla Firefox//' = //'HKLM:////Software////Policies////Mozilla////Firefox//'}; function find-application {Param([Parameter()][String]$Name); if (Get-ChildItem -Path HKLM:////SOFTWARE////Microsoft////Windows////CurrentVersion////Uninstall, HKLM:////SOFTWARE////Wow6432Node////Microsoft////Windows////CurrentVersion////Uninstall | Get-ItemProperty | Where-Object { $_.DisplayName -match $name }) {return $true} else {return $false} }; function check-regvalue { Param([Parameter()][String]$path); (Get-ItemProperty -Path $path ).passwordmanagerenabled }; function set-regvalue { Param([Parameter()][String]$path) ;  if ( ( check-regvalue -path $path ) -ne //'0//' ) { if ( !( Test-Path $path ) ) { New-Item -Path $path -Force | Out-Null }; Set-ItemProperty -Path $path -Name PasswordManagerEnabled -Value 0 -Force } } ; $failed=@(); foreach ( $browser in $browsers.Keys ) { if ( find-application -Name $browser ) { set-regvalue -Path $browsers.($browser); if ( ( check-regvalue -path $browsers.($browser) ) -ne //'0//' ) { $failed += $browser } } }; if ( $failed ) { return /////\\\"Failed: $($failed)/////\\\" }/\\\"' AS `DataOut`,\r\n  '16' AS `Comparor`,\r\n  '10|(^((OK){0,}(////r////n){0,}[////r////n]{0,}////s{0,})$)|11|(^((OK){0,}(////r////n){0,}[////r////n]{0,}////s{0,})$)%7C(Failed: ((Google Chrome)%7C(Brave)%7C(Microsoft Edge)))|10|(Failed: ((Google Chrome)%7C(Brave)%7C(Microsoft Edge)))' AS `DataIn`,\r\n  '' AS `IDField`,\r\n  '0' AS `AlertStyle`,\r\n  '0' AS `ScriptID`,\r\n  '' AS `datacollector`,\r\n  '21' AS `Category`,\r\n  '0' AS `TicketCategory`,\r\n  '1' AS `ScriptTarget`,\r\n  CONCAT(\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1)\r\n  ) AS `GUID`,\r\n  'root' AS `UpdatedBy`,\r\n  (NOW()) AS `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid = @groupid\r\nAND m.groupid NOT IN (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Production - Lockdown Browsers Password Manager');\r\nSET @groupid = (SELECT groupid FROM mastergroups WHERE `GUID` = 'eea5f14b-c12a-11ee-a53f-960002890dfa');\r\nSET @searchid = (SELECT SensID FROM sensorchecks WHERE `GUID` = 'bcfaf65a-4eb7-4cf9-9496-0c94ae86e59b');\r\nINSERT INTO groupagents \r\n  SELECT '' AS `AgentID`,\r\n  `groupid` AS `GroupID`,\r\n  @searchid AS `SearchID`,\r\n  'ProVal - Production - Lockdown Chromium Browsers Credit Card Autofill' AS `Name`,\r\n  '6' AS `CheckAction`,\r\n  '1' AS `AlertAction`,\r\n  'Chromium Browsers Credit Cards Autofill Lockdown - Failed on %CLIENTNAME%////%COMPUTERNAME%~~~Successfully Disabled the Credit Cards Autofill for the Installed Browsers. !!!Chromium Browsers Credit Cards Autofill Lockdown - Failed on %CLIENTNAME%////%COMPUTERNAME%~~~Credit Cards Autofill Lockdown Failed on %CLIENTNAME%////%COMPUTERNAME%. The script was unable to disable the Autofill of Credit Cards on the following browsers:%RESULT%Manual investigation is required.' AS `AlertMessage`,\r\n  '0' AS `ContactID`,\r\n  '604800' AS `interval`,\r\n  '127.0.0.1' AS `Where`,\r\n  '7' AS `What`,\r\n  'C:////Windows////System32////WindowsPowerShell////v1.0////powershell.exe -ExecutionPolicy Bypass -Command /\\\"$ErrorActionPreference = //'SilentlyContinue//';$browsers = @{//'Google Chrome//' = //'HKLM:////Software////Policies////Google////Chrome//';//'Microsoft Edge//' = //'HKLM:////SOFTWARE////Policies////Microsoft////Edge//';//'Brave//' = //'HKLM:////SOFTWARE////Policies////BraveSoftware////Brave//'}; Function Find-Application { Param([Parameter()][String]$Name); if ( Get-ChildItem -Path HKLM:////SOFTWARE////Microsoft////Windows////CurrentVersion////Uninstall, HKLM:////SOFTWARE////Wow6432Node////Microsoft////Windows////CurrentVersion////Uninstall | Get-ItemProperty | Where-Object { $_.DisplayName -match /\\\"$Name/\\\" } ) { return $Name } else { return $false } }; Function Get-RegValue { Param([Parameter()][String]$path,$Reg); ( Get-ItemProperty -Path $path )./\\\"$Reg/\\\" }; Function Set-RegValue { Param([Parameter()][String]$path,$Reg); if ( ( Get-RegValue -path $path -Reg $Reg ) -ne //'0//' ) { if ( !( Test-Path $path ) ) { New-Item -Path $path -Force | Out-Null }; Set-ItemProperty -Path $path -Name $Reg -Value 0 -Force } }; $failed = @(); foreach ( $browser in $browsers.Keys ) { if ( Find-Application -Name $browser ) { foreach ( $Reg in (//'AutofillCreditCardEnabled//', //'PaymentMethodQueryEnabled//') ) { Set-RegValue -Path $browsers.($browser) -Reg $Reg; if ( ( Get-RegValue -path $browsers.($browser) -Reg $Reg ) -ne //'0//' ) { $failed += $browser } } } }; if ( $failed ) { return /////\\\"Failed: $($failed)/////\\\" }/\\\"' AS `DataOut`,\r\n  '16' AS `Comparor`,\r\n  '10|(^((OK){0,}(////r////n){0,}[////r////n]{0,}////s{0,})$)|11|(^((OK){0,}(////r////n){0,}[////r////n]{0,}////s{0,})$)%7C(Failed: ((Google Chrome)%7C(Brave)%7C(Microsoft Edge)))|10|(Failed: ((Google Chrome)%7C(Brave)%7C(Microsoft Edge)))' AS `DataIn`,\r\n  '' AS `IDField`,\r\n  '0' AS `AlertStyle`,\r\n  '0' AS `ScriptID`,\r\n  '' AS `datacollector`,\r\n  '21' AS `Category`,\r\n  '0' AS `TicketCategory`,\r\n  '1' AS `ScriptTarget`,\r\n  CONCAT(\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1)\r\n  ) AS `GUID`,\r\n  'root' AS `UpdatedBy`,\r\n  (NOW()) AS `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid = @groupid\r\nAND m.groupid NOT IN (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Production - Lockdown Chromium Browsers Credit Card Autofill');\n"})}),"\n",(0,s.jsx)(r.h2,{id:"step-7",children:"Step 7"}),"\n",(0,s.jsx)(r.p,{children:"Reload System Cache"}),"\n",(0,s.jsx)(r.h2,{id:"step-8",children:"Step 8"}),"\n",(0,s.jsx)(r.p,{children:"Refresh Searches and Groups."}),"\n",(0,s.jsx)(r.h2,{id:"step-9",children:"Step 9"}),"\n",(0,s.jsxs)(r.p,{children:["Confirm the presence of the following remote monitors on the ",(0,s.jsx)(r.code,{children:"\u25b3 Lockdown Browsers Autofill"})," group:"]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"ProVal - Production - Lockdown Browsers Password Manager"}),"\n",(0,s.jsx)(r.li,{children:"ProVal - Production - Lockdown Chromium Browsers Credit Card Autofill"}),"\n",(0,s.jsx)(r.li,{children:"ProVal - Production - Lockdown Chromium Browsers Address Autofill"}),"\n"]})]})}function u(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,r,n)=>{n.d(r,{R:()=>a,x:()=>i});var o=n(296540);const s={},t=o.createContext(s);function a(e){const r=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),o.createElement(t.Provider,{value:r},e.children)}}}]);