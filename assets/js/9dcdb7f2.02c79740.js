"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[98331],{571059:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>s,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"cwa/monitors/5cc62311-8109-43b8-af64-e0aac4292d19","title":"Import - Remote Monitor - Deploy Teams","description":"This document outlines the implementation process of the Deploy Teams remote monitor.","source":"@site/docs/cwa/monitors/Import-Remote-Monitor-Deploy-Teams.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/5cc62311-8109-43b8-af64-e0aac4292d19","permalink":"/docs/cwa/monitors/5cc62311-8109-43b8-af64-e0aac4292d19","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Import-Remote-Monitor-Deploy-Teams.md","tags":[{"inline":false,"label":"ConnectWise","permalink":"/docs/tags/connectwise","description":"Documents on ConnectWise platforms for IT service management"},{"inline":false,"label":"Database","permalink":"/docs/tags/database","description":"Documents related to database management systems and operations"}],"version":"current","frontMatter":{"id":"5cc62311-8109-43b8-af64-e0aac4292d19","title":"Import - Remote Monitor - Deploy Teams","title_meta":"Import - Remote Monitor - Deploy Teams","keywords":["teams","machine-wide","connectwise","monitoring","alert"],"description":"This document outlines the implementation process of the Deploy Teams remote monitor.","tags":["connectwise","database"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Import - Hyper-V - Integration Service Out of Date.md","permalink":"/docs/cwa/monitors/81a45e9e-918b-4848-bcf7-874ee4a6c8a0"},"next":{"title":"Import - Remote Monitor - Set-PsRepository PSGallery","permalink":"/docs/cwa/monitors/5cb1373f-6cdc-4576-8b3e-e8bfc4d664de"}}');var a=n(474848),o=n(28453);const s={id:"5cc62311-8109-43b8-af64-e0aac4292d19",title:"Import - Remote Monitor - Deploy Teams",title_meta:"Import - Remote Monitor - Deploy Teams",keywords:["teams","machine-wide","connectwise","monitoring","alert"],description:"This document outlines the implementation process of the Deploy Teams remote monitor.",tags:["connectwise","database"],draft:!1,unlisted:!1},i=void 0,l={},c=[{value:"Implementation Steps",id:"implementation-steps",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h2,{id:"implementation-steps",children:"Implementation Steps"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["Import\xa0",(0,a.jsx)(t.a,{href:"/docs/cwa/scripts/d5ce6f1c-94ef-4e78-8e0a-61dd74f8d2cc",children:"Winget - Install/Update - Teams"}),"\xa0script."]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Run this SQL query from a RAWSQL monitor set to create the alert template.\xa0"}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-sql",children:"#Create Alert Template\r\nINSERT INTO `alerttemplate` (`Name`, `Comment`, `Last_User`, `Last_Date`, `GUID`)\xa0\r\nSELECT\xa0\r\n'\u25b3 Custom - Execute Script - Winget - Install/Update - Teams' AS `Name`,\xa0\r\n'\u25b3 Custom - Execute Script - Winget - Install/Update - Teams' AS `Comment`,\r\n'PRONOC' AS `Last_User`,\r\n(NOW()) AS `Last_Date`,\r\n'e0bd7229-5390-462d-9e21-ec56567219c5' AS `GUID`\xa0\r\nFrom (SELECT MIN(computerid) FROM computers) a\r\nWHERE (SELECT COUNT(*) FROM alerttemplate WHERE GUID = 'e0bd7229-5390-462d-9e21-ec56567219c5') = '0';\r\nINSERT INTO `alerttemplates` (`AlertActionID`, `DayOfWeek`, `TimeStart`, `TimeEnd`, `AlertAction`, `ContactID`, `UserID`, `ScriptID`, `Trump`, `GUID`, `WarningAction`)\r\nSELECT\xa0\r\n(SELECT alertactionid FROM alerttemplate WHERE `GUID` = 'e0bd7229-5390-462d-9e21-ec56567219c5') AS `AlertActionid`,\r\n'127' AS `DayOfWeek`,\r\n'00:00:00' AS `TimeStart`,\r\n'23:59:00' AS `TimeEnd`,\r\n'512' AS `AlertAction`,\r\n'-2' AS `ContactID`,\r\n'0' AS `UserID`,\r\n(SELECT Scriptid FROM lt_scripts WHERE scriptGUID = '32ea4448-2fd8-11ee-9dfe-000c295e5f21') AS `Scriptid`,\r\n'0' AS `Trump`,\r\n'620d5c4d-e89e-455a-ab72-bf98992119e4' AS `GUID`,\r\n'0' AS `WarningAction`\xa0\r\nFrom (SELECT MIN(computerid) FROM computers) a\r\nWHERE (SELECT COUNT(*) FROM alerttemplates WHERE GUID = '620d5c4d-e89e-455a-ab72-bf98992119e4') = '0' ;\n"})}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"Obtain the groupid(s) of the group(s) that the remote monitor should be applied to."}),"\n",(0,a.jsxs)(t.li,{children:["Copy the following query and replace 'YOUR COMMA SEPARATED LIST OF GROUPID(S)' with the Groupid(s) of the relevant groups: (The string to replace can be found at the very bottom of the query, right after ",(0,a.jsx)(t.code,{children:"WHERE"}),")"]}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-sql",children:"SET @AlertAction = (SELECT Alertactionid FROM alerttemplate WHERE `GUID` = 'e0bd7229-5390-462d-9e21-ec56567219c5') ;\r\nINSERT INTO groupagents\xa0\r\n\xa0SELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'ProVal - Dev - Deploy Teams' as `Name`,\r\n'6' as `CheckAction`,\r\n@AlertAction as `AlertAction`,\r\n'%NAME% %STATUS% on %CLIENTNAME%\\\\%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%.!!!%NAME% %STATUS% on %CLIENTNAME%\\\\%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%.' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'86400' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command \"if (((Get-ChildItem -Path HKLM:\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall, HKLM:\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall | Get-ItemProperty | Where-Object {$_.DisplayName -eq \\'Teams Machine-Wide Installer\\' }))) {return \\'Deployed\\'} else {return \\'Not Installed\\'}\"' as `DataOut`,\r\n'16' as `Comparor`,\r\n'8|Deployed|11|(Deployed)%7C(Not Installed)|10|Not Installed' as `DataIn`,\r\n'' as `IDField`,\r\n'1' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'21' as `Category`,\r\n'0' as `TicketCategory`,\r\n'1' as `ScriptTarget`,\r\nUUID() as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (YOUR COMMA SEPARATED LIST OF GROUPID(S))\r\nAND m.groupid NOT IN \xa0(SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Dev - Deploy Teams')\n"})}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"An example of a query with a groupid:"}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-sql",children:"SET @AlertAction = (SELECT Alertactionid FROM alerttemplate WHERE `GUID` = 'e0bd7229-5390-462d-9e21-ec56567219c5') ;\r\nINSERT INTO groupagents\xa0\r\n\xa0SELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'ProVal - Dev - Deploy Teams' as `Name`,\r\n'6' as `CheckAction`,\r\n@AlertAction as `AlertAction`,\r\n'%NAME% %STATUS% on %CLIENTNAME%\\\\%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%.!!!%NAME% %STATUS% on %CLIENTNAME%\\\\%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%.' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'86400' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command \"if (((Get-ChildItem -Path HKLM:\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall, HKLM:\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall | Get-ItemProperty | Where-Object {$_.DisplayName -eq \\'Teams Machine-Wide Installer\\' }))) {return \\'Deployed\\'} else {return \\'Not Installed\\'}\"' as `DataOut`,\r\n'16' as `Comparor`,\r\n'8|Deployed|11|(Deployed)%7C(Not Installed)|10|Not Installed' as `DataIn`,\r\n'' as `IDField`,\r\n'1' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'21' as `Category`,\r\n'0' as `TicketCategory`,\r\n'1' as `ScriptTarget`,\r\nUUID() as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (2)\r\nAND m.groupid NOT IN \xa0(SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Dev - Deploy Teams')\n"})}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Now execute your query from a RAWSQL monitor set."}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Now Locate the Remote monitor on the group(s) and ensure that it's functioning as required.\xa0"}),"\n"]}),"\n"]})]})}function m(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>i});var r=n(296540);const a={},o=r.createContext(a);function s(e){const t=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(o.Provider,{value:t},e.children)}}}]);