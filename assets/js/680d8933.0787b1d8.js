"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[36894],{975654:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>o,contentTitle:()=>d,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"cwa/scripts/c4cb8f27-762f-4ebc-9840-f5cb7712a05d","title":"O365 - Audit Users to Custom Table DV","description":"This document details a script that utilizes O365 admin credentials to connect to O365 and audit users into a custom table. It highlights the requirements, process, and output of the script, which is designed for integration with the ProVal Dashboard for enhanced reporting capabilities.","source":"@site/docs/cwa/scripts/O365 - Audit Users to Custom Table DV.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/c4cb8f27-762f-4ebc-9840-f5cb7712a05d","permalink":"/proval-docs/docs/cwa/scripts/c4cb8f27-762f-4ebc-9840-f5cb7712a05d","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/O365 - Audit Users to Custom Table DV.md","tags":[{"inline":false,"label":"Installation","permalink":"/proval-docs/docs/tags/installation","description":"Documents on installing software and configuring systems"},{"inline":false,"label":"Report","permalink":"/proval-docs/docs/tags/report","description":"Documents focused on generating and managing reports"},{"inline":false,"label":"Security","permalink":"/proval-docs/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"c4cb8f27-762f-4ebc-9840-f5cb7712a05d","title":"O365 - Audit Users to Custom Table DV","title_meta":"O365 - Audit Users to Custom Table DV","keywords":["o365","audit","users","reporting","dashboard"],"description":"This document details a script that utilizes O365 admin credentials to connect to O365 and audit users into a custom table. It highlights the requirements, process, and output of the script, which is designed for integration with the ProVal Dashboard for enhanced reporting capabilities.","tags":["installation","report","security","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"NinjaRMMAgent Uninstaller","permalink":"/proval-docs/docs/cwa/scripts/52254d14-bc24-4f32-bb3c-7447756ec15f"},"next":{"title":"OSX - File Vault Audit","permalink":"/proval-docs/docs/cwa/scripts/6c8b7535-ef72-4635-a968-60261dea67de"}}');var r=t(474848),n=t(28453);const a={id:"c4cb8f27-762f-4ebc-9840-f5cb7712a05d",title:"O365 - Audit Users to Custom Table DV",title_meta:"O365 - Audit Users to Custom Table DV",keywords:["o365","audit","users","reporting","dashboard"],description:"This document details a script that utilizes O365 admin credentials to connect to O365 and audit users into a custom table. It highlights the requirements, process, and output of the script, which is designed for integration with the ProVal Dashboard for enhanced reporting capabilities.",tags:["installation","report","security","windows"],draft:!1,unlisted:!1},d=void 0,o={},l=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Variables",id:"variables",level:2},{value:"User Parameters",id:"user-parameters",level:3},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2}];function c(e){const s={br:"br",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(s.p,{children:"This script uses O365 admin credentials to connect to O365 and audit users to a custom table. By default, the script saves the O365 credentials to the password tab, so subsequent runs won't require entering them again (if these fields are left blank, it will attempt to load them from the passwords tab of the client). This script is intended to be used with ProVal's Dashboard for reporting. Dataviews built to monitor this will require super admin access."}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Requirements"}),(0,r.jsx)(s.br,{}),"\n","Windows OS and PowerShell 5.0 are required."]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Time Saved by Automation:"})," 15 Minutes"]}),"\n",(0,r.jsx)(s.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Sample Run",src:t(559147).A+"",width:"493",height:"441"})}),"\n",(0,r.jsx)(s.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,r.jsx)(s.p,{children:"@O365 Users DV???"}),"\n",(0,r.jsx)(s.h2,{id:"variables",children:"Variables"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"@Add-Update-Username@ - User Param"}),"\n",(0,r.jsx)(s.li,{children:"@Add-Update-Password@ - User Param"}),"\n",(0,r.jsx)(s.li,{children:"@passwordid@ - Pulls from the Passwords table"}),"\n",(0,r.jsx)(s.li,{children:"@username@"}),"\n",(0,r.jsx)(s.li,{children:"@password@"}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"user-parameters",children:"User Parameters"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Example"}),(0,r.jsx)(s.th,{children:"Required"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Add-Update-Username"}),(0,r.jsx)(s.td,{children:"User"}),(0,r.jsx)(s.td,{children:"False"}),(0,r.jsx)(s.td,{children:"Will add or update a stored username for O365 admin in the Passwords Tab"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Add-Update-Password"}),(0,r.jsx)(s.td,{children:"Password1"}),(0,r.jsx)(s.td,{children:"False"}),(0,r.jsx)(s.td,{children:"Will add or update a stored password for O365 admin in the Passwords Tab"})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"process",children:"Process"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Creates the @plugin_proval_o365_users table."}),"\n",(0,r.jsx)(s.li,{children:"Checks if User Params for username/password have been entered; if yes, updates the table; if no, selects the existing username/passwords in the table."}),"\n",(0,r.jsx)(s.li,{children:"Checks for the AzureRM PowerShell module and installs it if missing."}),"\n",(0,r.jsx)(s.li,{children:"Attempts to connect to O365, gathers information, and imports it into the custom table."}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"output",children:"Output"}),"\n",(0,r.jsx)(s.p,{children:"Script Log"})]})}function u(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},559147:(e,s,t)=>{t.d(s,{A:()=>i});const i=t.p+"assets/images/image_1-fac0b3eea45f61a999d839937205c65d.png"},28453:(e,s,t)=>{t.d(s,{R:()=>a,x:()=>d});var i=t(296540);const r={},n=i.createContext(r);function a(e){const s=i.useContext(n);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(n.Provider,{value:s},e.children)}}}]);