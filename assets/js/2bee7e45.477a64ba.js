"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[85212],{583692:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>c,contentTitle:()=>o,default:()=>R,frontMatter:()=>i,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"cwa/monitors/e79a2422-0089-451b-9522-a6110976c2f5","title":"Disable RestrictDriverInstallationToAdministrators","description":"This document provides a detailed guide on how to disable the Restrict Driver Installation to Administrators setting in a ConnectWise Automate environment. It includes steps for ensuring the script and alert template are in place, obtaining group IDs, and executing the necessary SQL query to apply the changes effectively.","source":"@site/docs/cwa/monitors/Disable RestrictDriverInstallationToAdministrators.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/e79a2422-0089-451b-9522-a6110976c2f5","permalink":"/docs/cwa/monitors/e79a2422-0089-451b-9522-a6110976c2f5","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Disable RestrictDriverInstallationToAdministrators.md","tags":[{"inline":false,"label":"SQL","permalink":"/docs/tags/sql","description":"Documents discussing Structured Query Language and database interactions"}],"version":"current","frontMatter":{"id":"e79a2422-0089-451b-9522-a6110976c2f5","title":"Disable RestrictDriverInstallationToAdministrators","title_meta":"Disable RestrictDriverInstallationToAdministrators","keywords":["restrict","driver","installation","administrators","ticket","creation","monitor"],"description":"This document provides a detailed guide on how to disable the Restrict Driver Installation to Administrators setting in a ConnectWise Automate environment. It includes steps for ensuring the script and alert template are in place, obtaining group IDs, and executing the necessary SQL query to apply the changes effectively.","tags":["sql"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Disable Netbios on Network Interfaces","permalink":"/docs/cwa/monitors/7cd56a9d-67d5-4d67-a8bf-f61497a93059"},"next":{"title":"Disable Update Orchestrator Service Change","permalink":"/docs/cwa/monitors/f4687be0-4269-4cec-8e7b-685f56178f27"}}');var n=t(474848),s=t(28453);const i={id:"e79a2422-0089-451b-9522-a6110976c2f5",title:"Disable RestrictDriverInstallationToAdministrators",title_meta:"Disable RestrictDriverInstallationToAdministrators",keywords:["restrict","driver","installation","administrators","ticket","creation","monitor"],description:"This document provides a detailed guide on how to disable the Restrict Driver Installation to Administrators setting in a ConnectWise Automate environment. It includes steps for ensuring the script and alert template are in place, obtaining group IDs, and executing the necessary SQL query to apply the changes effectively.",tags:["sql"],draft:!1,unlisted:!1},o=void 0,c={},l=[{value:"Steps",id:"steps",level:2},{value:"1.",id:"1",level:3},{value:"2.",id:"2",level:3},{value:"3.",id:"3",level:3},{value:"4.",id:"4",level:3},{value:"5.",id:"5",level:3},{value:"6.",id:"6",level:3}];function d(e){const r={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.h2,{id:"steps",children:"Steps"}),"\n",(0,n.jsx)(r.h3,{id:"1",children:"1."}),"\n",(0,n.jsxs)(r.p,{children:["Ensure the presence of the ",(0,n.jsx)(r.a,{href:"/docs/cwa/scripts/63beba3c-f4a6-41a5-98e2-d4e4ce885035",children:"CWM - Automate - Script - Ticket Creation - Computer"})," script and ",(0,n.jsx)(r.code,{children:"\u25b3 Custom - Ticket Creation Computer - Failures Only"})," alert template."]}),"\n",(0,n.jsx)(r.h3,{id:"2",children:"2."}),"\n",(0,n.jsx)(r.p,{children:"Obtain the group ID(s) of the group(s) that the remote monitor should be applied to."}),"\n",(0,n.jsx)(r.h3,{id:"3",children:"3."}),"\n",(0,n.jsxs)(r.p,{children:["Copy the following query and replace '",(0,n.jsx)(r.strong,{children:"YOUR COMMA SEPARATED LIST OF GROUPID(S)"}),"' with the Group ID(s) of the relevant groups:",(0,n.jsx)(r.br,{}),"\n","(The string to replace can be found at the very bottom of the query, right after ",(0,n.jsx)(r.strong,{children:"WHERE"}),")"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"INSERT INTO groupagents  \r\n  SELECT '' as `AgentID`,\r\n  `groupid` as `GroupID`,\r\n  '0' as `SearchID`,\r\n  'ProVal - Client Specific - Disable RestrictDriverInstallationToAdministrators' as `Name`,\r\n  '6' as `CheckAction`,\r\n  '1' as `AlertAction`,\r\n  'Failed to Disable RestrictDriverInstallationToAdministrators~~~Value Successfully Set.!!!Failed to Disable RestrictDriverInstallationToAdministrators~~~%RESULT%' as `AlertMessage`,\r\n  '0' as `ContactID`,\r\n  '86400' as `interval`,\r\n  '127.0.0.1' as `Where`,\r\n  '7' as `What`,\r\n  'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command /\"$P = \\'HKLM:\\\\Software\\\\Policies\\\\Microsoft\\\\Windows NT\\\\Printers\\\\PointAndPrint\\'; $N = \\'RestrictDriverInstallationToAdministrators\\'; $V = 0; if ( !( (get-ItemProperty $P -Erroraction SilentlyContinue).$N -eq $V) ) {if(!(Test-Path -Path $P)) {try {New-Item -Path $P -Force -Erroraction stop | Out-Null} catch {return /\"Failed to create registry path $P. Reason: $($Error[0].Exception.Message)/\"}}; try {Set-Itemproperty -Path $P -Name $N -Value $V -Type \\'DWord\\' -Erroraction stop; return \\'Registry changes applied.\\'} catch {return /\"Failed to set registry key. Reason: $($Error[0].Exception.Message)/\"}} else {return \\'Registry Key is already set.\\'}/\"' as `DataOut`,\r\n  '16' as `Comparor`,\r\n  '10|(^$%7C^(\\\\s%7COK%7C\\\\r\\\\n)$)%7C(Registry changes applied)%7C(Registry Key is already set)|11|(^$%7C^(\\\\s%7COK%7C\\\\r\\\\n)$)%7C(Failed to Set Registry Value RestrictDriverInstallationToAdministrators. Reason:)%7C(Registry changes applied)%7C(Registry Key is already set)|5|Failed to Set Registry Value RestrictDriverInstallationToAdministrators. Reason:' as `DataIn`,\r\n  '' as `IDField`,\r\n  '1' as `AlertStyle`,\r\n  '0' as `ScriptID`,\r\n  '' as `datacollector`,\r\n  '21' as `Category`,\r\n  '0' as `TicketCategory`,\r\n  '1' as `ScriptTarget`,\r\n  CONCAT(\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1)\r\n  ) as `GUID`,\r\n  'root' as `UpdatedBy`,\r\n  (NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (YOUR COMMA SEPARATED LIST OF GROUPID(S))\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Client Specific - Disable RestrictDriverInstallationToAdministrators')\n"})}),"\n",(0,n.jsx)(r.h3,{id:"4",children:"4."}),"\n",(0,n.jsx)(r.p,{children:"An example of a query with a group ID:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"INSERT INTO groupagents  \r\n  SELECT '' as `AgentID`,\r\n  `groupid` as `GroupID`,\r\n  '0' as `SearchID`,\r\n  'ProVal - Client Specific - Disable RestrictDriverInstallationToAdministrators' as `Name`,\r\n  '6' as `CheckAction`,\r\n  '1' as `AlertAction`,\r\n  'Failed to Disable RestrictDriverInstallationToAdministrators~~~Value Successfully Set.!!!Failed to Disable RestrictDriverInstallationToAdministrators~~~%RESULT%' as `AlertMessage`,\r\n  '0' as `ContactID`,\r\n  '86400' as `interval`,\r\n  '127.0.0.1' as `Where`,\r\n  '7' as `What`,\r\n  'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command /\"$P = \\'HKLM:\\\\Software\\\\Policies\\\\Microsoft\\\\Windows NT\\\\Printers\\\\PointAndPrint\\'; $N = \\'RestrictDriverInstallationToAdministrators\\'; $V = 0; if ( !( (get-ItemProperty $P -Erroraction SilentlyContinue).$N -eq $V) ) {if(!(Test-Path -Path $P)) {try {New-Item -Path $P -Force -Erroraction stop | Out-Null} catch {return /\"Failed to create registry path $P. Reason: $($Error[0].Exception.Message)/\"}}; try {Set-Itemproperty -Path $P -Name $N -Value $V -Type \\'DWord\\' -Erroraction stop; return \\'Registry changes applied.\\'} catch {return /\"Failed to set registry key. Reason: $($Error[0].Exception.Message)/\"}} else {return \\'Registry Key is already set.\\'}/\"' as `DataOut`,\r\n  '16' as `Comparor`,\r\n  '10|(^$%7C^(\\\\s%7COK%7C\\\\r\\\\n)$)%7C(Registry changes applied)%7C(Registry Key is already set)|11|(^$%7C^(\\\\s%7COK%7C\\\\r\\\\n)$)%7C(Failed to Set Registry Value RestrictDriverInstallationToAdministrators. Reason:)%7C(Registry changes applied)%7C(Registry Key is already set)|5|Failed to Set Registry Value RestrictDriverInstallationToAdministrators. Reason:' as `DataIn`,\r\n  '' as `IDField`,\r\n  '1' as `AlertStyle`,\r\n  '0' as `ScriptID`,\r\n  '' as `datacollector`,\r\n  '21' as `Category`,\r\n  '0' as `TicketCategory`,\r\n  '1' as `ScriptTarget`,\r\n  CONCAT(\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    '-',\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n    SUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1)\r\n  ) as `GUID`,\r\n  'root' as `UpdatedBy`,\r\n  (NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (2,856)\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Client Specific - Disable RestrictDriverInstallationToAdministrators')\n"})}),"\n",(0,n.jsx)(r.h3,{id:"5",children:"5."}),"\n",(0,n.jsx)(r.p,{children:"Now execute your query from a RAWSQL monitor set."}),"\n",(0,n.jsx)(r.h3,{id:"6",children:"6."}),"\n",(0,n.jsxs)(r.p,{children:["Locate your remote monitor by opening the group(s) remote monitors tab, then apply the ",(0,n.jsx)(r.code,{children:"\u25b3 Custom - Ticket Creation - Computer - Failures Only"})," alert template."]})]})}function R(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},28453:(e,r,t)=>{t.d(r,{R:()=>i,x:()=>o});var a=t(296540);const n={},s=a.createContext(n);function i(e){const r=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),a.createElement(s.Provider,{value:r},e.children)}}}]);