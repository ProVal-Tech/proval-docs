"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[6526],{519986:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>m,frontMatter:()=>i,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"cwa/monitors/fc982478-9b78-470f-b9c0-35d21761c7ef","title":"Drive Errors and Raid Failures RECOVERED","description":"This document provides a comprehensive overview of a monitoring solution that proactively checks for drive errors and RAID failure events on Windows OS, detailing the SQL query used and answering common questions related to its configuration and usage.","source":"@site/docs/cwa/monitors/Drive Errors and Raid Failures RECOVERED.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/fc982478-9b78-470f-b9c0-35d21761c7ef","permalink":"/docs/cwa/monitors/fc982478-9b78-470f-b9c0-35d21761c7ef","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Drive Errors and Raid Failures RECOVERED.md","tags":[{"inline":false,"label":"Event Logs","permalink":"/docs/tags/eventlogs","description":"Documents on analyzing and managing system event logs"},{"inline":false,"label":"Performance","permalink":"/docs/tags/performance","description":"Documents related to enhancing system and application performance"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"fc982478-9b78-470f-b9c0-35d21761c7ef","title":"Drive Errors and Raid Failures RECOVERED","title_meta":"Drive Errors and Raid Failures RECOVERED","keywords":["drive","raid","errors","monitor","windows","eventlogs"],"description":"This document provides a comprehensive overview of a monitoring solution that proactively checks for drive errors and RAID failure events on Windows OS, detailing the SQL query used and answering common questions related to its configuration and usage.","tags":["eventlogs","performance","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Domain Trust Relationship Check","permalink":"/docs/cwa/monitors/bf518e9f-f93c-451b-a38a-5fc3472cc6f4"},"next":{"title":"Drive Errors and Raid Failures","permalink":"/docs/cwa/monitors/cef450c6-b649-4bd3-bcde-ed521d38d77f"}}');var o=r(474848),s=r(28453);const i={id:"fc982478-9b78-470f-b9c0-35d21761c7ef",title:"Drive Errors and Raid Failures RECOVERED",title_meta:"Drive Errors and Raid Failures RECOVERED",keywords:["drive","raid","errors","monitor","windows","eventlogs"],description:"This document provides a comprehensive overview of a monitoring solution that proactively checks for drive errors and RAID failure events on Windows OS, detailing the SQL query used and answering common questions related to its configuration and usage.",tags:["eventlogs","performance","windows"],draft:!1,unlisted:!1},a=void 0,c={},d=[{value:"Summary",id:"summary",level:2},{value:"Target",id:"target",level:2},{value:"Translated SQL",id:"translated-sql",level:2},{value:"FAQ",id:"faq",level:2}];function l(e){const n={br:"br",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,o.jsx)(n.p,{children:"This monitor proactively looks for all the drive errors and RAID failure events generated in the last 24 hours."}),"\n",(0,o.jsx)(n.h2,{id:"target",children:"Target"}),"\n",(0,o.jsx)(n.p,{children:"Windows OS"}),"\n",(0,o.jsx)(n.h2,{id:"translated-sql",children:"Translated SQL"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sql",children:"SELECT  \r\n  CONCAT(\r\n    'Latest Event ',  \r\n    eventlogs.`TimeGen`,  \r\n    ': ',  \r\n    REPLACE(\r\n      REPLACE(eventlogs.`message`, '//'', ''),  \r\n      '//n',  \r\n      ''  \r\n    ),  \r\n    ' (',  \r\n    COUNT(eventlogs.computerid),  \r\n    ' events found)'  \r\n  ) AS TestValue,  \r\n  computers.name AS identityfield,  \r\n  computers.computerid,  \r\n  AgentComputerData.uptimestart,  \r\n  AgentComputerData.uptimeend,  \r\n  AgentComputerData.noalerts  \r\nFROM  \r\n  EventLogs  \r\n  LEFT JOIN Computers ON EventLogs.ComputerID = Computers.ComputerID  \r\n  LEFT JOIN Locations ON Locations.LocationID = Computers.Locationid  \r\n  LEFT JOIN Clients ON Clients.ClientID = Computers.clientid  \r\n  JOIN AgentComputerData ON Computers.ComputerID = AgentComputerData.ComputerID  \r\nWHERE  \r\n  (Eventlogs.Source LIKE 'disk')  \r\n  AND timegen > DATE_SUB(  \r\n    CURRENT_DATE(),  \r\n    INTERVAL 1 DAY  \r\n  )  \r\n  AND eventlogs.message NOT LIKE '%paging operation%'  \r\n  AND eventlogs.message NOT LIKE '%controller error on%'  \r\n  AND eventlogs.message NOT LIKE '%was retried%'  \r\n  AND eventlogs.message NOT LIKE '%surprise removed%'  \r\n  AND eventlogs.message NOT LIKE '%same disk identifiers%'  \r\n  AND eventlogs.message NOT LIKE '%the capacity of%'  \r\n  AND eventlogs.message NOT LIKE '%is not ready for access yet%' \r\n  #AND Computers.Computerid IN (SELECT computerid FROM tcomp)  \r\nGROUP BY  \r\n  eventlogs.computerid,  \r\n  eventlogs.message \r\n  #HAVING `TestValue` NOT REGEXP 'controller error on.*////(([1-9]|1[0-9]|20) events* found////)'  \r\nHAVING  \r\n  `TestValue` NOT REGEXP 'has a bad block.*////([1-9] events{0,1} found////)'  \n"})}),"\n",(0,o.jsx)(n.h2,{id:"faq",children:"FAQ"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Q: How do I ignore certain error types or only alert on a number of events?"}),(0,o.jsx)(n.br,{}),"\n",(0,o.jsx)(n.strong,{children:"A:"})," At the end of the query, there is a commented-out (by default) line for this behavior.",(0,o.jsx)(n.br,{}),"\n",(0,o.jsx)(n.img,{alt:"Image",src:r(414334).A+""})]}),"\n",(0,o.jsxs)(n.p,{children:["Remove the ",(0,o.jsx)(n.code,{children:"#"})," from this line to allow it to go into production. In this example, we want to ignore controller errors if there are fewer than 20 of them on a specific drive. The portion:",(0,o.jsx)(n.br,{}),"\n",(0,o.jsx)(n.img,{alt:"Image",src:r(500085).A+""}),(0,o.jsx)(n.br,{}),"\n","is the subject line of the event log that we want to exclude unless there are X results. The portion here:",(0,o.jsx)(n.br,{}),"\n",(0,o.jsx)(n.img,{alt:"Image",src:r(264172).A+""}),(0,o.jsx)(n.br,{}),"\n","is the number of events."]}),"\n",(0,o.jsx)(n.p,{children:'Translated from programming to human, this essentially says, "Do not tell me about controller errors unless there are more than 20 of them."'}),"\n",(0,o.jsx)(n.p,{children:"This could work for Paging Errors, Bad Blocks, or really anything you can match."})]})}function m(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},414334:(e,n,r)=>{r.d(n,{A:()=>t});const t=r.p+"assets/images/image_1-33a20feb3b28ce15250c7138a0890a47.png"},500085:(e,n,r)=>{r.d(n,{A:()=>t});const t=r.p+"assets/images/image_2-cd686e92ce7516481bf9a8c7746fcce5.png"},264172:(e,n,r)=>{r.d(n,{A:()=>t});const t=r.p+"assets/images/image_3-f9145131923bbe25bd1cbcacec092851.png"},28453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>a});var t=r(296540);const o={},s=t.createContext(o);function i(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);