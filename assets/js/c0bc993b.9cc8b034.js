"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[62006],{635157:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>n,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"cwa/monitors/f4687be0-4269-4cec-8e7b-685f56178f27","title":"Disable Update Orchestrator Service Change","description":"This document provides details on a remote monitor that checks the status of the Update Orchestrator Service on Windows machines. If the service is running, it will be stopped and disabled, ensuring that it does not interfere with system updates. Caution is advised as this action will change the state of the service across all systems the monitor is deployed to.","source":"@site/docs/cwa/monitors/Disable Update Orchestrator Service Change.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/f4687be0-4269-4cec-8e7b-685f56178f27","permalink":"/docs/cwa/monitors/f4687be0-4269-4cec-8e7b-685f56178f27","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Disable Update Orchestrator Service Change.md","tags":[{"inline":false,"label":"Update","permalink":"/docs/tags/update","description":"Documents discussing software and system updates and their management"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"f4687be0-4269-4cec-8e7b-685f56178f27","title":"Disable Update Orchestrator Service Change","title_meta":"Disable Update Orchestrator Service Change","keywords":["monitor","service","disable","windows","update","orchestrator"],"description":"This document provides details on a remote monitor that checks the status of the Update Orchestrator Service on Windows machines. If the service is running, it will be stopped and disabled, ensuring that it does not interfere with system updates. Caution is advised as this action will change the state of the service across all systems the monitor is deployed to.","tags":["update","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Disable RestrictDriverInstallationToAdministrators","permalink":"/docs/cwa/monitors/e79a2422-0089-451b-9522-a6110976c2f5"},"next":{"title":"Disk - Predictive Failure","permalink":"/docs/cwa/monitors/81638d59-3335-4464-af10-25f37ed41402"}}');var i=r(474848),a=r(28453);const n={id:"f4687be0-4269-4cec-8e7b-685f56178f27",title:"Disable Update Orchestrator Service Change",title_meta:"Disable Update Orchestrator Service Change",keywords:["monitor","service","disable","windows","update","orchestrator"],description:"This document provides details on a remote monitor that checks the status of the Update Orchestrator Service on Windows machines. If the service is running, it will be stopped and disabled, ensuring that it does not interfere with system updates. Caution is advised as this action will change the state of the service across all systems the monitor is deployed to.",tags:["update","windows"],draft:!1,unlisted:!1},o=void 0,c={},l=[{value:"Summary",id:"summary",level:2},{value:"What Will Change?",id:"what-will-change",level:3},{value:"Details",id:"details",level:2},{value:"Target",id:"target",level:2},{value:"Ticketing",id:"ticketing",level:2},{value:"Implementation",id:"implementation",level:2},{value:"Step 1",id:"step-1",level:3},{value:"Step 2",id:"step-2",level:3},{value:"Step 3",id:"step-3",level:3},{value:"Step 4",id:"step-4",level:3},{value:"FAQ",id:"faq",level:2}];function d(e){const t={br:"br",code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",img:"img",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(t.p,{children:"This remote monitor checks the status of the Update Orchestrator Service, and if it is found running, it will stop and disable the service."}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsxs)(t.p,{children:["This monitor will make a change to all systems it is deployed to.",(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.img,{src:"https://c.tenor.com/8vSJsVW-1pQAAAAj/police-car-light-joypixels.gif",alt:"Police Car Light"})]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h3,{id:"what-will-change",children:"What Will Change?"}),"\n",(0,i.jsxs)(t.p,{children:["This monitor will check if the Update Orchestrator service is enabled and will disable it.",(0,i.jsx)(t.br,{}),"\n","The service will be stopped and marked as 'Disabled'."]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.em,{children:"This action will occur regardless of what alert template is set against the monitor."}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.em,{children:"Monitors that make changes to the environment can be difficult to audit. Use with caution."})]}),"\n",(0,i.jsx)(t.h2,{id:"details",children:"Details"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Check Action"}),(0,i.jsx)(t.th,{children:"Server Address"}),(0,i.jsx)(t.th,{children:"Check Type"}),(0,i.jsx)(t.th,{children:"Check Value"}),(0,i.jsx)(t.th,{children:"Comparator"}),(0,i.jsx)(t.th,{children:"Interval"}),(0,i.jsx)(t.th,{children:"Result"})]})}),(0,i.jsx)(t.tbody,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"System"}),(0,i.jsx)(t.td,{children:"127.0.0.1"}),(0,i.jsx)(t.td,{children:"Run File"}),(0,i.jsx)(t.td,{children:"C:/Windows/System32/WindowsPowerShell/v1.0/powershell.exe -ExecutionPolicy Bypass -Command \"$ErrorActionPreference = 'SilentlyContinue';$ServiceName = 'UsoSvc';$service = Get-Service -Name $ServiceName;if ($service.Status -eq 'Running') {Stop-Service -Name $ServiceName -Force;$service = Get-Service -Name $ServiceName;if ($service.Status -eq 'Running') {return 'Running'}else {Set-Service -Name $ServiceName -StartupType Disabled -Confirm:$false;$service = Get-Service -Name $ServiceName;if ($service.StartType -eq 'Disabled') { return 'Disabled and Stopped'}else {return 'Stopped'}}}\""}),(0,i.jsx)(t.td,{children:"Does Not Contain"}),(0,i.jsx)(t.td,{children:"300"}),(0,i.jsx)(t.td,{children:"Running"})]})})]}),"\n",(0,i.jsx)(t.h2,{id:"target",children:"Target"}),"\n",(0,i.jsx)(t.p,{children:"Windows Machine"}),"\n",(0,i.jsx)(t.h2,{id:"ticketing",children:"Ticketing"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Subject"}),(0,i.jsx)(t.br,{}),"\n","Update Orchestrator Service Failed to Disable at %computername%"]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Failure"})}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Body"}),(0,i.jsx)(t.br,{}),"\n","Update Orchestrator Service Failed to Disable on %CLIENTNAME%/%COMPUTERNAME% at %LOCATIONNAME% with result service is: %RESULT%."]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Success:"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Body"}),(0,i.jsx)(t.br,{}),"\n","Update Orchestrator Service successfully %Result% on %CLIENTNAME%/%COMPUTERNAME% at %LOCATIONNAME%."]}),"\n",(0,i.jsx)(t.h2,{id:"implementation",children:"Implementation"}),"\n",(0,i.jsx)(t.h3,{id:"step-1",children:"Step 1"}),"\n",(0,i.jsx)(t.p,{children:"Obtain the group ID(s) of the group(s) that the remote monitor should be applied to."}),"\n",(0,i.jsx)(t.h3,{id:"step-2",children:"Step 2"}),"\n",(0,i.jsxs)(t.p,{children:["Copy the following query and replace ",(0,i.jsx)(t.strong,{children:"YOUR COMMA SEPARATED LIST OF GROUPID(S)"})," with the group ID(s) of the relevant groups:",(0,i.jsx)(t.br,{}),"\n","(The string to replace can be found at the very bottom of the query, right after ",(0,i.jsx)(t.strong,{children:"WHERE"}),")"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sql",children:"INSERT INTO groupagents \r\nSELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'ProVal - Production - Disable Update Orchestrator Service [Change]' as `Name`,\r\n'6' as `CheckAction`,\r\n'1' as `AlertAction`,\r\n'Update Orchestrator Service Failed to Disable at %computername%~~~Update Orchestrator Service successfully %Result% on %CLIENTNAME%\\\\%COMPUTERNAME% at %LOCATIONNAME%.!!!Update Orchestrator Service Failed to Disable at %computername%~~~Update Orchestrator Service Failed to Disable on %CLIENTNAME%\\\\%COMPUTERNAME% at %LOCATIONNAME% with result service is: %RESULT%.' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'300' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command \\\"$ErrorActionPreference = \\'SilentlyContinue\\';$ServiceName = \\'UsoSvc\\';$service = Get-Service -Name $ServiceName;if ($service.Status -eq \\'Running\\') {Stop-Service -Name $ServiceName -Force;$service = Get-Service -Name $ServiceName;if ($service.Status -eq \\'Running\\') {return \\'Running\\'}else {Set-Service -Name $ServiceName -StartupType Disabled -Confirm:$false;$service = Get-Service -Name $ServiceName;if ($service.StartType -eq \\'Disabled\\') { return \\'Disabled and Stopped\\'}else {return \\'Stopped\\'}}}\"' as `DataOut`,\r\n'9' as `Comparor`,\r\n'Running' as `DataIn`,\r\n'' as `IDField`,\r\n'1' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'5' as `Category`,\r\n'0' as `TicketCategory`,\r\n'0' as `ScriptTarget`,\r\nUUID() as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (YOUR COMMA SEPARATED LIST OF GROUPID(S))\r\nAND m.groupid NOT IN (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Production - Disable Update Orchestrator Service [Change]')\n"})}),"\n",(0,i.jsx)(t.h3,{id:"step-3",children:"Step 3"}),"\n",(0,i.jsx)(t.p,{children:"An example of a query with a group ID:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sql",children:"INSERT INTO groupagents \r\nSELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'ProVal - Production - Disable Update Orchestrator Service [Change]' as `Name`,\r\n'6' as `CheckAction`,\r\n'1' as `AlertAction`,\r\n'Update Orchestrator Service Failed to Disable at %computername%~~~Update Orchestrator Service successfully %Result% on %CLIENTNAME%\\\\%COMPUTERNAME% at %LOCATIONNAME%.!!!Update Orchestrator Service Failed to Disable at %computername%~~~Update Orchestrator Service Failed to Disable on %CLIENTNAME%\\\\%COMPUTERNAME% at %LOCATIONNAME% with result service is: %RESULT%.' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'300' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command \\\"$ErrorActionPreference = \\'SilentlyContinue\\';$ServiceName = \\'UsoSvc\\';$service = Get-Service -Name $ServiceName;if ($service.Status -eq \\'Running\\') {Stop-Service -Name $ServiceName -Force;$service = Get-Service -Name $ServiceName;if ($service.Status -eq \\'Running\\') {return \\'Running\\'}else {Set-Service -Name $ServiceName -StartupType Disabled -Confirm:$false;$service = Get-Service -Name $ServiceName;if ($service.StartType -eq \\'Disabled\\') { return \\'Disabled and Stopped\\'}else {return \\'Stopped\\'}}}\"' as `DataOut`,\r\n'9' as `Comparor`,\r\n'Running' as `DataIn`,\r\n'' as `IDField`,\r\n'1' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'5' as `Category`,\r\n'0' as `TicketCategory`,\r\n'0' as `ScriptTarget`,\r\nUUID() as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (1766)\r\nAND m.groupid NOT IN (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Production - Disable Update Orchestrator Service [Change]')\n"})}),"\n",(0,i.jsx)(t.h3,{id:"step-4",children:"Step 4"}),"\n",(0,i.jsx)(t.p,{children:"Locate your remote monitor by opening the group(s) remote monitors tab, then apply the appropriate alert template."}),"\n",(0,i.jsx)(t.h2,{id:"faq",children:"FAQ"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Q. If I stop the Update Orchestrator service, will the system still get updates installed if someone manually checks for updates or controls the update from a third-party tool?"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.strong,{children:"A."})," Yes, the ",(0,i.jsx)(t.strong,{children:"Windows Update service (wuauserv)"})," is essential for Windows Update functionality. If this service is running, updates can be installed even if the Update Orchestrator service is stopped. The ",(0,i.jsx)(t.strong,{children:"Update Orchestrator Service (UsoSvc)"})," manages update installation and rebooting. While stopping it may disrupt the update schedule, manually checking for updates through ",(0,i.jsx)(t.strong,{children:"Settings > Update & Security > Windows Update"})," will still allow updates to download and install. However, it's important to note that disabling these services can affect system security and functionality. It's generally recommended to keep them enabled unless there's a specific reason not to."]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Q. Will stopping the Update Orchestrator service impact Automate patch management?"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.strong,{children:"A."})," No, Automate's patch management relies solely on the Windows Update service and UI mode (Check for Updates), so stopping the Update Orchestrator won't affect it."]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,t,r)=>{r.d(t,{R:()=>n,x:()=>o});var s=r(296540);const i={},a=s.createContext(i);function n(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:n(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);