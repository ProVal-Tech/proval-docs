"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[5587],{228427:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"cwa/scripts/1691cc51-ef36-451d-9086-ca69c6ef85d8","title":"EPM - Windows Configuration - Agnostic - Disable-PowershellVersion2","description":"This script disables the Windows PowerShell v2 feature, ensuring that a newer version is installed beforehand. It checks for the presence of a PowerShell version greater than v2, installs it if necessary, and then disables v2. The process includes logging and error handling to ensure successful execution.","source":"@site/docs/cwa/scripts/EPM - Windows Configuration - Agnostic - Disable-PowershellVersion2.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/1691cc51-ef36-451d-9086-ca69c6ef85d8","permalink":"/docs/cwa/scripts/1691cc51-ef36-451d-9086-ca69c6ef85d8","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/EPM - Windows Configuration - Agnostic - Disable-PowershellVersion2.md","tags":[{"inline":false,"label":"Installation","permalink":"/docs/tags/installation","description":"Documents on installing software and configuring systems"},{"inline":false,"label":"Security","permalink":"/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Update","permalink":"/docs/tags/update","description":"Documents discussing software and system updates and their management"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"1691cc51-ef36-451d-9086-ca69c6ef85d8","title":"EPM - Windows Configuration - Agnostic - Disable-PowershellVersion2","title_meta":"EPM - Windows Configuration - Agnostic - Disable-PowershellVersion2","keywords":["disable","powershell","windows","feature","installation"],"description":"This script disables the Windows PowerShell v2 feature, ensuring that a newer version is installed beforehand. It checks for the presence of a PowerShell version greater than v2, installs it if necessary, and then disables v2. The process includes logging and error handling to ensure successful execution.","tags":["installation","security","update","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"EPM - Software Configuration - Chromium Browsers - Homepage - Set","permalink":"/docs/cwa/scripts/e5c01410-3731-4b1c-b166-235d637c44bb"},"next":{"title":"EPM - Windows Configuration - Screen Saver - Protect","permalink":"/docs/cwa/scripts/952db509-c813-4225-a53f-7423d174ef24"}}');var i=t(474848),r=t(28453);const l={id:"1691cc51-ef36-451d-9086-ca69c6ef85d8",title:"EPM - Windows Configuration - Agnostic - Disable-PowershellVersion2",title_meta:"EPM - Windows Configuration - Agnostic - Disable-PowershellVersion2",keywords:["disable","powershell","windows","feature","installation"],description:"This script disables the Windows PowerShell v2 feature, ensuring that a newer version is installed beforehand. It checks for the presence of a PowerShell version greater than v2, installs it if necessary, and then disables v2. The process includes logging and error handling to ensure successful execution.",tags:["installation","security","update","windows"],draft:!1,unlisted:!1},o=void 0,a={},c=[{value:"Overview",id:"overview",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Process",id:"process",level:2},{value:"How the Content Operates",id:"how-the-content-operates",level:2},{value:"Payload Usage",id:"payload-usage",level:2},{value:"Output",id:"output",level:2},{value:"Locations",id:"locations",level:2}];function d(e){const s={code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(s.p,{children:"This script will disable the Windows PowerShell v2 feature, provided that a newer version is installed."}),"\n",(0,i.jsx)(s.h2,{id:"requirements",children:"Requirements"}),"\n",(0,i.jsx)(s.p,{children:"A version of PowerShell greater than v2 must be installed to disable PowerShell v2. This script will attempt to satisfy that requirement before disabling anything. The removal of the .NET 3.0 feature requires a reboot."}),"\n",(0,i.jsx)(s.h2,{id:"process",children:"Process"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:"If there is a PowerShell version installed greater than v2, then we will disable PowerShell v2."}),"\n",(0,i.jsxs)(s.li,{children:["If there is no PowerShell version installed greater than v2:","\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:"Install a version greater than v2."}),"\n",(0,i.jsx)(s.li,{children:"Verify that the installation was successful; error if not."}),"\n",(0,i.jsx)(s.li,{children:"Disable PowerShell version 2."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"how-the-content-operates",children:"How the Content Operates"}),"\n",(0,i.jsx)(s.p,{children:"The content checks for a version of PowerShell greater than v2. If one is present, it disables the PowerShell v2 feature. If it is not present, it attempts to install a newer PowerShell version so that v2 can be disabled."}),"\n",(0,i.jsx)(s.h2,{id:"payload-usage",children:"Payload Usage"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"./Disable-PowershellVersion2.ps1\n"})}),"\n",(0,i.jsx)(s.h2,{id:"output",children:"Output"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"./Disable-PowershellVersion2-log.txt\r\n./Disable-PowershellVersion2-error.txt\n"})}),"\n",(0,i.jsx)(s.h2,{id:"locations",children:"Locations"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Payload"}),(0,i.jsx)(s.th,{children:"Path"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Disable PowerShell v2"}),(0,i.jsx)(s.td,{children:"/repo/script/Disable-PowershellVersion2.ps1"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Automate"}),(0,i.jsx)(s.td,{})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"ConnectWise RMM"}),(0,i.jsx)(s.td,{})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Kaseya"}),(0,i.jsx)(s.td,{})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Datto RMM"}),(0,i.jsx)(s.td,{})]})]})]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,s,t)=>{t.d(s,{R:()=>l,x:()=>o});var n=t(296540);const i={},r=n.createContext(i);function l(e){const s=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),n.createElement(r.Provider,{value:s},e.children)}}}]);