"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[28777],{124051:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"cwa/scripts/2cc1d72d-5d5b-4017-8114-ad5f722b10f5","title":"Exchange Zero Day Patch Logging","description":"This document outlines a script designed to detect recent vulnerabilities associated with Exchange Server, specifically targeting CVEs related to the Zero Day vulnerability. It checks for the presence of necessary patches and can create tickets for unresolved vulnerabilities, improving response times and security management.","source":"@site/docs/cwa/scripts/Exchange Zero Day Patch Logging.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/2cc1d72d-5d5b-4017-8114-ad5f722b10f5","permalink":"/proval-docs/docs/cwa/scripts/2cc1d72d-5d5b-4017-8114-ad5f722b10f5","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Exchange Zero Day Patch Logging.md","tags":[{"inline":false,"label":"CVE","permalink":"/proval-docs/docs/tags/cve","description":"Documents related to Common Vulnerabilities and Exposures (CVE)"},{"inline":false,"label":"Security","permalink":"/proval-docs/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Ticketing","permalink":"/proval-docs/docs/tags/ticketing","description":"Documents related to ticketing systems and IT support management"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"2cc1d72d-5d5b-4017-8114-ad5f722b10f5","title":"Exchange Zero Day Patch Logging","title_meta":"Exchange Zero Day Patch Logging","keywords":["exchange","vulnerability","cve","patch","ticketing"],"description":"This document outlines a script designed to detect recent vulnerabilities associated with Exchange Server, specifically targeting CVEs related to the Zero Day vulnerability. It checks for the presence of necessary patches and can create tickets for unresolved vulnerabilities, improving response times and security management.","tags":["cve","security","ticketing","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Exchange - Reset Scan Engine Version","permalink":"/proval-docs/docs/cwa/scripts/f699ae53-3ba7-42bd-864d-a670aca7ab0b"},"next":{"title":"Export Application and Security Logs to CSV","permalink":"/proval-docs/docs/cwa/scripts/aedee17c-e3b5-4f8e-9565-058318a2009a"}}');var s=i(474848),r=i(28453);const a={id:"2cc1d72d-5d5b-4017-8114-ad5f722b10f5",title:"Exchange Zero Day Patch Logging",title_meta:"Exchange Zero Day Patch Logging",keywords:["exchange","vulnerability","cve","patch","ticketing"],description:"This document outlines a script designed to detect recent vulnerabilities associated with Exchange Server, specifically targeting CVEs related to the Zero Day vulnerability. It checks for the presence of necessary patches and can create tickets for unresolved vulnerabilities, improving response times and security management.",tags:["cve","security","ticketing","windows"],draft:!1,unlisted:!1},c=void 0,o={},l=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Variables",id:"variables",level:2},{value:"Global Parameters",id:"global-parameters",level:3},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2}];function d(e){const t={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsxs)(t.p,{children:["This script helps to fetch the vulnerability attack detection for the recent Exchange Zero Day Vulnerability.",(0,s.jsx)(t.br,{}),"\n","It primarily looks for the following CVEs:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"CVE-2021-26855"}),"\n",(0,s.jsx)(t.li,{children:"CVE-2021-26858"}),"\n",(0,s.jsx)(t.li,{children:"CVE-2021-26857"}),"\n",(0,s.jsx)(t.li,{children:"CVE-2021-27065"}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["If any of the above vulnerabilities are detected, the script checks whether the necessary patches (KB5000978, KB5000871) have been installed.",(0,s.jsx)(t.br,{}),"\n","If the patches are missing, you can view the logs in the script log or receive logs in the ticket, which informs that the agent is being attacked but no fix has been applied yet."]}),"\n",(0,s.jsxs)(t.p,{children:["To create a ticket, you must change the global parameter value for ",(0,s.jsx)(t.code,{children:"TicketCreation"})," to ",(0,s.jsx)(t.code,{children:"1"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Time Saved by Automation:"})," 15 Minutes"]}),"\n",(0,s.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Sample Run",src:i(187255).A+"",width:"490",height:"357"})}),"\n",(0,s.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Windows Exchange Server"}),"\n",(0,s.jsxs)(t.li,{children:["Intended to be triggered from the following monitor(s):","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"/proval-docs/docs/cwa/monitors/f0733b7f-b017-4d94-8949-310a737d395a",children:"ProVal - Production - CVE-2021-26858 Detection"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"/proval-docs/docs/cwa/monitors/54780af1-de8c-4373-bfef-cdcf185fd8de",children:"ProVal - Production - CVE-2021-26857 Detection"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"/proval-docs/docs/cwa/monitors/f0733b7f-b017-4d94-8949-310a737d395a",children:"ProVal - Production - CVE-2021-26858 Detection"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"variables",children:"Variables"}),"\n",(0,s.jsx)(t.p,{children:"Document the various variables in the script. Delete any section that is not relevant to your script."}),"\n",(0,s.jsx)(t.h3,{id:"global-parameters",children:"Global Parameters"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Name"}),(0,s.jsx)(t.th,{children:"Example"}),(0,s.jsx)(t.th,{children:"Required"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"TicketCreation"}),(0,s.jsx)(t.td,{children:"0"}),(0,s.jsx)(t.td,{children:"True"}),(0,s.jsx)(t.td,{children:"If set to '1', will enable ticket creation; default is 0 to disable ticketing"})]})})]}),"\n",(0,s.jsx)(t.h2,{id:"process",children:"Process"}),"\n",(0,s.jsxs)(t.p,{children:["The script performs various checks of Exchange server logs via PowerShell to confirm which CVEs apply to that server.",(0,s.jsx)(t.br,{}),"\n","Corrective steps and checks for patch installations are then taken based on CVE results."]}),"\n",(0,s.jsx)(t.p,{children:"Primarily, the installation of KB5000871 is confirmed for the resolution of CVEs 2021-26855, 26858, and 27065."}),"\n",(0,s.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Script log"}),"\n",(0,s.jsx)(t.li,{children:"Ticketing if enabled in Globals"}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},187255:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/image_1-cf43efb9980e50f9fe95de3b2379e25e.png"},28453:(e,t,i)=>{i.d(t,{R:()=>a,x:()=>c});var n=i(296540);const s={},r=n.createContext(s);function a(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);