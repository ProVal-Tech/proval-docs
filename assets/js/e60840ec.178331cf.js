"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[57122],{606140:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"cwa/scripts/adc83d4e-f34e-4b3c-b8c9-3975a6efb285","title":"Winget - Import Param","description":"This document provides a detailed guide on using a script to install applications via winget from a JSON file. It also includes instructions for creating tickets for failed installations, ensuring a streamlined software deployment process.","source":"@site/docs/cwa/scripts/Winget - Import Param.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/adc83d4e-f34e-4b3c-b8c9-3975a6efb285","permalink":"/docs/cwa/scripts/adc83d4e-f34e-4b3c-b8c9-3975a6efb285","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Winget - Import Param.md","tags":[{"inline":false,"label":"Installation","permalink":"/docs/tags/installation","description":"Documents on installing software and configuring systems"},{"inline":false,"label":"Software","permalink":"/docs/tags/software","description":"Documents related to software applications and their lifecycle management"},{"inline":false,"label":"Ticketing","permalink":"/docs/tags/ticketing","description":"Documents related to ticketing systems and IT support management"}],"version":"current","frontMatter":{"id":"adc83d4e-f34e-4b3c-b8c9-3975a6efb285","title":"Winget - Import Param","title_meta":"Winget - Import Param","keywords":["winget","installation","ticketing","json","deployment","software"],"description":"This document provides a detailed guide on using a script to install applications via winget from a JSON file. It also includes instructions for creating tickets for failed installations, ensuring a streamlined software deployment process.","tags":["installation","software","ticketing"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Winget - Export Param","permalink":"/docs/cwa/scripts/f9b8a027-e797-49c6-848d-7cb667a16ce0"},"next":{"title":"Winget - InstallUpdate - Teams","permalink":"/docs/cwa/scripts/d5ce6f1c-94ef-4e78-8e0a-61dd74f8d2cc"}}');var n=i(474848),a=i(28453);const r={id:"adc83d4e-f34e-4b3c-b8c9-3975a6efb285",title:"Winget - Import Param",title_meta:"Winget - Import Param",keywords:["winget","installation","ticketing","json","deployment","software"],description:"This document provides a detailed guide on using a script to install applications via winget from a JSON file. It also includes instructions for creating tickets for failed installations, ensuring a streamlined software deployment process.",tags:["installation","software","ticketing"],draft:!1,unlisted:!1},c=void 0,l={},o=[{value:"Summary",id:"summary",level:2},{value:"Implementation",id:"implementation",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"User Parameters",id:"user-parameters",level:3},{value:"System Properties",id:"system-properties",level:3},{value:"Output",id:"output",level:2},{value:"Ticketing",id:"ticketing",level:2}];function d(e){const t={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,n.jsxs)(t.p,{children:["The script offers the functionality to install a list of applications using winget from the ",(0,n.jsx)(t.code,{children:"softwarelist.json"})," file exported by the ",(0,n.jsx)(t.a,{href:"/docs/cwa/scripts/f9b8a027-e797-49c6-848d-7cb667a16ce0",children:"SWM - Data Collection - Script - Winget - Export [Param]"})," script."]}),"\n",(0,n.jsxs)(t.p,{children:["Additionally, it includes an option to create a ticket with the list of applications that failed to deploy on the computer from the ",(0,n.jsx)(t.code,{children:"softwarelist.json"})," list."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Requirements:"})," PowerShell 5+"]}),"\n",(0,n.jsx)(t.h2,{id:"implementation",children:"Implementation"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:["Import the following scripts from the ",(0,n.jsx)(t.code,{children:"ProSync"})," plugin:"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"/docs/cwa/scripts/f9b8a027-e797-49c6-848d-7cb667a16ce0",children:"Winget - Export [Param]"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://proval.itglue.com/5078775/docs/15522130",children:"Winget - Import [Param]"})}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:["Run the ",(0,n.jsx)(t.a,{href:"/docs/cwa/scripts/f9b8a027-e797-49c6-848d-7cb667a16ce0",children:"Winget - Export [Param]"})," on the preferred computer to export the list of installed applications. Ensure to set the parameter ",(0,n.jsx)(t.code,{children:"Email_Report"})," to ",(0,n.jsx)(t.code,{children:"1"}),". This will send the list of installed applications to your email address, saved as ",(0,n.jsx)(t.code,{children:"SoftwareList.Json"}),"."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:i(29427).A+"",width:"943",height:"893"})}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:["Place the ",(0,n.jsx)(t.code,{children:"SoftwareList.json"})," file in LTShare (WebDav for the hosted partners) under the ",(0,n.jsx)(t.code,{children:"Transfer/Tools/Winget"})," directory. Create the ",(0,n.jsx)(t.code,{children:"Winget"})," directory if it's missing."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:i(338584).A+"",width:"1000",height:"280"})}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:["To enable the creation of failure tickets from the script, create a system property named ",(0,n.jsx)(t.code,{children:"TicketCreationCategory_Winget_Import"})," in Automate. Assign the ID of the ticket category you want to use for creating these tickets."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,n.jsxs)(t.p,{children:["After placing the software list as ",(0,n.jsx)(t.code,{children:"softwarelist.json"})," in LTShare at the path explained in the ",(0,n.jsx)(t.code,{children:"Implementation"})," section of the document:"]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:i(127649).A+"",width:"1000",height:"820"})}),"\n",(0,n.jsxs)(t.p,{children:["The name of the file without the extension should be set to the user parameter after placing the software list with a different name in LTShare at the path explained in the ",(0,n.jsx)(t.code,{children:"Implementation"})," section of the document:"]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:i(444558).A+"",width:"1000",height:"825"})}),"\n",(0,n.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.a,{href:"/docs/cwa/scripts/f9b8a027-e797-49c6-848d-7cb667a16ce0",children:"SWM - Data Collection - Script - Winget - Export [Param]"})}),"\n",(0,n.jsx)(t.h3,{id:"user-parameters",children:"User Parameters"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Name"}),(0,n.jsx)(t.th,{children:"Example"}),(0,n.jsx)(t.th,{children:"Required"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsx)(t.tbody,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"JsonName"}),(0,n.jsx)(t.td,{children:"DevelopmentSoftwareList"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsxs)(t.td,{children:["The name of the file without the extension should be set to the user parameter after placing the software list with a different name in LTShare at the path explained in the ",(0,n.jsx)(t.code,{children:"Implementation"})," section of the document."]})]})})]}),"\n",(0,n.jsx)(t.h3,{id:"system-properties",children:"System Properties"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Name"}),(0,n.jsx)(t.th,{children:"Example"}),(0,n.jsx)(t.th,{children:"Required"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsx)(t.tbody,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"TicketCreationCategory_Winget_Import"}),(0,n.jsx)(t.td,{children:"6"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"ID of the ticket category to create a ticket. Setting the ID of the relevant ticket category in this system property will enable ticketing on failure for the script. The script will not create a ticket if this property is missing or set to 0."})]})})]}),"\n",(0,n.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Script log"}),"\n",(0,n.jsx)(t.li,{children:"Ticket (if enabled)"}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"ticketing",children:"Ticketing"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Subject:"})," ",(0,n.jsx)(t.code,{children:"Winget Import - Software List - Failed - %ComputerName%"})]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Summary:"}),(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.code,{children:"Failed to install the following applications:"}),(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.code,{children:"\\\\<List of the failed applications>"})]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Example:"}),(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.img,{src:i(918199).A+"",width:"894",height:"887"})]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},29427:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_1-a1c6349d3d42e973110f33fa24e23202.png"},338584:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_2-0db5e05cb32a47596648c68104da84f0.png"},127649:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_3-0ec8d312f7f6c393ca26f17d7bedda9e.png"},444558:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_4-f68a198f12409d1afb49ca5f0b4a9b29.png"},918199:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/image_5-4a194dc9cea5a427363ae08bc97a827d.png"},28453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>c});var s=i(296540);const n={},a=s.createContext(n);function r(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);