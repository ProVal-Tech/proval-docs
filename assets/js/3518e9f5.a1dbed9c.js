"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[88922],{263195:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>s,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"cwa/monitors/fbb859fd-ac3c-4cab-9460-6d5260edf65e","title":"Import - Remote Monitor - Uninstall VLC Player","description":"This document provides a step-by-step guide on how to uninstall VLC Player using ConnectWise Automate. It includes instructions for setting up the necessary scripts and alert templates, obtaining group IDs, and executing the SQL query to create a remote monitor that handles ticket creation for the uninstallation process.","source":"@site/docs/cwa/monitors/Import - Remote Monitor - Uninstall VLC Player.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/fbb859fd-ac3c-4cab-9460-6d5260edf65e","permalink":"/docs/cwa/monitors/fbb859fd-ac3c-4cab-9460-6d5260edf65e","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Import - Remote Monitor - Uninstall VLC Player.md","tags":[{"inline":false,"label":"ConnectWise","permalink":"/docs/tags/connectwise","description":"Documents on ConnectWise platforms for IT service management"},{"inline":false,"label":"Software","permalink":"/docs/tags/software","description":"Documents related to software applications and their lifecycle management"},{"inline":false,"label":"Uninstallation","permalink":"/docs/tags/uninstallation","description":"Documents related to software removal and uninstallation processes"}],"version":"current","frontMatter":{"id":"fbb859fd-ac3c-4cab-9460-6d5260edf65e","title":"Import - Remote Monitor - Uninstall VLC Player","title_meta":"Import - Remote Monitor - Uninstall VLC Player.md","keywords":["uninstall","vlc","connectwise","monitor","ticket"],"description":"This document provides a step-by-step guide on how to uninstall VLC Player using ConnectWise Automate. It includes instructions for setting up the necessary scripts and alert templates, obtaining group IDs, and executing the SQL query to create a remote monitor that handles ticket creation for the uninstallation process.","tags":["connectwise","software","uninstallation"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Import - Remote Monitor - SMB1 Detection","permalink":"/docs/cwa/monitors/ec956fa3-ab8c-410c-83d7-9e81f4b1f499"},"next":{"title":"Import - Remote Monitor - Veeam Service Monitor","permalink":"/docs/cwa/monitors/dce82a22-77ba-4133-90d9-78a0a1b88412"}}');var o=n(474848),a=n(28453);const s={id:"fbb859fd-ac3c-4cab-9460-6d5260edf65e",title:"Import - Remote Monitor - Uninstall VLC Player",title_meta:"Import - Remote Monitor - Uninstall VLC Player.md",keywords:["uninstall","vlc","connectwise","monitor","ticket"],description:"This document provides a step-by-step guide on how to uninstall VLC Player using ConnectWise Automate. It includes instructions for setting up the necessary scripts and alert templates, obtaining group IDs, and executing the SQL query to create a remote monitor that handles ticket creation for the uninstallation process.",tags:["connectwise","software","uninstallation"],draft:!1,unlisted:!1},i=void 0,l={},c=[{value:"Step 1",id:"step-1",level:2},{value:"Step 2",id:"step-2",level:2},{value:"Step 3",id:"step-3",level:2},{value:"Step 4",id:"step-4",level:2},{value:"Step 5",id:"step-5",level:2},{value:"Step 6",id:"step-6",level:2}];function d(e){const t={a:"a",br:"br",code:"code",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h2,{id:"step-1",children:"Step 1"}),"\n",(0,o.jsxs)(t.p,{children:["Ensure the presence of the ",(0,o.jsx)(t.a,{href:"/docs/cwa/scripts/63beba3c-f4a6-41a5-98e2-d4e4ce885035",children:"CWM - Automate - Script - Ticket Creation - Computer"})," script and the ",(0,o.jsx)(t.code,{children:"\u25b3 Custom - Ticket Creation - Computer"})," alert template."]}),"\n",(0,o.jsx)(t.h2,{id:"step-2",children:"Step 2"}),"\n",(0,o.jsx)(t.p,{children:"Obtain the group ID(s) of the group(s) that the remote monitor should be applied to."}),"\n",(0,o.jsx)(t.h2,{id:"step-3",children:"Step 3"}),"\n",(0,o.jsxs)(t.p,{children:["Copy the following query and replace ",(0,o.jsx)(t.strong,{children:"YOUR COMMA SEPARATED LIST OF GROUPID(S)"})," with the Group ID(s) of the relevant groups:",(0,o.jsx)(t.br,{}),"\n","(The string to replace can be found at the very bottom of the query, right after ",(0,o.jsx)(t.strong,{children:"WHERE"}),")"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sql",children:"INSERT INTO groupagents \r\nSELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'ProVal - Dev - Uninstall VLC Player' as `Name`,\r\n'6' as `CheckAction`,\r\n'1' as `AlertAction`,\r\n'VLC Removal Failed - %COMPUTERNAME%~~~Successfully removed VLC Player!!!VLC Removal Failed - %COMPUTERNAME%~~~Failed to remove VLC Player for %COMPUTERNAME%. Please review.' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'604800' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command \"$US = (Get-ChildItem -Path HKLM:\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall, HKLM:\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall | Get-ItemProperty | Where-Object {$_.DisplayName -Match \\'VLC Media Player\\' }).UninstallString; if($US) { foreach ($U in $US) {cmd.exe /c $U /S /V /qn }; $US = (Get-ChildItem -Path HKLM:\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall, HKLM:\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall | Get-ItemProperty | Where-Object {$_.DisplayName -Match \\'VLC Media Player\\' }).UninstallString; if($US) { return \\'Failed to remove VLC.\\' } else {return \\'Successfully removed VLC.\\'}} else {return \\'VLC player is not installed.\\'}\"' as `DataOut`,\r\n'9' as `Comparor`,\r\n'Failed to remove VLC' as `DataIn`,\r\n'' as `IDField`,\r\n'1' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'21' as `Category`,\r\n'0' as `TicketCategory`,\r\n'1' as `ScriptTarget`,\r\nUUID() as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (YOUR COMMA SEPARATED LIST OF GROUPID(S))\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Dev - Uninstall VLC Player')\n"})}),"\n",(0,o.jsx)(t.h2,{id:"step-4",children:"Step 4"}),"\n",(0,o.jsx)(t.p,{children:"An example of a query with a group ID:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sql",children:"INSERT INTO groupagents \r\nSELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'ProVal - Dev - Uninstall VLC Player' as `Name`,\r\n'6' as `CheckAction`,\r\n'1' as `AlertAction`,\r\n'VLC Removal Failed - %COMPUTERNAME%~~~Successfully removed VLC Player!!!VLC Removal Failed - %COMPUTERNAME%~~~Failed to remove VLC Player for %COMPUTERNAME%. Please review.' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'604800' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command \"$US = (Get-ChildItem -Path HKLM:\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall, HKLM:\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall | Get-ItemProperty | Where-Object {$_.DisplayName -Match \\'VLC Media Player\\' }).UninstallString; if($US) { foreach ($U in $US) {cmd.exe /c $U /S /V /qn }; $US = (Get-ChildItem -Path HKLM:\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall, HKLM:\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall | Get-ItemProperty | Where-Object {$_.DisplayName -Match \\'VLC Media Player\\' }).UninstallString; if($US) { return \\'Failed to remove VLC.\\' } else {return \\'Successfully removed VLC.\\'}} else {return \\'VLC player is not installed.\\'}\"' as `DataOut`,\r\n'9' as `Comparor`,\r\n'Failed to remove VLC' as `DataIn`,\r\n'' as `IDField`,\r\n'1' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'21' as `Category`,\r\n'0' as `TicketCategory`,\r\n'1' as `ScriptTarget`,\r\nUUID() as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (2,856)\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Dev - Uninstall VLC Player')\n"})}),"\n",(0,o.jsx)(t.h2,{id:"step-5",children:"Step 5"}),"\n",(0,o.jsx)(t.p,{children:"Now execute your query from a RAWSQL monitor set."}),"\n",(0,o.jsx)(t.h2,{id:"step-6",children:"Step 6"}),"\n",(0,o.jsxs)(t.p,{children:["Locate your remote monitor by opening the group(s) remote monitors tab, then apply the ",(0,o.jsx)(t.code,{children:"\u25b3 Custom - Ticket Creation - Computer"})," alert template."]})]})}function p(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>i});var r=n(296540);const o={},a=r.createContext(o);function s(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);