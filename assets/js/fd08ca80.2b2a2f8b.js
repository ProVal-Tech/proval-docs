"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[99861],{895711:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>l,frontMatter:()=>i,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"cwa/dataviews/81b5f220-8cfc-4a52-bbf2-e6606eebf822","title":"2FA - Duo Auth Audit","description":"This document provides an overview of agents configured with Duo Multifactor Authentication within the ConnectWise Automate environment. It details the necessary dependencies, describes the relevant data columns, and includes the SQL representation for querying this information.","source":"@site/docs/cwa/dataviews/2FA - Duo Auth Audit.md","sourceDirName":"cwa/dataviews","slug":"/cwa/dataviews/81b5f220-8cfc-4a52-bbf2-e6606eebf822","permalink":"/proval-docs/docs/cwa/dataviews/81b5f220-8cfc-4a52-bbf2-e6606eebf822","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/dataviews/2FA - Duo Auth Audit.md","tags":[{"inline":false,"label":"Database","permalink":"/proval-docs/docs/tags/database","description":"Documents related to database management systems and operations"},{"inline":false,"label":"Report","permalink":"/proval-docs/docs/tags/report","description":"Documents focused on generating and managing reports"},{"inline":false,"label":"Security","permalink":"/proval-docs/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"}],"version":"current","frontMatter":{"id":"81b5f220-8cfc-4a52-bbf2-e6606eebf822","title":"2FA - Duo Auth Audit","title_meta":"2FA - Duo Auth Audit","keywords":["duo","mfa","authentication","automate","agents"],"description":"This document provides an overview of agents configured with Duo Multifactor Authentication within the ConnectWise Automate environment. It details the necessary dependencies, describes the relevant data columns, and includes the SQL representation for querying this information.","tags":["database","report","security"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"2022 Transport Queue Issue Status","permalink":"/proval-docs/docs/cwa/dataviews/cwa-email-impact-summary"},"next":{"title":"2FA - Google Auth Audit","permalink":"/proval-docs/docs/cwa/dataviews/d2b45caf-2a68-4388-afac-c56a854d5287"}}');var r=n(474848),a=n(28453);const i={id:"81b5f220-8cfc-4a52-bbf2-e6606eebf822",title:"2FA - Duo Auth Audit",title_meta:"2FA - Duo Auth Audit",keywords:["duo","mfa","authentication","automate","agents"],description:"This document provides an overview of agents configured with Duo Multifactor Authentication within the ConnectWise Automate environment. It details the necessary dependencies, describes the relevant data columns, and includes the SQL representation for querying this information.",tags:["database","report","security"],draft:!1,unlisted:!1},o=void 0,d={},c=[{value:"Summary",id:"summary",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Columns",id:"columns",level:2},{value:"SQL Representation",id:"sql-representation",level:2}];function u(e){const t={code:"code",h2:"h2",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(t.p,{children:"This dataview provides an overview of the agents configured with Duo Multifactor Authentication. This data is specifically related to the Duo plugin for Automate. Please note that this audit will not work for any SSO accounts."}),"\n",(0,r.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,r.jsx)(t.p,{children:"The DUO Plugin must be installed and configured."}),"\n",(0,r.jsx)(t.h2,{id:"columns",children:"Columns"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Column"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Username"}),(0,r.jsx)(t.td,{children:"The username of the Automate user"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Duo Auth Enabled"}),(0,r.jsx)(t.td,{children:"A Yes/No column indicating whether the Automate user account is using Duo MFA."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Userid"}),(0,r.jsx)(t.td,{children:"User ID of the users."})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"sql-representation",children:"SQL Representation"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sql",children:"SELECT \r\n  t.userid, \r\n  t.username, \r\n  t.`DUO Auth Enabled` \r\nFROM \r\n  ( \r\n    SELECT \r\n      users.userid AS `userid`, \r\n      users.name AS `UserName`, \r\n      CASE \r\n        WHEN ( \r\n          SELECT \r\n            value \r\n          FROM \r\n            plugin_duo_settings \r\n          WHERE \r\n            settingname = 'duoenabledcc' \r\n        ) = 'false' THEN 'false' \r\n        WHEN ( \r\n          SELECT \r\n            value \r\n          FROM \r\n            plugin_duo_settings \r\n          WHERE \r\n            settingname = 'duotoggleallusers' \r\n        ) = '1' THEN 'true' \r\n        WHEN FIND_IN_SET( \r\n          CONVERT(users.`userid`, CHAR), \r\n          ( \r\n            SELECT \r\n              value \r\n            FROM \r\n              plugin_duo_settings \r\n            WHERE \r\n              settingname = 'duouserlist' \r\n          ) \r\n        ) > 0 THEN 'true' \r\n        ELSE 'false' \r\n      END AS `Duo Auth Enabled` \r\n    FROM \r\n      Users \r\n    WHERE \r\n      users.Name <> 'root' \r\n      AND users.userid > 0 \r\n  ) t\n"})})]})}function l(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>o});var s=n(296540);const r={},a=s.createContext(r);function i(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);