"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[86621],{910995:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"cwa/scripts/f2a3feba-fc4b-4693-ba31-6b50f66bac15","title":"Install All Approved Patches With Prompt","description":"This document outlines a script that manages the installation of approved patches on a machine, including user interaction for reboot scheduling and notifications for pending actions. It handles scenarios where the user is logged in or not, provides prompts for reboot timing, and ensures that users are informed of available patches and any installation failures.","source":"@site/docs/cwa/scripts/Install All Approved Patches With Prompt.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/f2a3feba-fc4b-4693-ba31-6b50f66bac15","permalink":"/proval-docs/docs/cwa/scripts/f2a3feba-fc4b-4693-ba31-6b50f66bac15","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Install All Approved Patches With Prompt.md","tags":[{"inline":false,"label":"Installation","permalink":"/proval-docs/docs/tags/installation","description":"Documents on installing software and configuring systems"},{"inline":false,"label":"Security","permalink":"/proval-docs/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"f2a3feba-fc4b-4693-ba31-6b50f66bac15","title":"Install All Approved Patches With Prompt","title_meta":"Install All Approved Patches With Prompt","keywords":["patches","installation","reboot","scheduling","notification"],"description":"This document outlines a script that manages the installation of approved patches on a machine, including user interaction for reboot scheduling and notifications for pending actions. It handles scenarios where the user is logged in or not, provides prompts for reboot timing, and ensures that users are informed of available patches and any installation failures.","tags":["installation","security","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Incorrect Drive Inventory Autofix","permalink":"/proval-docs/docs/cwa/scripts/59079938-6d59-48d6-aa45-b8c003456bc6"},"next":{"title":"Install All Available Updates Force Reboot","permalink":"/proval-docs/docs/cwa/scripts/80e9ef78-1a3c-4678-9801-5f60afd0a662"}}');var o=s(474848),n=s(28453);const a={id:"f2a3feba-fc4b-4693-ba31-6b50f66bac15",title:"Install All Approved Patches With Prompt",title_meta:"Install All Approved Patches With Prompt",keywords:["patches","installation","reboot","scheduling","notification"],description:"This document outlines a script that manages the installation of approved patches on a machine, including user interaction for reboot scheduling and notifications for pending actions. It handles scenarios where the user is logged in or not, provides prompts for reboot timing, and ensures that users are informed of available patches and any installation failures.",tags:["installation","security","windows"],draft:!1,unlisted:!1},r=void 0,l={},c=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Prompts",id:"prompts",level:2},{value:"Pre-Patch Installation Prompt",id:"pre-patch-installation-prompt",level:4},{value:"Post Patch Reboot Confirmation",id:"post-patch-reboot-confirmation",level:4},{value:"Pre Reboot Prompt",id:"pre-reboot-prompt",level:4},{value:"Post Reboot Prompt",id:"post-reboot-prompt",level:2},{value:"Windows Reboot Schedule Notification",id:"windows-reboot-schedule-notification",level:4},{value:"Output",id:"output",level:2}];function d(e){const t={a:"a",br:"br",code:"code",h2:"h2",h4:"h4",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,o.jsx)(t.p,{children:"This script is designed to handle the installation of all pending approved patches on the machine. If the user is not logged in, it will proceed to reboot the machine. However, if the user is logged in, it will provide a popup message with options to select a specific time for rebooting, ranging from within the next 48 hours."}),"\n",(0,o.jsx)(t.p,{children:"If the user chooses a time beyond the 48-hour window, the prompt will repeat up to three times, encouraging the user to select a time within the next 48 hours. If no time is selected after four attempts, the script will schedule the restart after 48 hours."}),"\n",(0,o.jsx)(t.p,{children:"Additionally, the script will display the number of available patches before installing them and inform the user of any patches that failed to install via a popup message. Furthermore, if the script schedules a restart after 48 hours due to user inactivity or failure to select a time, it will send another popup message before forcibly restarting the computer."}),"\n",(0,o.jsxs)(t.p,{children:["While the script can be executed from Automate, it is recommended to utilize it from the ",(0,o.jsx)(t.a,{href:"https://docs.connectwise.com/ConnectWise_Automate_Documentation/060/020/010#:~:text=setting%20this%20value.-,Tray%20Menus,-The%C2%A0Tray%20Menus",children:"Tray Menu"})," within an agent template for a better user experience."]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.strong,{children:"Note:"})}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"The logo displayed in the sample prompts is for exemplary purposes only. The prompter will fetch and display the logo from the concerned Automate environment."}),"\n",(0,o.jsxs)(t.li,{children:["The machine will be restarted immediately if the user selects the ",(0,o.jsx)(t.code,{children:"Reboot Now"})," button for a ",(0,o.jsx)(t.code,{children:"Post Patch Reboot Confirmation"})," prompt."]}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Sample Run",src:s(784881).A+"",width:"1000",height:"730"})}),"\n",(0,o.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.a,{href:"/proval-docs/docs/cwa/scripts/d8a124df-ea81-4194-82fc-a082c7a036d8",children:"CWM - Automate - Script - Prompter"})}),"\n",(0,o.jsx)(t.h2,{id:"prompts",children:"Prompts"}),"\n",(0,o.jsx)(t.h4,{id:"pre-patch-installation-prompt",children:"Pre-Patch Installation Prompt"}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"CASE 1:"})," If the approved production patches are available on the computer to install",(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.img,{alt:"Case 1",src:s(854714).A+"",width:"1000",height:"740"})]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"CASE 2:"})," If there are no patches available to install. The script will exit if there are no approved production patches missing on the computer.",(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.img,{alt:"Case 2",src:s(655939).A+"",width:"1000",height:"738"})]}),"\n",(0,o.jsx)(t.h4,{id:"post-patch-reboot-confirmation",children:"Post Patch Reboot Confirmation"}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"First Prompt:"}),(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.img,{alt:"First Prompt",src:s(242124).A+"",width:"877",height:"656"})]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Second Prompt:"})," This prompt will only be sent if the user fails to select a convenient time in the first prompt between the next 48 hours to restart the computer.",(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.img,{alt:"Second Prompt",src:s(611221).A+"",width:"874",height:"644"})]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Final Prompt:"})," The script will be scheduled to restart the computer after 48 hours if the user fails to select a convenient time between the next 48 hours to restart their computer.",(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.img,{alt:"Final Prompt",src:s(443870).A+"",width:"872",height:"646"})]}),"\n",(0,o.jsx)(t.h4,{id:"pre-reboot-prompt",children:"Pre Reboot Prompt"}),"\n",(0,o.jsxs)(t.p,{children:["This prompt will be sent solely if an automatic restart is scheduled after 48 hours.",(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.img,{alt:"Pre Reboot Prompt",src:s(162183).A+"",width:"1000",height:"728"})]}),"\n",(0,o.jsx)(t.h2,{id:"post-reboot-prompt",children:"Post Reboot Prompt"}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"CASE 1:"})," If the patch job was successful and there are no approved production patches left to install.",(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.img,{alt:"Post Reboot Case 1",src:s(201600).A+"",width:"1000",height:"742"})]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"CASE 2:"})," If Automate fails to install any patch(es).",(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.img,{alt:"Post Reboot Case 2",src:s(172777).A+"",width:"1000",height:"741"})]}),"\n",(0,o.jsx)(t.h4,{id:"windows-reboot-schedule-notification",children:"Windows Reboot Schedule Notification"}),"\n",(0,o.jsxs)(t.p,{children:["A pop-up message will appear at the bottom right corner of the screen to remind the end user of the scheduled reboot.",(0,o.jsx)(t.br,{}),"\n",(0,o.jsx)(t.img,{alt:"Windows Reboot Schedule Notification",src:s(254277).A+"",width:"1000",height:"450"})]}),"\n",(0,o.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Script Log"}),"\n",(0,o.jsx)(t.li,{children:"Prompt on End Machine"}),"\n"]})]})}function p(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},784881:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_1-1e3e1042aa753cf01fb1d97ce1d123a1.png"},254277:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_10-21724a3747deb392bcaa590628580831.png"},854714:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_2-25c9f428323940f6bf3e6b2e7a12cc98.png"},655939:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_3-ee45318d3a749d175f9fd2b58caa7099.png"},242124:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_4-581bc50f4b7c59bcf5f1ed40588330cf.png"},611221:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_5-4912799f3fcee8b5b1229f5e8e41e22d.png"},443870:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_6-1f7d5134a21a77a1c970231057e88b79.png"},162183:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_7-7bdc355fdcde1bd12d9916dcae4c029b.png"},201600:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_8-ce66da5fddc753e62667e30a79975297.png"},172777:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_9-3300a0e0d61c3f8476d228fc8f9640d5.png"},28453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>r});var i=s(296540);const o={},n=i.createContext(o);function a(e){const t=i.useContext(n);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),i.createElement(n.Provider,{value:t},e.children)}}}]);