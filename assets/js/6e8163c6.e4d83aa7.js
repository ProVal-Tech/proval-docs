"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[50255],{236746:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"cwa/scripts/bef87782-0d9d-40f0-96c5-d30b589b57b4","title":"Detect Frequent Logon User (Set Computer Contact)","description":"This script gathers frequently logged-in domain users on workstations and associates the detected user as a contact in ConnectWise Automate. It analyzes the lsass.exe file to identify users, determines the most frequent user over a specified period, and updates the computer contact information accordingly.","source":"@site/docs/cwa/scripts/Detect Frequent Logon User (Set Computer Contact).md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/bef87782-0d9d-40f0-96c5-d30b589b57b4","permalink":"/proval-docs/docs/cwa/scripts/bef87782-0d9d-40f0-96c5-d30b589b57b4","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Detect Frequent Logon User (Set Computer Contact).md","tags":[{"inline":false,"label":"Active Directory","permalink":"/proval-docs/docs/tags/active-directory","description":"Documents related to Active Directory services and management"},{"inline":false,"label":"Security","permalink":"/proval-docs/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Setup","permalink":"/proval-docs/docs/tags/setup","description":"Documents on setting up software and hardware configurations"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"bef87782-0d9d-40f0-96c5-d30b589b57b4","title":"Detect Frequent Logon User (Set Computer Contact)","title_meta":"Detect Frequent Logon User (Set Computer Contact)","keywords":["loggedin","domain","users","automate","contact","windows","security"],"description":"This script gathers frequently logged-in domain users on workstations and associates the detected user as a contact in ConnectWise Automate. It analyzes the lsass.exe file to identify users, determines the most frequent user over a specified period, and updates the computer contact information accordingly.","tags":["active-directory","security","setup","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Desktop Shortcut - Create","permalink":"/proval-docs/docs/cwa/scripts/de971be6-bd0c-432c-a0de-94119ee0da2b"},"next":{"title":"Disable NTLMv1.1","permalink":"/proval-docs/docs/cwa/scripts/2be0669b-3c87-4594-81f4-112c7411f513"}}');var r=s(474848),i=s(28453);const o={id:"bef87782-0d9d-40f0-96c5-d30b589b57b4",title:"Detect Frequent Logon User (Set Computer Contact)",title_meta:"Detect Frequent Logon User (Set Computer Contact)",keywords:["loggedin","domain","users","automate","contact","windows","security"],description:"This script gathers frequently logged-in domain users on workstations and associates the detected user as a contact in ConnectWise Automate. It analyzes the lsass.exe file to identify users, determines the most frequent user over a specified period, and updates the computer contact information accordingly.",tags:["active-directory","security","setup","windows"],draft:!1,unlisted:!1},a=void 0,c={},d=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Variables",id:"variables",level:2},{value:"Global Parameters",id:"global-parameters",level:4},{value:"EDFs",id:"edfs",level:2},{value:"Output",id:"output",level:2}];function l(e){const t={a:"a",br:"br",code:"code",h2:"h2",h4:"h4",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(t.p,{children:"This script is designed to gather the frequently logged-in domain users on the workstations and set the associated contact to the computer in Automate."}),"\n",(0,r.jsxs)(t.p,{children:["It detects the users present at the ",(0,r.jsx)(t.strong,{children:"path C:/Windows/System32/lsass.exe"}),", which refers to a crucial system file in Microsoft Windows operating systems. Here\u2019s what it does:"]}),"\n",(0,r.jsxs)(t.p,{children:["lsass.exe stands for Local Security Authority Subsystem Service.",(0,r.jsx)(t.br,{}),"\n","This file is a critical component of Microsoft Windows security policies, domain authentication, and Active Directory management on your computer.",(0,r.jsx)(t.br,{}),"\n","It is responsible for enforcing the security policy on the system, verifying users logging on to a Windows computer or server, handling password changes, and creating access tokens."]}),"\n",(0,r.jsxs)(t.p,{children:["The user who was detected most in ",(0,r.jsx)(t.code,{children:"@DaysToCheck@"})," is set as the Frequent user, and the script sets the corresponding contact to the computer associated in Automate."]}),"\n",(0,r.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Sample Run",src:s(577424).A+"",width:"722",height:"527"})}),"\n",(0,r.jsx)(t.h2,{id:"variables",children:"Variables"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Name"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"CurDate"}),(0,r.jsxs)(t.td,{children:['This stores the script run date in the format "yyyy-MM-dd HH:mm',":ss",'".']})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"LogonData"}),(0,r.jsxs)(t.td,{children:["This stores the frequently logged-on user's data. Example: \"",(0,r.jsx)(t.a,{href:"mailto:LogonUserName%3Dabc.xyz@test.com",children:"LogonUserName=abc.xyz@test.com"})]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"LogonUserName"}),(0,r.jsx)(t.td,{children:"It stores the LogonUserName value from the LogonData after splitting it."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"LogonCount"}),(0,r.jsx)(t.td,{children:"It stores the LogonCount value from the LogonData after splitting it."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"ContactIDCheck"}),(0,r.jsx)(t.td,{children:"It stores the Contact ID of the detected LogonUserName to set that Contact ID as the associated contact of the computer."})]})]})]}),"\n",(0,r.jsx)(t.h4,{id:"global-parameters",children:"Global Parameters"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Name"}),(0,r.jsx)(t.th,{children:"Example"}),(0,r.jsx)(t.th,{children:"Required"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"DaysToCheck"}),(0,r.jsx)(t.td,{children:"7"}),(0,r.jsx)(t.td,{children:"True"}),(0,r.jsx)(t.td,{children:"This determines how old event log data needs to be filtered to check the repetitive logged-on users list. By default, it is set to 7."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"MoveAgentAllow"}),(0,r.jsx)(t.td,{children:"1 or 0"}),(0,r.jsx)(t.td,{children:"False"}),(0,r.jsx)(t.td,{children:"If it is set to 1, the agent can move to the locations allocated with the frequent logon user location ID from the contacts record. By default, it is set to 0, which doesn't allow the moving of the agents to the locations."})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"edfs",children:"EDFs"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Name"}),(0,r.jsx)(t.th,{children:"Type"}),(0,r.jsx)(t.th,{children:"Required"}),(0,r.jsx)(t.th,{children:"Not Editable (Manually)"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"LogonUserCheckDate"}),(0,r.jsx)(t.td,{children:"Computer"}),(0,r.jsx)(t.td,{children:"True"}),(0,r.jsx)(t.td,{children:"True"}),(0,r.jsx)(t.td,{children:"This stores the script's last run date to collect the logon user details."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"LogonUserInfo"}),(0,r.jsx)(t.td,{children:"Computer"}),(0,r.jsx)(t.td,{children:"True"}),(0,r.jsx)(t.td,{children:"True"}),(0,r.jsx)(t.td,{children:"This stores the LogonUserName and LogonCount details, separated by (---) for later reporting in the dataview."})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Script log"}),"\n",(0,r.jsx)(t.li,{children:"EDFs"}),"\n",(0,r.jsx)(t.li,{children:"Dataview"}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},577424:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_1-cafa3445f3a697c349e08e3fe25cf253.png"},28453:(e,t,s)=>{s.d(t,{R:()=>o,x:()=>a});var n=s(296540);const r={},i=n.createContext(r);function o(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);