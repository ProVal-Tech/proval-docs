"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[37797],{635655:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>i,contentTitle:()=>c,default:()=>p,frontMatter:()=>s,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"cwa/monitors/1e8cbc91-0ac5-4b80-b2bd-0b876528148e","title":"Add Domain Group to Local Administrator","description":"This document provides a step-by-step guide for setting up a ticket creation system in ConnectWise Automate for computers. It covers the installation of necessary scripts, obtaining group IDs, and executing SQL queries to automate ticket creation when certain conditions are met.","source":"@site/docs/cwa/monitors/Add Domain Group to Local Administrator.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/1e8cbc91-0ac5-4b80-b2bd-0b876528148e","permalink":"/docs/cwa/monitors/1e8cbc91-0ac5-4b80-b2bd-0b876528148e","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Add Domain Group to Local Administrator.md","tags":[{"inline":false,"label":"Database","permalink":"/docs/tags/database","description":"Documents related to database management systems and operations"},{"inline":false,"label":"Setup","permalink":"/docs/tags/setup","description":"Documents on setting up software and hardware configurations"}],"version":"current","frontMatter":{"id":"1e8cbc91-0ac5-4b80-b2bd-0b876528148e","title":"Add Domain Group to Local Administrator","title_meta":"Add Domain Group to Local Administrator","keywords":["connectwise","ticket","creation","computer","groupid","alert","template","monitor"],"description":"This document provides a step-by-step guide for setting up a ticket creation system in ConnectWise Automate for computers. It covers the installation of necessary scripts, obtaining group IDs, and executing SQL queries to automate ticket creation when certain conditions are met.","tags":["database","setup"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Add Auto Lockout Policy","permalink":"/docs/cwa/monitors/65644f6f-922e-40e5-91fe-6063c5de2018"},"next":{"title":"Add Windows Capability - RSAT","permalink":"/docs/cwa/monitors/7c336dbd-72cb-4099-8be1-19c78f54cabb"}}');var a=r(474848),o=r(28453);const s={id:"1e8cbc91-0ac5-4b80-b2bd-0b876528148e",title:"Add Domain Group to Local Administrator",title_meta:"Add Domain Group to Local Administrator",keywords:["connectwise","ticket","creation","computer","groupid","alert","template","monitor"],description:"This document provides a step-by-step guide for setting up a ticket creation system in ConnectWise Automate for computers. It covers the installation of necessary scripts, obtaining group IDs, and executing SQL queries to automate ticket creation when certain conditions are met.",tags:["database","setup"],draft:!1,unlisted:!1},c=void 0,i={},d=[{value:"Step 1",id:"step-1",level:2},{value:"Step 2",id:"step-2",level:2},{value:"Step 3",id:"step-3",level:2},{value:"Step 4",id:"step-4",level:2},{value:"Step 5",id:"step-5",level:2},{value:"Step 6",id:"step-6",level:2}];function R(e){const t={a:"a",br:"br",code:"code",h2:"h2",hr:"hr",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h2,{id:"step-1",children:"Step 1"}),"\n",(0,a.jsxs)(t.p,{children:["Ensure the presence of the ",(0,a.jsx)(t.a,{href:"/docs/cwa/scripts/63beba3c-f4a6-41a5-98e2-d4e4ce885035",children:"CWM - Automate - Script - Ticket Creation - Computer"})," script and the ",(0,a.jsx)(t.code,{children:"\u25b3 Custom - Ticket Creation - Computer"})," alert template."]}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.h2,{id:"step-2",children:"Step 2"}),"\n",(0,a.jsx)(t.p,{children:"Obtain the group ID(s) of the group(s) that the remote monitor should be applied to."}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.h2,{id:"step-3",children:"Step 3"}),"\n",(0,a.jsxs)(t.p,{children:["Copy the following query and replace '",(0,a.jsx)(t.strong,{children:"YOUR COMMA SEPARATED LIST OF GROUPID(S)"}),"' with the group ID(s) of the relevant groups:",(0,a.jsx)(t.br,{}),"\n","(The string to replace can be found at the very bottom of the query, right after ",(0,a.jsx)(t.strong,{children:"WHERE"}),")"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"INSERT INTO groupagents \r\nSELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'ProVal - Client Specific - Add Domain Group to Local Administrators' as `Name`,\r\n'6' as `CheckAction`,\r\n'1' as `AlertAction`,\r\n'Failed to Add Domain Group to Local Administrators~~~Successfully Added Domain Group HEIDOMAIN//ITPcSupport to local administrators.!!!Failed to Add Domain Group to Local Administrators~~~Failed to add Domain Group HEIDOMAIN//ITPcSupport to local administrators for %COMPUTERNAME%. \r\nReason: %RESULT%' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'604800' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C://Windows//System32//WindowsPowerShell//v1.0//powershell.exe -ExecutionPolicy Bypass -Command \\\"$Admin = Net localGroup Administrators; if ( !($Admin -match /'HEIDOMAIN.ITPcSupport/') ) {net localgroup administrators HEIDOMAIN//ITPcSupport /Add /y} else {return /'The command completed successfully./'}\\\"' as `DataOut`,\r\n'10' as `Comparor`,\r\n'The command completed successfully.' as `DataIn`,\r\n'' as `IDField`,\r\n'1' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'21' as `Category`,\r\n'0' as `TicketCategory`,\r\n'1' as `ScriptTarget`,\r\nCONCAT(\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1)\r\n) as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (**YOUR COMMA SEPARATED LIST OF GROUPID(S)**)\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Client Specific - Add Domain Group to Local Administrators')\n"})}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.h2,{id:"step-4",children:"Step 4"}),"\n",(0,a.jsx)(t.p,{children:"An example of a query with a group ID:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"INSERT INTO groupagents \r\nSELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'ProVal - Client Specific - Add Domain Group to Local Administrators' as `Name`,\r\n'6' as `CheckAction`,\r\n'1' as `AlertAction`,\r\n'Failed to Add Domain Group to Local Administrators~~~Successfully Added Domain Group HEIDOMAIN//ITPcSupport to local administrators.!!!Failed to Add Domain Group to Local Administrators~~~Failed to add Domain Group HEIDOMAIN//ITPcSupport to local administrators for %COMPUTERNAME%. \r\nReason: %RESULT%' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'604800' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C://Windows//System32//WindowsPowerShell//v1.0//powershell.exe -ExecutionPolicy Bypass -Command \\\"$Admin = Net localGroup Administrators; if ( !($Admin -match /'HEIDOMAIN.ITPcSupport/') ) {net localgroup administrators HEIDOMAIN//ITPcSupport /Add /y} else {return /'The command completed successfully./'}\\\"' as `DataOut`,\r\n'10' as `Comparor`,\r\n'The command completed successfully.' as `DataIn`,\r\n'' as `IDField`,\r\n'1' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'21' as `Category`,\r\n'0' as `TicketCategory`,\r\n'1' as `ScriptTarget`,\r\nCONCAT(\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1)\r\n) as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (2,3)\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Client Specific - Add Domain Group to Local Administrators')\n"})}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.h2,{id:"step-5",children:"Step 5"}),"\n",(0,a.jsx)(t.p,{children:"Now execute your query from a RAWSQL monitor set."}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.h2,{id:"step-6",children:"Step 6"}),"\n",(0,a.jsxs)(t.p,{children:["Locate your remote monitor by opening the group(s) remote monitors tab, then apply the ",(0,a.jsx)(t.code,{children:"\u25b3 Custom - Ticket Creation - Computer"})," alert template."]})]})}function p(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(R,{...e})}):R(e)}},28453:(e,t,r)=>{r.d(t,{R:()=>s,x:()=>c});var n=r(296540);const a={},o=n.createContext(a);function s(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);