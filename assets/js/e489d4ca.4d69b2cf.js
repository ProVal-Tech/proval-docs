"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[685],{589648:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"cwa/scripts/b0bd8d59-9491-4669-8226-fd7df87c722d","title":"CVE-2016-2115 - SMB Signing","description":"This document details a script designed to detect and remediate the CVE-2016-2115 vulnerability related to SMB signing. It includes sample runs, dependencies, variables used in the script, output details, and ticketing procedures for successful remediation.","source":"@site/docs/cwa/scripts/CVE-2016-2115 - SMB Signing.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/b0bd8d59-9491-4669-8226-fd7df87c722d","permalink":"/proval-docs/docs/cwa/scripts/b0bd8d59-9491-4669-8226-fd7df87c722d","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/CVE-2016-2115 - SMB Signing.md","tags":[{"inline":false,"label":"CVE","permalink":"/proval-docs/docs/tags/cve","description":"Documents related to Common Vulnerabilities and Exposures (CVE)"},{"inline":false,"label":"Logging","permalink":"/proval-docs/docs/tags/logging","description":"Documents related to log management and analysis for systems"},{"inline":false,"label":"SMB","permalink":"/proval-docs/docs/tags/smb","description":"Documents concerning Server Message Block (SMB) protocol and file sharing"}],"version":"current","frontMatter":{"id":"b0bd8d59-9491-4669-8226-fd7df87c722d","title":"CVE-2016-2115 - SMB Signing","title_meta":"CVE-2016-2115 - SMB Signing","keywords":["cve","smb","signing","remediation","detection"],"description":"This document details a script designed to detect and remediate the CVE-2016-2115 vulnerability related to SMB signing. It includes sample runs, dependencies, variables used in the script, output details, and ticketing procedures for successful remediation.","tags":["cve","logging","smb"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"CVE-2013-3900 WinVerifyTrust Signature Vulnerability","permalink":"/proval-docs/docs/cwa/scripts/c8638470-bc69-4bc9-ac97-b0496e546d07"},"next":{"title":"CVE-2016-2115 SMB Signing Ticketing - Per Client","permalink":"/proval-docs/docs/cwa/scripts/fb51b42a-d982-447f-be4a-9842cd3a5936"}}');var s=i(474848),d=i(28453);const r={id:"b0bd8d59-9491-4669-8226-fd7df87c722d",title:"CVE-2016-2115 - SMB Signing",title_meta:"CVE-2016-2115 - SMB Signing",keywords:["cve","smb","signing","remediation","detection"],description:"This document details a script designed to detect and remediate the CVE-2016-2115 vulnerability related to SMB signing. It includes sample runs, dependencies, variables used in the script, output details, and ticketing procedures for successful remediation.",tags:["cve","logging","smb"],draft:!1,unlisted:!1},c=void 0,l={},o=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Variables",id:"variables",level:2},{value:"EDFs",id:"edfs",level:4},{value:"Output",id:"output",level:2},{value:"Ticketing",id:"ticketing",level:2}];function a(e){const t={a:"a",br:"br",code:"code",h2:"h2",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsx)(t.p,{children:"This script is created to run the detection/remediation for CVE-2016-2115 - SMB Signing Disable check and enable it if the remediation option is selected via EDF."}),"\n",(0,s.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Sample Run Image 1",src:i(408198).A+"",width:"717",height:"594"})}),"\n",(0,s.jsxs)(t.p,{children:["It is required to execute this script after importing with the setting ",(0,s.jsx)(t.code,{children:"SetEnvironment = 1"}),"."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Sample Run Image 2",src:i(189405).A+"",width:"717",height:"593"})}),"\n",(0,s.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{href:"/proval-docs/docs/cwa/monitors/ec7b5cdb-3a08-43c2-9f83-068522cf1ad7",children:"CWA Remote Monitor - SMB Signing Detection"})}),"\n",(0,s.jsx)(t.h2,{id:"variables",children:"Variables"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Name"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"DetectionOnly"}),(0,s.jsx)(t.td,{children:"This collects data from client-EDF 'CVE Vulnerability Detection Only' for the agent where the script is deployed. If it is 1, then the CVE-2016-2115-only detection will run and register to the dataview without remediation."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Detection-Remediation"}),(0,s.jsx)(t.td,{children:"This collects data from client-EDF 'CVE-2016-2115 Vul Detection and Remediation' for the agent where the script is deployed. If it is 1, then the SMB Signing will be detected; if found disabled, then it attempts to enable it and logs the result to the dataview."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"SMBSignDetection"}),(0,s.jsx)(t.td,{children:"This contains the SMB signing audit status of the agent."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"psout"}),(0,s.jsx)(t.td,{children:"It contains the SMB signing remediation data."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"TicketCreation"}),(0,s.jsxs)(t.td,{children:["It contains the ticket category ID applied on the monitor ",(0,s.jsx)(t.a,{href:"/proval-docs/docs/cwa/monitors/ec7b5cdb-3a08-43c2-9f83-068522cf1ad7",children:"CWA Remote Monitor - SMB Signing Detection"}),". If the category is set, then only the ticket will be created."]})]})]})]}),"\n",(0,s.jsx)(t.h4,{id:"edfs",children:"EDFs"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Name"}),(0,s.jsx)(t.th,{children:"Level"}),(0,s.jsx)(t.th,{children:"Type"}),(0,s.jsx)(t.th,{children:"Example"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CVE-2016-2115 Status"}),(0,s.jsx)(t.td,{children:"Computer"}),(0,s.jsx)(t.td,{children:"Text"}),(0,s.jsx)(t.td,{children:"Remediation Successful"}),(0,s.jsx)(t.td,{children:"This stores the status of CVE-2016-2115 after script execution."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CVE-2016-2115 Logging"}),(0,s.jsx)(t.td,{children:"Computer"}),(0,s.jsx)(t.td,{children:"Text"}),(0,s.jsx)(t.td,{children:"@psout@"}),(0,s.jsx)(t.td,{children:"This stores the script PowerShell execution output for logging."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CVE-2016-2115 Detection Date"}),(0,s.jsx)(t.td,{children:"Computer"}),(0,s.jsx)(t.td,{children:"Text"}),(0,s.jsx)(t.td,{children:"2024-05-01 00:00:00"}),(0,s.jsx)(t.td,{children:"This stores the date and time when the last CVE-2016-2115 status was detected via the script."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CVE-2016-2115 Vulnerability"}),(0,s.jsx)(t.td,{children:"Computer"}),(0,s.jsx)(t.td,{children:"Text"}),(0,s.jsx)(t.td,{children:"Not Vulnerable"}),(0,s.jsx)(t.td,{children:"This shows whether the device is vulnerable or not based on the script output detection."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CVE-2016-2115 Vul Detection and Remediation"}),(0,s.jsx)(t.td,{children:"Client"}),(0,s.jsx)(t.td,{children:"Flag"}),(0,s.jsx)(t.td,{children:"1"}),(0,s.jsx)(t.td,{children:"If this client EDF is checked, then the CVE-2016-2115 detection as well as remediation will be performed by the script."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CVE Vulnerability Detection Only"}),(0,s.jsx)(t.td,{children:"Client"}),(0,s.jsx)(t.td,{children:"Flag"}),(0,s.jsx)(t.td,{children:"1"}),(0,s.jsx)(t.td,{children:"If this client EDF is checked, then the CVE-2016-2115 detection only will be performed by the script."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CVE-2016-2115 Vul Detection and Remediation Exclude"}),(0,s.jsx)(t.td,{children:"Location"}),(0,s.jsx)(t.td,{children:"Flag"}),(0,s.jsx)(t.td,{children:"0"}),(0,s.jsx)(t.td,{children:"If this location EDF is checked, then the CVE-2016-2115 detection & remediation will be excluded from all agents of the location."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CVE-2016-2115 Vul Detection and Remediation Exclude"}),(0,s.jsx)(t.td,{children:"Computer"}),(0,s.jsx)(t.td,{children:"Flag"}),(0,s.jsx)(t.td,{children:"0"}),(0,s.jsx)(t.td,{children:"If this EDF is checked, then the CVE-2016-2115 detection & remediation will be excluded from the agent."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CVE-2016-2115 Vul Detection and Remediation"}),(0,s.jsx)(t.td,{children:"Computer"}),(0,s.jsx)(t.td,{children:"Flag"}),(0,s.jsx)(t.td,{children:"1"}),(0,s.jsx)(t.td,{children:'If this EDF is checked, then the agent will be added to the group "CVE-2016-2115 SMB Signing Detection & Rem".'})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Script log"}),"\n",(0,s.jsx)(t.li,{children:"Dataview"}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"ticketing",children:"Ticketing"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["How to Enable Ticket:","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Navigate to the group 'CVE-2016-2115 - SMB Signing' > Open group > Go to Computers > Remote Monitors."}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Select the remote monitor ",(0,s.jsx)(t.a,{href:"/proval-docs/docs/cwa/monitors/4ae6f939-e049-499e-8651-e452e0d5ba24",children:"CWA Remote Monitor - SMB Signing Detection"})," and check the ticket category.",(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.img,{alt:"Ticketing Image",src:i(272724).A+"",width:"1000",height:"401"})]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"If this ticket category is set, then only the script will be able to create a ticket for the remediation step."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Failure:"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Subject:"}),(0,s.jsx)(t.br,{}),"\n","CVE-2016-2115 SMB Signing enabling failed on %ComputerName%"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Body:"}),(0,s.jsx)(t.br,{}),"\n","@TicketComment@",(0,s.jsx)(t.br,{}),"\n","There are two possible failure comments:",(0,s.jsx)(t.br,{}),"\n","The remediation PowerShell execution has failed. Refer to the below logs:",(0,s.jsx)(t.br,{}),"\n","@psout@",(0,s.jsx)(t.br,{}),"\n","OR",(0,s.jsx)(t.br,{}),"\n","The remediation was attempted for the vulnerability fix on the computer name %computername% but it failed. Refer to the logs:",(0,s.jsx)(t.br,{}),"\n","@psout@"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Success:"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Body:"}),(0,s.jsx)(t.br,{}),"\n","The vulnerability has been remediated successfully. Refer to the below log information:",(0,s.jsx)(t.br,{}),"\n","@psout@"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,d.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},408198:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/image_1-72e7d7ade973e5af76be411ab377bed9.png"},189405:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/image_2-43d15a1270e745b834f44adbaa2402dc.png"},272724:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/image_3-130baa161f6a77be8a7fcde15e0c2be1.png"},28453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>c});var n=i(296540);const s={},d=n.createContext(s);function r(e){const t=n.useContext(d);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(d.Provider,{value:t},e.children)}}}]);