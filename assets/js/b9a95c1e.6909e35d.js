"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[61916],{340880:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>i});const r=JSON.parse('{"id":"vsa/procedures/7532eff4-e724-471e-96fc-ddfd944bf710","title":"PUA Remove","description":"This document provides a detailed overview of the configurable removal of potentially unwanted applications (PUAs) using an agnostic script. It includes sample run logs, variable descriptions, and the overall process for executing the script effectively.","source":"@site/docs/vsa/procedures/PUA Remove.md","sourceDirName":"vsa/procedures","slug":"/vsa/procedures/7532eff4-e724-471e-96fc-ddfd944bf710","permalink":"/proval-docs/docs/vsa/procedures/7532eff4-e724-471e-96fc-ddfd944bf710","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/vsa/procedures/PUA Remove.md","tags":[{"inline":false,"label":"Security","permalink":"/proval-docs/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Software","permalink":"/proval-docs/docs/tags/software","description":"Documents related to software applications and their lifecycle management"},{"inline":false,"label":"Uninstallation","permalink":"/proval-docs/docs/tags/uninstallation","description":"Documents related to software removal and uninstallation processes"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"7532eff4-e724-471e-96fc-ddfd944bf710","title":"PUA Remove","title_meta":"PUA Remove","keywords":["removal","pua","software","uninstall","bloatware"],"description":"This document provides a detailed overview of the configurable removal of potentially unwanted applications (PUAs) using an agnostic script. It includes sample run logs, variable descriptions, and the overall process for executing the script effectively.","tags":["security","software","uninstallation","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"OneDrive Disable","permalink":"/proval-docs/docs/vsa/procedures/55e5e8ed-f8a3-40d3-bc9c-8ca5f0059306"},"next":{"title":"PowerShell Within A Scheduled Task","permalink":"/proval-docs/docs/vsa/procedures/1b3d6a20-7e4d-4402-95f3-c2d54fa90b0e"}}');var n=s(474848),d=s(28453);const l={id:"7532eff4-e724-471e-96fc-ddfd944bf710",title:"PUA Remove",title_meta:"PUA Remove",keywords:["removal","pua","software","uninstall","bloatware"],description:"This document provides a detailed overview of the configurable removal of potentially unwanted applications (PUAs) using an agnostic script. It includes sample run logs, variable descriptions, and the overall process for executing the script effectively.",tags:["security","software","uninstallation","windows"],draft:!1,unlisted:!1},o=void 0,c={},i=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Variables",id:"variables",level:2},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2},{value:"Export Attachment",id:"export-attachment",level:2}];function a(e){const t={a:"a",br:"br",h2:"h2",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,d.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,n.jsxs)(t.p,{children:["Configurable Removal of Potentially Unwanted Applications",(0,n.jsx)(t.br,{}),"\n","Implementation of Agnostic Content ",(0,n.jsx)(t.a,{href:"/proval-docs/docs/powershell/ps-remove-pua",children:"SWM - Software Uninstall - Agnostic - Remove-PUA"})]}),"\n",(0,n.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Time"}),(0,n.jsx)(t.th,{children:"Action"}),(0,n.jsx)(t.th,{children:"Result"}),(0,n.jsx)(t.th,{children:"User"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:35 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"PUA Remove"}),(0,n.jsx)(t.td,{children:"Success THEN"}),(0,n.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:34 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"PUA Remove-0009"}),(0,n.jsx)(t.td,{children:"Log: 2022-07-22 11:52:27 INIT ... Microsoft.3DBuilder ... Checking the lists ..."}),(0,n.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:34 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"PUA Remove-0001"}),(0,n.jsx)(t.td,{children:"2022-07-22 11:53:30 INIT ... Microsoft.BingNews ... found Microsoft.BingNews in Microsoft bloat apps list ..."}),(0,n.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:34 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)"}),(0,n.jsx)(t.td,{children:"Success THEN"}),(0,n.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:34 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0016"}),(0,n.jsxs)(t.td,{children:["Powershell command complete. Results returned to global variable #global",":psresult","# and saved in the Agent's Documents tab of the server."]}),(0,n.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:34 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0016"}),(0,n.jsx)(t.td,{children:"Informational: GetFile command overwrote the server file C:/Kaseya/UserProfiles/204148124820810/GetFiles/../docs/psoutput.txt with the new contents from c:/provaltech/psoutput.txt in THEN step 3."}),(0,n.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:29 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0011"}),(0,n.jsx)(t.td,{children:'Executing 64-bit Powershell command as System: "" -command "%ProgramData%/_automation/AgentProcedure/PUARemove/Remove-PUA.ps1 -Remove Microsoft.BingNews" >"c:/provaltech/psoutputtmp.txt"'}),(0,n.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:29 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0013"}),(0,n.jsx)(t.td,{children:"Sending output to global variable."}),(0,n.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:29 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0008"}),(0,n.jsx)(t.td,{children:"Custom commands detected as %ProgramData%/_automation/AgentProcedure/PUARemove/Remove-PUA.ps1 -Remove Microsoft.BingNews"}),(0,n.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:29 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0003"}),(0,n.jsx)(t.td,{children:"No Powershell file variable detected."}),(0,n.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:29 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0002"}),(0,n.jsx)(t.td,{children:"Powershell is present."}),(0,n.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:26 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"Execute Powershell Command"}),(0,n.jsx)(t.td,{children:"Success THEN"}),(0,n.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:25 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"Execute Powershell Command-0011"}),(0,n.jsx)(t.td,{children:"Powershell command completed!"}),(0,n.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:25 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"Execute Powershell Command-0011"}),(0,n.jsx)(t.td,{children:'Executing Powershell "" -Command "New-Item -Type Directory -Path %ProgramData%/_automation/AgentProcedure -name PUARemove" ""'}),(0,n.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:25 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"Execute Powershell Command-0010"}),(0,n.jsx)(t.td,{children:"Not sending output to variable."}),(0,n.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:25 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"Execute Powershell Command-0008"}),(0,n.jsx)(t.td,{children:'New command variable is: -Command "New-Item -Type Directory -Path %ProgramData%/_automation/AgentProcedure -name PUARemove"'}),(0,n.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:25 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"Execute Powershell Command-0008"}),(0,n.jsx)(t.td,{children:"Custom commands detected as New-Item -Type Directory -Path %ProgramData%/_automation/AgentProcedure -name PUARemove"}),(0,n.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:24 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"Execute Powershell Command-0002"}),(0,n.jsx)(t.td,{children:"Powershell is present."}),(0,n.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"11:53:16 am 22-Jul-22"}),(0,n.jsx)(t.td,{children:"Run Now - PUA Remove"}),(0,n.jsx)(t.td,{children:"Admin provaltech.com/dan.hicks scheduled procedure Run Now - PUA Remove to run at Jul 22 2022 11:53 AM"}),(0,n.jsx)(t.td,{})]})]})]}),"\n",(0,n.jsx)(t.h2,{id:"variables",children:"Variables"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Variable Name"}),(0,n.jsx)(t.th,{children:"Description"}),(0,n.jsx)(t.th,{children:"Syntax"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"RemoveAll"}),(0,n.jsx)(t.td,{children:"Remove all bloatware from the machine. Can be used with #exceptions#"}),(0,n.jsx)(t.td,{children:"'app1','app2','app3'"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"RemoveSpecific"}),(0,n.jsx)(t.td,{children:"Remove specific apps per client request."}),(0,n.jsx)(t.td,{children:"'app1','app2','app3'"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"category"}),(0,n.jsx)(t.td,{children:"Remove all apps from a specific category. Multiple categories can be selected. Valid Categories: MsftBloatApps, ThirdPartyBloatApps, WindowsStoreApps, XboxFeaturesApps, NonAppxApps"}),(0,n.jsx)(t.td,{children:"'MsftBloatApps','XboxFeatureApps'"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"exceptions"}),(0,n.jsx)(t.td,{children:"Set app exceptions for #RemoveAll# and #category# (Apps you want to keep)"}),(0,n.jsx)(t.td,{children:"'app1','app2','app3'"})]})]})]}),"\n",(0,n.jsx)(t.h2,{id:"process",children:"Process"}),"\n",(0,n.jsxs)(t.p,{children:["Runs the agnostic script ",(0,n.jsx)(t.a,{href:"/proval-docs/docs/powershell/ps-remove-pua",children:"SWM - Software Uninstall - Agnostic - Remove-PUA"})," with the defined parameters."]}),"\n",(0,n.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,n.jsx)(t.p,{children:"AP Log"}),"\n",(0,n.jsx)(t.h2,{id:"export-attachment",children:"Export Attachment"}),"\n",(0,n.jsx)(t.p,{children:"Attach the content XML VSA Export to this document."})]})}function h(e={}){const{wrapper:t}={...(0,d.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>l,x:()=>o});var r=s(296540);const n={},d=r.createContext(n);function l(e){const t=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),r.createElement(d.Provider,{value:t},e.children)}}}]);