"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[61943],{265105:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"cwa/scripts/8b128210-5b70-4155-ade6-83ab5365911c","title":"Auto AAD to Autopilot - Client Specific (IT Synergy)","description":"This document outlines a PowerShell script designed to automate the addition of Active Directory to Windows Autopilot by checking specific registry values and executing necessary commands if conditions are met. It includes setup instructions, sample run outputs, dependencies, and detailed process steps.","source":"@site/docs/cwa/scripts/Auto AAD to Autopilot - Client Specific (IT Synergy).md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/8b128210-5b70-4155-ade6-83ab5365911c","permalink":"/proval-docs/docs/cwa/scripts/8b128210-5b70-4155-ade6-83ab5365911c","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Auto AAD to Autopilot - Client Specific (IT Synergy).md","tags":[{"inline":false,"label":"Security","permalink":"/proval-docs/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Update","permalink":"/proval-docs/docs/tags/update","description":"Documents discussing software and system updates and their management"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"8b128210-5b70-4155-ade6-83ab5365911c","title":"Auto AAD to Autopilot - Client Specific (IT Synergy)","title_meta":"Auto AAD to Autopilot - Client Specific (IT Synergy)","keywords":["script","autopilot","aad","registry","windows"],"description":"This document outlines a PowerShell script designed to automate the addition of Active Directory to Windows Autopilot by checking specific registry values and executing necessary commands if conditions are met. It includes setup instructions, sample run outputs, dependencies, and detailed process steps.","tags":["security","update","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Audit WMI Patch History","permalink":"/proval-docs/docs/cwa/scripts/113349eb-9de0-4b42-b773-cf873f87f2f0"},"next":{"title":"Auto Close - Feature Update Tickets Autofix","permalink":"/proval-docs/docs/cwa/scripts/84cd2c82-8c0b-4f7e-9240-6b640add79e0"}}');var n=s(474848),o=s(28453);const r={id:"8b128210-5b70-4155-ade6-83ab5365911c",title:"Auto AAD to Autopilot - Client Specific (IT Synergy)",title_meta:"Auto AAD to Autopilot - Client Specific (IT Synergy)",keywords:["script","autopilot","aad","registry","windows"],description:"This document outlines a PowerShell script designed to automate the addition of Active Directory to Windows Autopilot by checking specific registry values and executing necessary commands if conditions are met. It includes setup instructions, sample run outputs, dependencies, and detailed process steps.",tags:["security","update","windows"],draft:!1,unlisted:!1},c=void 0,l={},d=[{value:"Summary",id:"summary",level:2},{value:"Action Items:",id:"action-items",level:3},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Variables",id:"variables",level:2},{value:"Process",id:"process",level:2}];function a(e){const t={br:"br",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,n.jsx)(t.p,{children:"This script satisfies the request of ticket T20221207.0097 - auto AD to Autopilot."}),"\n",(0,n.jsx)(t.h3,{id:"action-items",children:"Action Items:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["Create a script that checks for the specified registry value ",(0,n.jsx)(t.code,{children:"Computer/HKEY_LOCAL_MACHINE/SOFTWARE/Microsoft/Provisioning/Diagnostics/AutoPilot/EstablishedCorrelations"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Name: AADEnrollInfo"}),"\n",(0,n.jsxs)(t.li,{children:["If the value does not exist, run the following command:","\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-powershell",children:"$TenantId = '1e334b75-3a05-4930-ab3d-2f2ef9d57937' \r\n$AppId = '67f6c690-2cd4-492d-b958-02e07e35bda5' \r\n$AppSecret = 'nwV8Q~XvrGYTra434667JkMNikpyF7YsbGi' \r\nGet-WindowsAutoPilotInfo -Online -TenantId $TenantId -AppId $AppId -AppSecret $AppSecret\n"})}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"$TenantId"}),", ",(0,n.jsx)(t.code,{children:"$AppId"}),", and ",(0,n.jsx)(t.code,{children:"$AppSecret"})," should be pulled from an encrypted EDF at the client level."]}),"\n",(0,n.jsxs)(t.li,{children:["You'll need to install ",(0,n.jsx)(t.code,{children:"Get-WindowsAutoPilotInfo"})," from PSGallery as well."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,n.jsxs)(t.p,{children:["Set up the assigned Encrypted Client Level EDF Values",(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.img,{alt:"Sample Run",src:s(322845).A+"",width:"1000",height:"459"})]}),"\n",(0,n.jsxs)(t.p,{children:["Run the script on the target machine",(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.img,{alt:"Run Script",src:s(25286).A+"",width:"484",height:"352"})]}),"\n",(0,n.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,n.jsx)(t.p,{children:"AppID, AppSecret, and Tenant ID EDFs must be set at the client level."}),"\n",(0,n.jsx)(t.h2,{id:"variables",children:"Variables"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Name"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Tenant"}),(0,n.jsx)(t.td,{children:"Holds the decrypted AAD Tenant value"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Secret"}),(0,n.jsx)(t.td,{children:"Holds the decrypted AAD Secret value"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"AppID"}),(0,n.jsx)(t.td,{children:"Holds the decrypted AAD AppID"})]})]})]}),"\n",(0,n.jsx)(t.h2,{id:"process",children:"Process"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Populate all variables with EDF values."}),"\n",(0,n.jsxs)(t.li,{children:["Execute the script to run ",(0,n.jsx)(t.code,{children:"Get-WindowsAutoPilotInfo.ps1"})," if the requested registry value is not present."]}),"\n",(0,n.jsxs)(t.li,{children:["There are two possible outcomes: either the registry value is returned with ",(0,n.jsx)(t.code,{children:"AADEnrollInfo"})," in the text, or the results of the ",(0,n.jsx)(t.code,{children:"Get-WindowsAutoPilotInfo.ps1"})," will be returned."]}),"\n",(0,n.jsxs)(t.li,{children:["If the output of PowerShell contains ",(0,n.jsx)(t.code,{children:"AADEnrollInfo"}),", it's a success because the value is present."]}),"\n",(0,n.jsxs)(t.li,{children:['If the output does not contain "All Devices synced," then ',(0,n.jsx)(t.code,{children:"Get-WindowsAutoPilotInfo.ps1"})," failed, and the script will fail."]}),"\n",(0,n.jsxs)(t.li,{children:["If the ",(0,n.jsx)(t.code,{children:"FinishStatus"})," of the script PowerShell response - All Errors - Check is false, then the check for common environmental errors found a known issue, and the script will fail."]}),"\n",(0,n.jsx)(t.li,{children:"The script log will hold any error type information."}),"\n"]})]})}function p(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}},322845:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_1-6b2732d483ef7d9256638466890588f3.png"},25286:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_2-7950cff219bb965e36799b7e9592d7b3.png"},28453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>c});var i=s(296540);const n={},o=i.createContext(n);function r(e){const t=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),i.createElement(o.Provider,{value:t},e.children)}}}]);