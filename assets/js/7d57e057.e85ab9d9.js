"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[38249],{927565:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"cwa/scripts/6357c957-b5b6-42eb-aacc-f4f2a12d3021","title":"ScreenConnect - End Session Command RMM+","description":"This document describes a script designed to terminate a matching session in the CW Control portal using the provided GUID. The script outlines the necessary dependencies, system properties, and the overall process for executing the command, including logging the results for review.","source":"@site/docs/cwa/scripts/ScreenConnect - End Session Command RMM+.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/6357c957-b5b6-42eb-aacc-f4f2a12d3021","permalink":"/proval-docs/docs/cwa/scripts/6357c957-b5b6-42eb-aacc-f4f2a12d3021","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/ScreenConnect - End Session Command RMM+.md","tags":[],"version":"current","frontMatter":{"id":"6357c957-b5b6-42eb-aacc-f4f2a12d3021","title":"ScreenConnect - End Session Command RMM+","title_meta":"ScreenConnect - End Session Command RMM+","keywords":["cwcontrol","session","guid","automation","rmm"],"description":"This document describes a script designed to terminate a matching session in the CW Control portal using the provided GUID. The script outlines the necessary dependencies, system properties, and the overall process for executing the command, including logging the results for review.","tags":[],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"ScreenConnect -  Update Vendor Restricted Property RMM+","permalink":"/proval-docs/docs/cwa/scripts/1e1a92d4-008b-4b8e-af9d-3ff9579acb24"},"next":{"title":"ScreenConnect - Offline Agent Remediation Autofix,RMM+","permalink":"/proval-docs/docs/cwa/scripts/ab3118dc-bc06-4443-9af0-78ccfb594844"}}');var i=s(474848),r=s(28453);const o={id:"6357c957-b5b6-42eb-aacc-f4f2a12d3021",title:"ScreenConnect - End Session Command RMM+",title_meta:"ScreenConnect - End Session Command RMM+",keywords:["cwcontrol","session","guid","automation","rmm"],description:"This document describes a script designed to terminate a matching session in the CW Control portal using the provided GUID. The script outlines the necessary dependencies, system properties, and the overall process for executing the command, including logging the results for review.",tags:[],draft:!1,unlisted:!1},c=void 0,d={},l=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Variables",id:"variables",level:3},{value:"System Properties",id:"system-properties",level:3},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2}];function a(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(t.p,{children:"This script will attempt to end a matching session in the CW Control portal using the provided GUID."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Time Saved by Automation:"})," 5 Minutes"]}),"\n",(0,i.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Target:"})," Any machine with CW Control installed"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Sample Run",src:s(709406).A+"",width:"481",height:"350"})}),"\n",(0,i.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"RMM+ extension in CW Control"}),"\n",(0,i.jsx)(t.li,{children:"HTTP GET/POST Plugin in CW Automate"}),"\n",(0,i.jsx)(t.li,{children:"System properties"}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Note:"})," This script is a subscript of ",(0,i.jsx)(t.a,{href:"/proval-docs/docs/cwa/scripts/d69c20e1-e605-4cf9-bf35-bbe4c74f134f",children:"CW Control - Uninstall and Remove from Control Web Portal"})]}),"\n",(0,i.jsx)(t.h3,{id:"variables",children:"Variables"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"@accesskey@"})," - See System properties below"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"@httpplugin_headers@"})," - See System properties below"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"@sccomputerguid@"})," - The GUID of the CW Control instance"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"@SCUrl@"})," - The URL for the CW Control portal"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"@Port@"})," - The port in use for CW Control"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"@SCFormattedURL@"})," - A formatted URL to work properly with the RMM+ extension in CW Control"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"@SCCommandURL@"})," - The URL to end sessions related to the RMM+ Plugin"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"@wiperesult@"})," - The output of the results from the command run above."]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"system-properties",children:"System Properties"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Name"}),(0,i.jsx)(t.th,{children:"Example"}),(0,i.jsx)(t.th,{children:"Required"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"RMMPlus_AccessKey"}),(0,i.jsx)(t.td,{children:"ajw8fh2p93ufn;o31ifu2091j23oif"}),(0,i.jsx)(t.td,{children:"True"}),(0,i.jsx)(t.td,{children:"This is the key set up in the CW Control RMM+ Plugin so Automate can reach out to gain access to the API."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"RMMPlus_Headers"}),(0,i.jsxs)(t.td,{children:["Origin: ",(0,i.jsx)(t.a,{href:"http://site.site.com/",children:"site.site.com"})]}),(0,i.jsx)(t.td,{children:"True"}),(0,i.jsx)(t.td,{children:"This is the URL (without http/https) for the CW Control server. This value needs to match the value in the RMM+ Plugin configuration in CW Control."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"RMMPlus_StaleAgentThreshold"}),(0,i.jsx)(t.td,{children:"30"}),(0,i.jsx)(t.td,{children:"True"}),(0,i.jsx)(t.td,{children:'The number of days to indicate what a "stale" agent is to the scripts. 30 is the default.'})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"RMMPlus_Timeout"}),(0,i.jsx)(t.td,{children:"1000"}),(0,i.jsx)(t.td,{children:"True"}),(0,i.jsx)(t.td,{children:"The default timeout for commands run via RMM+ through Automate. 1000 is the default."})]})]})]}),"\n",(0,i.jsx)(t.h2,{id:"process",children:"Process"}),"\n",(0,i.jsx)(t.p,{children:"This script will populate several variables required for RMM+ to function properly. The script will then post the command using the HTTP GET/POST plugin to remove the agent from the CW Control portal. The script will log the results."}),"\n",(0,i.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Script log messages only"})})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},709406:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_1-32539e872fbab21824cc0fafdd237edd.png"},28453:(e,t,s)=>{s.d(t,{R:()=>o,x:()=>c});var n=s(296540);const i={},r=n.createContext(i);function o(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);