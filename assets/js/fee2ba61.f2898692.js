"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[54633],{148711:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"cwa/monitors/d9b666b4-e0b0-4736-94c1-06b430581bad","title":"Security - Possible Brute Force Attack","description":"This document outlines how to monitor for security event log event ID 4625, specifically checking for failed logon attempts where the occurrence count exceeds a specified threshold within the last 60 minutes. It includes details on modifying thresholds, alerting, and dependencies for effective monitoring.","source":"@site/docs/cwa/monitors/Security - Possible Brute Force Attack.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/d9b666b4-e0b0-4736-94c1-06b430581bad","permalink":"/docs/cwa/monitors/d9b666b4-e0b0-4736-94c1-06b430581bad","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Security - Possible Brute Force Attack.md","tags":[{"inline":false,"label":"Security","permalink":"/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"}],"version":"current","frontMatter":{"id":"d9b666b4-e0b0-4736-94c1-06b430581bad","title":"Security - Possible Brute Force Attack","title_meta":"Security - Possible Brute Force Attack","keywords":["security","event","logon","failed","monitor"],"description":"This document outlines how to monitor for security event log event ID 4625, specifically checking for failed logon attempts where the occurrence count exceeds a specified threshold within the last 60 minutes. It includes details on modifying thresholds, alerting, and dependencies for effective monitoring.","tags":["security"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Scripting Engine Hung","permalink":"/docs/cwa/monitors/9292f135-cca4-4eba-97ff-cd4276ab62e9"},"next":{"title":"Security - Potential MimiKatz Vulnerable System","permalink":"/docs/cwa/monitors/1f0cc77f-4d58-4486-a99a-0c276e40b117"}}');var s=r(474848),i=r(28453);const o={id:"d9b666b4-e0b0-4736-94c1-06b430581bad",title:"Security - Possible Brute Force Attack",title_meta:"Security - Possible Brute Force Attack",keywords:["security","event","logon","failed","monitor"],description:"This document outlines how to monitor for security event log event ID 4625, specifically checking for failed logon attempts where the occurrence count exceeds a specified threshold within the last 60 minutes. It includes details on modifying thresholds, alerting, and dependencies for effective monitoring.",tags:["security"],draft:!1,unlisted:!1},c=void 0,a={},d=[{value:"Summary",id:"summary",level:2},{value:"Details",id:"details",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Target",id:"target",level:2},{value:"Alerting",id:"alerting",level:2},{value:"Implementation",id:"implementation",level:2}];function l(e){const t={a:"a",br:"br",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsx)(t.p,{children:"Check the computer for security event log event ID 4625 where the count of occurrences is greater than 10 in the last 60 minutes."}),"\n",(0,s.jsxs)(t.p,{children:["The threshold can be modified by updating the value of the ",(0,s.jsx)(t.code,{children:"$th"})," variable in the remote monitor's command. Change this value from 10 to the desired value after importing the remote monitor."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"The monitor set may not perform as expected for PowerShell versions older than 5."})}),"\n",(0,s.jsx)(t.h2,{id:"details",children:"Details"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:'Suggested "Limit to"'}),": Server Role - AD - Infrastructure Master",(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.strong,{children:"Suggested Alert Style"}),": Continuous",(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.strong,{children:"Suggested Alert Template"}),": \u25b3 Custom - Ticket Creation Computer - Failures Only"]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Check Action"}),(0,s.jsx)(t.th,{children:"Server Address"}),(0,s.jsx)(t.th,{children:"Check Type"}),(0,s.jsx)(t.th,{children:"Execute Info"}),(0,s.jsx)(t.th,{children:"Comparator"}),(0,s.jsx)(t.th,{children:"Interval"}),(0,s.jsx)(t.th,{children:"Result"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"System"}),(0,s.jsx)(t.td,{children:"127.0.0.1"}),(0,s.jsx)(t.td,{children:"Run File"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"REDACTED"})}),(0,s.jsx)(t.td,{children:"State Based"}),(0,s.jsx)(t.td,{children:"3600"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"<Shown Below>"})})]})})]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Image",src:r(753450).A+"",width:"694",height:"96"})}),"\n",(0,s.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{href:"/docs/cwa/scripts/e14bf501-f10d-44d7-a19a-2284fd5c5cc9",children:"CWM - Automate - Script - Ticket Creation - Computer [Failures Only]"})}),"\n",(0,s.jsx)(t.h2,{id:"target",children:"Target"}),"\n",(0,s.jsxs)(t.p,{children:["Domain Controllers",(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.img,{alt:"Image",src:r(702433).A+"",width:"578",height:"277"}),(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.img,{alt:"Image",src:r(734168).A+"",width:"1000",height:"452"})]}),"\n",(0,s.jsx)(t.h2,{id:"alerting",children:"Alerting"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Subject:"})," ",(0,s.jsx)(t.code,{children:"Possible Brute Force Attack on %COMPUTERNAME%"})]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Alert Message on Success:"})," ",(0,s.jsx)(t.code,{children:"There are no potential brute force or logon failures detected in the last hour on %CLIENTNAME%//%COMPUTERNAME% at %LOCATIONNAME%"})]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Alert Message on Failure:"}),(0,s.jsx)(t.br,{}),"\n","A possible brute force attack has been detected on %CLIENTNAME%//%COMPUTERNAME% at %LOCATIONNAME%.",(0,s.jsx)(t.br,{}),"\n","Here is a breakdown of the logon attempts that failed over the past hour.",(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.code,{children:"%RESULT%"})]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Logon Type Reference Table:"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"2: Interactive\r\n3: Network\r\n4: Batch\r\n5: Service\r\n7: Unlock\r\n8: NetworkCleartext\r\n9: NewCredentials\r\n10: RemoteInteractive\r\n11: CachedInteractive\n"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Failure Reason Reference Table:"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"0XC000005E: There are currently no logon servers available to service the logon request.\r\n0xC0000064: User logon with misspelled or bad user account.\r\n0xC000006A: User logon with misspelled or bad password for critical accounts or service accounts.\r\n0XC000006D: This is either due to a bad username or authentication information for critical accounts or service accounts.\r\n0xC000006F: User logon outside authorized hours.\r\n0xC0000070: User logon from unauthorized workstation.\r\n0xC0000072: User logon to account disabled by administrator.\r\n0XC000015B: The user has not been granted the requested logon type (aka logon right) at this machine.\r\n0XC0000192: An attempt was made to logon, but the Netlogon service was not started.\r\n0xC0000193: User logon with expired account.\r\n0XC0000413: Logon Failure: The machine you are logging onto is protected by an authentication firewall. The specified account is not allowed to authenticate to the machine.\n"})}),"\n",(0,s.jsx)(t.p,{children:"Note: Compare FailureSubStatus (or FailureStatus if FailureSubStatus is not available) with the reference table mentioned above to identify the failure reason."}),"\n",(0,s.jsxs)(t.p,{children:["For more detailed information: ",(0,s.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4625",children:"Event 4625 Documentation"})]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Sample Ticket:"}),(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.img,{alt:"Image",src:r(9335).A+"",width:"966",height:"1000"})]}),"\n",(0,s.jsx)(t.h2,{id:"implementation",children:"Implementation"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{href:"/docs/cwa/monitors/5099131e-bdc7-470a-8bd1-011dfc54ef4e",children:"Import - Remote Monitor - Security - Possible Brute Force Attack"})})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},753450:(e,t,r)=>{r.d(t,{A:()=>n});const n="data:image/png;base64,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"},702433:(e,t,r)=>{r.d(t,{A:()=>n});const n=r.p+"assets/images/image_2-a59f0cb7a0ca82377b32a108a3bf9511.png"},734168:(e,t,r)=>{r.d(t,{A:()=>n});const n=r.p+"assets/images/image_3-8af7d24053fe4ab7c4684bae640e49e1.png"},9335:(e,t,r)=>{r.d(t,{A:()=>n});const n=r.p+"assets/images/image_4-3cac985e35cb80c5db21dc271bca4bdf.png"},28453:(e,t,r)=>{r.d(t,{R:()=>o,x:()=>c});var n=r(296540);const s={},i=n.createContext(s);function o(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);