"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[51447],{338712:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>i});const n=JSON.parse('{"id":"vsa/procedures/1b3d6a20-7e4d-4402-95f3-c2d54fa90b0e","title":"PowerShell Within A Scheduled Task","description":"This document outlines an agent procedure used to create a scheduled task that runs PowerShell commands at user logon. It provides a detailed example of the procedure log, dependencies, and the process involved in executing the task.","source":"@site/docs/vsa/procedures/PowerShell Within A Scheduled Task.md","sourceDirName":"vsa/procedures","slug":"/vsa/procedures/1b3d6a20-7e4d-4402-95f3-c2d54fa90b0e","permalink":"/proval-docs/docs/vsa/procedures/1b3d6a20-7e4d-4402-95f3-c2d54fa90b0e","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/vsa/procedures/PowerShell Within A Scheduled Task.md","tags":[{"inline":false,"label":"Performance","permalink":"/proval-docs/docs/tags/performance","description":"Documents related to enhancing system and application performance"},{"inline":false,"label":"Setup","permalink":"/proval-docs/docs/tags/setup","description":"Documents on setting up software and hardware configurations"},{"inline":false,"label":"Software","permalink":"/proval-docs/docs/tags/software","description":"Documents related to software applications and their lifecycle management"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"1b3d6a20-7e4d-4402-95f3-c2d54fa90b0e","title":"PowerShell Within A Scheduled Task","title_meta":"PowerShell Within A Scheduled Task","keywords":["scheduled","task","logon","powershell","automation"],"description":"This document outlines an agent procedure used to create a scheduled task that runs PowerShell commands at user logon. It provides a detailed example of the procedure log, dependencies, and the process involved in executing the task.","tags":["performance","setup","software","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"PUA Remove","permalink":"/proval-docs/docs/vsa/procedures/7532eff4-e724-471e-96fc-ddfd944bf710"},"next":{"title":"Purge IIS Logs Older than 3 Days","permalink":"/proval-docs/docs/vsa/procedures/43cfcc23-05a8-4411-a901-65a819894164"}}');var d=s(474848),r=s(28453);const a={id:"1b3d6a20-7e4d-4402-95f3-c2d54fa90b0e",title:"PowerShell Within A Scheduled Task",title_meta:"PowerShell Within A Scheduled Task",keywords:["scheduled","task","logon","powershell","automation"],description:"This document outlines an agent procedure used to create a scheduled task that runs PowerShell commands at user logon. It provides a detailed example of the procedure log, dependencies, and the process involved in executing the task.",tags:["performance","setup","software","windows"],draft:!1,unlisted:!1},o=void 0,l={},i=[{value:"Summary",id:"summary",level:2},{value:"Example Agent Procedure Log",id:"example-agent-procedure-log",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2}];function c(e){const t={h2:"h2",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,d.jsx)(t.p,{children:"This agent procedure is used to create a scheduled task at logon and have it run PowerShell parameters as defined with the variables."}),"\n",(0,d.jsx)(t.h2,{id:"example-agent-procedure-log",children:"Example Agent Procedure Log"}),"\n",(0,d.jsxs)(t.table,{children:[(0,d.jsx)(t.thead,{children:(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.th,{children:"Time"}),(0,d.jsx)(t.th,{children:"Procedure"}),(0,d.jsx)(t.th,{children:"Description"}),(0,d.jsx)(t.th,{children:"Admin"})]})}),(0,d.jsxs)(t.tbody,{children:[(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:56:10 am 27-Jan-23"}),(0,d.jsx)(t.td,{children:"Download Folder Empty"}),(0,d.jsx)(t.td,{children:"Success THEN"}),(0,d.jsx)(t.td,{children:"provaltech.com/derek.joniak"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:56:10 am 27-Jan-23"}),(0,d.jsx)(t.td,{children:"Download Folder Empty"}),(0,d.jsx)(t.td,{children:"Comment at THEN step 4"}),(0,d.jsx)(t.td,{children:"provaltech.com/derek.joniak"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:56:10 am 27-Jan-23"}),(0,d.jsx)(t.td,{children:"Execute PowerShell Command"}),(0,d.jsx)(t.td,{children:"Success THEN"}),(0,d.jsx)(t.td,{children:"provaltech.com/derek.joniak"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:56:08 am 27-Jan-23"}),(0,d.jsx)(t.td,{children:"Execute PowerShell Command-0011"}),(0,d.jsx)(t.td,{children:"PowerShell command completed!"}),(0,d.jsx)(t.td,{children:"provaltech.com/derek.joniak"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:55:49 am 27-Jan-23"}),(0,d.jsx)(t.td,{children:"Execute PowerShell Command-0011"}),(0,d.jsxs)(t.td,{children:["Executing PowerShell `\"\" -Command \"\"$taskName = 'EmptyDownloadFolder';if((Get-ScheduledTask -TaskName $taskName -ErrorAction SilentlyContinue) -eq $null)\\{$action = New-ScheduledTaskAction -Execute 'powershell.exe' -Argument '-Command \"Get-ChildItem $env",":USERPROFILE","/Downloads"]}),(0,d.jsx)(t.td,{children:'Remove-Item -Recurse"\';$trigger = New-ScheduledTaskTrigger -AtLogon;$settings = New-ScheduledTaskSettingsSet -AllowStartIfOnBatteries -DontStopIfGoingOnBatteries -StartWhenAvailable -Hidden -RestartInterval (New-TimeSpan -Minutes 1) -RestartCount 3 -ExecutionTimeLimit (New-TimeSpan -Hours 1);Register-ScheduledTask -TaskName $taskName -Action $action -Trigger $trigger -Settings $settings;Write-Output "Scheduled task \'$taskName\' created successfully"}else\\{Write-Output "Task Already Exists or Failed To Create Task"}""`'})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:55:49 am 27-Jan-23"}),(0,d.jsx)(t.td,{children:"Execute PowerShell Command-0010"}),(0,d.jsx)(t.td,{children:"Not sending output to variable."}),(0,d.jsx)(t.td,{children:"provaltech.com/derek.joniak"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:55:49 am 27-Jan-23"}),(0,d.jsx)(t.td,{children:"Execute PowerShell Command-0008"}),(0,d.jsxs)(t.td,{children:["New command variable is: `-Command \"\"$taskName = 'EmptyDownloadFolder';if((Get-ScheduledTask -TaskName $taskName -ErrorAction SilentlyContinue) -eq $null)\\{$action = New-ScheduledTaskAction -Execute 'powershell.exe' -Argument '-Command \"Get-ChildItem $env",":USERPROFILE","/Downloads"]}),(0,d.jsx)(t.td,{children:'Remove-Item -Recurse"\';$trigger = New-ScheduledTaskTrigger -AtLogon;$settings = New-ScheduledTaskSettingsSet -AllowStartIfOnBatteries -DontStopIfGoingOnBatteries -StartWhenAvailable -Hidden -RestartInterval (New-TimeSpan -Minutes 1) -RestartCount 3 -ExecutionTimeLimit (New-TimeSpan -Hours 1);Register-ScheduledTask -TaskName $taskName -Action $action -Trigger $trigger -Settings $settings;Write-Output "Scheduled task \'$taskName\' created successfully"}else\\{Write-Output "Task Already Exists or Failed To Create Task"}""`'})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:55:49 am 27-Jan-23"}),(0,d.jsx)(t.td,{children:"Execute PowerShell Command-0008"}),(0,d.jsxs)(t.td,{children:["Custom commands detected as `\"$taskName = 'EmptyDownloadFolder';if((Get-ScheduledTask -TaskName $taskName -ErrorAction SilentlyContinue) -eq $null)\\{$action = New-ScheduledTaskAction -Execute 'powershell.exe' -Argument '-Command \"Get-ChildItem $env",":USERPROFILE","/Downloads"]}),(0,d.jsx)(t.td,{children:'Remove-Item -Recurse"\';$trigger = New-ScheduledTaskTrigger -AtLogon;$settings = New-ScheduledTaskSettingsSet -AllowStartIfOnBatteries -DontStopIfGoingOnBatteries -StartWhenAvailable -Hidden -RestartInterval (New-TimeSpan -Minutes 1) -RestartCount 3 -ExecutionTimeLimit (New-TimeSpan -Hours 1);Register-ScheduledTask -TaskName $taskName -Action $action -Trigger $trigger -Settings $settings;Write-Output "Scheduled task \'$taskName\' created successfully"}else\\{Write-Output "Task Already Exists or Failed To Create Task"}"`'})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:55:40 am 27-Jan-23"}),(0,d.jsx)(t.td,{children:"Execute PowerShell Command-0002"}),(0,d.jsx)(t.td,{children:"PowerShell is present."}),(0,d.jsx)(t.td,{children:"provaltech.com/derek.joniak"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:55:25 am 27-Jan-23"}),(0,d.jsx)(t.td,{children:"Run Now - Download Folder Empty"}),(0,d.jsx)(t.td,{children:"Admin provaltech.com/derek.joniak scheduled procedure Run Now - Download Folder Empty to run at Jan 27 2023 10:55 AM"}),(0,d.jsx)(t.td,{children:"provaltech.com/derek.joniak"})]})]})]}),"\n",(0,d.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,d.jsx)(t.p,{children:"Does this procedure depend on other VSA content? Link the ITGlue article for the content documentation."}),"\n",(0,d.jsx)(t.h2,{id:"process",children:"Process"}),"\n",(0,d.jsx)(t.p,{children:"Describe how the agent procedure completes its objective."}),"\n",(0,d.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,d.jsx)(t.p,{children:"Procedure log files and other outputs."})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,d.jsx)(t,{...e,children:(0,d.jsx)(c,{...e})}):c(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>o});var n=s(296540);const d={},r=n.createContext(d);function a(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:a(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);