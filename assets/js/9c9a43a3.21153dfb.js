"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[89814],{841632:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>n,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"cwa/monitors/3411cd85-0769-4241-93b3-8df35af3d9f6","title":"Azure VPN Configuration","description":"This document outlines a monitor that checks for the presence of the .pbk file for Azure VPN configuration on target machines. It verifies the existence of the Compassus Azure VPN header within the file and returns error messages if the file or header is missing. Ideal for Compassus workstations group.","source":"@site/docs/cwa/monitors/Azure VPN Configuration.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/3411cd85-0769-4241-93b3-8df35af3d9f6","permalink":"/proval-docs/docs/cwa/monitors/3411cd85-0769-4241-93b3-8df35af3d9f6","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Azure VPN Configuration.md","tags":[{"inline":false,"label":"Software","permalink":"/proval-docs/docs/tags/software","description":"Documents related to software applications and their lifecycle management"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"3411cd85-0769-4241-93b3-8df35af3d9f6","title":"Azure VPN Configuration","title_meta":"Azure VPN Configuration","keywords":["azure","vpn","configuration","monitor","compassus"],"description":"This document outlines a monitor that checks for the presence of the .pbk file for Azure VPN configuration on target machines. It verifies the existence of the Compassus Azure VPN header within the file and returns error messages if the file or header is missing. Ideal for Compassus workstations group.","tags":["software","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Automatically Restrict Vendor Machines in SC","permalink":"/proval-docs/docs/cwa/monitors/4a4b5a11-8087-4e0a-b2b1-629d07326dd2"},"next":{"title":"Backup Exec - No successful backups in 3 days","permalink":"/proval-docs/docs/cwa/monitors/abddfc3a-9f1b-4356-a62c-3475cdb32c96"}}');var o=s(474848),r=s(28453);const n={id:"3411cd85-0769-4241-93b3-8df35af3d9f6",title:"Azure VPN Configuration",title_meta:"Azure VPN Configuration",keywords:["azure","vpn","configuration","monitor","compassus"],description:"This document outlines a monitor that checks for the presence of the .pbk file for Azure VPN configuration on target machines. It verifies the existence of the Compassus Azure VPN header within the file and returns error messages if the file or header is missing. Ideal for Compassus workstations group.",tags:["software","windows"],draft:!1,unlisted:!1},a=void 0,c={},d=[{value:"Summary",id:"summary",level:2},{value:"Details",id:"details",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Target",id:"target",level:2}];function l(e){const t={a:"a",h2:"h2",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,o.jsx)(t.p,{children:"This monitor checks for the presence of the .pbk file for the Azure VPN configuration on the target machine. If that file exists, it checks for the presence of the [Compassus Azure VPN] header in that file. If the file is missing or the header is missing, the monitor returns ERROR: [description]."}),"\n",(0,o.jsx)(t.h2,{id:"details",children:"Details"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.strong,{children:"Should be applied to the Compassus workstations group that should have the VPN configuration file."})}),"\n",(0,o.jsxs)(t.table,{children:[(0,o.jsx)(t.thead,{children:(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.th,{children:"Check Action"}),(0,o.jsx)(t.th,{children:"Server Address"}),(0,o.jsx)(t.th,{children:"Check Type"}),(0,o.jsx)(t.th,{children:"Check Value"}),(0,o.jsx)(t.th,{children:"Comparator"}),(0,o.jsx)(t.th,{children:"Interval"}),(0,o.jsx)(t.th,{children:"Result"})]})}),(0,o.jsx)(t.tbody,{children:(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"System"}),(0,o.jsx)(t.td,{children:"Default"}),(0,o.jsx)(t.td,{children:"Run File"}),(0,o.jsx)(t.td,{children:"C:/Windows/system32/cmd.exe /c powershell.exe -ExecutionPolicy Bypass -Command \"$Users = ((Get-ChildItem 'HKLM:/Software/Microsoft/Windows NT/CurrentVersion/ProfileList'"}),(0,o.jsx)(t.td,{children:"Where-Object {$_.GetValue('ProfileImagePath') -notlike 'C:/Windows*'}"}),(0,o.jsx)(t.td,{children:"ForEach-Object { $_.GetValue('ProfileImagePath') })).replace('C:/Users/',''); $users"}),(0,o.jsx)(t.td,{children:'foreach {; Try {; $path = Get-item -Path """C:/Users/$_/AppData/Local/Packages/Microsoft.AzureVpn_8wekyb3d8bbwe/LocalState/rasphone.pbk""" -ErrorAction stop; if ((Get-Content $path) -Contains \'[Compassus Azure VPN]\') {; Return; } else {; Return \'ERROR: Missing VPN Configuration\'; }; } catch {; Return \'ERROR: Missing file\'; }; }"'})]})})]}),"\n",(0,o.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,o.jsxs)(t.p,{children:["If using this Remote monitor, we should have an autofix action set up to run the ",(0,o.jsx)(t.a,{href:"/proval-docs/docs/cwa/scripts/7d8df295-577a-4c61-934b-341fcbb37784",children:"EPM - Windows Configuration - Script - Add-AzureVPNConnection [Paranet(Compassus)]"})," script."]}),"\n",(0,o.jsx)(t.h2,{id:"target",children:"Target"}),"\n",(0,o.jsx)(t.p,{children:"The targeted group will be explicitly chosen by the client but should be limited to Compassus."})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>n,x:()=>a});var i=s(296540);const o={},r=i.createContext(o);function n(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:n(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);