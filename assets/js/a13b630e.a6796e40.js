"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[73530],{451438:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"cwa/monitors/c9183b6d-95a8-409a-9d04-e85611bf04d2","title":"ProVal - NonStack - Multiple Antivirus","description":"This document outlines the setup for an alert that triggers when two or more antivirus products are detected on a Windows machine. It provides details on the necessary checks, requirements, and potential issues that may arise when multiple antivirus applications are installed.","source":"@site/docs/cwa/monitors/ProVal - NonStack - Multiple Antivirus.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/c9183b6d-95a8-409a-9d04-e85611bf04d2","permalink":"/proval-docs/docs/cwa/monitors/c9183b6d-95a8-409a-9d04-e85611bf04d2","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/ProVal - NonStack - Multiple Antivirus.md","tags":[{"inline":false,"label":"Security","permalink":"/proval-docs/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"c9183b6d-95a8-409a-9d04-e85611bf04d2","title":"ProVal - NonStack - Multiple Antivirus","title_meta":"ProVal - NonStack - Multiple Antivirus","keywords":["alert","antivirus","monitor","detection","windows"],"description":"This document outlines the setup for an alert that triggers when two or more antivirus products are detected on a Windows machine. It provides details on the necessary checks, requirements, and potential issues that may arise when multiple antivirus applications are installed.","tags":["security","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"ProVal - Dev - Uninstall VLC Player","permalink":"/proval-docs/docs/cwa/monitors/5e887154-c307-4ac7-9b75-0a85c516dbad"},"next":{"title":"ProVal - Production - CPU Threshold Violation Monitor","permalink":"/proval-docs/docs/cwa/monitors/662b2faa-c7f5-4c96-bbbe-f1878ddb8aa3"}}');var s=i(474848),r=i(28453);const o={id:"c9183b6d-95a8-409a-9d04-e85611bf04d2",title:"ProVal - NonStack - Multiple Antivirus",title_meta:"ProVal - NonStack - Multiple Antivirus",keywords:["alert","antivirus","monitor","detection","windows"],description:"This document outlines the setup for an alert that triggers when two or more antivirus products are detected on a Windows machine. It provides details on the necessary checks, requirements, and potential issues that may arise when multiple antivirus applications are installed.",tags:["security","windows"],draft:!1,unlisted:!1},a=void 0,l={},d=[{value:"Summary",id:"summary",level:2},{value:"Details",id:"details",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Notes",id:"notes",level:2},{value:"Target",id:"target",level:2},{value:"FAQ",id:"faq",level:2}];function c(e){const t={br:"br",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsx)(t.p,{children:"Alerts if there are 2 or more antiviruses present in the AntivirusProduct class."}),"\n",(0,s.jsx)(t.h2,{id:"details",children:"Details"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:'Suggested "Limit to"'}),": Any",(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.strong,{children:"Suggested Alert Style"}),": Once",(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.strong,{children:"Suggested Alert Template"}),": To be determined by partner"]}),"\n",(0,s.jsx)(t.p,{children:"Insert the details of the monitor in the table below."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Check Action"}),(0,s.jsx)(t.th,{children:"Server Address"}),(0,s.jsx)(t.th,{children:"Check Type"}),(0,s.jsx)(t.th,{children:"Check Value"}),(0,s.jsx)(t.th,{children:"Comparator"}),(0,s.jsx)(t.th,{children:"Interval"}),(0,s.jsx)(t.th,{children:"Result"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"System"}),(0,s.jsx)(t.td,{children:"Default"}),(0,s.jsx)(t.td,{children:"Run File `C:/Windows/System32/WindowsPowerShell/v1.0/powershell.exe -ExecutionPolicy Bypass -Command \"if ((Get-CimInstance -Namespace 'root/SecurityCenter2' -Class AntiVirusProduct).count -gt 1) { return (Get-CimInstance -erroraction silentlycontinue -Namespace 'root/SecurityCenter2' -Class AntiVirusProduct"}),(0,s.jsx)(t.td,{children:"Select-Object -Property DisplayName -Unique"}),(0,s.jsx)(t.td,{children:"Where-Object -Property DisplayName -ne 'Windows Defender' ).count } else { return }\"`"}),(0,s.jsx)(t.td,{children:"Less Than"}),(0,s.jsx)(t.td,{children:"2"})]})})]}),"\n",(0,s.jsx)(t.h2,{id:"requirements",children:"Requirements"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"The target machine needs to have had an antivirus installed in the past; if it has not, the monitor will not trigger; however, the results will be inaccurate. The AntivirusProduct class does not exist until an antivirus is installed and activated."}),"\n",(0,s.jsx)(t.li,{children:"The target machine's antivirus must be active to populate into the AntivirusProduct class."}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"notes",children:"Notes"}),"\n",(0,s.jsx)(t.p,{children:"This monitor will be effective in determining many cases where multiple antiviruses are installed; however, it is not foolproof, as many antivirus applications do not report themselves to the AntivirusProduct class until they are completely active. A good example of this is ESET antivirus."}),"\n",(0,s.jsx)(t.p,{children:"Windows Defender will report itself to the AntivirusProduct class if it is installed (even if inactive); you may need to lower the remote monitor threshold to less than 3."}),"\n",(0,s.jsx)(t.h2,{id:"target",children:"Target"}),"\n",(0,s.jsx)(t.p,{children:"The intended target of this monitor is Windows-based machines that have had at least one antivirus installed in the past."}),"\n",(0,s.jsx)(t.h2,{id:"faq",children:"FAQ"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Q."})," This is reporting multiple antivirus products, but I don't see any in the software list.",(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.strong,{children:"A."})," The nature of this script is to report on how many antivirus products are currently registered in the 'root/SecurityCenter2' namespace as an AntiVirusProduct. There are two reasons why this can occur:"]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"The antivirus in question used to exist on the machine; however, the uninstallation of the product did not complete properly, and the product is still registered."}),"\n",(0,s.jsx)(t.li,{children:"The antivirus software in question is indeed installed; however, the uninstallation registry key for WindowsComponent is set to 1, which is hiding the software from the add/remove programs list as well as the automated software list."}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Q."})," Is there any way to see what this monitor specifically found?",(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.strong,{children:"A."})," Running the following PowerShell command will display the name of every found item."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"return (Get-CimInstance -erroraction silentlycontinue -Namespace 'root/SecurityCenter2' -Class AntiVirusProduct | Select-Object -Property DisplayName -Unique | Where-Object -Property DisplayName -ne 'Windows Defender')\n"})})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>a});var n=i(296540);const s={},r=n.createContext(s);function o(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);