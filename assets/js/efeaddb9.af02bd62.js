"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[58387],{630085:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>a,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"cwa/scripts/cd4cedee-cd92-4198-83d6-e7c596a6a01b","title":"Bitlocker Recovery Password - AD Backup","description":"This document provides a detailed guide on executing a script to back up BitLocker recovery keys to Active Directory. It covers requirements, dependencies, sample runs, and a step-by-step GPO creation process to ensure proper configuration for successful backups.","source":"@site/docs/cwa/scripts/Bitlocker Recovery Password - AD Backup.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/cd4cedee-cd92-4198-83d6-e7c596a6a01b","permalink":"/proval-docs/docs/cwa/scripts/cd4cedee-cd92-4198-83d6-e7c596a6a01b","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Bitlocker Recovery Password - AD Backup.md","tags":[{"inline":false,"label":"Active Directory","permalink":"/proval-docs/docs/tags/active-directory","description":"Documents related to Active Directory services and management"},{"inline":false,"label":"Backup","permalink":"/proval-docs/docs/tags/backup","description":"Documents detailing backup solutions and data protection strategies"},{"inline":false,"label":"Encryption","permalink":"/proval-docs/docs/tags/encryption","description":"Documents discussing encryption technologies for data protection"},{"inline":false,"label":"GPO","permalink":"/proval-docs/docs/tags/gpo","description":"Documents covering Group Policy Objects management and deployment"}],"version":"current","frontMatter":{"id":"cd4cedee-cd92-4198-83d6-e7c596a6a01b","title":"Bitlocker Recovery Password - AD Backup","title_meta":"Bitlocker Recovery Password - AD Backup","keywords":["bitlocker","active","directory","backup","encryption"],"description":"This document provides a detailed guide on executing a script to back up BitLocker recovery keys to Active Directory. It covers requirements, dependencies, sample runs, and a step-by-step GPO creation process to ensure proper configuration for successful backups.","tags":["active-directory","backup","encryption","gpo"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Bitlocker - Volume - Initialize","permalink":"/proval-docs/docs/cwa/scripts/759a5a88-17ef-42e0-9145-4760aff7a3c9"},"next":{"title":"BlackPoint - SnapAgent Installer","permalink":"/proval-docs/docs/cwa/scripts/202e2dde-5865-4035-8410-37dc6cb92a60"}}');var s=t(474848),c=t(28453);const r={id:"cd4cedee-cd92-4198-83d6-e7c596a6a01b",title:"Bitlocker Recovery Password - AD Backup",title_meta:"Bitlocker Recovery Password - AD Backup",keywords:["bitlocker","active","directory","backup","encryption"],description:"This document provides a detailed guide on executing a script to back up BitLocker recovery keys to Active Directory. It covers requirements, dependencies, sample runs, and a step-by-step GPO creation process to ensure proper configuration for successful backups.",tags:["active-directory","backup","encryption","gpo"],draft:!1,unlisted:!1},o=void 0,a={},d=[{value:"Summary",id:"summary",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Dependencies",id:"dependencies",level:3},{value:"Sample Run",id:"sample-run",level:2},{value:"Output",id:"output",level:3},{value:"FAQ",id:"faq",level:2},{value:"GPO Creation Process",id:"gpo-creation-process",level:2},{value:"Configuration",id:"configuration",level:3}];function l(e){const i={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsxs)(i.p,{children:["This Automate script executes the ",(0,s.jsx)(i.code,{children:"Backup-BitlockerRecoveryPW.ps1"})," agnostic script."]}),"\n",(0,s.jsx)(i.h2,{id:"requirements",children:"Requirements"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"PowerShell v5"}),"\n",(0,s.jsx)(i.li,{children:"The target must be domain-joined"}),"\n",(0,s.jsx)(i.li,{children:"Group policy must be properly configured on the domain controller to allow backups of BitLocker keys into Active Directory"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"dependencies",children:"Dependencies"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"/proval-docs/docs/powershell/ps-backup-bitlockerrecoverypw",children:"SEC - Encryption - Agnostic - Backup-BitlockerRecoveryPW"})}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"Sample Run",src:t(294545).A+"",width:"484",height:"352"})}),"\n",(0,s.jsx)(i.h3,{id:"output",children:"Output"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Script log"}),"\n",(0,s.jsx)(i.li,{children:"Dataview"}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"faq",children:"FAQ"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsxs)(i.li,{children:['The script is failing with "Unable to find type [Microsoft.BitLocker.Structures.BitLockerVolume]."',"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Group policy must be properly configured to allow backups of BitLocker keys to Active Directory. Follow the process below:"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"gpo-creation-process",children:"GPO Creation Process"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:["Click the Search icon in the taskbar and type \u201c",(0,s.jsx)(i.strong,{children:"Group Policy"}),"\u201c. You can then click ",(0,s.jsx)(i.strong,{children:"Group Policy Management"})," to launch it.\r\n",(0,s.jsx)(i.img,{alt:"Step 1",src:t(686234).A+"",width:"712",height:"873"})]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:["In the left pane of Group Policy Management, right-click your AD domain and select \u201c",(0,s.jsx)(i.strong,{children:"Create a GPO in this domain, and Link it here\u2026"}),"\u201d from the menu.\r\n",(0,s.jsx)(i.img,{alt:"Step 2",src:t(391459).A+"",width:"1000",height:"851"})]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:["In the New GPO dialog, give the GPO a name and click ",(0,s.jsx)(i.strong,{children:"OK"}),".\r\n",(0,s.jsx)(i.img,{alt:"Step 3",src:t(461292).A+"",width:"964",height:"447"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsxs)(i.ol,{start:"4",children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:["Right-click the newly created GPO in the left pane and select ",(0,s.jsx)(i.strong,{children:"Edit"}),".\r\n",(0,s.jsx)(i.img,{alt:"Step 4",src:t(544181).A+"",width:"1000",height:"726"})]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:["Browse to ",(0,s.jsx)(i.code,{children:"Computer Configuration -> Policies -> Administrative Templates -> Windows Components -> BitLocker Drive Encryption"}),", and then double-click the policy \u201c",(0,s.jsx)(i.strong,{children:"Store BitLocker recovery information in Active Directory Domain Services"}),"\u201c.\r\n",(0,s.jsx)(i.img,{alt:"Step 5",src:t(458430).A+"",width:"1000",height:"612"})]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:["Set the policy to ",(0,s.jsx)(i.strong,{children:"Enabled"}),". Ensure the \u201c",(0,s.jsx)(i.strong,{children:"Require BitLocker backup to AD DS"}),"\u201d option is checked, and select to store both recovery passwords and key packages.\r\n",(0,s.jsx)(i.img,{alt:"Step 6",src:t(846119).A+"",width:"1000",height:"914"})]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:["Next, expand ",(0,s.jsx)(i.strong,{children:"BitLocker Drive Encryption"})," in the left pane. You\u2019ll see three nodes: Fixed Data Drives, Operating System Drives, and Removable Data Drives. Select ",(0,s.jsx)(i.strong,{children:"Fixed Data Drives"})," and double-click the policy \u201c",(0,s.jsx)(i.strong,{children:"Choose how BitLocker-protected fixed drives can be recovered"}),"\u201c.\r\n",(0,s.jsx)(i.img,{alt:"Step 7",src:t(702496).A+"",width:"1000",height:"620"})]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:["Set it to ",(0,s.jsx)(i.strong,{children:"Enabled"}),". Check the options \u201cSave BitLocker recovery information to AD DS for fixed drives\u201d and then click ",(0,s.jsx)(i.strong,{children:"OK"}),".\r\n",(0,s.jsx)(i.img,{alt:"Step 8",src:t(157321).A+"",width:"1000",height:"984"})]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:["Go to the \u201cOperating System Drives\u201d node and enable the similar policy \u201c",(0,s.jsx)(i.strong,{children:"Choose how BitLocker-protected operating system drives can be recovered"}),"\u201c. Afterwards, go to the \u201cRemovable Data Drives\u201d node and enable the policy \u201c",(0,s.jsx)(i.strong,{children:"Choose how BitLocker-protected removable drives can be recovered"}),"\u201c."]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:"When any client PC retrieves the policy changes, BitLocker recovery information will be automatically and silently backed up to AD DS when BitLocker is turned on for fixed drives, OS drives, or removable drives."}),"\n"]}),"\n"]})]})}function p(e={}){const{wrapper:i}={...(0,c.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},294545:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/image_1-3d0893c9f4bbf38282588bfb74ffa11f.png"},686234:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/image_2-688a6f510aeeb14ebdfa4bde074c07d7.png"},391459:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/image_3-7fb6c5c05381c8d333d090e15a61c808.png"},461292:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/image_4-8ad97cbbd8ac020d5e3c48a17d4c7a48.png"},544181:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/image_5-8e650c20ae2a6b0068f36c7c3a494110.png"},458430:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/image_6-8edf7eee59b9e9e67aa7d7892fb5c56e.png"},846119:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/image_7-0fc83fd2336390b21a03fb5c264d81b0.png"},702496:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/image_8-a842c15ccb7faad38469d8055dd8d742.png"},157321:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/image_9-32e4a4b83a5ee6e116cab723b3a00cb9.png"},28453:(e,i,t)=>{t.d(i,{R:()=>r,x:()=>o});var n=t(296540);const s={},c=n.createContext(s);function r(e){const i=n.useContext(c);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(c.Provider,{value:i},e.children)}}}]);