"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[3852],{584623:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"powershell/21bc13d3-b2fb-42d5-8f38-da9b43990e06","title":"Get-VolumeExhaustionEstimate","description":"Documentation for the Get-VolumeExhaustionEstimate command to estimate disk space exhaustion for volumes based on linear regression.","source":"@site/docs/powershell/Get-VolumeExhaustionEstimate.md","sourceDirName":"powershell","slug":"/powershell/21bc13d3-b2fb-42d5-8f38-da9b43990e06","permalink":"/docs/powershell/21bc13d3-b2fb-42d5-8f38-da9b43990e06","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/powershell/Get-VolumeExhaustionEstimate.md","tags":[{"inline":false,"label":"Disk Encryption","permalink":"/docs/tags/disk-encryption","description":"Documents on encrypting disk drives and data protection methods"},{"inline":false,"label":"Performance","permalink":"/docs/tags/performance","description":"Documents related to enhancing system and application performance"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"21bc13d3-b2fb-42d5-8f38-da9b43990e06","title":"Get-VolumeExhaustionEstimate","title_meta":"Get-VolumeExhaustionEstimate","keywords":["volume","exhaustion","estimate","disk"],"description":"Documentation for the Get-VolumeExhaustionEstimate command to estimate disk space exhaustion for volumes based on linear regression.","tags":["disk-encryption","performance","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Get-VSAAuditReports","permalink":"/docs/powershell/f5181d46-745b-44a0-a154-0f83648e6a50"},"next":{"title":"Get-VolumeThresholds","permalink":"/docs/powershell/e36d9583-23da-4dfa-96c8-3467e36e30cf"}}');var i=s(474848),r=s(28453);const d={id:"21bc13d3-b2fb-42d5-8f38-da9b43990e06",title:"Get-VolumeExhaustionEstimate",title_meta:"Get-VolumeExhaustionEstimate",keywords:["volume","exhaustion","estimate","disk"],description:"Documentation for the Get-VolumeExhaustionEstimate command to estimate disk space exhaustion for volumes based on linear regression.",tags:["disk-encryption","performance","windows"],draft:!1,unlisted:!1},l=void 0,a={},o=[{value:"Description",id:"description",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Usage",id:"usage",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Output",id:"output",level:2}];function c(e){const t={a:"a",code:"code",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"description",children:"Description"}),"\n",(0,i.jsx)(t.p,{children:"This command takes a sample of the current volume space for each target volume and generates a list of space exhaustion estimations based on linear regression."}),"\n",(0,i.jsx)(t.h2,{id:"requirements",children:"Requirements"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"PowerShell v5"}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Note:"})," This process requires a data gathering period of no shorter than 15 hours due to the default requirement of 30 samples to start making estimations. This time can be shortened by changing the ",(0,i.jsx)(t.code,{children:"MinimumSamples"})," parameter to a smaller value. However, fewer samples will result in less accurate initial results."]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"The command retrieves the target volumes based on the provided parameters."}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["It creates the ",(0,i.jsx)(t.code,{children:"$Path"})," if it does not exist."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"The command then begins looping through the target volumes:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["If the drive letter of the volume equals ",(0,i.jsx)(t.code,{children:"0"}),", it is skipped, as this could be the Recovery volume."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"The current UNIX timestamp in UTC is obtained."}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"If the volume does not have a drive letter, an attempt is made to gather a GUID from the DeviceID instead."}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"If a GUID cannot be found, the volume is skipped."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["If the last write time of the report file for the volume is 30 minutes or greater, a new entry is added to the report ",(0,i.jsx)(t.code,{children:"$Path\\\\$driveLetter.csv"}),"."]}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"DriveLetter"}),(0,i.jsx)(t.th,{children:"SizeRemaining"}),(0,i.jsx)(t.th,{children:"Epoch"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"C"}),(0,i.jsx)(t.td,{children:"2483572834"}),(0,i.jsx)(t.td,{children:"1648488169"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"C"}),(0,i.jsx)(t.td,{children:"..."}),(0,i.jsx)(t.td,{children:"..."})]})]})]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Excessive entries in the report may skew results; thus, a hard limit of 30 minutes is enforced."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["Data points are gathered from the report based on the ",(0,i.jsx)(t.code,{children:"$DaysToReport"})," parameter."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["If the number of data points gathered is less than ",(0,i.jsx)(t.code,{children:"$MinimumSamples"}),", the volume is skipped until the requested number of samples has been gathered."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"The means of the UNIX timestamps and remaining volume space from the data points are calculated."}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Least_squares",children:"Least Squares Method"})," is used to approximate the slope (",(0,i.jsx)(t.em,{children:"m"}),") of the Line of Best Fit for the data points."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.a,{href:"https://latex.codecogs.com/png.image?%5CLARGE&space;%5Cdpi%7B110%7D%5Cbg%7Bwhite%7Dm=%5Cfrac%7B%5Csum_%7Bi=1%7D%5E%7Bn%7D(x_%7Bi%7D&space;-&space;%5Coverline%7BX%7D)(y_%7Bi%7D&space;-&space;%5Coverline%7BY%7D)%7D%7B%5Csum_%7Bi=1%7D%5E%7Bn%7D(x_%7Bi%7D&space;-&space;%5Coverline%7BX%7D)%5E%7B2%7D%7D",children:"Equation"})}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["The y-intercept (",(0,i.jsx)(t.em,{children:"c"}),") is calculated using the following equation:"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.a,{href:"https://latex.codecogs.com/png.image?%5CLARGE&space;%5Cdpi%7B110%7D%5Cbg%7Bwhite%7Dc&space;=&space;%5Coverline%7BY%7D&space;-&space;m%5Coverline%7BX%7D",children:"Equation"})}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"If the slope is greater than or equal to 0, the current trend of volume space is constant or upward, and the volume is skipped."}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"The epoch time of volume space exhaustion (when the remaining space on the volume equals 0) is calculated using the following equation:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.a,{href:"https://latex.codecogs.com/png.image?%5CLARGE&space;%5Cdpi%7B110%7D%5Cbg%7Bwhite%7D%5C%5Cy=mx+c%5C%5C*0=mx+c%5C%5C$-$c=mx%5C%5Cx=%5Cfrac%7B%5Ctext%7B-%7Dc%7D%7Bm%7D",children:"Equation"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"If the date of exhaustion is over three years, the volume will be skipped."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["With this value calculated, we can determine the amount of space that will be left ",(0,i.jsx)(t.code,{children:"$DaysToLead"})," days before exhaustion."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["A ",(0,i.jsx)(t.code,{children:"PSObject"})," with the following properties is generated and added to the return array:"]}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Name"}),(0,i.jsx)(t.th,{children:"MemberType"}),(0,i.jsx)(t.th,{children:"Definition"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"DriveLetter"}),(0,i.jsx)(t.td,{children:"NoteProperty"}),(0,i.jsx)(t.td,{children:"char"}),(0,i.jsx)(t.td,{children:"The drive letter of the volume"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"EstimatedLeadSpace"}),(0,i.jsx)(t.td,{children:"NoteProperty"}),(0,i.jsx)(t.td,{children:"double"}),(0,i.jsxs)(t.td,{children:["The amount of space estimated to be remaining after ",(0,i.jsx)(t.code,{children:"$DaysToLead"})," days."]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"ExhaustionEstimation"}),(0,i.jsx)(t.td,{children:"NoteProperty"}),(0,i.jsx)(t.td,{children:"System.TimeSpan"}),(0,i.jsx)(t.td,{children:"The amount of estimated time remaining before volume exhaustion."})]})]})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"PSObject"})," array is then returned."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Returns estimations with the default parameters."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:".\\Get-VolumeExhaustionEstimate.ps1\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Returns estimations with the reports directed to the ",(0,i.jsx)(t.code,{children:"C:\\temp"})," path."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:".\\Get-VolumeExhaustionEstimate.ps1 -Path 'C:\\temp'\n"})}),"\n",(0,i.jsx)(t.p,{children:"Returns estimations after 60 samples have been taken."}),"\n",(0,i.jsx)(t.p,{children:"The script will use samples that are up to 30 days old to make the estimations."}),"\n",(0,i.jsx)(t.p,{children:"The return object will include the estimated space 40 days before exhaustion."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:".\\Get-VolumeExhaustionEstimate.ps1 -MinimumSamples 60 -DaysToReport 30 -DaysToLead 40\n"})}),"\n",(0,i.jsx)(t.p,{children:"Returns estimations of volumes greater than 60MB in size that are Fixed or Removable."}),"\n",(0,i.jsx)(t.p,{children:"Excludes the D and E drive letters if they exist."}),"\n",(0,i.jsx)(t.p,{children:"Suppresses all informational, warning, and error console output."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:'.\\Get-VolumeExhaustionEstimate.ps1 -MinimumSize 60MB -DriveTypes "Fixed", "Removable" -ExcludeDriveLetters "D", "E" -Quiet\n'})}),"\n",(0,i.jsx)(t.h2,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Parameter"}),(0,i.jsx)(t.th,{children:"Alias"}),(0,i.jsx)(t.th,{children:"Required"}),(0,i.jsx)(t.th,{children:"Default"}),(0,i.jsx)(t.th,{children:"Type"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Path"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"p"})}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"pwd"})}),(0,i.jsx)(t.td,{children:"String"}),(0,i.jsx)(t.td,{children:"The path to save the raw volume report data to. Will be created if it does not exist."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"MinimumSamples"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"s"})}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"30"})}),(0,i.jsx)(t.td,{children:"Int"}),(0,i.jsx)(t.td,{children:"The minimum number of samples required to generate an estimation. If a volume does not meet this number of samples, the estimation will be skipped."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"DaysToReport"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"r"})}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"14"})}),(0,i.jsx)(t.td,{children:"String"}),(0,i.jsx)(t.td,{children:"The maximum age of samples to use for generating an estimation."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"DaysToLead"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"l"})}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"7"})}),(0,i.jsx)(t.td,{children:"Int"}),(0,i.jsx)(t.td,{children:"The number of days before volume exhaustion to generate a volume space estimation for."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"MinimumSize"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"m"})}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"1MB"})}),(0,i.jsx)(t.td,{children:"Int64"}),(0,i.jsx)(t.td,{children:"The minimum size of the volume to generate an estimation for."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"DriveTypes"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"d"})}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Fixed"})}),(0,i.jsx)(t.td,{children:"String[]"}),(0,i.jsxs)(t.td,{children:["A list of the types of drives to review. Valid options are:",(0,i.jsx)("br",{}),"- 'Unknown'",(0,i.jsx)("br",{}),"- 'Invalid Root Path'",(0,i.jsx)("br",{}),"- 'Removable'",(0,i.jsx)("br",{}),"- 'Fixed'",(0,i.jsx)("br",{}),"- 'Remote'",(0,i.jsx)("br",{}),"- 'CD-ROM'",(0,i.jsx)("br",{}),"- 'RAM Disk'"]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"IncludeUnassignedVolumes"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"u"})}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"False"})}),(0,i.jsx)(t.td,{children:"Switch"}),(0,i.jsx)(t.td,{children:"Include volumes that have not been assigned a drive letter."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"ExcludeDriveLetters"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"e"})}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"@()"})}),(0,i.jsx)(t.td,{children:"String[]"}),(0,i.jsx)(t.td,{children:"A list of drive letters to exclude from the review."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Force"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"f"})}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"False"})}),(0,i.jsx)(t.td,{children:"Switch"}),(0,i.jsx)(t.td,{children:"Return estimates for all drives regardless of status (trending upward or unreliable exhaustion date)."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Quiet"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"q"})}),(0,i.jsx)(t.td,{children:"False"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"False"})}),(0,i.jsx)(t.td,{children:"Switch"}),(0,i.jsx)(t.td,{children:"Suppress all console output other than the return object by overwriting the Write-Host function."})]})]})]}),"\n",(0,i.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"System.Management.Automation.PSCustomObject\r\nName                     MemberType   Definition      Description\r\n----                     ----------   ----------      ----------\r\nDriveLetter              NoteProperty char            The drive letter of the volume\r\nEstimatedLeadSpace       NoteProperty double          The amount of space estimated to be remaining after `$DaysToLead` days.\r\nExhaustionEstimation     NoteProperty System.TimeSpan The amount of estimated time remaining before volume exhaustion.\r\nExhaustionEstimationDate NoteProperty System.DateTime The estimated date of volume exhaustion.\n"})})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>d,x:()=>l});var n=s(296540);const i={},r=n.createContext(i);function d(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);