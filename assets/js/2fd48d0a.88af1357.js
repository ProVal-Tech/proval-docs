"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[9342],{5184:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>n,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"powershell/ps-import-lmcertificate","title":"Import-LMCertificate","description":"Documentation for the Import-LMCertificate command to import a certificate to one or more local machine stores.","source":"@site/docs/powershell/Import-LMCertificate.md","sourceDirName":"powershell","slug":"/powershell/ps-import-lmcertificate","permalink":"/docs/powershell/ps-import-lmcertificate","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/docs/tree/main/packages/create-docusaurus/templates/shared/docs/powershell/Import-LMCertificate.md","tags":[{"inline":false,"label":"Security","permalink":"/docs/tags/security","description":"Content related to security."},{"inline":false,"label":"Configuration","permalink":"/docs/tags/configuration","description":"Content related to configuring a device."},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Content related to the Windows operating system."}],"version":"current","frontMatter":{"id":"ps-import-lmcertificate","title":"Import-LMCertificate","title_meta":"Import-LMCertificate Command","keywords":["import","certificate","localmachine","security"],"description":"Documentation for the Import-LMCertificate command to import a certificate to one or more local machine stores.","tags":["security","configuration","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Get-WindowsUpdateReport","permalink":"/docs/powershell/ps-get-windowsupdatereport"},"next":{"title":"Import-Log4JTable","permalink":"/docs/powershell/ps-import-log4jtable"}}');var c=r(4848),s=r(8453);const n={id:"ps-import-lmcertificate",title:"Import-LMCertificate",title_meta:"Import-LMCertificate Command",keywords:["import","certificate","localmachine","security"],description:"Documentation for the Import-LMCertificate command to import a certificate to one or more local machine stores.",tags:["security","configuration","windows"],draft:!1,unlisted:!1},o=void 0,d={},a=[{value:"Description",id:"description",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Usage",id:"usage",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Output",id:"output",level:2}];function l(e){const t={code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(t.h2,{id:"description",children:"Description"}),"\n",(0,c.jsx)(t.p,{children:"Import a certificate to one or more local machine stores.\r\nThe target certificate can be a .CER file, a .CRT file, or a self-signed cert that will be created."}),"\n",(0,c.jsx)(t.h2,{id:"requirements",children:"Requirements"}),"\n",(0,c.jsx)(t.p,{children:"Powershell v5"}),"\n",(0,c.jsx)(t.h2,{id:"usage",children:"Usage"}),"\n",(0,c.jsxs)(t.ol,{children:["\n",(0,c.jsx)(t.li,{children:"Determine the origin of the desired certificate (file or self-signed)."}),"\n",(0,c.jsx)(t.li,{children:"If it is a file verify the file exists, and verify that the file is a .cer or .crt file."}),"\n",(0,c.jsx)(t.li,{children:"If it is a self-signed certificate, set up the certificate based on the parameters passed."}),"\n",(0,c.jsxs)(t.li,{children:["Import or create the desired certificate to the ",(0,c.jsx)(t.code,{children:"CurrentUser\\My"})," store."]}),"\n",(0,c.jsxs)(t.li,{children:["Loop through each target store.","\n",(0,c.jsxs)(t.ol,{children:["\n",(0,c.jsxs)(t.li,{children:["Check for any certificates in the store with the same subject name.","\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsx)(t.li,{children:"If an existing certificate is found, check the expiration date of that certificate. If the new certificate has a later expiration date than the existing one, remove the old cert. Otherwise, skip the import into the current store."}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(t.li,{children:"Add the new cert to the current store."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(t.p,{children:"Takes the certificate file 'ThisStrangeCert.cer' and applies it to the LocalMachine\\My, LocalMachine\\Root, and LocalMachine\\Trusted stores."}),"\n",(0,c.jsx)(t.pre,{children:(0,c.jsx)(t.code,{className:"language-powershell",children:".\\Import-LMCertificate.ps1 -CertStore My,Root,Trusted -CertLocation c:\\Users\\MyUser\\Downloads\\ThisStrangeCert.cer\n"})}),"\n",(0,c.jsx)(t.p,{children:"Creates a self-signed certificate with the subject name 'ThisNewCert' that is of a code-signing type, the cert has a 4096 key lenght with the provider 'Microsoft Enhanced RSA and AES Cryptographic Provider', it is exportable with a certsign usage and a RSA algorithm.\r\nThe Certificate will be placed in the LocalMachine\\My, LocalMachine\\Root, and LocalMachine\\CA."}),"\n",(0,c.jsx)(t.pre,{children:(0,c.jsx)(t.code,{className:"language-powershell",children:".\\Import-LMCertificate.ps1 -CertStore My,Root,CA -SubjectName 'ThisNewCert' -Type 'CodeSigningCert' -KeyLength 4096 -Provider 'Microsoft Enhanced RSA and AES Cryptographic Provider' -KeyExportPolicy 'Exportable' -KeyUsage 'CertSign' -KeyAlgorithm 'RSA'\n"})}),"\n",(0,c.jsx)(t.h2,{id:"parameters",children:"Parameters"}),"\n",(0,c.jsxs)(t.table,{children:[(0,c.jsx)(t.thead,{children:(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.th,{children:"Parameter"}),(0,c.jsx)(t.th,{children:"Alias"}),(0,c.jsx)(t.th,{children:"Required"}),(0,c.jsx)(t.th,{children:"Default"}),(0,c.jsx)(t.th,{children:"Type"}),(0,c.jsx)(t.th,{children:"Description"})]})}),(0,c.jsxs)(t.tbody,{children:[(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.td,{children:(0,c.jsx)(t.code,{children:"Path"})}),(0,c.jsx)(t.td,{children:(0,c.jsx)(t.code,{children:"CertLocation"})}),(0,c.jsx)(t.td,{children:"True"}),(0,c.jsx)(t.td,{}),(0,c.jsx)(t.td,{children:"String"}),(0,c.jsx)(t.td,{children:"The path to a certificate file to import."})]}),(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.td,{children:(0,c.jsx)(t.code,{children:"SubjectName"})}),(0,c.jsxs)(t.td,{children:[(0,c.jsx)(t.code,{children:"CertName"}),", ",(0,c.jsx)(t.code,{children:"Name"})]}),(0,c.jsx)(t.td,{children:"True"}),(0,c.jsx)(t.td,{}),(0,c.jsx)(t.td,{children:"String"}),(0,c.jsx)(t.td,{children:"The subject name for the created certificate."})]}),(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.td,{children:(0,c.jsx)(t.code,{children:"Type"})}),(0,c.jsx)(t.td,{}),(0,c.jsx)(t.td,{children:"True"}),(0,c.jsx)(t.td,{}),(0,c.jsx)(t.td,{children:"String"}),(0,c.jsx)(t.td,{children:"The type of certificate to create."})]}),(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.td,{children:(0,c.jsx)(t.code,{children:"CertStore"})}),(0,c.jsx)(t.td,{}),(0,c.jsx)(t.td,{children:"False"}),(0,c.jsx)(t.td,{children:"My"}),(0,c.jsx)(t.td,{children:"String"}),(0,c.jsx)(t.td,{children:"The set of LocalMachine stores to store the target certificate in."})]}),(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.td,{children:(0,c.jsx)(t.code,{children:"KeyLength"})}),(0,c.jsx)(t.td,{}),(0,c.jsx)(t.td,{children:"False"}),(0,c.jsx)(t.td,{children:"2048"}),(0,c.jsx)(t.td,{children:"Int"}),(0,c.jsx)(t.td,{children:"The length of the key for the created certificate."})]}),(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.td,{children:(0,c.jsx)(t.code,{children:"Provider"})}),(0,c.jsx)(t.td,{}),(0,c.jsx)(t.td,{children:"False"}),(0,c.jsx)(t.td,{children:"Microsoft Enhanced RSA and AES Cryptographic Provider"}),(0,c.jsx)(t.td,{children:"String"}),(0,c.jsx)(t.td,{children:"The provider for the created certificate."})]}),(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.td,{children:(0,c.jsx)(t.code,{children:"KeyExportPolicy"})}),(0,c.jsx)(t.td,{}),(0,c.jsx)(t.td,{children:"False"}),(0,c.jsx)(t.td,{children:"ExportableEncrypted"}),(0,c.jsx)(t.td,{children:"String"}),(0,c.jsx)(t.td,{children:"The desired export policy for the created certificate."})]}),(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.td,{children:(0,c.jsx)(t.code,{children:"KeyUsage"})}),(0,c.jsx)(t.td,{}),(0,c.jsx)(t.td,{children:"False"}),(0,c.jsx)(t.td,{children:"None"}),(0,c.jsx)(t.td,{children:"String"}),(0,c.jsx)(t.td,{children:"The Key Usage for a created certificate"})]}),(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.td,{children:(0,c.jsx)(t.code,{children:"KeyAlgorithm"})}),(0,c.jsx)(t.td,{}),(0,c.jsx)(t.td,{children:"False"}),(0,c.jsx)(t.td,{children:"RSA"}),(0,c.jsx)(t.td,{children:"String"}),(0,c.jsx)(t.td,{children:"The Key Algorithm for the created certificate."})]})]})]}),"\n",(0,c.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,c.jsx)(t.p,{children:"System.Security.Cryptography.X509Certificates.X509Certificate2"}),"\n",(0,c.jsx)(t.p,{children:"Log Files"}),"\n",(0,c.jsx)(t.p,{children:".\\Import-LMCertificate-log.txt\r\n.\\Import-LMCertificate-error.txt"})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,c.jsx)(t,{...e,children:(0,c.jsx)(l,{...e})}):l(e)}},8453:(e,t,r)=>{r.d(t,{R:()=>n,x:()=>o});var i=r(6540);const c={},s=i.createContext(c);function n(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:n(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);