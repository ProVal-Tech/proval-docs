"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[72993],{622137:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"cwa/monitors/91b463bf-7bb2-4c79-98ca-ef556ea093b0","title":"Configure BGInfo","description":"This document outlines the steps to implement a remote monitor for installing or updating Microsoft Teams using Winget. It includes SQL queries for creating alert templates and configuring group agents to ensure proper monitoring and notification of the installation status.","source":"@site/docs/cwa/monitors/Configure BGInfo.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/91b463bf-7bb2-4c79-98ca-ef556ea093b0","permalink":"/docs/cwa/monitors/91b463bf-7bb2-4c79-98ca-ef556ea093b0","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Configure BGInfo.md","tags":[{"inline":false,"label":"Setup","permalink":"/docs/tags/setup","description":"Documents on setting up software and hardware configurations"},{"inline":false,"label":"Software","permalink":"/docs/tags/software","description":"Documents related to software applications and their lifecycle management"},{"inline":false,"label":"SQL","permalink":"/docs/tags/sql","description":"Documents discussing Structured Query Language and database interactions"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"91b463bf-7bb2-4c79-98ca-ef556ea093b0","title":"Configure BGInfo","title_meta":"Configure BGInfo","keywords":["winget","teams","install","update","monitor"],"description":"This document outlines the steps to implement a remote monitor for installing or updating Microsoft Teams using Winget. It includes SQL queries for creating alert templates and configuring group agents to ensure proper monitoring and notification of the installation status.","tags":["setup","software","sql","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Certificate Expiration  30 Days","permalink":"/docs/cwa/monitors/a7dad4d0-d2dc-44b2-972b-0893d7814f8c"},"next":{"title":"DHCP Scope(s) < 5 IP Addresses Available","permalink":"/docs/cwa/monitors/90ad5d20-a081-4027-b8e2-238cbdbe64d3"}}');var o=n(474848),a=n(28453);const s={id:"91b463bf-7bb2-4c79-98ca-ef556ea093b0",title:"Configure BGInfo",title_meta:"Configure BGInfo",keywords:["winget","teams","install","update","monitor"],description:"This document outlines the steps to implement a remote monitor for installing or updating Microsoft Teams using Winget. It includes SQL queries for creating alert templates and configuring group agents to ensure proper monitoring and notification of the installation status.",tags:["setup","software","sql","windows"],draft:!1,unlisted:!1},i=void 0,l={},c=[{value:"Implementation Steps",id:"implementation-steps",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h2,{id:"implementation-steps",children:"Implementation Steps"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:["Import ",(0,o.jsx)(t.a,{href:"/docs/cwa/scripts/405866fb-2706-49b3-aed2-3d1f1fea4b4b",children:"Configure BGInfo script"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"Run this SQL query from a RAWSQL monitor set to create the alert template."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sql",children:"#Create Alert Template\r\nINSERT INTO `alerttemplate` (`Name`, `Comment`, `Last_User`, `Last_Date`, `GUID`) \r\nSELECT \r\n'\u25b3 Custom - Execute Script - Configure BGInfo' AS `Name`, \r\n'\u25b3 Custom - Execute Script - Configure BGInfo' AS `Comment`,\r\n'PRONOC' AS `Last_User`,\r\n(NOW()) AS `Last_Date`,\r\n'fd9097fb-1bbf-4c5a-a654-664867f7d605' AS `GUID` \r\nFrom (SELECT MIN(computerid) FROM computers) a\r\nWHERE (SELECT COUNT(*) FROM alerttemplate WHERE GUID = 'fd9097fb-1bbf-4c5a-a654-664867f7d605') = '0';\r\n\r\nINSERT INTO `alerttemplates` (`AlertActionID`, `DayOfWeek`, `TimeStart`, `TimeEnd`, `AlertAction`, `ContactID`, `UserID`, `ScriptID`, `Trump`, `GUID`, `WarningAction`)\r\nSELECT \r\n(SELECT alertactionid FROM alerttemplate WHERE `GUID` = 'fd9097fb-1bbf-4c5a-a654-664867f7d605') AS `AlertActionid`,\r\n'127' AS `DayOfWeek`,\r\n'00:00:00' AS `TimeStart`,\r\n'23:59:00' AS `TimeEnd`,\r\n'512' AS `AlertAction`,\r\n'-2' AS `ContactID`,\r\n'0' AS `UserID`,\r\n(SELECT Scriptid FROM lt_scripts WHERE scriptGUID = 'f070c915-2fce-11ee-9dfe-000c295e5f21') AS `Scriptid`,\r\n'0' AS `Trump`,\r\n'05c0b164-d150-4236-a02c-5cf7be143c41' AS `GUID`,\r\n'0' AS `WarningAction` \r\nFrom (SELECT MIN(computerid) FROM computers) a\r\nWHERE (SELECT COUNT(*) FROM alerttemplates WHERE GUID = '05c0b164-d150-4236-a02c-5cf7be143c41') = '0' ;\n"})}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Obtain the groupid(s) of the group(s) that the remote monitor should be applied to."}),"\n",(0,o.jsxs)(t.li,{children:["Copy the following query and replace 'YOUR COMMA SEPARATED LIST OF GROUPID(S)' with the Groupid(s) of the relevant groups: (The string to replace can be found at the very bottom of the query, right after ",(0,o.jsx)(t.code,{children:"WHERE"}),")"]}),"\n"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sql",children:"SET @AlertAction = (SELECT Alertactionid FROM alerttemplate WHERE `GUID` = 'fd9097fb-1bbf-4c5a-a654-664867f7d605') ;\r\nINSERT INTO groupagents \r\n SELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'ProVal - Dev - Configure BGInfo' as `Name`,\r\n'6' as `CheckAction`,\r\n@AlertAction as `AlertAction`,\r\n'%NAME% %STATUS% on %CLIENTNAME%\\\\%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%.!!!%NAME% %STATUS% on %CLIENTNAME%\\\\%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%.' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'86400' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command \"if ((Get-ItemProperty \\'HKLM:\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\').BGInfo) {\\'Configured\\'} Else {\\'Not Configured\\'}\"' as `DataOut`,\r\n'9' as `Comparor`,\r\n'Not Configured' as `DataIn`,\r\n'' as `IDField`,\r\n'1' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'21' as `Category`,\r\n'0' as `TicketCategory`,\r\n'1' as `ScriptTarget`,\r\nUUID() as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (YOUR COMMA SEPARATED LIST OF GROUPID(S))\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Dev - Configure BGInfo')\n"})}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"An example of a query with a groupid:"}),"\n"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sql",children:"SET @AlertAction = (SELECT Alertactionid FROM alerttemplate WHERE `GUID` = 'fd9097fb-1bbf-4c5a-a654-664867f7d605') ;\r\nINSERT INTO groupagents \r\n SELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'ProVal - Dev - Configure BGInfo' as `Name`,\r\n'6' as `CheckAction`,\r\n@AlertAction as `AlertAction`,\r\n'%NAME% %STATUS% on %CLIENTNAME%\\\\%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%.!!!%NAME% %STATUS% on %CLIENTNAME%\\\\%COMPUTERNAME% at %LOCATIONNAME% for %FIELDNAME% result %RESULT%.' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'86400' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command \"if ((Get-ItemProperty \\'HKLM:\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\').BGInfo) {\\'Configured\\'} Else {\\'Not Configured\\'}\"' as `DataOut`,\r\n'9' as `Comparor`,\r\n'Not Configured' as `DataIn`,\r\n'' as `IDField`,\r\n'1' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'21' as `Category`,\r\n'0' as `TicketCategory`,\r\n'1' as `ScriptTarget`,\r\nUUID() as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (2,3)\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Dev - Configure BGInfo')\n"})}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Now execute your query from a RAWSQL monitor set."}),"\n",(0,o.jsx)(t.li,{children:"Now Locate the Remote monitor on the group(s) and ensure that it's functioning as required."}),"\n"]})]})}function u(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>i});var r=n(296540);const o={},a=r.createContext(o);function s(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);