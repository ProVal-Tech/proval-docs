"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[85212],{583692:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>n,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"cwa/monitors/e79a2422-0089-451b-9522-a6110976c2f5","title":"Disable RestrictDriverInstallationToAdministrators","description":"This document provides a detailed guide on how to disable the Restrict Driver Installation to Administrators setting in a ConnectWise Automate environment. It includes steps for ensuring the script and alert template are in place, obtaining group IDs, and executing the necessary SQL query to apply the changes effectively.","source":"@site/docs/cwa/monitors/Disable RestrictDriverInstallationToAdministrators.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/e79a2422-0089-451b-9522-a6110976c2f5","permalink":"/docs/cwa/monitors/e79a2422-0089-451b-9522-a6110976c2f5","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Disable RestrictDriverInstallationToAdministrators.md","tags":[{"inline":false,"label":"SQL","permalink":"/docs/tags/sql","description":"Documents discussing Structured Query Language and database interactions"}],"version":"current","frontMatter":{"id":"e79a2422-0089-451b-9522-a6110976c2f5","title":"Disable RestrictDriverInstallationToAdministrators","title_meta":"Disable RestrictDriverInstallationToAdministrators","keywords":["restrict","driver","installation","administrators","ticket","creation","monitor"],"description":"This document provides a detailed guide on how to disable the Restrict Driver Installation to Administrators setting in a ConnectWise Automate environment. It includes steps for ensuring the script and alert template are in place, obtaining group IDs, and executing the necessary SQL query to apply the changes effectively.","tags":["sql"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Disable Netbios on Network Interfaces","permalink":"/docs/cwa/monitors/7cd56a9d-67d5-4d67-a8bf-f61497a93059"},"next":{"title":"Disable Update Orchestrator Service Change","permalink":"/docs/cwa/monitors/f4687be0-4269-4cec-8e7b-685f56178f27"}}');var a=r(474848),i=r(28453);const n={id:"e79a2422-0089-451b-9522-a6110976c2f5",title:"Disable RestrictDriverInstallationToAdministrators",title_meta:"Disable RestrictDriverInstallationToAdministrators",keywords:["restrict","driver","installation","administrators","ticket","creation","monitor"],description:"This document provides a detailed guide on how to disable the Restrict Driver Installation to Administrators setting in a ConnectWise Automate environment. It includes steps for ensuring the script and alert template are in place, obtaining group IDs, and executing the necessary SQL query to apply the changes effectively.",tags:["sql"],draft:!1,unlisted:!1},o=void 0,l={},c=[{value:"Steps",id:"steps",level:2},{value:"1.",id:"1",level:3},{value:"2.",id:"2",level:3},{value:"3.",id:"3",level:3},{value:"4.",id:"4",level:3},{value:"5.",id:"5",level:3},{value:"6.",id:"6",level:3}];function d(e){const t={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h2,{id:"steps",children:"Steps"}),"\n",(0,a.jsx)(t.h3,{id:"1",children:"1."}),"\n",(0,a.jsxs)(t.p,{children:["Ensure the presence of the ",(0,a.jsx)(t.a,{href:"/docs/cwa/scripts/63beba3c-f4a6-41a5-98e2-d4e4ce885035",children:"Ticket Creation - Computer"})," script and ",(0,a.jsx)(t.code,{children:"\u25b3 Custom - Ticket Creation Computer - Failures Only"})," alert template."]}),"\n",(0,a.jsx)(t.h3,{id:"2",children:"2."}),"\n",(0,a.jsx)(t.p,{children:"Obtain the group ID(s) of the group(s) that the remote monitor should be applied to."}),"\n",(0,a.jsx)(t.h3,{id:"3",children:"3."}),"\n",(0,a.jsxs)(t.p,{children:["Copy the following query and replace '",(0,a.jsx)(t.strong,{children:"YOUR COMMA SEPARATED LIST OF GROUPID(S)"}),"' with the Group ID(s) of the relevant groups:",(0,a.jsx)(t.br,{}),"\n","(The string to replace can be found at the very bottom of the query, right after ",(0,a.jsx)(t.strong,{children:"WHERE"}),")"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-sql",children:"INSERT INTO groupagents  \r\n  SELECT '' as `AgentID`,\r\n  `groupid` as `GroupID`,\r\n  '0' as `SearchID`,\r\n  'ProVal - Client Specific - Disable RestrictDriverInstallationToAdministrators' as `Name`,\r\n  '6' as `CheckAction`,\r\n  '1' as `AlertAction`,\r\n  'Failed to Disable RestrictDriverInstallationToAdministrators~~~Value Successfully Set.!!!Failed to Disable RestrictDriverInstallationToAdministrators~~~%RESULT%' as `AlertMessage`,\r\n  '0' as `ContactID`,\r\n  '86400' as `interval`,\r\n  '127.0.0.1' as `Where`,\r\n  '7' as `What`,\r\n  'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command \"$P = \\'HKLM:\\\\Software\\\\Policies\\\\Microsoft\\\\Windows NT\\\\Printers\\\\PointAndPrint\\'; $N = \\'RestrictDriverInstallationToAdministrators\\'; $V = 0; if ( !( (get-ItemProperty $P -Erroraction SilentlyContinue).$N -eq $V) ) {if(!(Test-Path -Path $P)) {try {New-Item -Path $P -Force -Erroraction stop | Out-Null} catch {return \\\\\"Failed to create registry path $P. Reason: $($Error[0].Exception.Message)\\\\\"}}; try {Set-Itemproperty -Path $P -Name $N -Value $V -Type \\'DWord\\' -Erroraction stop; return \\'Registry changes applied.\\'} catch {return \\\\\"Failed to set registry key. Reason: $($Error[0].Exception.Message)\\\\\"}} else {return \\'Registry Key is already set.\\'}\"' as `DataOut`,\r\n  '16' as `Comparor`,\r\n  '10|(^$%7C^(\\\\s%7COK%7C\\\\r\\\\n)$)%7C(Registry changes applied)%7C(Registry Key is already set)|11|(^$%7C^(\\\\s%7COK%7C\\\\r\\\\n)$)%7C(Failed to Set Registry Value RestrictDriverInstallationToAdministrators. Reason:)%7C(Registry changes applied)%7C(Registry Key is already set)|5|Failed to Set Registry Value RestrictDriverInstallationToAdministrators. Reason:' as `DataIn`,\r\n  '' as `IDField`,\r\n  '1' as `AlertStyle`,\r\n  '0' as `ScriptID`,\r\n  '' as `datacollector`,\r\n  '21' as `Category`,\r\n  '0' as `TicketCategory`,\r\n  '1' as `ScriptTarget`,\r\n  UUID() as `GUID`,\r\n  'root' as `UpdatedBy`,\r\n  (NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (YOUR COMMA SEPARATED LIST OF GROUPID(S))\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Client Specific - Disable RestrictDriverInstallationToAdministrators')\n"})}),"\n",(0,a.jsx)(t.h3,{id:"4",children:"4."}),"\n",(0,a.jsx)(t.p,{children:"An example of a query with a group ID:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-sql",children:"INSERT INTO groupagents  \r\n  SELECT '' as `AgentID`,\r\n  `groupid` as `GroupID`,\r\n  '0' as `SearchID`,\r\n  'ProVal - Client Specific - Disable RestrictDriverInstallationToAdministrators' as `Name`,\r\n  '6' as `CheckAction`,\r\n  '1' as `AlertAction`,\r\n  'Failed to Disable RestrictDriverInstallationToAdministrators~~~Value Successfully Set.!!!Failed to Disable RestrictDriverInstallationToAdministrators~~~%RESULT%' as `AlertMessage`,\r\n  '0' as `ContactID`,\r\n  '86400' as `interval`,\r\n  '127.0.0.1' as `Where`,\r\n  '7' as `What`,\r\n  'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command \"$P = \\'HKLM:\\\\Software\\\\Policies\\\\Microsoft\\\\Windows NT\\\\Printers\\\\PointAndPrint\\'; $N = \\'RestrictDriverInstallationToAdministrators\\'; $V = 0; if ( !( (get-ItemProperty $P -Erroraction SilentlyContinue).$N -eq $V) ) {if(!(Test-Path -Path $P)) {try {New-Item -Path $P -Force -Erroraction stop | Out-Null} catch {return \\\\\"Failed to create registry path $P. Reason: $($Error[0].Exception.Message)\\\\\"}}; try {Set-Itemproperty -Path $P -Name $N -Value $V -Type \\'DWord\\' -Erroraction stop; return \\'Registry changes applied.\\'} catch {return \\\\\"Failed to set registry key. Reason: $($Error[0].Exception.Message)\\\\\"}} else {return \\'Registry Key is already set.\\'}\"' as `DataOut`,\r\n  '16' as `Comparor`,\r\n  '10|(^$%7C^(\\\\s%7COK%7C\\\\r\\\\n)$)%7C(Registry changes applied)%7C(Registry Key is already set)|11|(^$%7C^(\\\\s%7COK%7C\\\\r\\\\n)$)%7C(Failed to Set Registry Value RestrictDriverInstallationToAdministrators. Reason:)%7C(Registry changes applied)%7C(Registry Key is already set)|5|Failed to Set Registry Value RestrictDriverInstallationToAdministrators. Reason:' as `DataIn`,\r\n  '' as `IDField`,\r\n  '1' as `AlertStyle`,\r\n  '0' as `ScriptID`,\r\n  '' as `datacollector`,\r\n  '21' as `Category`,\r\n  '0' as `TicketCategory`,\r\n  '1' as `ScriptTarget`,\r\n  UUID() as `GUID`,\r\n  'root' as `UpdatedBy`,\r\n  (NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (2,856)\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Client Specific - Disable RestrictDriverInstallationToAdministrators')\n"})}),"\n",(0,a.jsx)(t.h3,{id:"5",children:"5."}),"\n",(0,a.jsx)(t.p,{children:"Now execute your query from a RAWSQL monitor set."}),"\n",(0,a.jsx)(t.h3,{id:"6",children:"6."}),"\n",(0,a.jsxs)(t.p,{children:["Locate your remote monitor by opening the group(s) remote monitors tab, then apply the ",(0,a.jsx)(t.code,{children:"\u25b3 Custom - Ticket Creation - Computer - Failures Only"})," alert template."]})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},28453:(e,t,r)=>{r.d(t,{R:()=>n,x:()=>o});var s=r(296540);const a={},i=s.createContext(a);function n(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:n(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);