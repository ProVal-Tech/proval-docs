"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[13672],{763202:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>n});const i=JSON.parse('{"id":"cwa/scripts/f16b700f-16c7-43f9-8470-84861d7f5c52","title":"Shadow Copy - Schedule Shadow Copies","description":"This document details a PowerShell script that enables shadow copies on the system drive by creating a scheduled task through Task Scheduler. It provides configuration parameters and outlines the process for setting up the script to automate shadow copy tasks at specified times.","source":"@site/docs/cwa/scripts/Shadow Copy - Schedule Shadow Copies.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/f16b700f-16c7-43f9-8470-84861d7f5c52","permalink":"/docs/cwa/scripts/f16b700f-16c7-43f9-8470-84861d7f5c52","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Shadow Copy - Schedule Shadow Copies.md","tags":[{"inline":false,"label":"Backup","permalink":"/docs/tags/backup","description":"Documents detailing backup solutions and data protection strategies"},{"inline":false,"label":"Security","permalink":"/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"f16b700f-16c7-43f9-8470-84861d7f5c52","title":"Shadow Copy - Schedule Shadow Copies","title_meta":"Shadow Copy - Schedule Shadow Copies","keywords":["shadow","copy","task","scheduler","windows","backup"],"description":"This document details a PowerShell script that enables shadow copies on the system drive by creating a scheduled task through Task Scheduler. It provides configuration parameters and outlines the process for setting up the script to automate shadow copy tasks at specified times.","tags":["backup","security","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Shadow Copy - Audit Complete Statistics DV","permalink":"/docs/cwa/scripts/9d69d33c-688e-4c02-adfe-cef7c8ecd766"},"next":{"title":"ShadowControl Installer","permalink":"/docs/cwa/scripts/13e225e3-ebab-45f8-ac25-f1a15eb4ac80"}}');var a=t(474848),d=t(28453);const o={id:"f16b700f-16c7-43f9-8470-84861d7f5c52",title:"Shadow Copy - Schedule Shadow Copies",title_meta:"Shadow Copy - Schedule Shadow Copies",keywords:["shadow","copy","task","scheduler","windows","backup"],description:"This document details a PowerShell script that enables shadow copies on the system drive by creating a scheduled task through Task Scheduler. It provides configuration parameters and outlines the process for setting up the script to automate shadow copy tasks at specified times.",tags:["backup","security","windows"],draft:!1,unlisted:!1},r=void 0,c={},n=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Variables",id:"variables",level:2},{value:"Global Parameters",id:"global-parameters",level:4},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2}];function l(e){const s={code:"code",h2:"h2",h4:"h4",img:"img",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,d.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.h2,{id:"summary",children:"Summary"}),"\n",(0,a.jsx)(s.p,{children:'The script uses PowerShell to enable shadow copies (similar to the older "previous versions" feature in Windows 7). It will create a Shadow Copy task for the system drive via Task Scheduler at the scheduled times defined in the global parameters.'}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Time Saved by Automation:"})," 20 Minutes"]}),"\n",(0,a.jsx)(s.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Sample Run",src:t(679102).A+"",width:"479",height:"346"})}),"\n",(0,a.jsx)(s.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,a.jsx)(s.p,{children:"None"}),"\n",(0,a.jsx)(s.h2,{id:"variables",children:"Variables"}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.code,{children:"@ShadowCopies@"})," - The output from the PowerShell used to build the Shadow Copy configuration."]}),"\n",(0,a.jsx)(s.h4,{id:"global-parameters",children:"Global Parameters"}),"\n",(0,a.jsxs)(s.table,{children:[(0,a.jsx)(s.thead,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.th,{children:"Name"}),(0,a.jsx)(s.th,{children:"Example"}),(0,a.jsx)(s.th,{children:"Required"}),(0,a.jsx)(s.th,{children:"Description"})]})}),(0,a.jsxs)(s.tbody,{children:[(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"AM-Time"}),(0,a.jsx)(s.td,{children:"6:00 AM"}),(0,a.jsx)(s.td,{children:"True"}),(0,a.jsx)(s.td,{children:"This is the scheduled AM instance of the Shadow Copy (6:00 AM is the default value)"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"PM-Time"}),(0,a.jsx)(s.td,{children:"6:00 PM"}),(0,a.jsx)(s.td,{children:"True"}),(0,a.jsx)(s.td,{children:"This is the scheduled PM instance of the Shadow Copy (6:00 PM is the default value)"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Task-Prefix"}),(0,a.jsx)(s.td,{children:"MSP-"}),(0,a.jsx)(s.td,{children:"True"}),(0,a.jsx)(s.td,{children:"The prefix added to the name of the scheduled task (MSP- is the default value)"})]})]})]}),"\n",(0,a.jsx)(s.h2,{id:"process",children:"Process"}),"\n",(0,a.jsx)(s.p,{children:"Once the global parameters are configured to the desired values, the script will use those values to run a PowerShell script that allocates space on the system drive for the shadow copies. It then proceeds to set up scheduled tasks for both AM and PM shadow copies. The script will verify that there were no failures in the PowerShell script and will exit successfully as long as there are no errors returned from the PowerShell script. If the PowerShell script does not run successfully, the automation script will exit with an error and log a message."}),"\n",(0,a.jsx)(s.h2,{id:"output",children:"Output"}),"\n",(0,a.jsx)(s.p,{children:"Script log"})]})}function h(e={}){const{wrapper:s}={...(0,d.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},679102:(e,s,t)=>{t.d(s,{A:()=>i});const i=t.p+"assets/images/image_1-39d554f59be67615ded8e99df30c436b.png"},28453:(e,s,t)=>{t.d(s,{R:()=>o,x:()=>r});var i=t(296540);const a={},d=i.createContext(a);function o(e){const s=i.useContext(d);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),i.createElement(d.Provider,{value:s},e.children)}}}]);