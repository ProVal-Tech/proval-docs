"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[36284],{688664:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>n,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"vsa/procedures/5c93252c-c3d9-48d7-bc9b-4073c9e49638","title":"Disable RDP","description":"This document explains a script designed to check if Remote Desktop Protocol (RDP) is enabled on a Windows machine and disable it by modifying the relevant Registry value. It provides a detailed log of actions taken during the execution of the script, along with sample outputs and processes involved.","source":"@site/docs/vsa/procedures/Disable RDP.md","sourceDirName":"vsa/procedures","slug":"/vsa/procedures/5c93252c-c3d9-48d7-bc9b-4073c9e49638","permalink":"/docs/vsa/procedures/5c93252c-c3d9-48d7-bc9b-4073c9e49638","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/vsa/procedures/Disable RDP.md","tags":[{"inline":false,"label":"Logging","permalink":"/docs/tags/logging","description":"Documents related to log management and analysis for systems"},{"inline":false,"label":"Security","permalink":"/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"5c93252c-c3d9-48d7-bc9b-4073c9e49638","title":"Disable RDP","title_meta":"Disable RDP","keywords":["rdp","windows","registry","disable","script"],"description":"This document explains a script designed to check if Remote Desktop Protocol (RDP) is enabled on a Windows machine and disable it by modifying the relevant Registry value. It provides a detailed log of actions taken during the execution of the script, along with sample outputs and processes involved.","tags":["logging","security","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Disable BitLocker","permalink":"/docs/vsa/procedures/343354b6-6418-4e44-8544-52fe2fb0851a"},"next":{"title":"Domain Watch Configuration","permalink":"/docs/vsa/procedures/46c7d8b6-eefc-4a70-9ecd-54386326f177"}}');var d=s(474848),i=s(28453);const n={id:"5c93252c-c3d9-48d7-bc9b-4073c9e49638",title:"Disable RDP",title_meta:"Disable RDP",keywords:["rdp","windows","registry","disable","script"],description:"This document explains a script designed to check if Remote Desktop Protocol (RDP) is enabled on a Windows machine and disable it by modifying the relevant Registry value. It provides a detailed log of actions taken during the execution of the script, along with sample outputs and processes involved.",tags:["logging","security","windows"],draft:!1,unlisted:!1},l=void 0,c={},o=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2},{value:"Export Attachment",id:"export-attachment",level:2},{value:"Attachments",id:"attachments",level:2}];function a(e){const t={a:"a",h2:"h2",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,d.jsx)(t.p,{children:"The script is used to check whether RDP is enabled on the machine. If RDP is enabled, the script disables it by editing the Registry value."}),"\n",(0,d.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,d.jsxs)(t.table,{children:[(0,d.jsx)(t.thead,{children:(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.th,{children:"Time"}),(0,d.jsx)(t.th,{children:"Action"}),(0,d.jsx)(t.th,{children:"Status"}),(0,d.jsx)(t.th,{children:"Link"})]})}),(0,d.jsxs)(t.tbody,{children:[(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:12:00 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Disable RDP"}),(0,d.jsx)(t.td,{children:"Success THEN"}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:12:00 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Disable RDP-0002"}),(0,d.jsx)(t.td,{children:"RDP is Disabled"}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:59 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Disable RDP-0001"}),(0,d.jsx)(t.td,{children:"1"}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:59 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command"}),(0,d.jsx)(t.td,{children:"Success THEN"}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:59 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0012"}),(0,d.jsxs)(t.td,{children:["Results returned to global variable #global",":psresult","# and saved in Documents tab of server."]}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:59 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0012"}),(0,d.jsx)(t.td,{children:"Informational: GetFile command overwrote the server file C:/Kaseya/UserProfiles/162522262609191/GetFiles/../docs/psoutput.txt with the new contents from c:/provaltech/psoutput.txt in THEN step 2."}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:59 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0011"}),(0,d.jsx)(t.td,{children:"Powershell command completed!"}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:51 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0011"}),(0,d.jsx)(t.td,{children:'Executing powershell "" -Command "(Get-ItemProperty -Path \'HKLM:/SYSTEM/CurrentControlSet/Control/Terminal Server\').fDenyTSConnections" >"c:/provaltech/psoutput.txt"'}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:51 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0010"}),(0,d.jsx)(t.td,{children:"Sending output to global variable."}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:51 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0008"}),(0,d.jsx)(t.td,{children:"New command variable is: -Command \"(Get-ItemProperty -Path 'HKLM:/SYSTEM/CurrentControlSet/Control/Terminal Server').fDenyTSConnections\""}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:51 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0008"}),(0,d.jsx)(t.td,{children:"Custom commands detected as (Get-ItemProperty -Path 'HKLM:/SYSTEM/CurrentControlSet/Control/Terminal Server').fDenyTSConnections"}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:42 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0002"}),(0,d.jsx)(t.td,{children:"Powershell is present."}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:39 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Disable RDP"}),(0,d.jsx)(t.td,{children:"0"}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:39 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command"}),(0,d.jsx)(t.td,{children:"Success THEN"}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:39 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0012"}),(0,d.jsxs)(t.td,{children:["Results returned to global variable #global",":psresult","# and saved in Documents tab of server."]}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:39 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0012"}),(0,d.jsx)(t.td,{children:"Informational: GetFile command overwrote the server file C:/Kaseya/UserProfiles/162522262609191/GetFiles/../docs/psoutput.txt with the new contents from c:/provaltech/psoutput.txt in THEN step 2."}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:38 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0011"}),(0,d.jsx)(t.td,{children:"Powershell command completed!"}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:31 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0011"}),(0,d.jsx)(t.td,{children:'Executing powershell "" -Command "(Get-ItemProperty -Path \'HKLM:/SYSTEM/CurrentControlSet/Control/Terminal Server\').fDenyTSConnections" >"c:/provaltech/psoutput.txt"'}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:31 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0010"}),(0,d.jsx)(t.td,{children:"Sending output to global variable."}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:31 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0008"}),(0,d.jsx)(t.td,{children:"New command variable is: -Command \"(Get-ItemProperty -Path 'HKLM:/SYSTEM/CurrentControlSet/Control/Terminal Server').fDenyTSConnections\""}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:31 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0008"}),(0,d.jsx)(t.td,{children:"Custom commands detected as (Get-ItemProperty -Path 'HKLM:/SYSTEM/CurrentControlSet/Control/Terminal Server').fDenyTSConnections"}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:24 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0002"}),(0,d.jsx)(t.td,{children:"Powershell is present."}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"4:11:15 pm 20-Sep-22"}),(0,d.jsx)(t.td,{children:"Run Now - Disable RDP"}),(0,d.jsx)(t.td,{children:"Admin provaltech.com/ovais.rashid scheduled procedure Run Now - Disable RDP to run at Sep 20 2022 4:11 PM"}),(0,d.jsx)(t.td,{children:"provaltech.com/ovais.rashid"})]})]})]}),"\n",(0,d.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,d.jsx)(t.p,{children:"None"}),"\n",(0,d.jsx)(t.h2,{id:"process",children:"Process"}),"\n",(0,d.jsx)(t.p,{children:"First, the script checks if RDP is enabled. If RDP is enabled, the shell command will run to make changes to the Registry value and disable RDP. Then the script checks again if RDP is still enabled; if not, it provides logs indicating that RDP is disabled."}),"\n",(0,d.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,d.jsx)(t.p,{children:"Script Logs"}),"\n",(0,d.jsx)(t.h2,{id:"export-attachment",children:"Export Attachment"}),"\n",(0,d.jsx)(t.p,{children:"Attach the content XML VSA Export to this document."}),"\n",(0,d.jsx)(t.h2,{id:"attachments",children:"Attachments"}),"\n",(0,d.jsx)(t.p,{children:(0,d.jsx)(t.a,{href:"......%5Cstatic%5Cattachments%5Citg%5C10932189%5CProcedure_Disable_RDP.xml",children:"Procedure_Disable_RDP.xml"})})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,d.jsx)(t,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>n,x:()=>l});var r=s(296540);const d={},i=r.createContext(d);function n(e){const t=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:n(e.components),r.createElement(i.Provider,{value:t},e.children)}}}]);