"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[45266],{57049:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>r,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"cwa/scripts/f499a42f-9194-4109-88c4-6ae61fcfbb93","title":"Set Logon Success and Failure Auditing ON","description":"This document provides a detailed overview of a script that configures logon auditing for success and failure events using auditpol.exe. The script is designed to run on a domain controller and ensures that logon auditing is enabled, facilitating better security monitoring and compliance.","source":"@site/docs/cwa/scripts/Set Logon Success and Failure Auditing ON.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/f499a42f-9194-4109-88c4-6ae61fcfbb93","permalink":"/proval-docs/docs/cwa/scripts/f499a42f-9194-4109-88c4-6ae61fcfbb93","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Set Logon Success and Failure Auditing ON.md","tags":[{"inline":false,"label":"Report","permalink":"/proval-docs/docs/tags/report","description":"Documents focused on generating and managing reports"},{"inline":false,"label":"Security","permalink":"/proval-docs/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"f499a42f-9194-4109-88c4-6ae61fcfbb93","title":"Set Logon Success and Failure Auditing ON","title_meta":"Set Logon Success and Failure Auditing ON","keywords":["audit","logon","success","failure","dc"],"description":"This document provides a detailed overview of a script that configures logon auditing for success and failure events using auditpol.exe. The script is designed to run on a domain controller and ensures that logon auditing is enabled, facilitating better security monitoring and compliance.","tags":["report","security","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Set Last Logged In User","permalink":"/proval-docs/docs/cwa/scripts/d8fcfe10-81c9-42d9-b56b-a4021601f842"},"next":{"title":"Set NUMA VM Status","permalink":"/proval-docs/docs/cwa/scripts/75173959-6166-4520-838a-f960ab0070ea"}}');var t=n(474848),o=n(28453);const a={id:"f499a42f-9194-4109-88c4-6ae61fcfbb93",title:"Set Logon Success and Failure Auditing ON",title_meta:"Set Logon Success and Failure Auditing ON",keywords:["audit","logon","success","failure","dc"],description:"This document provides a detailed overview of a script that configures logon auditing for success and failure events using auditpol.exe. The script is designed to run on a domain controller and ensures that logon auditing is enabled, facilitating better security monitoring and compliance.",tags:["report","security","windows"],draft:!1,unlisted:!1},c=void 0,r={},l=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Variables",id:"variables",level:2},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2}];function d(e){const s={code:"code",h2:"h2",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsxs)(s.p,{children:["This script uses ",(0,t.jsx)(s.code,{children:"auditpol.exe"})," to configure logon auditing for success and failure events to ON. This applies to the default domain controller policy, so it will only run on a DC."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Time Saved by Automation:"})," 5 Minutes"]}),"\n",(0,t.jsx)(s.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Sample Run",src:n(541208).A+"",width:"482",height:"352"})}),"\n",(0,t.jsx)(s.h2,{id:"variables",children:"Variables"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"%Shellresult%"})," - Used to check whether the Auditpol command succeeded or not."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"process",children:"Process"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"The script checks if it's running on a DC; it exits if the machine is not a DC."}),"\n",(0,t.jsxs)(s.li,{children:["It runs ",(0,t.jsx)(s.code,{children:"Auditpol.exe /set /subcategory:logon /success:enable /failure:enable"})," to enable logon success and failure events."]}),"\n",(0,t.jsx)(s.li,{children:"It checks whether the command succeeded or not."}),"\n",(0,t.jsx)(s.li,{children:"It resends the inventory command."}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"output",children:"Output"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Script log"}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},541208:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/image_1-ab65063cce25a2f6aaa50d63ab7ef2fb.png"},28453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>c});var i=n(296540);const t={},o=i.createContext(t);function a(e){const s=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(o.Provider,{value:s},e.children)}}}]);