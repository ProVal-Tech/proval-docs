"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[73143],{672981:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"cwa/scripts/18a8b802-bc6a-42a8-859b-89c93fed4257","title":"Malicious Software Removal Tool Scanner","description":"This document outlines a script that downloads and executes the latest version of the Microsoft Malicious Software Removal Tool Scanner. It logs the results and sends an email with the outcome to specified addresses, and it also includes an option for automatic infection resolution.","source":"@site/docs/cwa/scripts/Malicious Software Removal Tool Scanner.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/18a8b802-bc6a-42a8-859b-89c93fed4257","permalink":"/docs/cwa/scripts/18a8b802-bc6a-42a8-859b-89c93fed4257","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Malicious Software Removal Tool Scanner.md","tags":[{"inline":false,"label":"Email","permalink":"/docs/tags/email","description":"Documents about email systems and their management"},{"inline":false,"label":"Logging","permalink":"/docs/tags/logging","description":"Documents related to log management and analysis for systems"},{"inline":false,"label":"Report","permalink":"/docs/tags/report","description":"Documents focused on generating and managing reports"},{"inline":false,"label":"Security","permalink":"/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"18a8b802-bc6a-42a8-859b-89c93fed4257","title":"Malicious Software Removal Tool Scanner","title_meta":"Malicious Software Removal Tool Scanner","keywords":["download","microsoft","malicious","software","removal","tool","scanner","log","email","autofix"],"description":"This document outlines a script that downloads and executes the latest version of the Microsoft Malicious Software Removal Tool Scanner. It logs the results and sends an email with the outcome to specified addresses, and it also includes an option for automatic infection resolution.","tags":["email","logging","report","security","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Maintenance Mode - Set","permalink":"/docs/cwa/scripts/cca4abea-2af2-4ea8-b8ea-d6c2342c88a2"},"next":{"title":"Malwarebytes Uninstaller","permalink":"/docs/cwa/scripts/f3a5844b-166b-41a0-901e-b4684fd08db5"}}');var n=s(474848),a=s(28453);const r={id:"18a8b802-bc6a-42a8-859b-89c93fed4257",title:"Malicious Software Removal Tool Scanner",title_meta:"Malicious Software Removal Tool Scanner",keywords:["download","microsoft","malicious","software","removal","tool","scanner","log","email","autofix"],description:"This document outlines a script that downloads and executes the latest version of the Microsoft Malicious Software Removal Tool Scanner. It logs the results and sends an email with the outcome to specified addresses, and it also includes an option for automatic infection resolution.",tags:["email","logging","report","security","windows"],draft:!1,unlisted:!1},l=void 0,o={},c=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Variables",id:"variables",level:2},{value:"EDF",id:"edf",level:2},{value:"User Parameters",id:"user-parameters",level:4},{value:"Global Parameter",id:"global-parameter",level:2},{value:"Output",id:"output",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",h4:"h4",img:"img",li:"li",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,n.jsx)(t.p,{children:"This script will download and run the latest version of the Microsoft Malicious Software Removal Tool Scanner, logging the results and emailing them to the specified email address. It also provides an option to perform an autofix for any detected infections."}),"\n",(0,n.jsx)(t.p,{children:"Please get the following file hashes approved for this script to work if the environment has a security block application:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"ED06AECD5686944B0A5E5D76C1E7A9EA"})," --\x3e Audit MSRT.ps1 script"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"C8759C7E4979819C0BB39DAF4DC64124"})," --\x3e MSRTAutofix.ps1 script"]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,n.jsxs)(t.p,{children:["Run with ",(0,n.jsx)(t.code,{children:"SetEnvironment = 1"})," to set the EDFs the first time this script is imported."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Sample Run Image 1",src:s(847434).A+"",width:"715",height:"676"})}),"\n",(0,n.jsxs)(t.p,{children:["After the ",(0,n.jsx)(t.code,{children:"SetEnvironment"})," is set, please refer to the sample execution."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Sample Run Image 2",src:s(878017).A+"",width:"713",height:"674"})}),"\n",(0,n.jsx)(t.h2,{id:"variables",children:"Variables"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Name"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsx)(t.tbody,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"ScanResult"}),(0,n.jsx)(t.td,{children:"This stores the scan result of the Malicious Software Removal Tool."})]})})]}),"\n",(0,n.jsx)(t.h2,{id:"edf",children:"EDF"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Name"}),(0,n.jsx)(t.th,{children:"Level"}),(0,n.jsx)(t.th,{children:"Type"}),(0,n.jsx)(t.th,{children:"Editable"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"MSRT Scanner Enable"}),(0,n.jsx)(t.td,{children:"Client"}),(0,n.jsx)(t.td,{children:"Flag"}),(0,n.jsx)(t.td,{children:"Yes"}),(0,n.jsxs)(t.td,{children:["This EDF check will enable the MSRT scan automation via the ",(0,n.jsx)(t.a,{href:"/docs/cwa/monitors/52caa288-ae6c-4047-a2d1-6d34b806d673",children:"Internal Monitor - MSRT Scanner Execute"}),"."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"MSRT Scanner Exclude"}),(0,n.jsx)(t.td,{children:"Location"}),(0,n.jsx)(t.td,{children:"Flag"}),(0,n.jsx)(t.td,{children:"Yes"}),(0,n.jsxs)(t.td,{children:["This EDF check will exclude the location from the MSRT scan automation via the ",(0,n.jsx)(t.a,{href:"/docs/cwa/monitors/52caa288-ae6c-4047-a2d1-6d34b806d673",children:"Internal Monitor - MSRT Scanner Execute"}),"."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"MSRT Scanner Exclude"}),(0,n.jsx)(t.td,{children:"Computer"}),(0,n.jsx)(t.td,{children:"Flag"}),(0,n.jsx)(t.td,{children:"Yes"}),(0,n.jsxs)(t.td,{children:["This EDF check will exclude the computer from the MSRT scan automation via the ",(0,n.jsx)(t.a,{href:"/docs/cwa/monitors/52caa288-ae6c-4047-a2d1-6d34b806d673",children:"Internal Monitor - MSRT Scanner Execute"}),"."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"MSRT Scanner Result"}),(0,n.jsx)(t.td,{children:"Client"}),(0,n.jsx)(t.td,{children:"Text"}),(0,n.jsx)(t.td,{children:"No"}),(0,n.jsxs)(t.td,{children:['This EDF stores the scan result, conclusive output, and date when the scanning occurred in the format example: "Infection Not Found -- M/DD/YYYY hh:mm',":ss",'".']})]})]})]}),"\n",(0,n.jsx)(t.h4,{id:"user-parameters",children:"User Parameters"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Name"}),(0,n.jsx)(t.th,{children:"Example"}),(0,n.jsx)(t.th,{children:"Required"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Send_ScanReport_To_Email"}),(0,n.jsxs)(t.td,{children:[(0,n.jsx)(t.a,{href:"mailto:abc@test.com",children:"abc@test.com"}),"; ",(0,n.jsx)(t.a,{href:"mailto:xyz@test.com",children:"xyz@test.com"})]}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"This stores the email addresses of users to whom the scan report of MSRT needs to be sent. Use a semicolon (;) to separate multiple email addresses so that a report can be sent to multiple users at a time."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Allow_Autofix"}),(0,n.jsx)(t.td,{children:"1"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsxs)(t.td,{children:["If this user parameter is set to 1, then if an infection is detected, the MSRT /F",":Y"," (force scan and automatic cleaning of infection) will be scheduled."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"SetEnvironment"}),(0,n.jsx)(t.td,{children:"1"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"If this is set, then it will import the EDFs."})]})]})]}),"\n",(0,n.jsx)(t.h2,{id:"global-parameter",children:"Global Parameter"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Name"}),(0,n.jsx)(t.th,{children:"Example"}),(0,n.jsx)(t.th,{children:"Required"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsx)(t.tbody,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Email_On_No_Infection"}),(0,n.jsx)(t.td,{children:"1 or 0"}),(0,n.jsx)(t.td,{children:"False"}),(0,n.jsx)(t.td,{children:"If set to 1, the user will receive an email for the no infection message with the attached report."})]})})]}),"\n",(0,n.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Script log"}),"\n",(0,n.jsxs)(t.li,{children:["Local file on the computer: ",(0,n.jsx)(t.code,{children:"C:/WINDOWS/debug/mrt.log"})]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},847434:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_1-9616200ca34e7bddf4fb59918e15201d.png"},878017:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_2-22b74a38cd3784060487b1b67da657c6.png"},28453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>l});var i=s(296540);const n={},a=i.createContext(n);function r(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);