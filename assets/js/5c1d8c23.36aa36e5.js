"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[69366],{776403:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"cwrmm/tasks/09fb13cb-05b1-4515-8041-128689d933ff","title":"Get-AutopilotHash","description":"This the RMMM version of Automate script [Get-AutopilotHash](<../../cwa/scripts/Get-AutopilotHash.md>)","source":"@site/docs/cwrmm/tasks/Get-AutopilotHash.md","sourceDirName":"cwrmm/tasks","slug":"/cwrmm/tasks/09fb13cb-05b1-4515-8041-128689d933ff","permalink":"/docs/cwrmm/tasks/09fb13cb-05b1-4515-8041-128689d933ff","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwrmm/tasks/Get-AutopilotHash.md","tags":[{"inline":false,"label":"Setup","permalink":"/docs/tags/setup","description":"Documents on setting up software and hardware configurations"}],"version":"current","frontMatter":{"id":"09fb13cb-05b1-4515-8041-128689d933ff","title":"Get-AutopilotHash","title_meta":"Get-AutopilotHash","keywords":["autopilot","hash","device","registration"],"description":"This the RMMM version of Automate script [Get-AutopilotHash](<../../cwa/scripts/Get-AutopilotHash.md>)","tags":["setup"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Get TPM Status","permalink":"/docs/cwrmm/tasks/678a70ca-c156-4568-95bd-f3df413433e3"},"next":{"title":"HP iLO - Health Report - Check","permalink":"/docs/cwrmm/tasks/e5e4ea6b-1d75-49c9-9569-26a213006bc7"}}');var a=s(474848),n=s(28453);const o={id:"09fb13cb-05b1-4515-8041-128689d933ff",title:"Get-AutopilotHash",title_meta:"Get-AutopilotHash",keywords:["autopilot","hash","device","registration"],description:"This the RMMM version of Automate script [Get-AutopilotHash](<../../cwa/scripts/Get-AutopilotHash.md>)",tags:["setup"],draft:!1,unlisted:!1},r=void 0,c={},d=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Task Creation",id:"task-creation",level:2},{value:"Task",id:"task",level:2},{value:"Row 1 Function: CMD Script",id:"row-1-function-cmd-script",level:3},{value:"Row 2: Function: Script Log",id:"row-2-function-script-log",level:3},{value:"Completed Task",id:"completed-task",level:2},{value:"Output",id:"output",level:2}];function l(e){const t={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,a.jsxs)(t.p,{children:["This the RMM version of Automate script ",(0,a.jsx)(t.a,{href:"/docs/cwa/scripts/9171549a-070a-4346-be90-393416713806",children:"Get-AutopilotHash"}),". It retrieves the Hardware Hash required for Autopilot device registration."]}),"\n",(0,a.jsx)(t.p,{children:"Note: The Hardware Hash cannot be stored in a custom field due to character limitations. Check the script logs to view the Hash key of a device."}),"\n",(0,a.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Sample Run",src:s(78577).A+"",width:"730",height:"456"})}),"\n",(0,a.jsx)(t.h2,{id:"task-creation",children:"Task Creation"}),"\n",(0,a.jsxs)(t.p,{children:["Create a new ",(0,a.jsx)(t.code,{children:"Script Editor"})," style script in the system to implement this task.",(0,a.jsx)(t.br,{}),"\n",(0,a.jsx)(t.img,{alt:"Create Script",src:s(438729).A+"",width:"319",height:"673"}),(0,a.jsx)(t.br,{}),"\n",(0,a.jsx)(t.img,{alt:"Script Creation",src:s(98646).A+"",width:"485",height:"279"})]}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Name:"})," Get - Autopilot Hash\r\n",(0,a.jsx)(t.strong,{children:"Description:"})," This task retrieves the Hardware Hash for Autopilot device registration.\r\n",(0,a.jsx)(t.strong,{children:"Category:"})," Custom",(0,a.jsx)(t.br,{}),"\n",(0,a.jsx)(t.img,{alt:"Category",src:s(904917).A+"",width:"466",height:"431"})]}),"\n",(0,a.jsx)(t.h2,{id:"task",children:"Task"}),"\n",(0,a.jsxs)(t.p,{children:["Navigate to the Script Editor section and start by adding a row. You can do this by clicking the ",(0,a.jsx)(t.code,{children:"Add Row"})," button at the bottom of the script page.",(0,a.jsx)(t.br,{}),"\n",(0,a.jsx)(t.img,{alt:"Add Row",src:s(200522).A+"",width:"302",height:"292"})]}),"\n",(0,a.jsxs)(t.p,{children:["A blank function will appear.",(0,a.jsx)(t.br,{}),"\n",(0,a.jsx)(t.img,{alt:"Blank Function",src:s(231105).A+"",width:"1000",height:"237"})]}),"\n",(0,a.jsx)(t.h3,{id:"row-1-function-cmd-script",children:"Row 1 Function: CMD Script"}),"\n",(0,a.jsxs)(t.p,{children:["Search and select the ",(0,a.jsx)(t.code,{children:"Command Prompt Script"})," function.",(0,a.jsx)(t.br,{}),"\n",(0,a.jsx)(t.img,{alt:"CMD Function",src:s(737566).A+"",width:"1164",height:"202"})]}),"\n",(0,a.jsxs)(t.p,{children:["The following function will pop up on the screen:",(0,a.jsx)(t.br,{}),"\n",(0,a.jsx)(t.img,{alt:"Function Popup",src:s(455879).A+"",width:"958",height:"612"})]}),"\n",(0,a.jsxs)(t.p,{children:["Paste in the following CMD script and set the expected time of script execution to 300 seconds. Click the ",(0,a.jsx)(t.code,{children:"Save"})," button."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-powershell",children:"\r\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -ExecutionPolicy Bypass -Command \"try {$session = New-CimSession;$devDetail = Get-CimInstance -CimSession $session -Namespace root/cimv2/mdm/dmmap -Class MDM_DevDetail_Ext01 -Filter \\\"InstanceID='Ext' AND ParentID='./DevDetail'\\\";if ($devDetail) {$hash = $devDetail.DeviceHardwareData } else {$hash = ''};if ($hash -match '^[A-Za-z0-9+/=,.\\-\\s]+$') {$hash} else { throw 'Failed to fetch Autopilot Hash'}}catch { return 'Failed to fetch Autopilot Hash'}\"\n"})}),"\n",(0,a.jsx)(t.h3,{id:"row-2-function-script-log",children:"Row 2: Function: Script Log"}),"\n",(0,a.jsxs)(t.p,{children:["In the script log message, simply type ",(0,a.jsx)(t.code,{children:"%output%"})," so that the script will send the results of the PowerShell script above to the output on the Automation tab for the target device.",(0,a.jsx)(t.br,{}),"\n",(0,a.jsx)(t.img,{alt:"Script Log",src:s(313390).A+"",width:"338",height:"272"})]}),"\n",(0,a.jsx)(t.h2,{id:"completed-task",children:"Completed Task"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Completed Task",src:s(180712).A+"",width:"1149",height:"302"})}),"\n",(0,a.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"Script Logs"}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},904917:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image1-36baca9a017c8abccbd5bf3d53d83d0f.png"},737566:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image2-fc3afc96361334bfd3a4e73b52f40124.png"},455879:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image3-002b16a8cd46d9de07af5279d5aafd93.png"},180712:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image4-f7228149a0c04b721c232533572f6249.png"},78577:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image5-2505e83443e70f4714bc9d8b4e328ff3.png"},200522:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_11-f9f7e1395f9d88161e6e54cf71936f32.png"},231105:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_12-8ae4adc0439b09df626c3427b22db7f6.png"},313390:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_15-39c2357a125d769e7f35e934d2dd5e61.png"},438729:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_3-90a2d4880463c30ae83540ced3c30561.png"},98646:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image_4-69211544b73189ff8535050361ae8f20.png"},28453:(e,t,s)=>{s.d(t,{R:()=>o,x:()=>r});var i=s(296540);const a={},n=i.createContext(a);function o(e){const t=i.useContext(n);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),i.createElement(n.Provider,{value:t},e.children)}}}]);