"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[23520],{669802:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"cwa/scripts/f9a0c7b8-2807-4e08-b1b7-c9342b89a493","title":"Automate Agent - Duplicate Serial Number - Auto Retire Email,Ticket","description":"This document provides a comprehensive guide on retiring duplicate agents in the ConnectWise Automate environment. It explains how the script identifies duplicate agents based on their serial number, name, and client affiliation, and outlines the process for keeping only the most recent agent. Additionally, it covers the configuration options for email notifications and ticket generation for retired agents.","source":"@site/docs/cwa/scripts/Automate Agent - Duplicate Serial Number - Auto Retire Email,Ticket.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/f9a0c7b8-2807-4e08-b1b7-c9342b89a493","permalink":"/docs/cwa/scripts/f9a0c7b8-2807-4e08-b1b7-c9342b89a493","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Automate Agent - Duplicate Serial Number - Auto Retire Email,Ticket.md","tags":[{"inline":false,"label":"Email","permalink":"/docs/tags/email","description":"Documents about email systems and their management"},{"inline":false,"label":"Ticketing","permalink":"/docs/tags/ticketing","description":"Documents related to ticketing systems and IT support management"},{"inline":false,"label":"Windows","permalink":"/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"f9a0c7b8-2807-4e08-b1b7-c9342b89a493","title":"Automate Agent - Duplicate Serial Number - Auto Retire Email,Ticket","title_meta":"Automate Agent - Duplicate Serial Number - Auto Retire Email,Ticket","keywords":["duplicate","agents","automate","retire","email","ticketing"],"description":"This document provides a comprehensive guide on retiring duplicate agents in the ConnectWise Automate environment. It explains how the script identifies duplicate agents based on their serial number, name, and client affiliation, and outlines the process for keeping only the most recent agent. Additionally, it covers the configuration options for email notifications and ticket generation for retired agents.","tags":["email","ticketing","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Automate Agent - Duplicate Serial Number - Audit Only Email,Ticket","permalink":"/docs/cwa/scripts/44296eb1-9cdc-4833-ac40-7f390eac3a7f"},"next":{"title":"Automate Agent - Duplicate Serial Number - Retire","permalink":"/docs/cwa/scripts/0282785b-f740-490a-8e5c-75e2de10088a"}}');var s=i(474848),r=i(28453);const a={id:"f9a0c7b8-2807-4e08-b1b7-c9342b89a493",title:"Automate Agent - Duplicate Serial Number - Auto Retire Email,Ticket",title_meta:"Automate Agent - Duplicate Serial Number - Auto Retire Email,Ticket",keywords:["duplicate","agents","automate","retire","email","ticketing"],description:"This document provides a comprehensive guide on retiring duplicate agents in the ConnectWise Automate environment. It explains how the script identifies duplicate agents based on their serial number, name, and client affiliation, and outlines the process for keeping only the most recent agent. Additionally, it covers the configuration options for email notifications and ticket generation for retired agents.",tags:["email","ticketing","windows"],draft:!1,unlisted:!1},c=void 0,l={},d=[{value:"Summary",id:"summary",level:2},{value:"Update Notice: 27 December 2024",id:"update-notice-27-december-2024",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Schedule",id:"schedule",level:2},{value:"System Property",id:"system-property",level:2},{value:"User Parameters",id:"user-parameters",level:2},{value:"Output",id:"output",level:2},{value:"Ticketing",id:"ticketing",level:2}];function o(e){const t={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsx)(t.p,{children:"The script retires duplicate agents from the Automate environment. A duplicate agent is identified based on its serial number, name, and client affiliation. Agents are removed based on their last contact with the Automate server, keeping only the agent with the most recent date. The script also emails or generates tickets for the list of duplicate agents that have been retired."}),"\n",(0,s.jsx)(t.p,{children:"This is a client script and will work only for physical machines. Virtual machines are excluded to prevent any accidental deletion. It can be set up to email the list of duplicate agents that have been retired by the script to any email address, or a ticket can also be generated."}),"\n",(0,s.jsx)(t.h2,{id:"update-notice-27-december-2024",children:"Update Notice: 27 December 2024"}),"\n",(0,s.jsx)(t.p,{children:"Introduced the following system properties:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"_sysDuplicateAgent_Contact_Threshold"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"_sysDuplicateAgent_Retire_VM"})}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["Run the script with the ",(0,s.jsx)(t.code,{children:"Set_Environment"})," parameter to import the newly introduced properties."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Update Notice Image",src:i(573113).A+"",width:"527",height:"468"})}),"\n",(0,s.jsxs)(t.p,{children:["Remove the ",(0,s.jsx)(t.code,{children:"Automate Agent - Duplicate Serial Number - Retire"})," script if it exists."]}),"\n",(0,s.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,s.jsxs)(t.p,{children:["Set the parameter ",(0,s.jsx)(t.code,{children:"Set_Environment"})," for the first execution."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Sample Run Image",src:i(717026).A+"",width:"483",height:"427"})}),"\n",(0,s.jsx)(t.p,{children:"Specify the email address where you would like to receive the output of the result."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Email Specification Image",src:i(938155).A+"",width:"487",height:"430"})}),"\n",(0,s.jsx)(t.h2,{id:"schedule",children:"Schedule"}),"\n",(0,s.jsx)(t.p,{children:"It is suggested to run the script once per schedule."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Schedule Image",src:i(988244).A+"",width:"1000",height:"441"})}),"\n",(0,s.jsx)(t.h2,{id:"system-property",children:"System Property"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Name"}),(0,s.jsx)(t.th,{children:"Required"}),(0,s.jsx)(t.th,{children:"Example"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"_sysDuplicateAgentEmailAddress"})}),(0,s.jsx)(t.td,{children:"False"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.a,{href:"mailto:xyz@something.com",children:"xyz@something.com"})}),(0,s.jsx)(t.td,{children:"Universal email address where you would like to receive the list of duplicate agents that have been retired by the script."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"_sysDuplicateAgentTicketingEnable"})}),(0,s.jsx)(t.td,{children:"False"}),(0,s.jsx)(t.td,{children:"1"}),(0,s.jsx)(t.td,{children:"Set to '1' if you would like to receive a ticket with a list of duplicate agents; otherwise, leave it blank or set to '0'."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"_sysDuplicateAgentTicketCategory"})}),(0,s.jsx)(t.td,{children:"False"}),(0,s.jsx)(t.td,{children:"234"}),(0,s.jsxs)(t.td,{children:["Specify the ticket creation category to direct tickets to the correct board in Manage. ",(0,s.jsx)(t.strong,{children:"Note:"})," If no ticket creation category is mentioned, the script will use the universal ticket creation category in the global System property ",(0,s.jsx)(t.code,{children:"MonitorTicketCategory"}),"."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"_sysDuplicateAgent_NoDuplicate_Ticketing"})}),(0,s.jsx)(t.td,{children:"False"}),(0,s.jsx)(t.td,{children:"0"}),(0,s.jsx)(t.td,{children:"Set to '1' to receive tickets/emails when there are no duplicate agents. The default value is '0', meaning the script will not generate tickets/emails if no duplicate agents are found."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"_sysDuplicateAgent_Ticketing_DefaultClientid"})}),(0,s.jsx)(t.td,{children:"False"}),(0,s.jsx)(t.td,{children:"1"}),(0,s.jsx)(t.td,{children:"Client ID under which tickets should be generated. The default value is '1', meaning tickets will be generated under the client whose client ID is '1' in the environment."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"_sysDuplicateAgent_Contact_Threshold"})}),(0,s.jsx)(t.td,{children:"False"}),(0,s.jsx)(t.td,{children:"15"}),(0,s.jsx)(t.td,{children:"Define the threshold for the number of days after which duplicate agents should be retired. If this property is not specified, duplicate agents with a last contact time of more than an hour will be automatically removed."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"_sysDuplicateAgent_Retire_VM"})}),(0,s.jsx)(t.td,{children:"False"}),(0,s.jsx)(t.td,{children:"1"}),(0,s.jsx)(t.td,{children:"Set to '1' to retire duplicate virtual machines as well (based on serial number). If nothing is mentioned, the script will not retire duplicate virtual machines."})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"user-parameters",children:"User Parameters"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Name"}),(0,s.jsx)(t.th,{children:"Required"}),(0,s.jsx)(t.th,{children:"Example"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Email_Address"})}),(0,s.jsx)(t.td,{children:"False"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.a,{href:"mailto:xyz@something.com",children:"xyz@something.com"})}),(0,s.jsxs)(t.td,{children:["Provide an email address where you would like to receive the list of duplicate agents retired by the script. ",(0,s.jsx)(t.strong,{children:"Note:"})," If nothing is mentioned, the script will check the system property ",(0,s.jsx)(t.code,{children:"_sysDuplicateAgentEmailAddress"}),". If an email address is specified there, it will send an email to it; otherwise, it will not send any email."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Set_Environment"})}),(0,s.jsx)(t.td,{children:"True (For First execution)"}),(0,s.jsx)(t.td,{children:"1"}),(0,s.jsx)(t.td,{children:"Set to '1' to create the system properties if they are not already created in the environment. This must be set to '1' for the first execution."})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Script Logs"}),"\n",(0,s.jsx)(t.li,{children:"Ticketing"}),"\n",(0,s.jsx)(t.li,{children:"Email"}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"ticketing",children:"Ticketing"}),"\n",(0,s.jsxs)(t.p,{children:["Tickets will only be generated if the system property ",(0,s.jsx)(t.code,{children:"_sysDuplicateAgentTicketingEnable"})," is set to '1'."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Subject:"})," ",(0,s.jsx)(t.code,{children:"List of Retired Duplicate Agents Based on Serial Numbers"})]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Body:"})," ",(0,s.jsx)(t.code,{children:'"%ScriptName% ran on the machines and has retired the following duplicate agents:@Machines@"'})]}),"\n",(0,s.jsx)(t.p,{children:"In case there are no duplicate serial numbers:"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"No duplicate machines identified based on serial number."})})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},573113:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/image_1-4df6b60c7fd7d069538de16532b6a57b.png"},717026:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/image_2-e1e6450589e6f545849a41e030693251.png"},938155:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/image_3-17568ed720109a3eae4f9b0c68af5505.png"},988244:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/image_4-cd8f53679309fddc8217eb15c3e0f668.png"},28453:(e,t,i)=>{i.d(t,{R:()=>a,x:()=>c});var n=i(296540);const s={},r=n.createContext(s);function a(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);