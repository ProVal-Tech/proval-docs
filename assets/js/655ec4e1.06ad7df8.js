"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[6217],{767870:(e,t,c)=>{c.r(t),c.d(t,{assets:()=>n,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"vsa/procedures/c0c1b5a3-0e2d-4ed9-9c0a-926ce2181c7c","title":"Office C2R Automatic Update Repair","description":"This document outlines the process to repair the Office Click2Run Automatic Update on an endpoint using the ProVal Agnostic Solution. It includes example logs and details on the execution of the repair procedure.","source":"@site/docs/vsa/procedures/Office C2R Automatic Update Repair.md","sourceDirName":"vsa/procedures","slug":"/vsa/procedures/c0c1b5a3-0e2d-4ed9-9c0a-926ce2181c7c","permalink":"/proval-docs/docs/vsa/procedures/c0c1b5a3-0e2d-4ed9-9c0a-926ce2181c7c","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/vsa/procedures/Office C2R Automatic Update Repair.md","tags":[{"inline":false,"label":"Office 365","permalink":"/proval-docs/docs/tags/office-365","description":"Documents concerning Office 365 applications and cloud services"},{"inline":false,"label":"Software","permalink":"/proval-docs/docs/tags/software","description":"Documents related to software applications and their lifecycle management"},{"inline":false,"label":"Update","permalink":"/proval-docs/docs/tags/update","description":"Documents discussing software and system updates and their management"}],"version":"current","frontMatter":{"id":"c0c1b5a3-0e2d-4ed9-9c0a-926ce2181c7c","title":"Office C2R Automatic Update Repair","title_meta":"Office C2R Automatic Update Repair","keywords":["office","update","repair","automatic","click2run"],"description":"This document outlines the process to repair the Office Click2Run Automatic Update on an endpoint using the ProVal Agnostic Solution. It includes example logs and details on the execution of the repair procedure.","tags":["office365","software","update"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Office Activation Status Audit","permalink":"/proval-docs/docs/vsa/procedures/cb7d4500-3e57-454a-8c47-3c31bf79db80"},"next":{"title":"Office C2R Update Schedule Select (macOS)","permalink":"/proval-docs/docs/vsa/procedures/bf426f89-7da1-4f4b-88b7-03983136458c"}}');var d=c(474848),s=c(28453);const a={id:"c0c1b5a3-0e2d-4ed9-9c0a-926ce2181c7c",title:"Office C2R Automatic Update Repair",title_meta:"Office C2R Automatic Update Repair",keywords:["office","update","repair","automatic","click2run"],description:"This document outlines the process to repair the Office Click2Run Automatic Update on an endpoint using the ProVal Agnostic Solution. It includes example logs and details on the execution of the repair procedure.",tags:["office365","software","update"],draft:!1,unlisted:!1},i=void 0,n={},o=[{value:"Summary",id:"summary",level:2},{value:"Example Agent Procedure Log",id:"example-agent-procedure-log",level:2},{value:"Output",id:"output",level:2}];function l(e){const t={a:"a",br:"br",h2:"h2",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,d.jsxs)(t.p,{children:["This document describes the process to repair the Office Click2Run Automatic Update on an endpoint using the ProVal Agnostic Solution. For detailed instructions, refer to:",(0,d.jsx)(t.br,{}),"\n",(0,d.jsx)(t.a,{href:"/proval-docs/docs/powershell/ps-repair-officeautomaticupdate",children:"SWM - Software Configuration - Agnostic - Repair-OfficeAutomaticUpdate"})]}),"\n",(0,d.jsx)(t.h2,{id:"example-agent-procedure-log",children:"Example Agent Procedure Log"}),"\n",(0,d.jsxs)(t.table,{children:[(0,d.jsx)(t.thead,{children:(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.th,{children:"Time"}),(0,d.jsx)(t.th,{children:"Action"}),(0,d.jsx)(t.th,{children:"Result"}),(0,d.jsx)(t.th,{children:"User"})]})}),(0,d.jsxs)(t.tbody,{children:[(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:50 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Automatic Update Repair"}),(0,d.jsx)(t.td,{children:"Success THEN"}),(0,d.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:49 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Automatic Update Repair-0001"}),(0,d.jsx)(t.td,{children:"Log: 2023-02-21 08:56:15 INIT ----------------------------------------------- 2023-02-21 08:56:15 INIT Repair-OfficeAutomaticUpdate 2023-02-21 08:56:15 INIT System: DEV 2023-02-21 08:56:15 INIT User: DEV$ 2023-02-21 08:56:15 INIT OS Bitness: AMD64 2023-02-21 08:56:15 INIT PowerShell Bitness: 64 2023-02-21 08:56:15 INIT PowerShell Version: 5 2023-02-21 08:56:15 INIT ----------------------------------------------- 2023-02-21 09:08:43 INIT ----------------------------------------------- 2023-02-21 09:08:43 INIT Repair-OfficeAutomaticUpdate 2023-02-21 09:08:43 INIT System: DEV 2023-02-21 09:08:43 INIT User: DEV$ 2023-02-21 09:08:43 INIT OS Bitness: AMD64 2023-02-21 09:08:43 INIT PowerShell Bitness: 64 2023-02-21 09:08:43 INIT PowerShell Version: 5 2023-02-21 09:08:43 INIT ----------------------------------------------- 2023-02-21 09:08:43 WARN RESOLVED ISSUE: UnmanagedUpdateUrl was empty..."}),(0,d.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:49 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Automatic Update Repair"}),(0,d.jsx)(t.td,{children:"Raw PS1 Data: 2023-02-21 09:08:43 WARN RESOLVED ISSUE: UnmanagedUpdateUrl was empty. Set the value to the Microsoft Current Channel URI."}),(0,d.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:49 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)"}),(0,d.jsx)(t.td,{children:"Success THEN"}),(0,d.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:49 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0016"}),(0,d.jsxs)(t.td,{children:["Powershell command complete. Results returned to global variable #global",":psresult","# and saved in Agent's Documents tab of server."]}),(0,d.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:49 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0016"}),(0,d.jsx)(t.td,{children:"Informational: GetFile command overwrote the server file C://Kaseya//UserProfiles//229175768944442//GetFiles//..//docs//psoutput.txt with the new contents from c://provaltech//psoutput.txt in THEN step 3."}),(0,d.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:42 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0011"}),(0,d.jsx)(t.td,{children:'Executing 64-bit Powershell command as System: "" -command "%ProgramData%//_automation//AgentProcedure//OfficeAutomaticUpdateRepair//Repair-OfficeAutomaticUpdate.ps1" >"c://provaltech//psoutputtmp.txt"'}),(0,d.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:42 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0013"}),(0,d.jsx)(t.td,{children:"Sending output to global variable."}),(0,d.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:42 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0008"}),(0,d.jsx)(t.td,{children:"Custom commands detected as %ProgramData%//_automation//AgentProcedure//OfficeAutomaticUpdateRepair//Repair-OfficeAutomaticUpdate.ps1"}),(0,d.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:42 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0003"}),(0,d.jsx)(t.td,{children:"No powershell file variable detected."}),(0,d.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:40 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command (64-bit, Run As System)-0002"}),(0,d.jsx)(t.td,{children:"Powershell is present."}),(0,d.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:38 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command"}),(0,d.jsx)(t.td,{children:"Success THEN"}),(0,d.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:37 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0011"}),(0,d.jsx)(t.td,{children:"Powershell command completed!"}),(0,d.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:35 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0011"}),(0,d.jsxs)(t.td,{children:['Executing powershell "" -Command "New-Item -Type Directory -Path $env',":ProgramData",'//_automation//AgentProcedure -name OfficeAutomaticUpdateRepair" ""']}),(0,d.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:35 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0010"}),(0,d.jsx)(t.td,{children:"Not sending output to variable."}),(0,d.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:35 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0008"}),(0,d.jsxs)(t.td,{children:['New command variable is: -Command "New-Item -Type Directory -Path $env',":ProgramData",'//_automation//AgentProcedure -name OfficeAutomaticUpdateRepair"']}),(0,d.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:35 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0008"}),(0,d.jsxs)(t.td,{children:["Custom commands detected as New-Item -Type Directory -Path $env",":ProgramData","//_automation//AgentProcedure -name OfficeAutomaticUpdateRepair"]}),(0,d.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:31 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Execute Powershell Command-0002"}),(0,d.jsx)(t.td,{children:"Powershell is present."}),(0,d.jsx)(t.td,{children:"provaltech.com/dan.hicks"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:"9:08:23 am 21-Feb-23"}),(0,d.jsx)(t.td,{children:"Run Now - Automatic Update Repair"}),(0,d.jsx)(t.td,{children:"Admin provaltech.com/dan.hicks scheduled procedure Run Now - Automatic Update Repair to run at Feb 21 2023 9:08 AM"}),(0,d.jsx)(t.td,{})]})]})]}),"\n",(0,d.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,d.jsx)(t.p,{children:"Agent Procedure Log"})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,d.jsx)(t,{...e,children:(0,d.jsx)(l,{...e})}):l(e)}},28453:(e,t,c)=>{c.d(t,{R:()=>a,x:()=>i});var r=c(296540);const d={},s=r.createContext(d);function a(e){const t=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:a(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);