"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[97061],{522640:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"cwa/monitors/561f5be7-feb7-4c6a-b7b3-5ca93b39a40c","title":"Bitlocker - Encryption Type Incorrect","description":"This document provides an overview of a Bitlocker monitoring script that identifies target machines based on specific conditions related to Bitlocker settings and client configurations. It includes SQL queries, dependencies, and guidelines for targeting the Bitlocker solution.","source":"@site/docs/cwa/monitors/Bitlocker - Encryption Type Incorrect.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/561f5be7-feb7-4c6a-b7b3-5ca93b39a40c","permalink":"/docs/cwa/monitors/561f5be7-feb7-4c6a-b7b3-5ca93b39a40c","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Bitlocker - Encryption Type Incorrect.md","tags":[{"inline":false,"label":"Compliance","permalink":"/docs/tags/compliance","description":"Documents related to compliance with industry standards and regulations"},{"inline":false,"label":"Database","permalink":"/docs/tags/database","description":"Documents related to database management systems and operations"},{"inline":false,"label":"Encryption","permalink":"/docs/tags/encryption","description":"Documents discussing encryption technologies for data protection"},{"inline":false,"label":"Security","permalink":"/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"}],"version":"current","frontMatter":{"id":"561f5be7-feb7-4c6a-b7b3-5ca93b39a40c","title":"Bitlocker - Encryption Type Incorrect","title_meta":"Bitlocker - Encryption Type Incorrect","keywords":["bitlocker","monitoring","encryption","security","compliance"],"description":"This document provides an overview of a Bitlocker monitoring script that identifies target machines based on specific conditions related to Bitlocker settings and client configurations. It includes SQL queries, dependencies, and guidelines for targeting the Bitlocker solution.","tags":["compliance","database","encryption","security"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Backup Exec - No successful backups in 3 days","permalink":"/docs/cwa/monitors/abddfc3a-9f1b-4356-a62c-3475cdb32c96"},"next":{"title":"Bitlocker - Fully Decrypted Detection","permalink":"/docs/cwa/monitors/d4cbb2a9-7658-4a6c-924d-208827e4e961"}}');var r=n(474848),a=n(28453);const o={id:"561f5be7-feb7-4c6a-b7b3-5ca93b39a40c",title:"Bitlocker - Encryption Type Incorrect",title_meta:"Bitlocker - Encryption Type Incorrect",keywords:["bitlocker","monitoring","encryption","security","compliance"],description:"This document provides an overview of a Bitlocker monitoring script that identifies target machines based on specific conditions related to Bitlocker settings and client configurations. It includes SQL queries, dependencies, and guidelines for targeting the Bitlocker solution.",tags:["compliance","database","encryption","security"],draft:!1,unlisted:!1},s=void 0,c={},d=[{value:"Summary",id:"summary",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Target",id:"target",level:2},{value:"Translated SQL",id:"translated-sql",level:2},{value:"Ticketing",id:"ticketing",level:2}];function l(e){const t={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(t.p,{children:"This monitor will return any target machine whose client has the 'Bitlocker Monitoring' EDF checked, and the target's 'Bitlocker Monitoring Exclusion' is not checked, and its 'C' drive is listed as a mount point in 'plugin_proval_bitlocker_audit' under the following conditions:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"If the client level 'Bitlocker XTS-AES 256' EDF is checked and the value for Encryption Method is not NONE and not 'XtsAes256', then return that target."}),"\n",(0,r.jsx)(t.li,{children:"If the client level 'Bitlocker XTS-AES 256' EDF is not checked and the value for Encryption Method is not NONE and not 'Aes256', then return that target."}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"/docs/cwa/tables/bb3eaac8-80f6-43b9-90f1-75886c06bf14",children:"SEC - Encryption - Custom Table - plugin_proval_bitlocker_audit"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"/docs/solutions/f41e4d71-7074-4c28-8246-b8e3036c1212",children:"SEC - Encryption - Solution - Bitlocker"})}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"target",children:"Target"}),"\n",(0,r.jsx)(t.p,{children:"Please follow the recommended target for the Bitlocker solution."}),"\n",(0,r.jsx)(t.h2,{id:"translated-sql",children:"Translated SQL"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sql",children:"SELECT \r\n   ppba.EncryptionMethod as TestValue,\r\n   computers.name as IdentityField,\r\n   computers.computerid,\r\n   clients.name as `Client Name`,\r\n   computers.domain as `Computer Domain`,\r\n   computers.username as `Computer User`,\r\n   IFNULL(IFNULL(edfAssigned1.Value,edfDefault1.value),'0') as `Computer - Client - Extra Data Field - Security Compliance - Bitlocker Monitoring`,\r\n   IFNULL(IFNULL(edfAssigned2.Value,edfDefault2.value),'0') as `Computer - Extra Data Field - Security Compliance - Bitlocker Monitoring Exclusion`,\r\n   IFNULL(IFNULL(edfAssigned3.Value,edfDefault3.value),'0') as `Computer - Client - Extra Data Field - Security Compliance - Bitlocker XTS-AES 256`,\r\n   ppba.MountPoint,\r\n   a.noalerts,\r\n   a.uptimestart,\r\n   a.uptimeend,\r\n   computers.DateAdded\r\nFROM Computers \r\nLEFT JOIN inv_operatingsystem ON (Computers.ComputerId=inv_operatingsystem.ComputerId)\r\nLEFT JOIN Clients ON (Computers.ClientId=Clients.ClientId)\r\nLEFT JOIN Locations ON (Computers.LocationId=Locations.LocationID)\r\nLEFT JOIN plugin_proval_bitlocker_audit ppba ON computers.ComputerID = ppba.ComputerID\r\nLEFT JOIN agentcomputerdata a ON computers.computerid = a.computerid\r\nLEFT JOIN ExtraFieldData edfAssigned1 ON (edfAssigned1.id=Clients.ClientId and edfAssigned1.ExtraFieldId =(Select ExtraField.id FROM ExtraField WHERE `Name` = 'Bitlocker Monitoring'))\r\nLEFT JOIN ExtraFieldData edfDefault1 ON (edfDefault1.id=0 and edfDefault1.ExtraFieldId =(Select ExtraField.id FROM ExtraField WHERE `Name` = 'Bitlocker Monitoring'))\r\nLEFT JOIN ExtraFieldData edfAssigned3 ON (edfAssigned3.id=Clients.ClientId and edfAssigned3.ExtraFieldId =(Select ExtraField.id FROM ExtraField WHERE `Name` = 'Bitlocker XTS-AES 256'))\r\nLEFT JOIN ExtraFieldData edfDefault3 ON (edfDefault3.id=0 and edfDefault3.ExtraFieldId =(Select ExtraField.id FROM ExtraField WHERE `Name` = 'Bitlocker XTS-AES 256'))\r\nLEFT JOIN ExtraFieldData edfAssigned2 ON (edfAssigned2.id=Computers.ComputerId and edfAssigned2.ExtraFieldId =(Select ExtraField.id FROM ExtraField WHERE `Name` = 'Bitlocker Monitoring Exclusion'))\r\nLEFT JOIN ExtraFieldData edfDefault2 ON (edfDefault2.id=0 and edfDefault2.ExtraFieldId =(Select ExtraField.id FROM ExtraField WHERE LTGuid='Bitlocker Monitoring Exclusion'))\r\nWHERE \r\n((((IFNULL(IFNULL(edfAssigned1.Value,edfDefault1.value),'0') <> '0') AND (IFNULL(IFNULL(edfAssigned2.Value,edfDefault2.value),'0')='0')))) \r\nAND ( \r\n   (ppba.MountPoint = 'C:') \r\n   AND ( \r\n       CASE WHEN (IFNULL(IFNULL(edfAssigned3.Value,edfDefault3.value),'0') = '1') THEN \r\n       (ppba.`EncryptionMethod` != 'NONE' AND ppba.`EncryptionMethod` != 'XtsAes256') \r\n       ELSE (ppba.`EncryptionMethod` != 'NONE' AND ppba.`EncryptionMethod` != 'Aes256') \r\n       END \r\n   ) \r\n) AND ( \r\n       computers.DateAdded < DATE_SUB(NOW(), INTERVAL 7 DAY) \r\n)\n"})}),"\n",(0,r.jsx)(t.h2,{id:"ticketing",children:"Ticketing"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Ticketing Image",src:n(618795).A+"",width:"1000",height:"489"})})]})}function u(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},618795:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image_1-e69db2ecaf29d506a9a28a3ab1537312.png"},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>s});var i=n(296540);const r={},a=i.createContext(r);function o(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);