"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[92347],{146891:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"cwrmm/tasks/1f9c0a54-177b-46a1-8a8d-7817b3997036","title":"Get Latest Installed Cumulative Update","description":"This document outlines the steps to create a task that fetches the latest installed Cumulative Update and the Full Build Number of a Windows computer using a PowerShell script within a ConnectWise Automate environment.","source":"@site/docs/cwrmm/tasks/Get Latest Installed Cumulative Update.md","sourceDirName":"cwrmm/tasks","slug":"/cwrmm/tasks/1f9c0a54-177b-46a1-8a8d-7817b3997036","permalink":"/proval-docs/docs/cwrmm/tasks/1f9c0a54-177b-46a1-8a8d-7817b3997036","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwrmm/tasks/Get Latest Installed Cumulative Update.md","tags":[{"inline":false,"label":"Update","permalink":"/proval-docs/docs/tags/update","description":"Documents discussing software and system updates and their management"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"1f9c0a54-177b-46a1-8a8d-7817b3997036","title":"Get Latest Installed Cumulative Update","title_meta":"Get Latest Installed Cumulative Update","keywords":["windows","update","cumulative","build","script"],"description":"This document outlines the steps to create a task that fetches the latest installed Cumulative Update and the Full Build Number of a Windows computer using a PowerShell script within a ConnectWise Automate environment.","tags":["update","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Get Crystal Disk Info (Disk Health)","permalink":"/proval-docs/docs/cwrmm/tasks/37220488-64d2-4de9-8e65-1cd53f5dee3b"},"next":{"title":"Get TPM Status","permalink":"/proval-docs/docs/cwrmm/tasks/678a70ca-c156-4568-95bd-f3df413433e3"}}');var a=s(474848),i=s(28453);const r={id:"1f9c0a54-177b-46a1-8a8d-7817b3997036",title:"Get Latest Installed Cumulative Update",title_meta:"Get Latest Installed Cumulative Update",keywords:["windows","update","cumulative","build","script"],description:"This document outlines the steps to create a task that fetches the latest installed Cumulative Update and the Full Build Number of a Windows computer using a PowerShell script within a ConnectWise Automate environment.",tags:["update","windows"],draft:!1,unlisted:!1},o=void 0,l={},c=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Task Creation",id:"task-creation",level:2},{value:"Task",id:"task",level:2},{value:"Row 1 Function: PowerShell Script",id:"row-1-function-powershell-script",level:3},{value:"Row 2: Function: Script Log",id:"row-2-function-script-log",level:3},{value:"Completed Task",id:"completed-task",level:2},{value:"Output",id:"output",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,a.jsx)(t.p,{children:"The purpose of this task is to fetch the latest installed Cumulative Update and the Full Build Number of a Windows computer."}),"\n",(0,a.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Sample Run Image 1",src:s(642704).A+"",width:"734",height:"463"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Sample Run Image 2",src:s(754927).A+"",width:"900",height:"708"})}),"\n",(0,a.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.a,{href:"https://file.provaltech.com/repo/script/Get-LatestInstalledCU.ps1",children:"Get-LatestInstalledCU.ps1"})}),"\n",(0,a.jsx)(t.h2,{id:"task-creation",children:"Task Creation"}),"\n",(0,a.jsxs)(t.p,{children:["Create a new ",(0,a.jsx)(t.code,{children:"Script Editor"})," style script in the system to implement this task."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Task Creation Image",src:s(715910).A+"",width:"319",height:"673"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Task Creation Image 2",src:s(497117).A+"",width:"485",height:"279"})}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Name:"})," Get Latest Installed Cumulative Update"]}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Description:"})," The purpose of this task is to fetch the latest installed Cumulative Update and the Full Build Number of a Windows computer."]}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Category:"})," Custom"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Task Creation Image 3",src:s(64084).A+"",width:"602",height:"326"})}),"\n",(0,a.jsx)(t.h2,{id:"task",children:"Task"}),"\n",(0,a.jsxs)(t.p,{children:["Navigate to the Script Editor section and start by adding a row. You can do this by clicking the ",(0,a.jsx)(t.code,{children:"Add Row"})," button at the bottom of the script page."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Add Row Image",src:s(359379).A+"",width:"302",height:"292"})}),"\n",(0,a.jsx)(t.p,{children:"A blank function will appear."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Blank Function Image",src:s(720522).A+"",width:"1000",height:"237"})}),"\n",(0,a.jsx)(t.h3,{id:"row-1-function-powershell-script",children:"Row 1 Function: PowerShell Script"}),"\n",(0,a.jsxs)(t.p,{children:["Search and select the ",(0,a.jsx)(t.code,{children:"PowerShell Script"})," function."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Select PowerShell Script Image",src:s(856856).A+"",width:"1000",height:"242"})}),"\n",(0,a.jsx)(t.p,{children:"The following function will pop up on the screen:"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"PowerShell Function Image",src:s(129569).A+"",width:"951",height:"597"})}),"\n",(0,a.jsxs)(t.p,{children:["Paste in the following PowerShell script and set the expected time of script execution to ",(0,a.jsx)(t.code,{children:"900"})," seconds. Click the ",(0,a.jsx)(t.code,{children:"Save"})," button."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:'#region Setup - Variables\r\n$ProjectName = \'Get-LatestInstalledCU\'\r\n[Net.ServicePointManager]::SecurityProtocol = [enum]::ToObject([Net.SecurityProtocolType], 3072)\r\n$BaseURL = \'https://file.provaltech.com/repo\'\r\n$PS1URL = "$BaseURL/script/$ProjectName.ps1"\r\n$WorkingDirectory = "C:/ProgramData/_automation/script/$ProjectName"\r\n$PS1Path = "$WorkingDirectory/$ProjectName.ps1"\r\n$Workingpath = $WorkingDirectory\r\n$LogPath = "$WorkingDirectory/$ProjectName-log.txt"\r\n$ErrorLogPath = "$WorkingDirectory/$ProjectName-Error.txt"\r\n#endregion\r\n\r\n#region Setup - Folder Structure\r\nNew-Item -Path $WorkingDirectory -ItemType Directory -ErrorAction SilentlyContinue | Out-Null\r\n$response = Invoke-WebRequest -Uri $PS1URL -UseBasicParsing\r\nif (($response.StatusCode -ne 200) -and (!(Test-Path -Path $PS1Path))) {\r\n    throw "No pre-downloaded script exists and the script \'$PS1URL\' failed to download. Exiting."\r\n} elseif ($response.StatusCode -eq 200) {\r\n    Remove-Item -Path $PS1Path -ErrorAction SilentlyContinue\r\n    [System.IO.File]::WriteAllLines($PS1Path, $response.Content)\r\n}\r\nif (!(Test-Path -Path $PS1Path)) {\r\n    throw \'An error occurred and the script was unable to be downloaded. Exiting.\'\r\n}\r\n#endregion\r\n\r\n#region Execution\r\n$output = & $PS1Path\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:'return "LastInstalledCU: $($output.LastInstalledCU). Version: $($output.OSBuild). ReleaseDate: $($output.ReleaseDate). KBID: $($output.KBID)"\n'})}),"\n",(0,a.jsx)(t.h3,{id:"row-2-function-script-log",children:"Row 2: Function: Script Log"}),"\n",(0,a.jsxs)(t.p,{children:["In the script log message, simply type ",(0,a.jsx)(t.code,{children:"%output%"})," so that the script will send the results of the PowerShell script above to the output on the Automation tab for the target device."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Script Log Image",src:s(180586).A+"",width:"338",height:"272"})}),"\n",(0,a.jsx)(t.h2,{id:"completed-task",children:"Completed Task"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Completed Task Image",src:s(31347).A+"",width:"971",height:"379"})}),"\n",(0,a.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"Script Log"}),"\n"]})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},856856:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_10-9d42f657589671db9e7e2593ccf47cbb.png"},129569:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_11-eb64abab1ad2853fc1d526a31b0b0ea0.png"},180586:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_12-39c2357a125d769e7f35e934d2dd5e61.png"},31347:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_13-36218b184ad2c5cc810153947be8c3c6.png"},642704:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_3-9e4f27cd45f420a272c998fd83dbe652.png"},754927:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_4-641f827387d8129a22f445a2f0120429.png"},715910:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_5-90a2d4880463c30ae83540ced3c30561.png"},497117:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_6-69211544b73189ff8535050361ae8f20.png"},64084:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_7-2ed9a0b95bcef5aaa0676cd61b27073a.png"},359379:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_8-f9f7e1395f9d88161e6e54cf71936f32.png"},720522:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_9-8ae4adc0439b09df626c3427b22db7f6.png"},28453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>o});var n=s(296540);const a={},i=n.createContext(a);function r(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);