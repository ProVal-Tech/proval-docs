"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[6025],{784811:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>s,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"cwa/scripts/6c9ef438-835d-44a9-bf31-4a1db9253347","title":"ScreenConnect - RMM+ Autofix - AD Plugin - Sync Out of Date Ticket","description":"This document details a script designed to automatically fix issues related to the Active Directory Sync Out of Date monitor in ConnectWise Automate. It outlines the process, dependencies, and ticketing information for effective resolution of sync errors.","source":"@site/docs/cwa/scripts/ScreenConnect - RMM+ Autofix - AD Plugin - Sync Out of Date Ticket.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/6c9ef438-835d-44a9-bf31-4a1db9253347","permalink":"/proval-docs/docs/cwa/scripts/6c9ef438-835d-44a9-bf31-4a1db9253347","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/ScreenConnect - RMM+ Autofix - AD Plugin - Sync Out of Date Ticket.md","tags":[{"inline":false,"label":"Active Directory","permalink":"/proval-docs/docs/tags/active-directory","description":"Documents related to Active Directory services and management"}],"version":"current","frontMatter":{"id":"6c9ef438-835d-44a9-bf31-4a1db9253347","title":"ScreenConnect - RMM+ Autofix - AD Plugin - Sync Out of Date Ticket","title_meta":"ScreenConnect - RMM+ Autofix - AD Plugin - Sync Out of Date Ticket","keywords":["active-directory","sync","autofix","monitor","ticketing"],"description":"This document details a script designed to automatically fix issues related to the Active Directory Sync Out of Date monitor in ConnectWise Automate. It outlines the process, dependencies, and ticketing information for effective resolution of sync errors.","tags":["active-directory"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"ScreenConnect - Offline Agent Remediation Autofix,RMM+","permalink":"/proval-docs/docs/cwa/scripts/ab3118dc-bc06-4443-9af0-78ccfb594844"},"next":{"title":"ScreenConnect - Repair RMM+, Autofix, Globals","permalink":"/proval-docs/docs/cwa/scripts/43225bbe-98a0-4352-8fb2-79e7431dea10"}}');var r=i(474848),o=i(28453);const s={id:"6c9ef438-835d-44a9-bf31-4a1db9253347",title:"ScreenConnect - RMM+ Autofix - AD Plugin - Sync Out of Date Ticket",title_meta:"ScreenConnect - RMM+ Autofix - AD Plugin - Sync Out of Date Ticket",keywords:["active-directory","sync","autofix","monitor","ticketing"],description:"This document details a script designed to automatically fix issues related to the Active Directory Sync Out of Date monitor in ConnectWise Automate. It outlines the process, dependencies, and ticketing information for effective resolution of sync errors.",tags:["active-directory"],draft:!1,unlisted:!1},c=void 0,a={},l=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2},{value:"Ticketing",id:"ticketing",level:2}];function d(e){const t={a:"a",code:"code",em:"em",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(t.p,{children:"This script is intended to be used as an autofix for the 'ProVal - Production - Active Directory - Sync Out of Date [RMM+ Autofix]' monitor. This script will not function if run manually."}),"\n",(0,r.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,r.jsx)(t.p,{children:"This script is intended to run from a monitor and will not function if run manually."}),"\n",(0,r.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,r.jsx)(t.p,{children:"This script depends on the following items to function as intended:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"/proval-docs/docs/cwa/monitors/18432358-9550-4ab9-959e-255196b0ebcf",children:"CWA Internal Monitor - Active Directory - Sync Out of Date [RMM+ Autofix]"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"/proval-docs/docs/cwa/scripts/f99ddaae-0cb3-4941-b2aa-dc93671dd246",children:"CWM - Automate - RMM+ Plugin Configuration"})}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"process",children:"Process"}),"\n",(0,r.jsx)(t.p,{children:"This script follows the process outlined below:"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"Monitor alerts and triggers the script."}),"\n",(0,r.jsxs)(t.li,{children:["Check if the FieldName = Failed. It will verify if the password title used in the AD Plugin matches the expected password title mentioned in System properties. If yes, it will run the ",(0,r.jsx)(t.a,{href:"/proval-docs/docs/cwa/scripts/ea1aca74-77ee-4387-91f2-57adb5822737",children:"CWM - Automate - Script - Active Directory - Plugin User Account - Create/Update"})," to reset the password. Otherwise, it will run the RMM+ fix to rebuild the ActiveDirectory.db file."]}),"\n",(0,r.jsx)(t.li,{children:"Verify if the machine is online in Control and Automate; if offline, it will create a ticket."}),"\n",(0,r.jsxs)(t.li,{children:["Run the following command through CWC:","\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.code,{children:"taskkill /F /IM ltsvc.exe /T & taskkill /F /IM lttray.exe /T & ping -n 3 127.0.0.1 > nul & del C:/Windows/LTSvc/ActiveDirectory/ActiveDirectory.bak & ren C:/Windows/LTSvc/ActiveDirectory/ActiveDirectory.db ActiveDirectory.bak & net start ltservice"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.li,{children:"Create a ticket with repair results and auto-close once the monitor no longer sees it as an issue."}),"\n",(0,r.jsx)(t.li,{children:"The ticket will not auto-close if the machine is offline, to avoid situations where the monitor returns to a successful state while the machine is offline, causing the script to auto-close the ticket while the issue still exists."}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,r.jsx)(t.p,{children:"This script will output its logging information into the ticket as it completes troubleshooting steps."}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Script Logs"}),"\n",(0,r.jsx)(t.li,{children:"Tickets"}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"ticketing",children:"Ticketing"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Ticket Subject:"})," ",(0,r.jsx)(t.code,{children:"Active Directory Plugin Sync Error for %CLIENTNAME%"})]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Ticket Body:"})}),"\n",(0,r.jsx)(t.p,{children:"Ticket body if the machine is offline in Automate and Control:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"The Active Directory plugin is not syncing for %CLIENTNAME%/%COMPUTERNAME% at %LOCATIONNAME%. We attempted to resolve the issue automatically by forcing a re-sync of the Active Directory data. However, the Active Directory server %CLIENTNAME%/%COMPUTERNAME% at %LOCATIONNAME% was found to be offline in Control. Please get this server online or replace it with a new Infrastructure Master Domain Controller.\n"})}),"\n",(0,r.jsx)(t.p,{children:"Here is pertinent information about the affected PC:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"PC Name: %computername%\r\nLast Login: %lastuser%\r\nPC Model: @biosname@\r\nOS: %os%\r\nS/N OF PC: @biosver@\r\nAD Last Sync: @RESULT@\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Ticket body ",(0,r.jsx)(t.em,{children:"after the script finishes the attempt to sync the Active Directory Plugin"}),":"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"The Active Directory plugin is currently not syncing for the machine %CLIENTNAME%%COMPUTERNAME% located at %LOCATIONNAME%. To address this issue, we are taking automated steps to force a re-sync of the Active Directory data. Furthermore, we have confirmed that the Active Directory server %CLIENTNAME%%COMPUTERNAME% is online and functioning correctly. We initiated the automatic fix to trigger the Active Directory Plugin to synchronize with a new local database. Below are the results of the repair attempts:\r\n@ADRepairResult@\r\nIf there are no errors in the log above, the Active Directory server should synchronize its information within the next few hours. However, it might take some time for the system to recognize the success of the autofix. If synchronization does not occur as expected, further manual troubleshooting may be required.\n"})}),"\n",(0,r.jsx)(t.p,{children:"Here is pertinent information about the affected PC:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"PC Name: %computername%\r\nLast Login: %lastuser%\r\nPC Model: @biosname@\r\nOS: %os%\r\nS/N OF PC: @biosver@\r\nAD Last Sync: @RESULT@\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Ticket body ",(0,r.jsx)(t.em,{children:"when monitor"})," FieldName = Failed, and the called script failed to reset the password:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"The Active Directory plugin is not syncing for %CLIENTNAME%/%COMPUTERNAME% at %LOCATIONNAME%. The script has identified a match between the password title used in the Active Directory plugin and the password title set up in the AD Plugin User Account creation tool. Consequently, it initiated the AD Plugin user creation script in an attempt to reset the password. However, this script ultimately failed to update the password for the server. Here are the results of the script's attempts:\r\n@Output@\n"})}),"\n",(0,r.jsx)(t.p,{children:"The PC information is outlined below:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"PC Name: %computername%\r\nLast Login: %lastuser%\r\nPC Model: @biosname@\r\nOS: %os%\r\nS/N OF PC: @biosver@\n"})})]})}function u(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,t,i)=>{i.d(t,{R:()=>s,x:()=>c});var n=i(296540);const r={},o=n.createContext(r);function s(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);