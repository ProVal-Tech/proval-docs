"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[43639],{51515:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"cwa/scripts/150f9b38-2ff8-457d-9293-943a2d038d04","title":"Power Management - No Sleep on AC Power","description":"This document outlines a script that prevents a computer from sleeping while plugged in, detailing its dependencies, variables, and the process involved in executing the script. It includes a sample run and highlights the time saved by automation.","source":"@site/docs/cwa/scripts/Power Management - No Sleep on AC Power.md","sourceDirName":"cwa/scripts","slug":"/cwa/scripts/150f9b38-2ff8-457d-9293-943a2d038d04","permalink":"/proval-docs/docs/cwa/scripts/150f9b38-2ff8-457d-9293-943a2d038d04","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/scripts/Power Management - No Sleep on AC Power.md","tags":[{"inline":false,"label":"Performance","permalink":"/proval-docs/docs/tags/performance","description":"Documents related to enhancing system and application performance"},{"inline":false,"label":"Software","permalink":"/proval-docs/docs/tags/software","description":"Documents related to software applications and their lifecycle management"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"150f9b38-2ff8-457d-9293-943a2d038d04","title":"Power Management - No Sleep on AC Power","title_meta":"Power Management - No Sleep on AC Power","keywords":["sleep","powercfg","never","exe","ac"],"description":"This document outlines a script that prevents a computer from sleeping while plugged in, detailing its dependencies, variables, and the process involved in executing the script. It includes a sample run and highlights the time saved by automation.","tags":["performance","software","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Point and Print Nightmare Check","permalink":"/proval-docs/docs/cwa/scripts/d65da81c-76ee-429a-a007-9ef788f2ee51"},"next":{"title":"Power Plan - Audit DV","permalink":"/proval-docs/docs/cwa/scripts/6e9ec56b-ba57-48cd-8dff-e659c30d2f3d"}}');var n=r(474848),i=r(28453);const a={id:"150f9b38-2ff8-457d-9293-943a2d038d04",title:"Power Management - No Sleep on AC Power",title_meta:"Power Management - No Sleep on AC Power",keywords:["sleep","powercfg","never","exe","ac"],description:"This document outlines a script that prevents a computer from sleeping while plugged in, detailing its dependencies, variables, and the process involved in executing the script. It includes a sample run and highlights the time saved by automation.",tags:["performance","software","windows"],draft:!1,unlisted:!1},l=void 0,o={},c=[{value:"Summary",id:"summary",level:2},{value:"Sample Run",id:"sample-run",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Variables",id:"variables",level:2},{value:"Process",id:"process",level:2},{value:"Output",id:"output",level:2}];function d(e){const t={a:"a",h2:"h2",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,n.jsx)(t.p,{children:"This script sets the computer to not sleep when plugged in."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Time Saved by Automation:"})," 5 Minutes"]}),"\n",(0,n.jsx)(t.h2,{id:"sample-run",children:"Sample Run"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Sample Run",src:r(796861).A+"",width:"477",height:"348"})}),"\n",(0,n.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.a,{href:"https://file.provaltech.com/repo/app/NeverSleepAC.exe",children:"Download NeverSleepAC.exe"})}),"\n",(0,n.jsx)(t.h2,{id:"variables",children:"Variables"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:(0,n.jsx)(t.strong,{children:"Variable Name"})}),(0,n.jsx)(t.th,{children:(0,n.jsx)(t.strong,{children:"Description"})})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"ProjectName"}),(0,n.jsx)(t.td,{children:"This represents the name of the executable, which in this case will be NeverSleepAC."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"BaseURL"}),(0,n.jsxs)(t.td,{children:["This represents the base URL, which will be ",(0,n.jsx)(t.a,{href:"https://file.provaltech.com/repo",children:"https://file.provaltech.com/repo"})," in this case."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"WorkingDirectory"}),(0,n.jsx)(t.td,{children:"C:/ProgramData/provaltech/app/@ProjectName@"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"EXEURL"}),(0,n.jsxs)(t.td,{children:["@BaseURL@/app/@",(0,n.jsx)(t.a,{href:"mailto:ProjectName@.exe",children:"ProjectName@.exe"})]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"EXEPath"}),(0,n.jsxs)(t.td,{children:["@WorkingDirectory@/@",(0,n.jsx)(t.a,{href:"mailto:ProjectName@.exe",children:"ProjectName@.exe"})]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"EXETempPath"}),(0,n.jsxs)(t.td,{children:["@WorkingDirectory@/@",(0,n.jsx)(t.a,{href:"mailto:ProjectName@-temp.exe",children:"ProjectName@-temp.exe"})]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"EXELog"}),(0,n.jsxs)(t.td,{children:["@WorkingDirectory@/@",(0,n.jsx)(t.a,{href:"mailto:ProjectName@-log.txt",children:"ProjectName@-log.txt"})]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"EXEErrorLog"}),(0,n.jsxs)(t.td,{children:["@WorkingDirectory@/@",(0,n.jsx)(t.a,{href:"mailto:ProjectName@-errors.txt",children:"ProjectName@-errors.txt"})]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"LogContent"}),(0,n.jsx)(t.td,{children:"@EXELog@"})]})]})]}),"\n",(0,n.jsx)(t.h2,{id:"process",children:"Process"}),"\n",(0,n.jsxs)(t.p,{children:["This script will download the NeverSleepAC.exe from ",(0,n.jsx)(t.a,{href:"https://file.provaltech.com/repo/app/NeverSleepAC.exe",children:"NeverSleepAC.exe"}),". The script is a .NET wrapper that retrieves the three GUIDs required for powercfg: active scheme, subgroup, and setting. It gets the currently loaded power plan, which allows it to adjust user settings from the system account. The script modifies the values for only the AC settings (plugged in) of that current plan:"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Sleep after = Never"}),"\n",(0,n.jsx)(t.li,{children:"Allow hybrid sleep = Off"}),"\n",(0,n.jsx)(t.li,{children:"Hibernate after = Never"}),"\n",(0,n.jsx)(t.li,{children:"Lid Close Action = Nothing (which is only present on mobile hardware)."}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"The script will download the EXE file and execute it."}),"\n",(0,n.jsx)(t.h2,{id:"output",children:"Output"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Script log"}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},796861:(e,t,r)=>{r.d(t,{A:()=>s});const s=r.p+"assets/images/image_1-cee5013d00b9db3bfe2b32aaf1cd357f.png"},28453:(e,t,r)=>{r.d(t,{R:()=>a,x:()=>l});var s=r(296540);const n={},i=s.createContext(n);function a(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);