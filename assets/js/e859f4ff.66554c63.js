"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[71876],{572331:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>i,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"cwa/monitors/81c88531-4918-4d74-ac84-efbc2c3cfe51","title":"Import- DHCP Scope(s)  5 IP Addresses Available","description":"This document provides a detailed guide on how to apply a remote monitor to specific groups in ConnectWise Automate. It outlines the steps for obtaining group IDs, constructing SQL queries for inserting group agents, and executing those queries to ensure proper monitoring of DHCP scopes with insufficient IP addresses.","source":"@site/docs/cwa/monitors/Import- DHCP Scope(s)  5 IP Addresses Available.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/81c88531-4918-4d74-ac84-efbc2c3cfe51","permalink":"/docs/cwa/monitors/81c88531-4918-4d74-ac84-efbc2c3cfe51","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Import- DHCP Scope(s)  5 IP Addresses Available.md","tags":[{"inline":false,"label":"Database","permalink":"/docs/tags/database","description":"Documents related to database management systems and operations"},{"inline":false,"label":"Networking","permalink":"/docs/tags/networking","description":"Documents related to network infrastructure and management practices"}],"version":"current","frontMatter":{"id":"81c88531-4918-4d74-ac84-efbc2c3cfe51","title":"Import- DHCP Scope(s)  5 IP Addresses Available","title_meta":"Import- DHCP Scope(s)  5 IP Addresses Available","keywords":["remote","monitor","dhcp","groupid","alert","configuration"],"description":"This document provides a detailed guide on how to apply a remote monitor to specific groups in ConnectWise Automate. It outlines the steps for obtaining group IDs, constructing SQL queries for inserting group agents, and executing those queries to ensure proper monitoring of DHCP scopes with insufficient IP addresses.","tags":["database","networking"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Import- DHCP Scope(s)  25% and 20 IP Addresses Available","permalink":"/docs/cwa/monitors/d18b57a8-8b6a-41aa-939b-f0dff26bd5cf"},"next":{"title":"Import- Enable Bitlocker Feature","permalink":"/docs/cwa/monitors/183d5388-764f-4e39-9ddc-2e4212b579e4"}}');var s=t(474848),a=t(28453);const o={id:"81c88531-4918-4d74-ac84-efbc2c3cfe51",title:"Import- DHCP Scope(s)  5 IP Addresses Available",title_meta:"Import- DHCP Scope(s)  5 IP Addresses Available",keywords:["remote","monitor","dhcp","groupid","alert","configuration"],description:"This document provides a detailed guide on how to apply a remote monitor to specific groups in ConnectWise Automate. It outlines the steps for obtaining group IDs, constructing SQL queries for inserting group agents, and executing those queries to ensure proper monitoring of DHCP scopes with insufficient IP addresses.",tags:["database","networking"],draft:!1,unlisted:!1},c=void 0,i={},d=[{value:"Steps to Apply Remote Monitor",id:"steps-to-apply-remote-monitor",level:2},{value:"1. Obtain Group IDs",id:"1-obtain-group-ids",level:3},{value:"2. Construct the SQL Query",id:"2-construct-the-sql-query",level:3},{value:"3. Example of a Query with a Group ID",id:"3-example-of-a-query-with-a-group-id",level:3},{value:"4. Execute the Query",id:"4-execute-the-query",level:3},{value:"5. Locate and Apply the Remote Monitor",id:"5-locate-and-apply-the-remote-monitor",level:3}];function R(e){const r={code:"code",em:"em",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.h2,{id:"steps-to-apply-remote-monitor",children:"Steps to Apply Remote Monitor"}),"\n",(0,s.jsx)(r.h3,{id:"1-obtain-group-ids",children:"1. Obtain Group IDs"}),"\n",(0,s.jsx)(r.p,{children:"Obtain the group ID(s) of the group(s) to which the remote monitor should be applied."}),"\n",(0,s.jsx)(r.h3,{id:"2-construct-the-sql-query",children:"2. Construct the SQL Query"}),"\n",(0,s.jsxs)(r.p,{children:["Copy the following query and replace ",(0,s.jsx)(r.strong,{children:"YOUR COMMA SEPARATED LIST OF GROUPID(S)"})," with the group ID(s) of the relevant groups:\r\n",(0,s.jsxs)(r.em,{children:["(The string to replace can be found at the very bottom of the query, right after ",(0,s.jsx)(r.code,{children:"WHERE"}),")"]})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"INSERT INTO groupagents \r\nSELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'ProVal - Production - DHCP Scope(s) < 5 IP Addresses Available' as `Name`,\r\n'6' as `CheckAction`,\r\n'1' as `AlertAction`,\r\n'DHCP Scope(s) with Insufficient IP Addresses Detected on %computername%~~~The problem is fixed.!!!DHCP Scope(s) with Insufficient IP Addresses Detected on %computername%~~~Active DHCP scope(s) with less than 5 available IP addresses detected on %ClientName%/%ComputerName% at %LocationName%. \r\nThis could potentially lead to IP address allocation problems and network connectivity issues for users. Immediate action should be taken to ensure sufficient IP addresses are available within the DHCP scopes to prevent any network disruptions. Please investigate the DHCP server configuration and take the necessary steps to address this issue. Potential solutions could include expanding IP address ranges, optimizing IP address allocation, or adding additional DHCP servers.\r\nAffected Scope(s) details: \r\n%RESULT%' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'3600' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command \\\"$ErroractionPreference= \\'SilentlyContinue\\'; $t = 5; $ss = try {Get-DhcpServerv4Failover -erroraction stop | Where-Object {$_.ServerRole -eq \\'Active\\' -and $_.ScopeId -match \\'.\\'}} catch {$null}; if ($ss.ServerRole -eq \\'Standby\\') {return}; $scopes = Get-DhcpServerv4Scope | Where-Object {$_.State -eq \\'Active\\'}; $DhcpScopes = foreach($scope in $scopes) {$scopeStats = $scope | Get-DhcpServerv4ScopeStatistics; [pscustomobject]@{scopeid = $scope.scopeid; startrange = $scope.startrange; endrange = $scope.endrange; free = $(if ($ss.ReservePercent -gt 0) {[Math]::Max(0, $($scopestats.free - [Math]::Round((($scopestats.free + $scopestats.InUse) * $ss.ReservePercent)/100)))} else {$scopestats.free}); inuse = $scopestats.inuse; Reserved = $scopestats.Reserved}}; $DhcpScopes | Where-Object {$_.free -le $t}\"' as `DataOut`,\r\n'16' as `Comparor`,\r\n'10|(^(\\\\r\\\\n%7COK%7C[\\\\s\\\\S])$)%7C(^$)|11|(^(\\\\r\\\\n%7COK%7C[\\\\s\\\\S])$)%7C(^$)%7C(scopeid.*?:.*?[\\\\r\\\\n]{0,}.*?startrange)|10|(scopeid.*?:.*?[\\\\r\\\\n]{0,}.*?startrange)' as `DataIn`,\r\n'' as `IDField`,\r\n'1' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'21' as `Category`,\r\n'0' as `TicketCategory`,\r\n'1' as `ScriptTarget`,\r\nCONCAT(\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1)\r\n) as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (YOUR COMMA SEPARATED LIST OF GROUPID(S))\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Production - DHCP Scope(s) < 5 IP Addresses Available')\n"})}),"\n",(0,s.jsx)(r.h3,{id:"3-example-of-a-query-with-a-group-id",children:"3. Example of a Query with a Group ID"}),"\n",(0,s.jsx)(r.p,{children:"Here is an example of a query with a group ID:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"INSERT INTO groupagents \r\nSELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'ProVal - Production - DHCP Scope(s) < 5 IP Addresses Available' as `Name`,\r\n'6' as `CheckAction`,\r\n'1' as `AlertAction`,\r\n'DHCP Scope(s) with Insufficient IP Addresses Detected on %computername%~~~The problem is fixed.!!!DHCP Scope(s) with Insufficient IP Addresses Detected on %computername%~~~Active DHCP scope(s) with less than 5 available IP addresses detected on %ClientName%/%ComputerName% at %LocationName%. \r\nThis could potentially lead to IP address allocation problems and network connectivity issues for users. Immediate action should be taken to ensure sufficient IP addresses are available within the DHCP scopes to prevent any network disruptions. Please investigate the DHCP server configuration and take the necessary steps to address this issue. Potential solutions could include expanding IP address ranges, optimizing IP address allocation, or adding additional DHCP servers.\r\nAffected Scope(s) details: \r\n%RESULT%' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'3600' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command \\\"$ErroractionPreference= \\'SilentlyContinue\\'; $t = 5; $ss = try {Get-DhcpServerv4Failover -erroraction stop | Where-Object {$_.ServerRole -eq \\'Active\\' -and $_.ScopeId -match \\'.\\'}} catch {$null}; if ($ss.ServerRole -eq \\'Standby\\') {return}; $scopes = Get-DhcpServerv4Scope | Where-Object {$_.State -eq \\'Active\\'}; $DhcpScopes = foreach($scope in $scopes) {$scopeStats = $scope | Get-DhcpServerv4ScopeStatistics; [pscustomobject]@{scopeid = $scope.scopeid; startrange = $scope.startrange; endrange = $scope.endrange; free = $(if ($ss.ReservePercent -gt 0) {[Math]::Max(0, $($scopestats.free - [Math]::Round((($scopestats.free + $scopestats.InUse) * $ss.ReservePercent)/100)))} else {$scopestats.free}); inuse = $scopestats.inuse; Reserved = $scopestats.Reserved}}; $DhcpScopes | Where-Object {$_.free -le $t}\"' as `DataOut`,\r\n'16' as `Comparor`,\r\n'10|(^(\\\\r\\\\n%7COK%7C[\\\\s\\\\S])$)%7C(^$)|11|(^(\\\\r\\\\n%7COK%7C[\\\\s\\\\S])$)%7C(^$)%7C(scopeid.*?:.*?[\\\\r\\\\n]{0,}.*?startrange)|10|(scopeid.*?:.*?[\\\\r\\\\n]{0,}.*?startrange)' as `DataIn`,\r\n'' as `IDField`,\r\n'1' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'21' as `Category`,\r\n'0' as `TicketCategory`,\r\n'1' as `ScriptTarget`,\r\nCONCAT(\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n'-',\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1)\r\n) as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (1624)\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - Production - DHCP Scope(s) < 5 IP Addresses Available')\n"})}),"\n",(0,s.jsx)(r.h3,{id:"4-execute-the-query",children:"4. Execute the Query"}),"\n",(0,s.jsx)(r.p,{children:"Now execute your query from a RAWSQL monitor set."}),"\n",(0,s.jsx)(r.h3,{id:"5-locate-and-apply-the-remote-monitor",children:"5. Locate and Apply the Remote Monitor"}),"\n",(0,s.jsx)(r.p,{children:"Locate your remote monitor by opening the group(s) remote monitors tab, then apply the appropriate alert template."})]})}function p(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(R,{...e})}):R(e)}},28453:(e,r,t)=>{t.d(r,{R:()=>o,x:()=>c});var n=t(296540);const s={},a=n.createContext(s);function o(e){const r=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(a.Provider,{value:r},e.children)}}}]);