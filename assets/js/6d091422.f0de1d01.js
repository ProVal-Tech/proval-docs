"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[36211],{766823:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"cwa/monitors/80e10bf1-9e98-427a-a5bf-dd8ffb208ce8","title":"Unexpected Shutdown","description":"This document outlines a monitor set designed to detect unexpected shutdowns on Windows machines running PowerShell v5 or higher. It provides detailed insights into the shutdown events, including potential causes and ticketing information for alerts.","source":"@site/docs/cwa/monitors/Unexpected Shutdown.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/80e10bf1-9e98-427a-a5bf-dd8ffb208ce8","permalink":"/proval-docs/docs/cwa/monitors/80e10bf1-9e98-427a-a5bf-dd8ffb208ce8","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Unexpected Shutdown.md","tags":[{"inline":false,"label":"Performance","permalink":"/proval-docs/docs/tags/performance","description":"Documents related to enhancing system and application performance"},{"inline":false,"label":"Ticketing","permalink":"/proval-docs/docs/tags/ticketing","description":"Documents related to ticketing systems and IT support management"},{"inline":false,"label":"Windows","permalink":"/proval-docs/docs/tags/windows","description":"Documents related to Microsoft Windows operating system and its functionalities"}],"version":"current","frontMatter":{"id":"80e10bf1-9e98-427a-a5bf-dd8ffb208ce8","title":"Unexpected Shutdown","title_meta":"Unexpected Shutdown","keywords":["shutdown","monitor","windows","power","event"],"description":"This document outlines a monitor set designed to detect unexpected shutdowns on Windows machines running PowerShell v5 or higher. It provides detailed insights into the shutdown events, including potential causes and ticketing information for alerts.","tags":["performance","ticketing","windows"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Time Sync Compliance","permalink":"/proval-docs/docs/cwa/monitors/021f4d58-3458-4536-96e7-b618960a1e0b"},"next":{"title":"Uninstall Anydesk","permalink":"/proval-docs/docs/cwa/monitors/34d2f7ec-4b5d-43d3-b109-4af2bb24d6be"}}');var s=t(474848),o=t(28453);const i={id:"80e10bf1-9e98-427a-a5bf-dd8ffb208ce8",title:"Unexpected Shutdown",title_meta:"Unexpected Shutdown",keywords:["shutdown","monitor","windows","power","event"],description:"This document outlines a monitor set designed to detect unexpected shutdowns on Windows machines running PowerShell v5 or higher. It provides detailed insights into the shutdown events, including potential causes and ticketing information for alerts.",tags:["performance","ticketing","windows"],draft:!1,unlisted:!1},d=void 0,c={},a=[{value:"Summary",id:"summary",level:2},{value:"Details",id:"details",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Target",id:"target",level:2},{value:"Ticketing",id:"ticketing",level:2},{value:"Implementation",id:"implementation",level:2}];function l(e){const n={a:"a",br:"br",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsx)(n.p,{children:"The monitor set helps check if the computer had any recent unexpected shutdowns and provides basic details about them, offering insights into possible reasons."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Requirement:"})," PowerShell v5+"]}),"\n",(0,s.jsx)(n.h2,{id:"details",children:"Details"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:'Suggested "Limit to":'})," Windows machines with PowerShell v5+ (Windows 10, 11, Server 2016, 2019, 2022)",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Suggested Alert Style:"})," Continuous",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Suggested Alert Template:"})," \u25b3 Custom - Ticket Creation Computer - Failures Only"]}),"\n",(0,s.jsx)(n.p,{children:"Insert the details of the monitor in the table below."}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Check Action"}),(0,s.jsx)(n.th,{children:"Server Address"}),(0,s.jsx)(n.th,{children:"Check Type"}),(0,s.jsx)(n.th,{children:"Execute Info"}),(0,s.jsx)(n.th,{children:"Condition"}),(0,s.jsx)(n.th,{children:"Interval"}),(0,s.jsx)(n.th,{children:"Result"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"System"}),(0,s.jsx)(n.td,{children:"127.0.0.1"}),(0,s.jsx)(n.td,{children:"Run File"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"REDACTED"})}),(0,s.jsx)(n.td,{children:"State Based"}),(0,s.jsx)(n.td,{children:"3600"}),(0,s.jsx)(n.td,{children:"<Screenshot Below>"})]})})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Screenshot",src:t(887061).A+"",width:"1000",height:"113"})}),"\n",(0,s.jsx)(n.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"/proval-docs/docs/cwa/scripts/e14bf501-f10d-44d7-a19a-2284fd5c5cc9",children:"CWM - Automate - Script - Ticket Creation - Computer [Failures Only]"})}),"\n",(0,s.jsx)(n.h2,{id:"target",children:"Target"}),"\n",(0,s.jsx)(n.p,{children:"Managed Windows machines with PowerShell v5+ (Windows 10, 11, Server 2016, 2019, 2022)"}),"\n",(0,s.jsx)(n.h2,{id:"ticketing",children:"Ticketing"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Subject:"})," ",(0,s.jsx)(n.code,{children:"EV - Unexpected Shutdown Detected on %COMPUTERNAME%"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Body:"})," ",(0,s.jsx)(n.code,{children:"%RESULT%"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example 1:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"The previous system shutdown at 7:44:21 AM on 1/8/2024 was unexpected.\r\nEvent ID: 41\r\n--------------------------------------\r\nEventDate                      : 1/9/2024 2:47:50 AM\r\nComputer                       : DEV-Win11-1\r\nBugcheckCode                  : 0x000000a9\r\nBugcheckParameter1 : 0x0\r\nBugcheckParameter2 : 0x0\r\nBugcheckParameter3 : 0x0\r\nBugcheckParameter4 : 0x0\r\nSleepInProgress : 0\r\nPowerButtonTimestamp : 0\r\nBootAppStatus : 0\r\nCheckpoint : 0\r\nConnectedStandbyInProgress : false\r\nSystemSleepTransitionsToOn : 0\r\nCsEntryScenarioInstanceId : 0\r\nBugcheckInfoFromEFI : false\r\nCheckpointStatus : 0\r\nCsEntryScenarioInstanceIdV2 : 0\r\nLongPowerButtonPressDetected : false\r\nLidReliability              : false\r\nInputSuppressionState       : 0\r\nPowerButtonSuppressionState  : 0\r\nLidState                    : 1\r\n----------------------------------------\r\nPlease review this article for more information on the detected BugCheckCode: [Event ID 41 Restart](https://learn.microsoft.com/en-us/troubleshoot/windows-client/performance/event-id-41-restart)\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example 2:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"The previous system shutdown at 9:24:16 AM on 1/10/2024 was unexpected.\r\nEvent ID: 41\r\n--------------------------------------\r\nEventDate                      : 1/10/2024 3:17:30 PM\r\nComputer                       : DEV-Win11-1\r\nBugcheckCode                  : 0\r\nBugcheckParameter1 : 0x0\r\nBugcheckParameter2 : 0x0\r\nBugcheckParameter3 : 0x0\r\nBugcheckParameter4 : 0x0\r\nSleepInProgress : 0\r\nPowerButtonTimestamp : 0\r\nBootAppStatus : 0\r\nCheckpoint : 0\r\nConnectedStandbyInProgress : false\r\nSystemSleepTransitionsToOn : 0\r\nCsEntryScenarioInstanceId : 0\r\nBugcheckInfoFromEFI : false\r\nCheckpointStatus : 0\r\nCsEntryScenarioInstanceIdV2 : 0\r\nLongPowerButtonPressDetected : false\r\nLidReliability              : false\r\nInputSuppressionState       : 0\r\nPowerButtonSuppressionState  : 0\r\nLidState                    : 1\r\n----------------------------------------\r\nThe computer was not shut down due to crashing or a user pressing the power button; the most likely cause was a power outage.\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example 3:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"The previous system shutdown at 11:13:56 PM on 2/21/2024 was unexpected.\r\nEvent ID: 41\r\n--------------------------------------\r\nEventDate                      : 2/22/2024 12:14:50 AM\r\nComputer                       : DEV-Win11-1\r\nBugcheckCode                  : 0\r\nBugcheckParameter1 : 0x0\r\nBugcheckParameter2 : 0x0\r\nBugcheckParameter3 : 0x0\r\nBugcheckParameter4 : 0x0\r\nSleepInProgress : 0\r\nPowerButtonTimestamp : 2/21/2024 11:13:56 PM\r\nBootAppStatus : 0\r\nCheckpoint : 0\r\nConnectedStandbyInProgress : false\r\nSystemSleepTransitionsToOn : 0\r\nCsEntryScenarioInstanceId : 0\r\nBugcheckInfoFromEFI : false\r\nCheckpointStatus : 0\r\nCsEntryScenarioInstanceIdV2 : 0\r\nLongPowerButtonPressDetected : false\r\nLidReliability              : false\r\nInputSuppressionState       : 0\r\nPowerButtonSuppressionState  : 0\r\nLidState                    : 1\r\n----------------------------------------\r\nThe user pressed the power button.\n"})}),"\n",(0,s.jsx)(n.h2,{id:"implementation",children:"Implementation"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"/proval-docs/docs/cwa/monitors/80e10bf1-9e98-427a-a5bf-dd8ffb208ce8",children:"Import - Remote Monitor - Unexpected Shutdown"})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},887061:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/image_1-f6deb133a6d43fc6205142ec169a8db4.png"},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>d});var r=t(296540);const s={},o=r.createContext(s);function i(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);