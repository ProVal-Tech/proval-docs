"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[90061],{374712:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"solutions/5e48c013-4305-4bfb-9cdd-1aa518d8f729","title":"Threatlocker - Set Learning Mode Implement and Audit","description":"This document outlines the process of setting ThreatLocker to learning mode using an API, including auditing details such as duration, status, and user information. It provides implementation steps, associated scripts, and FAQs for effective usage.","source":"@site/docs/solutions/Threatlocker - Set Learning Mode Implement and Audit.md","sourceDirName":"solutions","slug":"/solutions/5e48c013-4305-4bfb-9cdd-1aa518d8f729","permalink":"/proval-docs/docs/solutions/5e48c013-4305-4bfb-9cdd-1aa518d8f729","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/solutions/Threatlocker - Set Learning Mode Implement and Audit.md","tags":[{"inline":false,"label":"API","permalink":"/proval-docs/docs/tags/api","description":"Documents related to Application Programming Interfaces and their usage"},{"inline":false,"label":"Security","permalink":"/proval-docs/docs/tags/security","description":"Documents discussing security measures and practices for IT systems"},{"inline":false,"label":"Setup","permalink":"/proval-docs/docs/tags/setup","description":"Documents on setting up software and hardware configurations"}],"version":"current","frontMatter":{"id":"5e48c013-4305-4bfb-9cdd-1aa518d8f729","title":"Threatlocker - Set Learning Mode Implement and Audit","title_meta":"Threatlocker - Set Learning Mode Implement and Audit","keywords":["threatlocker","learning","mode","audit","api"],"description":"This document outlines the process of setting ThreatLocker to learning mode using an API, including auditing details such as duration, status, and user information. It provides implementation steps, associated scripts, and FAQs for effective usage.","tags":["api","security","setup"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Sysmon","permalink":"/proval-docs/docs/solutions/67bf4b52-4294-4773-b4df-7d75c9387954"},"next":{"title":"Threatlocker Deployment","permalink":"/proval-docs/docs/solutions/c9969bad-d2da-45ec-90fe-d6be82479ebc"}}');var i=s(474848),r=s(28453);const o={id:"5e48c013-4305-4bfb-9cdd-1aa518d8f729",title:"Threatlocker - Set Learning Mode Implement and Audit",title_meta:"Threatlocker - Set Learning Mode Implement and Audit",keywords:["threatlocker","learning","mode","audit","api"],description:"This document outlines the process of setting ThreatLocker to learning mode using an API, including auditing details such as duration, status, and user information. It provides implementation steps, associated scripts, and FAQs for effective usage.",tags:["api","security","setup"],draft:!1,unlisted:!1},a=void 0,d={},c=[{value:"Purpose",id:"purpose",level:2},{value:"Associated Content",id:"associated-content",level:2},{value:"Implementation",id:"implementation",level:2},{value:"FAQ",id:"faq",level:2}];function l(e){const t={a:"a",code:"code",em:"em",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"purpose",children:"Purpose"}),"\n",(0,i.jsx)(t.p,{children:"This solution is built to set ThreatLocker to learning mode using the API. It also performs auditing for ThreatLocker, providing details like the learning mode start and end times, duration, status, logs, the LT user who set the learning mode, and the reason for being recorded."}),"\n",(0,i.jsx)(t.h2,{id:"associated-content",children:"Associated Content"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Content"}),(0,i.jsx)(t.th,{children:"Type"}),(0,i.jsx)(t.th,{children:"Function"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"/proval-docs/docs/cwa/scripts/7dedea46-a8d7-4901-93c5-f2bb4c876f83",children:"Script - ThreatLocker - Set Learning Mode"})}),(0,i.jsx)(t.td,{children:"Script"}),(0,i.jsxs)(t.td,{children:["This script gathers API keys from the client's EDF and securely uses them to set the machine to learning mode in ThreatLocker.   ",(0,i.jsx)(t.strong,{children:"User Parameters"}),"   ",(0,i.jsx)(t.strong,{children:"LearningDuration"}),"   Accepts a numerical value and sets the computer to learning mode in ThreatLocker for the specified number of hours.   ",(0,i.jsx)(t.strong,{children:"Reason"}),"   This is required to provide a reason for setting the learning mode."]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"/proval-docs/docs/cwa/dataviews/33f561fb-e60a-4240-a4e7-03542a45b347",children:"Dataview - ThreatLocker LearningMode Set Audit"})}),(0,i.jsx)(t.td,{children:"Dataview"}),(0,i.jsx)(t.td,{children:'This dataview stores the results of the ThreatLocker learning mode setting done via the script, "Script - ThreatLocker - Set Learning Mode."'})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"/proval-docs/docs/cwa/tables/7367ea61-b4bf-4449-b7dd-a68569dc7b75",children:"Table - pvl_threatlocker-disable_audit"})}),(0,i.jsx)(t.td,{children:"Custom Table"}),(0,i.jsx)(t.td,{children:'This table stores data from the script "Script - ThreatLocker - Set Learning Mode," including the computer ID, learning mode duration, start and end times, reason, the LT user who set the mode, status, and the complete log.'})]})]})]}),"\n",(0,i.jsx)(t.h2,{id:"implementation",children:"Implementation"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"Import the following content using the ProSync Plugin:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Script - ThreatLocker - Set Learning Mode"}),"\n",(0,i.jsx)(t.li,{children:"Dataview - ThreatLocker LearningMode Set Audit"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"Reload the system cache."}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"This script can be run on-demand or called from another script to first enable ThreatLocker\u2019s learning mode, allowing LT users to disable blocking internally."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["The client needs to obtain report keys and maintenance auth keys from ThreatLocker support for each organization where they want to enable the learning mode setup via the script. ",(0,i.jsx)(t.em,{children:"Note: The user needs to have the phone associated with their profile on hand."})]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"https://proval.itglue.com/5078775/docs/16557700/images/25596110",alt:"Image"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"https://proval.itglue.com/5078775/docs/16557700/images/25596103",alt:"Image"})}),"\n",(0,i.jsx)(t.p,{children:"Support will send an SMS to validate the user, after which they will provide the auth keys."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"https://proval.itglue.com/5078775/docs/16557700/images/25600165",alt:"Image"})}),"\n",(0,i.jsx)(t.p,{children:"Once the keys are provided, they need to be entered into the client's password tab with the title as shown below:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"https://proval.itglue.com/5078775/docs/16557700/images/25596156",alt:"Image"})}),"\n",(0,i.jsxs)(t.p,{children:["After setting the keys, it is necessary to whitelist the file hash ",(0,i.jsx)(t.code,{children:"9FA61A436668967C26CB76858275EC17"})," to allow the script to execute the PowerShell script (.ps1) and perform the learning mode setup in ThreatLocker for the specified duration."]}),"\n",(0,i.jsx)(t.h2,{id:"faq",children:"FAQ"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Does ThreatLocker block this script from setting it to learning mode?"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Answer:"})," Yes, ThreatLocker will block the .ps1 file generated by this script. To ensure the script works, the partner needs to whitelist the file hash ",(0,i.jsx)(t.code,{children:"9FA61A436668967C26CB76858275EC17"})," and deploy the policy for proper script execution."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"What kind of error messages can the script return?"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Answer:"})," Possible error messages include the following:"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"https://proval.itglue.com/5078775/docs/16557700/images/24294965",alt:"Image"})})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>o,x:()=>a});var n=s(296540);const i={},r=n.createContext(i);function o(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);