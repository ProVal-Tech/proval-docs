"use strict";(self.webpackChunkproval_docs=self.webpackChunkproval_docs||[]).push([[8220],{506986:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>d,contentTitle:()=>i,default:()=>m,frontMatter:()=>s,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"cwa/monitors/b927b474-abad-4e84-8f39-8995d5ace913","title":"Implement- Add Windows Capability - RSAT","description":"This document outlines the steps required to implement a remote monitor for Remote Server Administration Tools (RSAT) using SQL queries. It details how to obtain group IDs, modify the SQL query, execute it, and apply the appropriate alert template in ConnectWise Automate.","source":"@site/docs/cwa/monitors/Implement- Add Windows Capability - RSAT.md","sourceDirName":"cwa/monitors","slug":"/cwa/monitors/b927b474-abad-4e84-8f39-8995d5ace913","permalink":"/docs/cwa/monitors/b927b474-abad-4e84-8f39-8995d5ace913","draft":false,"unlisted":false,"editUrl":"https://github.com/proval-tech/proval-docs/tree/main/docs/cwa/monitors/Implement- Add Windows Capability - RSAT.md","tags":[{"inline":false,"label":"Database","permalink":"/docs/tags/database","description":"Documents related to database management systems and operations"},{"inline":false,"label":"Setup","permalink":"/docs/tags/setup","description":"Documents on setting up software and hardware configurations"}],"version":"current","frontMatter":{"id":"b927b474-abad-4e84-8f39-8995d5ace913","title":"Implement- Add Windows Capability - RSAT","title_meta":"Implement- Add Windows Capability - RSAT","keywords":["rsat","groupid","query","monitor","alert","automation"],"description":"This document outlines the steps required to implement a remote monitor for Remote Server Administration Tools (RSAT) using SQL queries. It details how to obtain group IDs, modify the SQL query, execute it, and apply the appropriate alert template in ConnectWise Automate.","tags":["database","setup"],"draft":false,"unlisted":false},"sidebar":"contentSidebar","previous":{"title":"Implement - Remote Monitor - Mega RAID Errors","permalink":"/docs/cwa/monitors/94acea25-1d14-4ccd-8991-045331d05fde"},"next":{"title":"Implement- Dell Hardware Monitoring","permalink":"/docs/cwa/monitors/2be5ccc9-2700-4f5d-9b77-30567de4cfdf"}}');var o=a(474848),r=a(28453);const s={id:"b927b474-abad-4e84-8f39-8995d5ace913",title:"Implement- Add Windows Capability - RSAT",title_meta:"Implement- Add Windows Capability - RSAT",keywords:["rsat","groupid","query","monitor","alert","automation"],description:"This document outlines the steps required to implement a remote monitor for Remote Server Administration Tools (RSAT) using SQL queries. It details how to obtain group IDs, modify the SQL query, execute it, and apply the appropriate alert template in ConnectWise Automate.",tags:["database","setup"],draft:!1,unlisted:!1},i=void 0,d={},l=[{value:"Implementation Steps",id:"implementation-steps",level:2},{value:"Step 1",id:"step-1",level:3},{value:"Step 2",id:"step-2",level:3},{value:"Step 3",id:"step-3",level:3},{value:"Step 4",id:"step-4",level:3},{value:"Step 5",id:"step-5",level:3}];function p(e){const t={br:"br",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h2,{id:"implementation-steps",children:"Implementation Steps"}),"\n",(0,o.jsx)(t.h3,{id:"step-1",children:"Step 1"}),"\n",(0,o.jsx)(t.p,{children:"Obtain the group ID(s) of the group(s) that the remote monitor should be applied to."}),"\n",(0,o.jsx)(t.h3,{id:"step-2",children:"Step 2"}),"\n",(0,o.jsxs)(t.p,{children:["Copy the following query and replace ",(0,o.jsx)(t.strong,{children:"YOUR COMMA SEPARATED LIST OF GROUPID(S)"})," with the group ID(s) of the relevant groups:",(0,o.jsx)(t.br,{}),"\n","(The string to replace can be found at the very bottom of the query, right after ",(0,o.jsx)(t.strong,{children:"WHERE"}),")"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sql",children:"INSERT INTO groupagents \r\nSELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'ProVal - NonStack - Add Windows Capability - RSAT' as `Name`,\r\n'6' as `CheckAction`,\r\n'1' as `AlertAction`,\r\n'Failed to add RSAT Features on %computername%~~~RSAT Features successfully added!!!Failed to add RSAT Features on %computername%~~~Remote Server Administration Tools Features are not enabled on the %ComputerName%. Automate attempted to enable it but failed. \r\nCommand Executed: Get-WindowsCapability -Name RSAT* -Online | Where-Object{$_.State -eq 'NotPresent'} | Add-WindowsCapability -Online\r\nOutput: %RESULT%\r\nHow to enable it manually: [https://learn.microsoft.com/en-us/troubleshoot/windows-server/system-management-components/remote-server-administration-tools](https://learn.microsoft.com/en-us/troubleshoot/windows-server/system-management-components/remote-server-administration-tools)' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'604800' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command \\\"if((Get-CimInstance -ClassName Cim_computersystem).partofdomain -and (Get-WindowsCapability -Name RSAT* -Online | Where-Object{$_.State -eq 'NotPresent'})) {try {Get-WindowsCapability -Name RSAT* -Online | Where-Object{$_.State -eq 'NotPresent'} | Add-WindowsCapability -Online -Erroraction Stop} catch { return \\\"Failed to Add RSAT capability. Reason: $($Error[0].Exception.Message)\\\"}}\"' as `DataOut`,\r\n'16' as `Comparor`,\r\n'11|(PowerShell)%7C(Failed to Add RSAT capability. Reason:)|10|PowerShell|10|Failed to Add RSAT capability. Reason:' as `DataIn`,\r\n'' as `IDField`,\r\n'1' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'21' as `Category`,\r\n'0' as `TicketCategory`,\r\n'1' as `ScriptTarget`,\r\nCONCAT(\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n...\r\n) as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (**YOUR COMMA SEPARATED LIST OF GROUPID(S)**)\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - NonStack - Add Windows Capability - RSAT')\n"})}),"\n",(0,o.jsx)(t.h3,{id:"step-3",children:"Step 3"}),"\n",(0,o.jsx)(t.p,{children:"An example of a query with a group ID:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sql",children:"INSERT INTO groupagents \r\nSELECT '' as `AgentID`,\r\n`groupid` as `GroupID`,\r\n'0' as `SearchID`,\r\n'ProVal - NonStack - Add Windows Capability - RSAT' as `Name`,\r\n'6' as `CheckAction`,\r\n'1' as `AlertAction`,\r\n'Failed to add RSAT Features on %computername%~~~RSAT Features successfully added!!!Failed to add RSAT Features on %computername%~~~Remote Server Administration Tools Features are not enabled on the %ComputerName%. Automate attempted to enable it but failed. \r\nCommand Executed: Get-WindowsCapability -Name RSAT* -Online | Where-Object{$_.State -eq 'NotPresent'} | Add-WindowsCapability -Online\r\nOutput: %RESULT%\r\nHow to enable it manually: [https://learn.microsoft.com/en-us/troubleshoot/windows-server/system-management-components/remote-server-administration-tools](https://learn.microsoft.com/en-us/troubleshoot/windows-server/system-management-components/remote-server-administration-tools)' as `AlertMessage`,\r\n'0' as `ContactID`,\r\n'604800' as `interval`,\r\n'127.0.0.1' as `Where`,\r\n'7' as `What`,\r\n'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command \\\"if((Get-CimInstance -ClassName Cim_computersystem).partofdomain -and (Get-WindowsCapability -Name RSAT* -Online | Where-Object{$_.State -eq 'NotPresent'})) {try {Get-WindowsCapability -Name RSAT* -Online | Where-Object{$_.State -eq 'NotPresent'} | Add-WindowsCapability -Online -Erroraction Stop} catch { return \\\"Failed to Add RSAT capability. Reason: $($Error[0].Exception.Message)\\\"}}\"' as `DataOut`,\r\n'16' as `Comparor`,\r\n'11|(PowerShell)%7C(Failed to Add RSAT capability. Reason:)|10|PowerShell|10|Failed to Add RSAT capability. Reason:' as `DataIn`,\r\n'' as `IDField`,\r\n'1' as `AlertStyle`,\r\n'0' as `ScriptID`,\r\n'' as `datacollector`,\r\n'21' as `Category`,\r\n'0' as `TicketCategory`,\r\n'1' as `ScriptTarget`,\r\nCONCAT(\r\nSUBSTRING('abcdef0123456789', FLOOR(RAND()*16+1), 1),\r\n...\r\n) as `GUID`,\r\n'root' as `UpdatedBy`,\r\n(NOW()) as `UpdateDate`\r\nFROM mastergroups m\r\nWHERE m.groupid IN (1764)\r\nAND m.groupid NOT IN  (SELECT DISTINCT groupid FROM groupagents WHERE `Name` = 'ProVal - NonStack - Add Windows Capability - RSAT')\n"})}),"\n",(0,o.jsx)(t.h3,{id:"step-4",children:"Step 4"}),"\n",(0,o.jsx)(t.p,{children:"Now execute your query from a RAWSQL monitor set."}),"\n",(0,o.jsx)(t.h3,{id:"step-5",children:"Step 5"}),"\n",(0,o.jsxs)(t.p,{children:["Locate your remote monitor by opening the group(s) remote monitors tab, then apply the appropriate alert template.",(0,o.jsx)(t.br,{}),"\n","While assigning the alert template, ensure that it is not performing any actions for WARNINGS unless you want to be notified for the PowerShell errors as well."]})]})}function m(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(p,{...e})}):p(e)}},28453:(e,t,a)=>{a.d(t,{R:()=>s,x:()=>i});var n=a(296540);const o={},r=n.createContext(o);function s(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);