---
id: 'cwa-windows-10-feature-update-status'
title: 'Windows 10 Feature Update Status Gathering'
title_meta: 'Windows 10 Feature Update Status Gathering'
keywords: ['windows', 'update', 'monitor', 'registry', 'database', 'event', 'error', 'ticket', 'installation', 'report']
description: 'This document outlines the process for gathering status information related to Windows 10 feature updates. It details the dependencies, variables, and processes involved in executing an auto-fix script that monitors specific event logs and manages registry values related to Windows updates.'
tags: ['windows', 'update', 'monitor', 'database', 'error', 'installation', 'report']
draft: false
unlisted: false
---
## Summary

Gathers status information generated by the script [Windows 10 - Feature Update - Install Latest](https://proval.itglue.com/DOC-5078775-9744053).

The script is designed to be executed as an auto-fix against an event log remote monitor looking for Application EventID 6501 from the "Update-Windows10-PS" provider.

This function script should never be run manually.

## Dependencies

- [EPM - Data Collection - Script - Remote Event Monitor - Create](https://proval.itglue.com/DOC-5078775-9742626)
  - [https://app.myglue.com/help_center/documents/9742626](https://app.myglue.com/help_center/documents/9742626)
  
- [SEC - Windows Patching - Solution - Windows 10 Update](https://proval.itglue.com/DOC-5078775-9560440)
  - [https://app.myglue.com/help_center/documents/9560440](https://app.myglue.com/help_center/documents/9560440)
  
- [CWM - Automate - Custom Table - plugin_proval_windows10_upgradestats](https://proval.itglue.com/DOC-5078775-9746809)
  - [https://app.myglue.com/help_center/documents/9746809](https://app.myglue.com/help_center/documents/9746809)

## Variables

Document the various variables in the script. Delete any section that is not relevant to your script.

| Name                        | Description                                                                 |
|-----------------------------|-----------------------------------------------------------------------------|
| TableName                   | The name of the table in the database.                                     |
| RegPath                     | The registry path to query for the remote monitor.                         |
| UnformattedInstallationDate  | Holds the registry value from the regpath variable for the property InstallationDate. |
| InstallationDate            | Holds the formatted date from the unformattedInstallationDate variable.    |
| WindowsVersion              | Holds the registry value from the regpath variable at the property WindowsVersion. |
| Failures                    | Holds the registry value from the regpath variable at the property Failures. |
| InstallationState           | Holds the registry value from the regpath variable at the property InstallationState. |
| Successes                   | Holds the registry value from the regpath variable at the property Successes. |
| TotalAttempts               | Holds the registry value from the regpath variable at the property TotalAttempts. |
| GroupId                     | Holds the group id created by the remote monitor - create script.         |

## Global Variables

| Name          | Description                                                |
|---------------|------------------------------------------------------------|
| TicketOnError | If set to 1 a ticket will be generated on error.          |

## Process

1. Review the previous log, check for specific error and log or create a ticket depending on global variable set.
2. Create the table [plugin_proval_windows10_upgradestats](https://proval.itglue.com/DOC-5078775-9746809) if it does not exist. ([https://app.myglue.com/help_center/documents/9746809](https://app.myglue.com/help_center/documents/9746809))
3. Check the registry for the expected value, if it's not found log an error or create a ticket depending on global variable set.
4. Retrieve all registry values from the target machine.
5. Convert the retrieved date/time into a MySQL recognized date/time.
6. Get the GroupID for the created group in the monitor - create script.
7. Insert the values into the database on duplicates update.
8. Remove the target computer from the "Windows 10 Upgrade Pending Reports" group.

## Output

This is intended to be an autofix on a monitor and should be used to populate data after a specific event is thrown on a computer.



