---
id: '29efddbd-07f0-4d6a-837a-0b8d1f5a818e'
slug: /29efddbd-07f0-4d6a-837a-0b8d1f5a818e
title: 'OneDrive Files On-Demand Policy Settings'
title_meta: 'OneDrive Files On-Demand Policy Settings'
keywords: ['OneDrive', 'OnDemand', 'Demand', 'Policy', 'office365', 'office']
description: 'This script sets the OneDrive Files On-Demand Policy settings at the system and user level.'
tags: ['onedrive']
draft: false
unlisted: false
---

## Summary
This script sets the OneDrive Files On-Demand Policy settings at the system and user level.

## Sample Run

![SampleRun](../../../static/img/docs/5fab9cd8-be2b-4cfa-b910-ee3b6fc1611c/image.webp)

## Process

This script sets the OneDrive Files On-Demand Policy settings at the system and user level.
This writes up a PowerShell file `OneDrive-OnDemandSettings.ps1` to the directory 
`C:\ProgramData\_Automation\Script\OneDrive-OnDemandSettings`.

Note: If partner uses the third-party application that blocks the ps1 execution, then please get the below hash whitelisted:

Filehash: `F4D16149230C120A044676239926C56B`

## Output

- Script log
- Local file directory `C:\ProgramData\_Automation\Script\OneDrive-OnDemandSettings\OneDrive-OnDemandSettings-log.txt`