---
id: 'cwa-set-permissions-cve-2021-1675'
title: 'Set Permissions for User System on Drivers Folder'
title_meta: 'Set Permissions for User System on Drivers Folder'
keywords: ['permissions', 'cve', 'monitoring', 'event', 'logging', 'deny', 'windows']
description: 'This document outlines a script that sets permissions for the user "System" on the C:\\Windows\\System32\\Spool\\Drivers folder to DENY, aiming to prevent file injection related to CVE-2021-1675. The script also enables event logging for monitoring purposes, providing a comprehensive solution for security enhancement.'
tags: ['security', 'windows', 'monitor', 'logging', 'cve']
draft: false
unlisted: false
---
## Summary

This script will set the permissions for user 'System' on the `C:\Windows\System32\Spool\Drivers` folder to DENY. This will attempt to block any files from being placed in that folder which is part of the execution of CVE-2021-1675 to inject a .dll in the drivers folder.

Script will also enable the Microsoft-Windows-PrintService/Operational event logging for future monitoring options.

Attached Zip file contains monitor, script, dataview.

**Time Saved by Automation:** 10 Minutes

## Sample Run

![Sample Run](5078775/docs/7798632/images/10857401)

## Dependencies

N/A

#### User Parameters

| Name | Example | Required | Description |
|------|---------|----------|-------------|
| Undo | True | False | Undo being set to True - will remove the ACL settings on the 'drivers' folder. |

#### System Properties

N/A

#### Script States

| Name | Example | Description |
|------|---------|-------------|
| CVE_2021_1675_Status | DenySet, Failed, Restored, Attempted | Allows reporting to Dataview for CVE status on agent |

## Process

Script will use Powershell to set a DENY for user 'system' on the `C:\Windows\System32\Spool\Drivers` folder.

Setting Param to 'True' will undo the DENY for user 'system'.

## Output

The location and method by which this script returns data.

- Script log
- Script state
- Dataview
- Monitor - Proval - Production - CVE-2021-1675 - Not Attempted - can use this script as an Autofix for this monitor - Will run an initial deny attempt.


