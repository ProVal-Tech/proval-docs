---
id: 'cwa_winget_auto_update_implementation'
title: 'Winget Auto Update Implementation Guide'
title_meta: 'Winget Auto Update Implementation Guide'
keywords: ['winget', 'auto', 'update', 'audit', 'monitor']
description: 'This guide provides a comprehensive overview of implementing the Winget Auto Update solution, including the necessary auditing and automation content, configuration steps, and monitoring setup to ensure that winget-supported applications are kept up to date and their statuses reported effectively.'
tags: ['automation', 'monitoring', 'configuration', 'windows', 'software']
draft: false
unlisted: false
---
## Purpose

The solution aims to keep the winget supported updated and report the current status of the applications to Automate. The automation portion of the solution uses [Romanitho's Winget-AutoUpdate](https://github.com/Romanitho/Winget-AutoUpdate).

## Associated Content

#### Auditing

| Content                                                                 | Type          | Function                                                                                          |
|-------------------------------------------------------------------------|---------------|---------------------------------------------------------------------------------------------------|
| [Winget App Audit](https://proval.itglue.com/DOC-5078775-17973895)    | Script        | Fetches information of the installed winget supported application from the endpoint.             |
| [pvl_winget_audit](https://proval.itglue.com/DOC-5078775-17973960)    | Custom Table  | Stores the data fetched by the [Winget App Audit](https://proval.itglue.com/DOC-5078775-17973895) script. |
| [Winget App Audit](https://proval.itglue.com/DOC-5078775-17973899)    | Dataview      | Displays the data fetched by the [Winget App Audit](https://proval.itglue.com/DOC-5078775-17973895) script. |
| [Execute Script - Winget App Audit](https://proval.itglue.com/DOC-5078775-17973897) | Internal Monitor | Detects Windows computers where the [Winget App Audit](https://proval.itglue.com/DOC-5078775-17973895) script has not been executed in the past 7 days. |
| △ Custom - Execute Script - Winget App Audit                             | Alert Template | Executes the [Winget App Audit](https://proval.itglue.com/DOC-5078775-17973895) script against the computers detected by the [Execute Script - Winget App Audit](https://proval.itglue.com/DOC-5078775-17973897) internal monitor. |

#### Automation

| Content                                                                 | Type          | Function                                                                                          |
|-------------------------------------------------------------------------|---------------|---------------------------------------------------------------------------------------------------|
| [Configure Winget Auto Update](https://proval.itglue.com/DOC-5078775-17973896) | Script        | Configures the [Winget-AutoUpdate](https://github.com/Romanitho/Winget-AutoUpdate) solution on the endpoint. |
| [pvl_wau_config](https://proval.itglue.com/DOC-5078775-17973964)      | Custom Table  | Stores the current configuration set for the computer from the client-level EDFs                  |
| [Winget Auto Update Errors](https://proval.itglue.com/DOC-5078775-17973900) | Remote Monitor | Check the error log file generated by the Winget Auto Update solution.                           |
| [Execute Script - Configure Winget Auto Update](https://proval.itglue.com/DOC-5078775-17973898) | Internal Monitor | Detects Windows computer where the [Configure Winget Auto Update](https://proval.itglue.com/DOC-5078775-17973896) script needs to be executed. |
| △ Custom - Execute Script - Configure Winget Auto Update               | Alert Template | Executes the [Configure Winget Auto Update](https://proval.itglue.com/DOC-5078775-17973896) script against the computers detected by the [Execute Script - Configure Winget Auto Update](https://proval.itglue.com/DOC-5078775-17973898) internal monitor. |

**Client-Level EDFs:**  
![Client-Level EDFs](..\..\static\img\Winget-Auto-Update\image_1.png)

`Exclude From Winget Auto Update` checkbox is available at the location and computer-level EDF section `Exclusions` to exclude the location and computer respectively.

**Note:** Refer to the [Client-Level EDF section](https://proval.itglue.com/5078775/docs/17973896#section-32120357) in the [script’s document](https://proval.itglue.com/DOC-5078775-17973896) for comprehensive details on EDFs.

## Implementation

1. Import the following auditing content using the ProSync Plugin:
   - [Script - Winget App Audit](https://proval.itglue.com/DOC-5078775-17973895)
   - [Dataview - Winget App Audit](https://proval.itglue.com/DOC-5078775-17973899)
   - [Internal Monitor - Execute Script - Winget App Audit](https://proval.itglue.com/DOC-5078775-17973897)
   - Alert Template - △ Custom - Execute Script - Winget App Audit

2. Import the following automation content (if approved) using the ProSync Plugin:
   - [Script - Configure Winget Auto Update](https://proval.itglue.com/DOC-5078775-17973896)
   - [Internal Monitor - Execute Script - Configure Winget Auto Update](https://proval.itglue.com/DOC-5078775-17973898)
   - Alert Template - △ Custom - Execute Script - Configure Winget Auto Update

3. Reload the system cache:  
   ![Reload Cache](..\..\static\img\Winget-Auto-Update\image_2.png)

4. Run the [Winget App Audit](https://proval.itglue.com/DOC-5078775-17973895) script with the `Set_Environment` parameter set to `1` for the first run to create the [pvl_winget_audit](https://proval.itglue.com/DOC-5078775-17973960) table used by the solution.  
   ![Run Winget App Audit](..\..\static\img\Winget-Auto-Update\image_3.png)

5. Run the [Configure Winget Auto Update](https://proval.itglue.com/DOC-5078775-17973896) script (if imported) with the `Set_Environment` parameter set to `1` for the first run to create the [pvl_wau_config](https://proval.itglue.com/DOC-5078775-17973964) table and the EDFs used by the solution.  
   ![Run Configure Winget Auto Update](..\..\static\img\Winget-Auto-Update\image_4.png)

6. Reload the system cache again:  
   ![Reload Cache](..\..\static\img\Winget-Auto-Update\image_2.png)

7. Configure the auditing solution as outlined below:
   - Navigate to Automation → Monitors within the CWA Control Center and setup the following:
     - [Internal Monitor - Execute Script - Winget App Audit](https://proval.itglue.com/DOC-5078775-17973897)  
       - Alert Template - `△ Custom - Execute Script - Winget App Audit`
       - Right-click and Run Now to start the monitor

8. Configure the automation solution (if approved) as outlined below:
   - Navigate to Automation → Monitors within the CWA Control Center and setup the following:
     - [Internal Monitor - Execute Script - Configure Winget Auto Update](https://proval.itglue.com/DOC-5078775-17973898)  
       - Alert Template - `△ Custom - Execute Script - Configure Winget Auto Update`
       - Right-click and Run Now to start the monitor


