---
id: 'cwa-workaround-windows-search-protocol-vulnerability'
title: 'Workaround for Windows Search Protocol Vulnerability'
title_meta: 'Workaround for Windows Search Protocol Vulnerability'
keywords: ['windows', 'vulnerability', 'workaround', 'search', 'protocol']
description: 'This document provides a comprehensive solution to apply a temporary workaround for the Windows Search Protocol Vulnerability as released by Microsoft. It includes associated content, implementation steps, and necessary roles and scripts to effectively manage the vulnerability.'
tags: ['vulnerability', 'windows', 'monitor', 'script', 'audit']
draft: false
unlisted: false
---
## Purpose

This solution applies the temporary workaround for the Windows Search Protocol Vulnerability, as released by Microsoft.  
Reference: [Windows Search Zero-Day Added to Microsoft Protocol Nightmare](https://www.bleepingcomputer.com/news/security/new-windows-search-zero-day-added-to-microsoft-protocol-nightmare/)

## Associated Content

| Content                                                                                                      | Type          | Function                                                                                                                                                                                                                   |
|--------------------------------------------------------------------------------------------------------------|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [Search-MS Registry Key](https://proval.itglue.com/DOC-5078775-10080552)                                   | Role          | This role is being used to detect the computers in need of a workaround.                                                                                                                                                 |
| [ProVal - Development - Workaround - Windows Search Protocol Vulnerability [G]](https://proval.itglue.com/DOC-5078775-10080562) | Internal Monitor | This monitor set will detect the computers with the [Search-MS Registry Key](https://proval.itglue.com/DOC-5078775-10080552) role enabled and will execute the [Workaround - Windows Search Protocol Vulnerability [Param][Autofix][DV]](https://proval.itglue.com/DOC-5078775-10080536) script to apply the autofix/workaround. |
| [Workaround - Windows Search Protocol Vulnerability [Param][Autofix][DV]](https://proval.itglue.com/DOC-5078775-10080536) | Script        | Primary purpose of the script is to take the backup of the HKEY_CLASSES_ROOT\search-ms registry keys and remove them from the computer. But it can be executed manually to restore the key in the hour of need as well.   |
| [Windows Search Protocol Registry Key Audit [Script][Role]](https://proval.itglue.com/DOC-5078775-10080544) | Dataview      | It serves a purpose of tracking the progress of the Workaround being applied by the [Workaround - Windows Search Protocol Vulnerability [Param][Autofix][DV]](https://proval.itglue.com/DOC-5078775-10080536) script and [ProVal - Development - Workaround - Microsoft Support Diagnostic Tool Vulnerability [G]](https://proval.itglue.com/DOC-5078775-10072205) monitor set. |

## Implementation

Step 1: Import the Role, [Search-MS Registry Key](https://proval.itglue.com/DOC-5078775-10080552).  
Step 2: Import the Internal Monitor, [ProVal - Development - Workaround - Windows Search Protocol Vulnerability [G]](https://proval.itglue.com/DOC-5078775-10080562).  
Step 3: Import the Script, [Workaround - Windows Search Protocol Vulnerability [Param][Autofix][DV]](https://proval.itglue.com/DOC-5078775-10080536).  
Step 4: Import the Dataview, [Windows Search Protocol Registry Key Audit [Script][Role]](https://proval.itglue.com/DOC-5078775-10080544).  
Step 5: Create an alert template "WorkAround - MSDT Vulnerability" to run the [Workaround - Windows Search Protocol Vulnerability [Param][Autofix][DV]](https://proval.itglue.com/DOC-5078775-10080536) script.  
Step 6: Now apply the "WorkAround - MSDT Vulnerability" template to the [ProVal - Development - Workaround - Windows Search Protocol Vulnerability [G]](https://proval.itglue.com/DOC-5078775-10080562) internal monitor.  
Step 7: Execute the "Update Config" command against the All agents groups.  
Step 8: Wait for 10 minutes.  
Step 9: Execute the "Resend System" command against the All agents groups.  

OR  

Step 1: Import the [Workaround - Windows Search Protocol Vulnerability [Param][Autofix][DV]](https://proval.itglue.com/DOC-5078775-10080536) script.  
Step 2: Execute it against a computer and it will import the rest of the contents.  
Step 3: Verify the existence of the contents.  
Step 4: Execute the "Update Config" command against the All agents groups.  
Step 5: Wait for 10 minutes.  
Step 6: Execute the "Resend System" command against the All agents groups.  

The above steps will do the work, but if you may need tickets for failures then you'll have to update the value of the Global variable `Ticket` to 1.


