---
id: 'f41e4d71-7074-4c28-8246-b8e3036c1212'
title: 'Managing Bitlocker Protection on Endpoints'
title_meta: 'Managing Bitlocker Protection on Endpoints'
keywords: ['bitlocker', 'encryption', 'security', 'audit', 'monitoring']
description: 'This document provides a comprehensive guide on managing Bitlocker protection on endpoints, including updates on auditing scripts, implementation steps, and optional configurations for automatic encryption and Active Directory backups.'
tags: ['encryption', 'audit', 'monitoring', 'windows', 'security']
draft: false
unlisted: false
---
## Purpose

To manage Bitlocker protection on endpoints.

## Update Notice: 6-Sept-2024

- The solution has been updated to store and display the data even if the computer is retired. However, the data cannot be displayed if the computer is also deleted from the retired assets.
- Modified Content:
  - [Script - Bitlocker - Audit](https://proval.itglue.com/DOC-5078775-8943478)
  - [Script - Bitlocker - AD Key Protector - Audit](https://proval.itglue.com/DOC-5078775-9045331)
  - [Custom Table - plugin_proval_bitlocker_audit](https://proval.itglue.com/DOC-5078775-8943520)
  - [Custom Table - plugin_proval_tpm_audit](https://proval.itglue.com/DOC-5078775-11140597)
- New Content:
  - [Dataview - Bitlocker Status - Retired Computers](https://proval.itglue.com/DOC-5078775-17010179)
- Sync the modified scripts from the `Prosync` plugin and run the [Bitlocker - Audit](https://proval.itglue.com/DOC-5078775-8943478) script against any online Windows computer with the `Set_Environment` parameter set to `1` to modify the custom tables.

![Image](../../static/img/Bitlocker/image_1.png)

## Associated Content

### Auditing Content

| Content | Type | Function |
|---------|------|----------|
| [Script - Bitlocker - Audit](https://proval.itglue.com/DOC-5078775-8943478) | Script | Gathers Bitlocker information from the target endpoint and stores it in the [Custom Table - plugin_proval_bitlocker_audit](https://proval.itglue.com/DOC-5078775-8943520). |
| [Script - Bitlocker - AD Key Protector - Audit](https://proval.itglue.com/DOC-5078775-9045331) | Script | Audits the existing backup Bitlocker key protectors from an Active Directory server. |
| [Script - Bitlocker Recovery Password - AD Backup](https://proval.itglue.com/DOC-5078775-10672949) | Script | This script will backup Bitlocker Recovery Passwords to the associated Active Directory instance. |
| [Dataview - Bitlocker Status](https://proval.itglue.com/DOC-5078775-8946167) | Dataview | Displays information from the [Custom Table - plugin_proval_bitlocker_audit](https://proval.itglue.com/DOC-5078775-8943520) filled by the [Script - Bitlocker - Audit](https://proval.itglue.com/DOC-5078775-8943478). Additionally displays information about the Active Directory backup status of each key protector. |
| [Dataview - Bitlocker Status - Retired Computers](https://proval.itglue.com/DOC-5078775-17010179) | Dataview | Displays the Bitlocker's data stored in the [Custom Table - plugin_proval_bitlocker_audit](https://proval.itglue.com/DOC-5078775-8943520) for the retired computers. |
| [SEC - Encryption - Dataview - Bitlocker - AD Backup Audit](https://proval.itglue.com/DOC-5078775-9045328) | Dataview | Displays Bitlocker key protectors backed up to Active Directory. |
| [Internal Monitor - ProVal - Production - Security - Stale Bitlocker Data](https://proval.itglue.com/DOC-5078775-12589046) | Internal Monitor | Detects the Windows computer where [Script - Bitlocker - Audit](https://proval.itglue.com/DOC-5078775-8943478) script has not executed within 30 days and triggers the audit script to run. |
| [CWM - Automate - Roles - Bitlocker](https://proval.itglue.com/DOC-5078775-17817010) | Role | These roles determine whether the Windows server is eligible for Bitlocker or not. These roles are also being used in [Internal Monitor - ProVal - Production - Security - Stale Bitlocker Data](https://proval.itglue.com/DOC-5078775-12589046). |
| [CWA Dataview - Bitlocker Initialize Failure Audit [Script]](https://proval.itglue.com/DOC-5078775-16786569) | Dataview (Optional) | This dataview contains the computer record where the BitLocker initialization failed twice by the Autofix script "[Script - Bitlocker - Volume - Initialize [Autofix, Param] - Wrapper](https://proval.itglue.com/DOC-5078775-16716755)". |

### Automation

| Content | Type | Function |
|---------|------|----------|
| [Script - Bitlocker - Initialize Volume](https://proval.itglue.com/DOC-5078775-8934308) | Script | Encrypts a drive with Bitlocker disk encryption. |
| [Script - Bitlocker - Remove Volume](https://proval.itglue.com/DOC-5078775-8953686) | Script | Disable Bitlocker protection on one (or all) volumes. |
| [Internal Monitor - Bitlocker - Missing Key Protectors](https://proval.itglue.com/DOC-5078775-13808695) | Internal Monitor | Detects the computer where Bitlocker is enabled, and the drive is fully encrypted but does not have any key protectors. |
| [Bitlocker - Volume - Add Recovery Password [Autofix]](https://proval.itglue.com/DOC-5078775-13808694) | Script | Add a recovery password to the drive where BitLocker is enabled but a key protector is not found. It is an autofix script for the [Internal Monitor - Bitlocker - Missing Key Protectors](https://proval.itglue.com/DOC-5078775-13808695) monitor set. |
| △ Custom - Execute Script - Bitlocker - Volume - Add Recovery Password | Alert Template | This will be used with the [Internal Monitor - Bitlocker - Missing Key Protectors](https://proval.itglue.com/DOC-5078775-13808695) and should execute the script [Bitlocker - Volume - Add Recovery Password [Autofix]](https://proval.itglue.com/DOC-5078775-13808694). |
| [Script - Bitlocker - Volume - Initialize [Autofix,Param] - Wrapper](https://proval.itglue.com/DOC-5078775-16716755) | Script (Optional) | This script runs as an autofix to deploy the BitLocker initialization to the agents detected by the monitor [Internal Monitor - Bitlocker - Initialize Volume Deployment](https://proval.itglue.com/DOC-5078775-16773035). |
| [Internal Monitor - Bitlocker - Initialize Volume Deployment](https://proval.itglue.com/DOC-5078775-16773035) | Internal Monitor (Optional) | This internal monitor detects the online supported Windows OS (Windows 10/11, Windows Server 2016, 2019, and 2022) which is not updated in the table `plugin_proval_bitlocker_audit` in the last 7 days and does not have the keyprotectorid and protectionstatus set. It also checks if the location-EDF 'BitLocker Enable List' is set to either "AllDrive" or "SystemDrive" from the dropdown option and the computer-EDF 'BitLocker Enable Exclude' is not checked. It ensures running the [Script - Bitlocker - Volume - Initialize [Autofix,Param] - Wrapper](https://proval.itglue.com/DOC-5078775-16716755) once every 7 days on the detected agents of the monitor to remove the reiterate attempts numerous times. |
| △ Custom - Execute Script - Bitlocker - Volume - Initialize [Autofix] - Wrapper | Alert Template (Optional) | This alert template needs to be applied on [Internal Monitor - Bitlocker - Initialize Volume Deployment](https://proval.itglue.com/DOC-5078775-16773035) and should execute the [Script - Bitlocker - Volume - Initialize [Autofix,Param] - Wrapper](https://proval.itglue.com/DOC-5078775-16716755). |
| [Remote Monitor - Enable Bitlocker Feature](https://proval.itglue.com/DOC-5078775-14612201) | Remote Monitor | Enables the below Bitlocker feature on the Windows server if it's not already installed. \<ul>\<li>BitLocker Drive Encryption Administration Utilities\</li>\<li>BitLocker Recovery Password Viewer\</li>\<li>BitLocker Drive Encryption Tools\</li>\</ul> |

### Other Content

| Content | Type | Function |
|---------|------|----------|
| [Agnostic - Initialize-BitLockerVolume](https://proval.itglue.com/DOC-5078775-8931801) | Agnostic | Encrypts a drive with Bitlocker disk encryption. |
| [Agnostic - Unprotect-BitLockerVolume](https://proval.itglue.com/DOC-5078775-8952850) | Agnostic | Disable Bitlocker protection on one (or all) volumes. |
| [Agnostic - Get-ADBitlockerStores](https://proval.itglue.com/DOC-5078775-9038164) | Agnostic | Returns objects from AD representing backed up Bitlocker key protectors. |
| [Custom Table - plugin_proval_bitlocker_audit](https://proval.itglue.com/DOC-5078775-8943520) | Custom Table | Stores information about Bitlocker configuration on target machines. |
| [Custom Table - plugin_proval_ad_bitlocker_keyprotectors](https://proval.itglue.com/DOC-5078775-9045330) | Custom Table | Stores information about Bitlocker key protectors backed up to Active Directory. |
| [Custom Table - plugin_proval_tpm_audit](https://proval.itglue.com/DOC-5078775-11140597) | Custom Table | This Table will be populated by the [Script - Bitlocker - Audit](https://proval.itglue.com/DOC-5078775-8943478). It holds all data from the Get-TPM command. |

## Implementation

1. Import the following scripts using the ProSync plugin:
   - [Script - Bitlocker - Initialize Volume](https://proval.itglue.com/DOC-5078775-8934308)
   - [Script - Bitlocker - Remove Volume](https://proval.itglue.com/DOC-5078775-8953686)
   - [Script - Bitlocker - Audit](https://proval.itglue.com/DOC-5078775-8943478)
   - [Script - Bitlocker - AD Key Protector - Audit](https://proval.itglue.com/DOC-5078775-9045331)

2. Import the following Dataviews using the ProSync Plugin:
   - [Dataview - Bitlocker Status](https://proval.itglue.com/DOC-5078775-8946167)
   - [Dataview - Bitlocker Status - Retired Computers](https://proval.itglue.com/DOC-5078775-17010179)

3. Import the following monitors using the ProSync Plugin:
   - [Internal Monitor - ProVal - Production - Security - Stale Bitlocker Data](https://proval.itglue.com/DOC-5078775-12589046)

4. Import the following Alert Templates using the ProSync plugin:
   - △ Custom - Execute Script - Bitlocker - Audit

5. Import the following roles using the SQL provided in the [CWM - Automate - Roles - Bitlocker](https://proval.itglue.com/DOC-5078775-17817010):
   - Windows Server Bitlocker
   - Windows Server Bitlocker-Utilities
   - Windows Server BitLocker-RemoteAdminTool

6. Reload the System Cache  
   ![Image](../../static/img/Bitlocker/image_2.png)

7. Execute the [Script - Bitlocker - Audit](https://proval.itglue.com/DOC-5078775-8943478) against any online windows computer with the `Set_Environment` parameter set to `1` to create the custom tables used by the solution.  
   ![Image](../../static/img/Bitlocker/image_3.png)

8. Configure the solution as follows:
   - Navigate to Automation --> Monitors within the CWA Control Center and setup the following:
     - [Internal Monitor - ProVal - Production - Security - Stale Bitlocker Data](https://proval.itglue.com/DOC-5078775-12589046)
       - Configure with the alert template: `△ Custom - Execute Script - Bitlocker - Audit`
       - Right-click and Run Now to start the monitor
   - Use the implementation Instructions in the below document to set up this remote monitor:
     - [Remote Monitor - Enable Bitlocker Feature](https://proval.itglue.com/DOC-5078775-14612201)
       - Import this monitor to the Domain Controllers group
       - **Do NOT** assign any alert template to the monitor.

### Optional

#### Auto Encryption

1. If the partner would like to perform the auto-deployment of the Bitlocker - Initialize volume then only get the below document imported and implemented as mentioned below:
   - Import the internal monitor:  
     [Internal Monitor - Bitlocker - Initialize Volume Deployment](https://proval.itglue.com/DOC-5078775-16773035)
   - Import the dataview:  
     [CWA Dataview - Bitlocker Initialize Failure Audit [Script]](https://proval.itglue.com/DOC-5078775-16786569)
   - Import the script:  
     [Script - Bitlocker - Volume - Initialize [Autofix, Param] - Wrapper](https://proval.itglue.com/DOC-5078775-16716755)
   - Import the alert template:  
     △ Custom - Execute Script - Bitlocker - Volume - Initialize [Autofix] - Wrapper
   - Configure the monitor [Internal Monitor - Bitlocker - Initialize Volume Deployment](https://proval.itglue.com/DOC-5078775-16773035) with the alert template: `△ Custom - Execute Script - Bitlocker - Volume - Initialize [Autofix] - Wrapper`
   - Right-click and Run Now to start the monitor.

#### Bitlocker - AD Backup

1. If the partner would like their **recovery keys backed up into Active Directory**, a GPO must be created to support this. 
   - Import the script:  
     [Script - Bitlocker Recovery Password - AD Backup](https://proval.itglue.com/DOC-5078775-10672949)  
     [Bitlocker - AD Key Protector - Audit](https://proval.itglue.com/DOC-5078775-9045331)
   - Import the Dataview:  
     [Dataview - Bitlocker AD Backups](https://proval.itglue.com/DOC-5078775-9045328)  
   - Use the following doc to implement this:
     - After the GPO has been created, Run the [Script - Bitlocker Recovery Password - AD Backup](https://proval.itglue.com/DOC-5078775-10672949) on a single domain joined workstation at that client to validate the settings
     - [Bitlocker - AD Key Protector - Audit](https://proval.itglue.com/DOC-5078775-9045331) (Tutorial at the bottom of the document)

#### Missing Key Protectors

1. If the partner would like to ensure the monitor set detects the computer where Bitlocker is enabled, and the drive is fully encrypted but does not have any key protectors. Follow the below steps to set this:
   - Import the internal monitor:  
     [Internal Monitor - Bitlocker - Missing Key Protectors](https://proval.itglue.com/DOC-5078775-13808695)  
   - Import the script:  
     [Bitlocker - Volume - Add Recovery Password [Autofix]](https://proval.itglue.com/DOC-5078775-13808694).  
   - Configure with the alert template: `△ Custom - Execute Script - Bitlocker - Volume - Add Recovery Password`
     - Right-click and Run Now to start the monitor.












