---
id: '7736f421-bfd6-41c0-ba75-5eba3bc82f78'
title: 'CVE-2022-30190 MSDT Vulnerability - Workarounds'
title_meta: 'CVE-2022-30190 MSDT Vulnerability - Workarounds'
keywords: ['microsoft', 'vulnerability', 'workaround', 'msdt', 'security']
description: 'This document provides a comprehensive solution for applying a temporary workaround for the Microsoft Support Diagnostic Tool Vulnerability (CVE-2022-30190) as released by Microsoft. It includes detailed implementation steps and associated content for monitoring and restoring registry keys.'
tags: ['backup', 'security', 'windows']
draft: false
unlisted: false
---

## Purpose

This solution applies the temporary workaround for the Microsoft Support Diagnostic Tool Vulnerability, as released by Microsoft.  
Reference:  
[Guidance for CVE-2022-30190 Microsoft Support Diagnostic Tool Vulnerability](https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/)  
[Microsoft Update Guide for CVE-2022-30190](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-30190)

## Associated Content

| Content                                                                                                           | Type          | Function                                                                                                                                                                                                                                      |
|-------------------------------------------------------------------------------------------------------------------|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [MS-MSDT Registry Key](<../cwa/roles/MS-MSDT Registry Key.md>)                                                 | Role          | This role is used to detect the computers in need of a workaround.                                                                                                                                                                        |
| [ProVal - Development - Workaround - Microsoft Support Diagnostic Tool Vulnerability [G]](<../cwa/monitors/Microsoft Support Diagnostic Tool Vulnerability G.md>) | Internal Monitor | This monitor set will detect the computers with the [MS-MSDT Registry Key](<../cwa/roles/MS-MSDT Registry Key.md>) role enabled and will execute the [Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]](<../cwa/scripts/Workaround - Microsoft Support Diagnostic Tool Vulnerability.md>) script to apply the autofix/workaround. |
| [Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]](<../cwa/scripts/Workaround - Microsoft Support Diagnostic Tool Vulnerability.md>) | Script        | The primary purpose of the script is to take a backup of the HKEY_CLASSES_ROOT/ms-msdt registry keys and remove them from the computer. However, it can also be executed manually to restore the key in case of need.                           |
| [Microsoft Support Diagnostic Tool Registry Key Audit [Script][Role]](<../cwa/dataviews/Microsoft Support Diagnostic Tool Registry Key AuditScriptRole.md>) | Dataview      | This serves the purpose of tracking the progress of the workaround being applied by the [Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]](<../cwa/scripts/Workaround - Microsoft Support Diagnostic Tool Vulnerability.md>) script and the [ProVal - Development - Workaround - Microsoft Support Diagnostic Tool Vulnerability [G]](<../cwa/monitors/Microsoft Support Diagnostic Tool Vulnerability G.md>) monitor set. |
| [ProVal - Development - Restore MS-MSDT Registry Key [G]](<../cwa/monitors/Restore MS-MSDT Registry Key G.md>)       | Internal Monitor | This will run the [Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]](<../cwa/scripts/Workaround - Microsoft Support Diagnostic Tool Vulnerability.md>) script to restore the key on computers where the recommended patches are installed. |

## Implementation

1. Import the Role, [MS-MSDT Registry Key](<../cwa/roles/MS-MSDT Registry Key.md>).
2. Import the Internal Monitor, [ProVal - Development - Workaround - Microsoft Support Diagnostic Tool Vulnerability [G]](<../cwa/monitors/Microsoft Support Diagnostic Tool Vulnerability G.md>).
3. Import the Script, [Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]](<../cwa/scripts/Workaround - Microsoft Support Diagnostic Tool Vulnerability.md>).
4. Import the Dataview, [Microsoft Support Diagnostic Tool Registry Key Audit [Script][Role]](<../cwa/dataviews/Microsoft Support Diagnostic Tool Registry Key AuditScriptRole.md>).
5. Create an alert template "WorkAround - MSDT Vulnerability" to run the [Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]](<../cwa/scripts/Workaround - Microsoft Support Diagnostic Tool Vulnerability.md>) script.
6. Apply the "WorkAround - MSDT Vulnerability" template to the [ProVal - Development - Workaround - Microsoft Support Diagnostic Tool Vulnerability [G]](<../cwa/monitors/Microsoft Support Diagnostic Tool Vulnerability G.md>) internal monitor.
7. Execute the "Update Config" command against all agent groups.
8. Wait for 10 minutes.
9. Execute the "Resend System" command against all agent groups.

**OR**

1. Import the [Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]](<../cwa/scripts/Workaround - Microsoft Support Diagnostic Tool Vulnerability.md>) script.
2. Execute it against a computer, and it will import the rest of the contents.
3. Verify the existence of the contents.
4. Execute the "Update Config" command against all agent groups.
5. Wait for 10 minutes.
6. Execute the "Resend System" command against all agent groups.

The above steps will accomplish the task, but if you need tickets for failures, you will have to update the value of the global variable `Ticket` to 1.

### Introduction to a New Internal Monitor:

1. Import the "[ProVal - Development - Restore MS-MSDT Registry Key [G]](<../cwa/monitors/Restore MS-MSDT Registry Key G.md>)" monitor set from the pro-sync plugin.
2. Update the [ProVal - Development - Workaround - Microsoft Support Diagnostic Tool Vulnerability [G]](<../cwa/monitors/Microsoft Support Diagnostic Tool Vulnerability G.md>) monitor set from the pro-sync plugin.
3. Update the [Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]](<../cwa/scripts/Workaround - Microsoft Support Diagnostic Tool Vulnerability.md>) script from the pro-sync plugin.



