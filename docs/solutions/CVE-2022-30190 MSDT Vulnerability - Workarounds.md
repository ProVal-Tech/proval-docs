---
id: '7736f421-bfd6-41c0-ba75-5eba3bc82f78'
title: 'Workaround for Microsoft Support Diagnostic Tool Vulnerability'
title_meta: 'Workaround for Microsoft Support Diagnostic Tool Vulnerability'
keywords: ['microsoft', 'vulnerability', 'workaround', 'msdt', 'security']
description: 'This document provides a comprehensive solution for applying a temporary workaround for the Microsoft Support Diagnostic Tool Vulnerability (CVE-2022-30190) as released by Microsoft. It includes detailed implementation steps and associated content for monitoring and restoring registry keys.'
tags: ['backup', 'security', 'windows']
draft: false
unlisted: false
---
## Purpose

This solution applies the temporary workaround for the Microsoft Support Diagnostic Tool Vulnerability, as released by Microsoft.  
Reference:  
[Guidance for CVE-2022-30190 Microsoft Support Diagnostic Tool Vulnerability](https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/)  
[Microsoft Update Guide for CVE-2022-30190](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-30190)

## Associated Content

| Content                                                                                                           | Type          | Function                                                                                                                                                                                                                                      |
|-------------------------------------------------------------------------------------------------------------------|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [MS-MSDT Registry Key](<../cwa/roles/MS-MSDT Registry Key.md>)                                         | Role          | This role is being used to detect the computers in need of a workaround.                                                                                                                                                                   |
| [ProVal - Development - Workaround - Microsoft Support Diagnostic Tool Vulnerability [G]](<../cwa/monitors/Microsoft Support Diagnostic Tool Vulnerability G.md>) | Internal Monitor | This monitor set will detect the computers with the [MS-MSDT Registry Key](<../cwa/roles/MS-MSDT Registry Key.md>) role enabled and will execute the [Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]](<../cwa/scripts/Workaround - Microsoft Support Diagnostic Tool Vulnerability.md>) script to apply the autofix/workaround. |
| [Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]](<../cwa/scripts/Workaround - Microsoft Support Diagnostic Tool Vulnerability.md>) | Script        | Primary purpose of the script is to take the backup of the HKEY_CLASSES_ROOT/ms-msdt registry keys and remove them from the computer. But it can be executed manually to restore the key in the hour of need as well.                      |
| [Microsoft Support Diagnostic Tool Registry Key Audit[Script][Role]](<../cwa/dataviews/Microsoft Support Diagnostic Tool Registry Key AuditScriptRole.md>) | Dataview      | It serves a purpose of tracking the progress of the Workaround being applied by the [Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]](<../cwa/scripts/Workaround - Microsoft Support Diagnostic Tool Vulnerability.md>) script and [ProVal - Development - Workaround - Microsoft Support Diagnostic Tool Vulnerability [G]](<../cwa/monitors/Microsoft Support Diagnostic Tool Vulnerability G.md>) monitor set. |
| [ProVal - Development - Restore MS-MSDT Registry Key [G]](<../cwa/monitors/Restore MS-MSDT Registry Key G.md>)       | Internal Monitor | It will run the [Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]](<../cwa/scripts/Workaround - Microsoft Support Diagnostic Tool Vulnerability.md>) script to restore the key against the computers where the recommended patches are installed. |

## Implementation

Step 1: Import the Role, [MS-MSDT Registry Key](<../cwa/roles/MS-MSDT Registry Key.md>).  
Step 2: Import the Internal Monitor, [ProVal - Development - Workaround - Microsoft Support Diagnostic Tool Vulnerability [G]](<../cwa/monitors/Microsoft Support Diagnostic Tool Vulnerability G.md>).  
Step 3: Import the Script, [Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]](<../cwa/scripts/Workaround - Microsoft Support Diagnostic Tool Vulnerability.md>).  
Step 4: Import the Dataview, [Microsoft Support Diagnostic Tool Registry Key Audit[Script][Role]](<../cwa/dataviews/Microsoft Support Diagnostic Tool Registry Key AuditScriptRole.md>).  
Step 5: Create an alert template "WorkAround - MSDT Vulnerability" to run the [Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]](<../cwa/scripts/Workaround - Microsoft Support Diagnostic Tool Vulnerability.md>) script.  
Step 6: Now apply the "WorkAround - MSDT Vulnerability" template to the [ProVal - Development - Workaround - Microsoft Support Diagnostic Tool Vulnerability [G]](<../cwa/monitors/Microsoft Support Diagnostic Tool Vulnerability G.md>) internal monitor.  
Step 7: Execute the "Update Config" command against all agent groups.  
Step 8: Wait for 10 minutes.  
Step 9: Execute the "Resend System" command against all agent groups.  

OR

Step 1: Import the [Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]](<../cwa/scripts/Workaround - Microsoft Support Diagnostic Tool Vulnerability.md>) script.  
Step 2: Execute it against a computer and it will import the rest of the contents.  
Step 3: Verify the existence of the contents.  
Step 4: Execute the "Update Config" command against all agent groups.  
Step 5: Wait for 10 minutes.  
Step 6: Execute the "Resend System" command against all agent groups.  

The above steps will do the work, but if you may need tickets for failures then you'll have to update the value of the Global variable `Ticket` to 1.

Introduction to a new internal monitor:  

Step 1: Import the "[ProVal - Development - Restore MS-MSDT Registry Key [G]](<../cwa/monitors/Restore MS-MSDT Registry Key G.md>)" monitor set from the pro-sync plugin.  
Step 2: Update the [ProVal - Development - Workaround - Microsoft Support Diagnostic Tool Vulnerability [G]](<../cwa/monitors/Microsoft Support Diagnostic Tool Vulnerability G.md>) monitor set from the pro-sync plugin.  
Step 3: Update the [Workaround - Microsoft Support Diagnostic Tool Vulnerability [Param][Autofix][DV]](<../cwa/scripts/Workaround - Microsoft Support Diagnostic Tool Vulnerability.md>) script from the pro-sync plugin.












