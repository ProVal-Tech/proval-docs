---
id: '5756f649-47ee-4bf0-b8ef-f65eeb4453fe'
title: 'Windows 10 Feature Upgrade with Mandatory Reboot'
title_meta: 'Windows 10 Feature Upgrade with Mandatory Reboot'
keywords: ['windows', 'upgrade', 'feature', 'reboot', 'patching']
description: 'This document outlines the process of initiating a Windows 10 feature upgrade that requires a mandatory reboot. It includes a summary of the procedure, sample run logs, and detailed steps of the process involved in executing the upgrade and scheduling necessary tasks.'
tags: ['upgrade', 'windows', 'reboot', 'patching', 'automation']
draft: false
unlisted: false
---
## Summary

Initiates a Windows Feature Upgrade with mandatory reboot

## Sample Run

| Time                   | Task                                                         | Status                                                                                           | Link                          |
|------------------------|--------------------------------------------------------------|--------------------------------------------------------------------------------------------------|-------------------------------|
| 3:57:45 pm 31-Aug-22  | Windows 10 Feature Upgrade                                   | Success THEN                                                                                     | [provaltech.com/dan.hicks](https://provaltech.com/dan.hicks) |
| 3:57:45 pm 31-Aug-22  | Windows 10 Feature Upgrade                                   | Script Registry Check was successfully scheduled to run in 1 hours                              | [provaltech.com/dan.hicks](https://provaltech.com/dan.hicks) |
| 3:57:45 pm 31-Aug-22  | Windows 10 Feature Upgrade                                   | Raw PS1 Data: Id Name PSJobTypeName State HasMoreData Location Command -- ---- ------------- ----- ----------- -------- ------- 1 Job1 BackgroundJob Running True localhost C:/ProgramData/_autom... | [provaltech.com/dan.hicks](https://provaltech.com/dan.hicks) |
| 3:57:45 pm 31-Aug-22  | Execute Powershell Command (64-bit, Run As System)         | Success THEN                                                                                     | [provaltech.com/dan.hicks](https://provaltech.com/dan.hicks) |
| 3:57:45 pm 31-Aug-22  | Execute Powershell Command (64-bit, Run As System)-0016    | Powershell command complete. Results returned to global variable #global:psresult# and saved in Agent's Documents tab of server. | [provaltech.com/dan.hicks](https://provaltech.com/dan.hicks) |
| 3:57:32 pm 31-Aug-22  | Execute Powershell Command (64-bit, Run As System)-0011    | Executing 64-bit Powershell command as System: "" -command "Start-Job -ScriptBlock \{ C:/ProgramData/_automation/AgentProcedure/UpdateWindows10/Update-Windows10.ps1 -Reboot None}" >"c:/provaltech/psoutputtmp.txt" | [provaltech.com/dan.hicks](https://provaltech.com/dan.hicks) |
| 3:57:32 pm 31-Aug-22  | Execute Powershell Command (64-bit, Run As System)-0013    | Sending output to global variable.                                                               | [provaltech.com/dan.hicks](https://provaltech.com/dan.hicks) |
| 3:57:32 pm 31-Aug-22  | Execute Powershell Command (64-bit, Run As System)-0008    | Custom commands detected as Start-Job -ScriptBlock \{ C:/ProgramData/_automation/AgentProcedure/UpdateWindows10/Update-Windows10.ps1 -Reboot None} | [provaltech.com/dan.hicks](https://provaltech.com/dan.hicks) |
| 3:57:32 pm 31-Aug-22  | Execute Powershell Command (64-bit, Run As System)-0003    | No powershell file variable detected.                                                            | [provaltech.com/dan.hicks](https://provaltech.com/dan.hicks) |
| 3:57:31 pm 31-Aug-22  | Execute Powershell Command (64-bit, Run As System)-0002    | Powershell is present.                                                                            | [provaltech.com/dan.hicks](https://provaltech.com/dan.hicks) |
| 3:57:17 pm 31-Aug-22  | Execute Powershell Command                                   | Success THEN                                                                                     | [provaltech.com/dan.hicks](https://provaltech.com/dan.hicks) |
| 3:57:16 pm 31-Aug-22  | Execute Powershell Command-0011                             | Powershell command completed!                                                                     | [provaltech.com/dan.hicks](https://provaltech.com/dan.hicks) |
| 3:57:13 pm 31-Aug-22  | Execute Powershell Command-0011                             | Executing powershell "" -Command "New-Item -Type Directory -Path $env:ProgramData/_automation/AgentProcedure -name UpdateWindows10" "" | [provaltech.com/dan.hicks](https://provaltech.com/dan.hicks) |
| 3:57:13 pm 31-Aug-22  | Execute Powershell Command-0010                             | Not sending output to variable.                                                                    | [provaltech.com/dan.hicks](https://provaltech.com/dan.hicks) |
| 3:57:13 pm 31-Aug-22  | Execute Powershell Command-0008                             | New command variable is: -Command "New-Item -Type Directory -Path $env:ProgramData/_automation/AgentProcedure -name UpdateWindows10" | [provaltech.com/dan.hicks](https://provaltech.com/dan.hicks) |
| 3:57:13 pm 31-Aug-22  | Execute Powershell Command-0008                             | Custom commands detected as New-Item -Type Directory -Path $env:ProgramData/_automation/AgentProcedure -name UpdateWindows10 | [provaltech.com/dan.hicks](https://provaltech.com/dan.hicks) |
| 3:57:05 pm 31-Aug-22  | Execute Powershell Command-0002                             | Powershell is present.                                                                            | [provaltech.com/dan.hicks](https://provaltech.com/dan.hicks) |
| 3:56:58 pm 31-Aug-22  | Get Add/Remove Programs List                                 | Success THEN                                                                                     |                               |
| 3:56:57 pm 31-Aug-22  | SW License Audit                                             | Success THEN                                                                                     |                               |
| 3:56:57 pm 31-Aug-22  | Close KLicense                                              | Success ELSE                                                                                     |                               |
| 3:56:57 pm 31-Aug-22  | Check if KLicense running                                    | Success ELSE                                                                                     |                               |
| 3:56:05 pm 31-Aug-22  | Run Now - Windows 10 Feature Upgrade                        | Admin [provaltech.com/dan.hicks](https://provaltech.com/dan.hicks) scheduled procedure Run Now - Windows 10 Feature Upgrade to run at Aug 31 2022 3:56PM |                               |

## Process

Starts a job running in the background to execute [SEC - Windows Patching - Agnostic - Update-Windows10](https://proval.itglue.com/DOC-5078775-9447713) on the machine with no reboot.  
Schedules [SEC - Windows Patching - Agent Procedure - Registry Check](https://proval.itglue.com/DOC-5078775-10784806) for 1 hour from run time.  
Sets [SEC - Windows Patching - Custom Fields - xPVAL Windows Feature Upgrade Status](https://proval.itglue.com/DOC-5078775-10784808) to [In Progress].

## Output

AP Log  
[SEC - Windows Patching - Custom Fields - xPVAL Windows Feature Upgrade Status](https://proval.itglue.com/DOC-5078775-10784808)  
PSOutput Document













