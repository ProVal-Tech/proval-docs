---
id: 'afca866d-b468-437d-8555-5928d2bed089'
title: 'Patch Counts Report for ConnectWise Automate'
title_meta: 'Patch Counts Report for ConnectWise Automate'
keywords: ['patches', 'count', 'approval', 'missing', 'report', 'connectwise']
description: 'This document provides a detailed overview of patch counts in ConnectWise Automate, including missing patches and those without approval. It includes SQL representation for generating the report and insights into the status of Microsoft patches across servers and workstations.'
tags: ['report', 'patches', 'missing', 'approval', 'connectwise', 'software', 'windows']
draft: true
unlisted: false
---
## Summary

This Dataview contains counts of missing patches and patches that have no approval across the entire Automate instance.

## Columns

| Column                     | Description                                                                                   |
|---------------------------|-----------------------------------------------------------------------------------------------|
| Server Missing            | It shows count of Microsoft patches missing for the servers.                                 |
| PerServer                 | It shows the percentage of patches missing per server.                                       |
| Workstation Missing        | It shows count of Microsoft patches missing for the workstations.                            |
| PerWorkstation             | It shows the percentage of patches missing per workstation.                                   |
| Total Missing             | It shows the count of the total Microsoft missing patches.                                   |
| TotalPerMachine           | It shows the percentage of total patches missing on total agent count.                       |
| Total Missing Unfiltered   | It shows the count of the total patches missing in the environment.                          |
| Total Approved            | It shows the count of total approved patches in the environment.                             |
| Total Not Set            | It shows the count of total "Not Set" patches, meant which has not been actioned by any approval policies. |

## SQL Representation

```
SELECT 
  server.`Server Missing` as `Server Missing`, 
  ROUND(
    server.`Server Missing` /(
      SELECT 
        COUNT(computerid) 
      FROM 
        computerpatchpolicies 
      WHERE 
        installpolicy IN(
          SELECT 
            id 
          FROM 
            installsoftwarepolicies 
          WHERE 
            updatemode IN(5, 6)
        ) 
        AND computerid IN(
          SELECT 
            computerid 
          FROM 
            computers 
          WHERE 
            OS LIKE '%server%'
        )
    ), 
    2
  ) as PerServer, 
  workstation.`Workstation Missing` as `Workstation Missing`, 
  ROUND(
    workstation.`Workstation Missing` /(
      SELECT 
        COUNT(computerid) 
      FROM 
        computerpatchpolicies 
      WHERE 
        installpolicy IN(
          SELECT 
            id 
          FROM 
            installsoftwarepolicies 
          WHERE 
            updatemode IN(5, 6)
        ) 
        AND computerid IN(
          SELECT 
            computerid 
          FROM 
            computers 
          WHERE 
            OS NOT LIKE '%server%'
        )
    ), 
    2
  ) as PerWorkstation, 
  total.`Total Missing` as `Total Missing`, 
  ROUND(
    Total.`Total Missing` /(
      SELECT 
        COUNT(computerid) 
      FROM 
        computerpatchpolicies 
      WHERE 
        installpolicy IN(
          SELECT 
            id 
          FROM 
            installsoftwarepolicies 
          WHERE 
            updatemode IN(5, 6)
        ) 
        AND computerid IN(
          SELECT 
            computerid 
          FROM 
            computers
        )
    ), 
    2
  ) as TotalPerMachine, 
  `Total Missing unfiltered`.`Total Missing Unfiltered` as `Total Missing Unfiltered`, 
  CountApproved.`Total Approved`, 
  CountNotSet.`Total Not Set` 
FROM 
  (
    (
      (
        (
          (
            SELECT 
              COUNT(*) AS `Server Missing` 
            FROM 
              hotfix 
            WHERE 
              approved = 2 
              AND installed = 0 
              AND OS LIKE '%server%' 
              AND hotfixid IN(
                SELECT 
                  hotfixid 
                FROM 
                  `hotfixdata` 
                WHERE 
                  manufacturer = 'Microsoft'
              ) 
              AND computerid IN(
                SELECT 
                  computerid 
                FROM 
                  computerpatchpolicies 
                WHERE 
                  installpolicy IN(
                    SELECT 
                      id 
                    FROM 
                      `installsoftwarepolicies` 
                    WHERE 
                      updatemode IN('5', '6')
                  )
              )
          ) AS `Server`
        ) 
        JOIN (
          SELECT 
            COUNT(*) AS `Workstation Missing` 
          FROM 
            hotfix 
          WHERE 
            approved = 2 
            AND installed = 0 
            AND OS NOT LIKE '%server%' 
            AND hotfixid IN(
              SELECT 
                hotfixid 
              FROM 
                `hotfixdata` 
              WHERE 
                manufacturer = 'Microsoft'
            ) 
            AND computerid IN(
              SELECT 
                computerid 
              FROM 
                computerpatchpolicies 
              WHERE 
                installpolicy IN(
                  SELECT 
                    id 
                  FROM 
                    `installsoftwarepolicies` 
                  WHERE 
                    updatemode IN('5', '6')
                )
            )
        ) AS `Workstation`
      ) 
      JOIN (
        SELECT 
          COUNT(*) AS `Total Missing` 
        FROM 
          hotfix 
        WHERE 
          approved = 2 
          AND installed = 0 
          AND hotfixid IN(
            SELECT 
              hotfixid 
            FROM 
              `hotfixdata` 
            WHERE 
              manufacturer = 'Microsoft'
          ) 
          AND computerid IN(
            SELECT 
              computerid 
            FROM 
              computerpatchpolicies 
            WHERE 
              installpolicy IN(
                SELECT 
                  id 
                FROM 
                  `installsoftwarepolicies` 
                WHERE 
                  updatemode IN('5', '6')
              )
          )
      ) AS `Total`
    ) 
    JOIN (
      SELECT 
        COUNT(*) AS `Total Missing Unfiltered` 
      FROM 
        hotfix 
      WHERE 
        approved = 2 
        AND installed = 0 
        AND hotfixid IN(
          SELECT 
            hotfixid 
          FROM 
            `hotfixdata` 
          WHERE 
            manufacturer = 'Microsoft'
        )
    ) AS `Total Missing Unfiltered`
  ) 
  JOIN (
    (
      SELECT 
        COUNT(*) AS `Total Approved` 
      FROM 
        (
          (
            `patchapprovalsettings` 
            JOIN `hotfixdata` ON (
              (
                (
                  `patchapprovalsettings`.`HotFixID` = `hotfixdata`.`LTProductKey`
                ) 
                AND (
                  `patchapprovalsettings`.`OS` = `hotfixdata`.`OS`
                )
              )
            )
          ) 
          JOIN `approvalpolicies` ON (
            (
              `patchapprovalsettings`.`ApprovalPolicyID` = `approvalpolicies`.`ID`
            )
          )
        ) 
      WHERE 
        (
          ApprovalPolicyID =(
            SELECT 
              id 
            FROM 
              approvalpolicies 
            WHERE 
              requiresapproval = 1
          )
        ) 
        AND (
          `hotfixdata`.`Manufacturer` IN ('Microsoft')
        )
    ) AS CountApproved
  ) 
  JOIN (
    SELECT 
      COUNT(*) AS `Total Not Set` 
    FROM 
      `hotfixdata` 
    WHERE 
      approvalpolicycount = 0
  ) AS CountNotSet
```














