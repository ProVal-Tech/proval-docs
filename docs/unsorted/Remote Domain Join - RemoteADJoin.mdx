---
id: 'b30fa1c5-4c3a-41f5-bebf-dcbca148b470'
title: 'Remote Domain Join Using Kaseya API'
title_meta: 'Remote Domain Join Using Kaseya API'
keywords: ['kaseya', 'domain', 'join', 'api', 'remote']
description: 'This document outlines a program pair that facilitates remote domain joining of machines without direct domain access by utilizing the Kaseya API. It details the processes involved, parameters required, and output generated during the execution of the program.'
tags: ['kaseya', 'configuration', 'setup', 'windows', 'networking', 'security']
draft: true
unlisted: false
---
## OverView

This Program pair are used to remote domain join a machine without connection access to the domain using Kaseya API by running on the endpoint and the dc.  
The endpoint requires a restart.  
This will and can rename the machine if specified, otherwise the machine will use the computer name.

## Process

#### GetDCKasyeaNameAPI.exe

This Executable uses API to get its own agent details. It uses its org id for its agent result to get the most common domain in the org, then gets the DC for that domain.  
The executable then pushes its details to that dc using api and the dc's agent guid and executes a agent procedure on that dc.  
Finally the executable waits for its own domain join payload file to appear in its API documents folder, at which point it will domain join the machine.  
If the program does not see the payload file after 10 min it will die.

#### CreateDJOINFileAPI.exe

This Executable is called by an agent procedure fired from another executable on the endpoint.  
It gets all the detail files from its API documents folder and then makes payloads for the ones that do not have payloads on the end point.  
Once no files are needed to be made it cleans up its managed files (the files it acted on) then closes itself after uploading the payloads to the endpoint.

## Parameters

#### GetDCKaseyaName

| Parameter     | Required | Default | Type   | Description                                                                                             |
|---------------|----------|---------|--------|---------------------------------------------------------------------------------------------------------|
| agentguid     | true     |         | String | This is an agent guid you need to push to the script from the endpoint                                   |
| url           | true     |         | String | The URL for our api connection                                                                           |
| username      | true     |         | String | The username for api our connection                                                                      |
| password      | true     |         | String | The password for api our connection                                                                      |
| renametype    | false    |         | String | Set to SERIAL for Serial, Set to COMPUTERNAME for computer name, else the program will take input as computer name |
| customdomain  | false    |         | String | Input the domain name you wish to join to, there must be a domain controller for this domain in that org |

#### GetDCKaseyaName

| Parameter     | Required | Default | Type   | Description                                                                                             |
|---------------|----------|---------|--------|---------------------------------------------------------------------------------------------------------|
| agentguid     | true     |         | String | This is an agent guid you need to push to the script from the endpoint                                   |
| url           | true     |         | String | The URL for our api connection                                                                           |
| username      | true     |         | String | The username for api our connection                                                                      |
| password      | true     |         | String | The password for api our connection                                                                      |

## Output

Output files for endpoint are located in the same directory as the exe:  
`.//{YOURAGENTGUID}-EndpointCompName.txt - local file for dc to make djoin file`  
`.//RemoteADJoin_CreateDJOINFile-log.txt - log file for endpoint`  
`.//{YOURAGENTGUID}Z-DJoinPayload.txt - the djoin file`

## Locations

| Executable Endpoint                                                                                     | Executable DC                                                                                          |
|---------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
| [https://file.provaltech.com/repo/app/RemoteADJoin-CreateDJOINFileAPI.exe](https://file.provaltech.com/repo/app/MySQLConnectionPing.exe) | [https://file.provaltech.com/repo/app/RemoteADJoin-GetDCKaseyaNameAPI.exe](https://file.provaltech.com/repo/app/MySQLConnectionPing.exe) |
| Automate                                                                                               | N/A                                                                                                    |
| Kaseya endpoint procedure                                                                               | Shared / PVAL Stack / Tool Set - Global / Remote Domain Join                                          |
| Kaseya DC procedure                                                                                   | Shared / PVAL Stack / Tool Set - Global / Remote Domain Join                                          |













