---
id: 'cwa-cve-2021-40444-office365-mitigation-tracking'
title: 'CVE-2021-40444 Office 365 Mitigation Tracking'
title_meta: 'CVE-2021-40444 Office 365 Mitigation Tracking'
keywords: ['cve-2021-40444', 'office365', 'mitigation', 'tracking', 'rmm']
description: 'This document provides a detailed overview of the dataview tracking the results on agents where the CVE-2021-40444 Office 365 script mitigation has been applied. It includes dependencies, column descriptions, and SQL representation for data retrieval.'
tags: ['cve', 'tracking', 'mitigation', 'database', 'report']
draft: true
unlisted: true
---
## Summary

This dataview tracks the results on agents where the CVE-2021-40444 Office 365 script mitigation is applied.

## Dependencies

- [CVE-2021-40444 Office 365 Vulnerability 09-2021](https://proval.itglue.com/DOC-5078775-8226760)
- [CVE-2021-40444 Office 365 Detection](https://proval.itglue.com/DOC-5078775-8233671)

## Columns

| Column               | Description                                                                                   |
|---------------------|-----------------------------------------------------------------------------------------------|
| Client Name         | Client Name                                                                                   |
| Location Name       | Location Name                                                                                 |
| Computer Name       | Computer Name                                                                                 |
| Operating System     | Operating System of the agent                                                                 |
| Last Contact        | Last Contact with RMM                                                                         |
| User Logged In      | Stored username of the last logged in user to the endpoint                                    |
| Script Ran Count    | It stores info about how many times the script has run on the endpoint                       |
| Script Last Run     | It stores info about last run date of the script.                                            |
| User Response       | It stores the user response whether they approved the reboot or not                          |
| Mitigation Status   | It denotes whether mitigation has been successfully applied or is still pending a reboot.    |

## SQL Representation

```
SELECT 
  c.computerid, 
  c.clientid, 
  c.locationid, 
  cl.name as `Client Name`, 
  l.name as `Location Name`, 
  c.name as `Computer Name`, 
  c.os as `Operating System`, 
  c.LastContact as `Last Contact With RMM`, 
  c.LastUserName as `User LoggedIn`, 
  TRIM(
    SUBSTRING_INDEX(ss.value, '--', 1)
  ) as `Script Ran Count`, 
  CasE WHEN TRIM(
    SUBSTRING_INDEX(
      SUBSTRING_INDEX(ss.value, '--', 2), 
      '--', 
      -1
    )
  ) = ' ' THEN 'Not Detected' ELSE TRIM(
    SUBSTRING_INDEX(
      SUBSTRING_INDEX(ss.value, '--', 2), 
      '--', 
      -1
    )
  ) END as `Script Last Run`, 
  CasE WHEN TRIM(
    SUBSTRING_INDEX(
      SUBSTRING_INDEX(ss.value, '--', 3), 
      '--', 
      -1
    )
  ) = ' ' THEN 'Not Detected' ELSE TRIM(
    SUBSTRING_INDEX(
      SUBSTRING_INDEX(ss.value, '--', 3), 
      '--', 
      -1
    )
  ) END as `User Response`, 
  CasE WHEN TRIM(
    SUBSTRING_INDEX(
      SUBSTRING_INDEX(ss.value, '--', 4), 
      '--', 
      -1
    )
  ) = ' ' THEN 'Not Detected' ELSE TRIM(
    SUBSTRING_INDEX(
      SUBSTRING_INDEX(ss.value, '--', 4), 
      '--', 
      -1
    )
  ) END as `Mitigation Status` 
FROM 
  ( 
    ( 
      ( 
        computers c 
        LEFT JOIN scriptstate ss ON c.computerid = ss.computerid
      ) 
      LEFT JOIN clients cl ON cl.clientid = c.clientid
    ) 
    LEFT JOIN locations l ON l.locationid = c.locationid
  ) 
WHERE 
  ss.variable = 'CVE-2021-40444_Office365'
```



