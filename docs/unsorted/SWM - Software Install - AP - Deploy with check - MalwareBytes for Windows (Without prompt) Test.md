---
id: '767920e0-d62b-4b1a-a97c-333654c766ef'
title: 'Uninstall Old Malwarebytes and Install Latest Version'
title_meta: 'Uninstall Old Malwarebytes and Install Latest Version'
keywords: ['malwarebytes', 'uninstall', 'install', 'latest', 'version']
description: 'This procedure outlines the steps to uninstall the old version of Malwarebytes and install the latest version on machines. It includes checks for the necessary installation token and provides detailed logs of the procedure execution.'
tags: ['installation', 'malwarebytes', 'security', 'uninstallation', 'windows']
draft: true
unlisted: false
---
## Summary

This Procedure is used to Uninstall the Old Malwarebytes version and Install the latest version on the machines. The Script grabs the token to install the latest Malwarebytes from Org CF namely "MalwareBytes Token". If the token is not present then the script only uninstalls the old malware bytes version if present.

## Example Agent Procedure Log

Logs to uninstall the old version and did not install the new version as ORG CF "MalwareBytes Token" is not filled with token

| Time                     | Action                                                      | Status                      | User                             |
|--------------------------|-------------------------------------------------------------|-----------------------------|----------------------------------|
| 9:47:38 am 16-Dec-22     | Deploy with check - MalwareBytes for Windows (Without prompt) | Success THEN                | provaltech.com/ovais.rashid     |
| 9:47:38 am 16-Dec-22     | Deploy with check - MalwareBytes for Windows (Without prompt)-0010 | Machine is not 32 BIt Os    | provaltech.com/ovais.rashid     |
| 9:47:38 am 16-Dec-22     | Windows - 32 or 64 bit OS                                   | Success THEN                | provaltech.com/ovais.rashid     |
| 9:47:38 am 16-Dec-22     | Windows - 32 or 64 bit OS-0011                              | Windows OS is 64-bit.       | provaltech.com/ovais.rashid     |
| 9:47:37 am 16-Dec-22     | Deploy with check - MalwareBytes for Windows (Without prompt) | False                       | provaltech.com/ovais.rashid     |
| 9:47:37 am 16-Dec-22     | Execute Shell command - Get Results to Variable             | Success THEN                | provaltech.com/ovais.rashid     |
| 9:47:34 am 16-Dec-22     | Execute Shell command - Get Results to Variable-0005        | Executing command in 64-bit shell as system: C:/Windows/System32/WindowsPowerShell/v1.0/powershell.exe -ExecutionPolicy Bypass -Command C:/provaltech/malwarebytes32bit.ps1 >"c:/provaltech/commandresults-1592077206.txt" 2>&1 | provaltech.com/ovais.rashid     |
| 9:47:32 am 16-Dec-22     | Write text to file                                          | Success THEN                | provaltech.com/ovais.rashid     |
| 9:47:31 am 16-Dec-22     | Write text to file-0002                                     | Overwrite enabled and file exists - deleting before write process. | provaltech.com/ovais.rashid     |
| 9:47:31 am 16-Dec-22     | Deploy with check - MalwareBytes for Windows (Without prompt)-0006 | MalwareBytes installation run, check dashboard for status | provaltech.com/ovais.rashid     |
| 9:47:31 am 16-Dec-22     | Deploy with check - MalwareBytes for Windows (Without prompt)-0006 | Comment at THEN step 3      | provaltech.com/ovais.rashid     |
| 9:47:24 am 16-Dec-22     | Windows - 32 or 64 bit OS                                   | Success THEN                | provaltech.com/ovais.rashid     |
| 9:47:24 am 16-Dec-22     | Windows - 32 or 64 bit OS-0011                              | Windows OS is 64-bit.       | provaltech.com/ovais.rashid     |
| 9:47:24 am 16-Dec-22     | Deploy with check - MalwareBytes for Windows (Without prompt) | False False False False False | provaltech.com/ovais.rashid     |
| 9:47:24 am 16-Dec-22     | Execute Shell command - Get Results to Variable             | Success THEN                | provaltech.com/ovais.rashid     |
| 9:47:21 am 16-Dec-22     | Execute Shell command - Get Results to Variable-0005        | Executing command in 64-bit shell as system: C:/Windows/System32/WindowsPowerShell/v1.0/powershell.exe -ExecutionPolicy Bypass -Command C:/provaltech/malwarebytes64bit.ps1 >"c:/provaltech/commandresults-577953449.txt" 2>&1 | provaltech.com/ovais.rashid     |
| 9:47:20 am 16-Dec-22     | Write text to file                                          | Success THEN                | provaltech.com/ovais.rashid     |
| 9:47:19 am 16-Dec-22     | Write text to file-0003                                     | Overwrite disabled and file exists - adding text to existing file. | provaltech.com/ovais.rashid     |
| 9:47:19 am 16-Dec-22     | Deploy with check - MalwareBytes for Windows (Without prompt)-0002 | Malwarebytes 32 bit version found and removed successfully | provaltech.com/ovais.rashid     |
| 9:47:17 am 16-Dec-22     | Deploy with check - MalwareBytes for Windows (Without prompt)-0001 | 64 Bit malwareBytes are not present | provaltech.com/ovais.rashid     |
| 9:47:17 am 16-Dec-22     | Deploy with check - MalwareBytes for Windows (Without prompt) | Comment at THEN step 5      | provaltech.com/ovais.rashid     |
| 9:47:17 am 16-Dec-22     | Deploy with check - MalwareBytes for Windows (Without prompt) | orgGUID: 25112131431621572261613213 | provaltech.com/ovais.rashid     |
| 9:47:10 am 16-Dec-22     | Run Now - Deploy with check - MalwareBytes for Windows (Without prompt) | Admin provaltech.com/ovais.rashid scheduled procedure Run Now - Deploy with check - MalwareBytes for Windows (Without prompt) to run at Dec 16 2022 9:47AM | provaltech.com/ovais.rashid     |

Logs when old version was not present and the LATEST VERSION was already installed.

| Time                     | Action                                                      | Status                      | User                             |
|--------------------------|-------------------------------------------------------------|-----------------------------|----------------------------------|
| 5:02:43 am 07-Dec-22     | Deploy with check - MalwareBytes for Windows (Without prompt) Test | Script Summary: Success THEN | provaladmin                      |
| 5:02:43 am 07-Dec-22     | Deploy with check - MalwareBytes for Windows (Without prompt) Test-0005 | 64Bit Latest version of MalwareBytes is already installed | provaladmin                      |
| 5:02:43 am 07-Dec-22     | Windows - 32 or 64 bit OS                                   | Script Summary: Success THEN | provaladmin                      |
| 5:02:43 am 07-Dec-22     | Windows - 32 or 64 bit OS-0011                              | Windows OS is 64-bit.       | provaladmin                      |
| 5:02:43 am 07-Dec-22     | Deploy with check - MalwareBytes for Windows (Without prompt) Test-0002 | 32bit path is not Present and Old Version is already Uninstalled | provaladmin                      |
| 5:02:43 am 07-Dec-22     | Deploy with check - MalwareBytes for Windows (Without prompt) Test-0001 | 64 Bit path is not Present and Old Version is already Uninstalled | provaladmin                      |
| 5:02:43 am 07-Dec-22     | Deploy with check - MalwareBytes for Windows (Without prompt) Test | de56be1c-0e80-4946-b673-56b096a9030f | provaladmin                      |
| 5:02:43 am 07-Dec-22     | Deploy with check - MalwareBytes for Windows (Without prompt) Test | orgGUID: 36197532434171111895249772 | provaladmin                      |
| 5:02:36 am 07-Dec-22     | Run Now - Deploy with check - MalwareBytes for Windows (Without prompt) Test | Admin provaladmin scheduled procedure Run Now - Deploy with check - MalwareBytes for Windows (Without prompt) Test to run at Dec 7 2022 5:02AM | provaladmin                      |

## Dependencies

No Dependencies

## Process

The script first checks if the old version is installed and then remove it. Then checks whether the latest version is installed or not if not then install the latest version. The script grabs the token from org CF.

## Output

Procedure Logfiles.













