---
id: '29b9b4f6-5032-4673-b983-8a8a33883143'
title: 'Office 365 CVE-2021-40444 Mitigation Monitor'
title_meta: 'Office 365 CVE-2021-40444 Mitigation Monitor'
keywords: ['cve', 'office365', 'vulnerability', 'monitor', 'mitigation']
description: 'This document outlines an internal monitor designed to detect agents where the ActiveX mitigation for the CVE-2021-40444 vulnerability in Office 365 has not been applied. It includes dependencies, target environment, and a translated SQL query for implementation.'
tags: ['active-directory', 'database', 'security', 'windows']
draft: true
unlisted: false
---
## Summary

This internal monitor will catch the agents where the ActiveX mitigation for the CVE-2021-40444 Office 365 vulnerability is not applied.

## Dependencies

- [CVE-2021-40444 Office 365 Vulnerability Report](<./CVE-2021-40444 Office 365 Vulnerability Report.md>) 
- [CVE-2021-40444 Office 365 Vulnerability 09-2021](<./CVE-2021-40444 Office 365 Vulnerability 09-2021.md>) 

## Target

Windows Machine

## Translated SQL

```sql
SELECT 
'Mitigation Not Applied' AS TestValue,
c.name AS IDentityField,
cl.name AS `Client Name`,
c.name AS `Computer Name`,
c.lAStcontact AS `LASt Contact`,
acd.uptimestart,
acd.uptimeend,
acd.noalerts,
c.ComputerID
FROM computers c 
LEFT JOIN clients cl on cl.clientid=c.clientid
LEFT JOIN agentcomputerdata acd ON acd.computerid=c.computerid
WHERE
c.computerid NOT IN (SELECT computerid FROM scriptstate WHERE variable = 'CVE-2021-40444_Office365' AND `value` LIKE '%Mitigation Applied%')
AND c.computerid NOT IN (SELECT computerid FROM scriptstate WHERE variable = 'CVE-2021-40444_Office365' AND `value` LIKE '%Mitigation Pending to Restart%')
AND c.computerid IN (SELECT computerid FROM tcomp)
AND c.lAStcontact > NOW() - INTERVAL 15 MINUTE
```














